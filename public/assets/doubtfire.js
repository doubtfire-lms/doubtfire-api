/**
 * doubtfire - v4.0.0 - 2016-04-29
 * http://doubtfire.ict.swin.edu.au
 *
 * Copyright (c) 2016 
 */
function uiCodemirrorDirective($timeout,uiCodemirrorConfig){function postLink(scope,iElement,iAttrs,ngModel){var codemirrorOptions=angular.extend({value:iElement.text()},uiCodemirrorConfig.codemirror||{},scope.$eval(iAttrs.uiCodemirror),scope.$eval(iAttrs.uiCodemirrorOpts)),codemirror=newCodemirrorEditor(iElement,codemirrorOptions);configOptionsWatcher(codemirror,iAttrs.uiCodemirror||iAttrs.uiCodemirrorOpts,scope),configNgModelLink(codemirror,ngModel,scope),configUiRefreshAttribute(codemirror,iAttrs.uiRefresh,scope),scope.$on("CodeMirror",function(event,callback){if(!angular.isFunction(callback))throw new Error("the CodeMirror event requires a callback function");callback(codemirror)}),angular.isFunction(codemirrorOptions.onLoad)&&codemirrorOptions.onLoad(codemirror)}function newCodemirrorEditor(iElement,codemirrorOptions){var codemirrot;return"TEXTAREA"===iElement[0].tagName?codemirrot=window.CodeMirror.fromTextArea(iElement[0],codemirrorOptions):(iElement.html(""),codemirrot=new window.CodeMirror(function(cm_el){iElement.append(cm_el)},codemirrorOptions)),codemirrot}function configOptionsWatcher(codemirrot,uiCodemirrorAttr,scope){function updateOptions(newValues,oldValue){angular.isObject(newValues)&&codemirrorDefaultsKeys.forEach(function(key){if(newValues.hasOwnProperty(key)){if(oldValue&&newValues[key]===oldValue[key])return;codemirrot.setOption(key,newValues[key])}})}if(uiCodemirrorAttr){var codemirrorDefaultsKeys=Object.keys(window.CodeMirror.defaults);scope.$watch(uiCodemirrorAttr,updateOptions,!0)}}function configNgModelLink(codemirror,ngModel,scope){ngModel&&(ngModel.$formatters.push(function(value){if(angular.isUndefined(value)||null===value)return"";if(angular.isObject(value)||angular.isArray(value))throw new Error("ui-codemirror cannot use an object or an array as a model");return value}),ngModel.$render=function(){var safeViewValue=ngModel.$viewValue||"";codemirror.setValue(safeViewValue)},codemirror.on("change",function(instance){var newValue=instance.getValue();newValue!==ngModel.$viewValue&&scope.$evalAsync(function(){ngModel.$setViewValue(newValue)})}))}function configUiRefreshAttribute(codeMirror,uiRefreshAttr,scope){uiRefreshAttr&&scope.$watch(uiRefreshAttr,function(newVal,oldVal){newVal!==oldVal&&$timeout(function(){codeMirror.refresh()})})}return{restrict:"EA",require:"?ngModel",compile:function(){if(angular.isUndefined(window.CodeMirror))throw new Error("ui-codemirror needs CodeMirror to work... (o rly?)");return postLink}}}!function(window,document,undefined){"use strict";function minErr(module){return function(){var message,i,code=arguments[0],prefix="["+(module?module+":":"")+code+"] ",template=arguments[1],templateArgs=arguments,stringify=function(obj){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof obj?"undefined":"string"!=typeof obj?JSON.stringify(obj):obj};for(message=prefix+template.replace(/\{\d+\}/g,function(match){var arg,index=+match.slice(1,-1);return index+2<templateArgs.length?(arg=templateArgs[index+2],"function"==typeof arg?arg.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof arg?"undefined":"string"!=typeof arg?toJson(arg):arg):match}),message=message+"\nhttp://errors.angularjs.org/1.2.28/"+(module?module+"/":"")+code,i=2;i<arguments.length;i++)message=message+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(stringify(arguments[i]));return new Error(message)}}function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;var length=obj.length;return 1===obj.nodeType&&length?!0:isString(obj)||isArray(obj)||0===length||"number"==typeof length&&length>0&&length-1 in obj}function forEach(obj,iterator,context){var key;if(obj)if(isFunction(obj))for(key in obj)"prototype"==key||"length"==key||"name"==key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key);else if(isArray(obj)||isArrayLike(obj))for(key=0;key<obj.length;key++)iterator.call(context,obj[key],key);else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context);else for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key);return obj}function sortedKeys(obj){var keys=[];for(var key in obj)obj.hasOwnProperty(key)&&keys.push(key);return keys.sort()}function forEachSorted(obj,iterator,context){for(var keys=sortedKeys(obj),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){for(var digit,index=uid.length;index;){if(index--,digit=uid[index].charCodeAt(0),57==digit)return uid[index]="A",uid.join("");if(90!=digit)return uid[index]=String.fromCharCode(digit+1),uid.join("");uid[index]="0"}return uid.unshift("0"),uid.join("")}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function extend(dst){var h=dst.$$hashKey;return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst[key]=value})}),setHashKey(dst,h),dst}function int(str){return parseInt(str,10)}function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!=value&&"object"==typeof value}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.document&&obj.location&&obj.alert&&obj.setInterval}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.call(obj)}function isBlob(obj){return"[object Blob]"===toString.call(obj)}function isPromiseLike(obj){return obj&&isFunction(obj.then)}function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function map(obj,iterator,context){var results=[];return forEach(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results}function includes(array,obj){return-1!=indexOf(array,obj)}function indexOf(array,obj){if(array.indexOf)return array.indexOf(obj);for(var i=0;i<array.length;i++)if(obj===array[i])return i;return-1}function arrayRemove(array,value){var index=indexOf(array,value);return index>=0&&array.splice(index,1),value}function copy(source,destination,stackSource,stackDest){if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(destination){if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");if(stackSource=stackSource||[],stackDest=stackDest||[],isObject(source)){var index=indexOf(stackSource,source);if(-1!==index)return stackDest[index];stackSource.push(source),stackDest.push(destination)}var result;if(isArray(source)){destination.length=0;for(var i=0;i<source.length;i++)result=copy(source[i],null,stackSource,stackDest),isObject(source[i])&&(stackSource.push(source[i]),stackDest.push(result)),destination.push(result)}else{var h=destination.$$hashKey;isArray(destination)?destination.length=0:forEach(destination,function(value,key){delete destination[key]});for(var key in source)result=copy(source[key],null,stackSource,stackDest),isObject(source[key])&&(stackSource.push(source[key]),stackDest.push(result)),destination[key]=result;setHashKey(destination,h)}}else destination=source,source&&(isArray(source)?destination=copy(source,[],stackSource,stackDest):isDate(source)?destination=new Date(source.getTime()):isRegExp(source)?(destination=new RegExp(source.source,source.toString().match(/[^\/]*$/)[0]),destination.lastIndex=source.lastIndex):isObject(source)&&(destination=copy(source,{},stackSource,stackDest)));return destination}function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0;i<src.length;i++)dst[i]=src[i]}else if(isObject(src)){dst=dst||{};for(var key in src)!hasOwnProperty.call(src,key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key])}return dst||src}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)?isNaN(o1.getTime())&&isNaN(o2.getTime())||o1.getTime()===o2.getTime():!1;if(isRegExp(o1)&&isRegExp(o2))return o1.toString()==o2.toString();if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2))return!1;keySet={};for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!keySet.hasOwnProperty(key)&&"$"!==key.charAt(0)&&o2[key]!==undefined&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)==o2.length){for(key=0;length>key;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,curryArgs.concat(slice.call(arguments,0))):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)?val=undefined:isWindow(value)?val="$WINDOW":value&&document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){return"undefined"==typeof obj?undefined:JSON.stringify(obj,toJsonReplacer,pretty?"  ":null)}function fromJson(json){return isString(json)?JSON.parse(json):json}function toBoolean(value){if("function"==typeof value)value=!0;else if(value&&0!==value.length){var v=lowercase(""+value);value=!("f"==v||"0"==v||"false"==v||"no"==v||"n"==v||"[]"==v)}else value=!1;return value}function startingTag(element){element=jqLite(element).clone();try{element.empty()}catch(e){}var TEXT_NODE=3,elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===TEXT_NODE?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var key_value,key,obj={};return forEach((keyValue||"").split("&"),function(keyValue){if(keyValue&&(key_value=keyValue.replace(/\+/g,"%20").split("="),key=tryDecodeURIComponent(key_value[0]),isDefined(key))){var val=isDefined(key_value[1])?tryDecodeURIComponent(key_value[1]):!0;hasOwnProperty.call(obj,key)?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val}}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(arrayValue===!0?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function angularInit(element,bootstrap){function append(element){element&&elements.push(element)}var appElement,module,elements=[element],names=["ng:app","ng-app","x-ng-app","data-ng-app"],NG_APP_CLASS_REGEXP=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;forEach(names,function(name){names[name]=!0,append(document.getElementById(name)),name=name.replace(":","\\:"),element.querySelectorAll&&(forEach(element.querySelectorAll("."+name),append),forEach(element.querySelectorAll("."+name+"\\:"),append),forEach(element.querySelectorAll("["+name+"]"),append))}),forEach(elements,function(element){if(!appElement){var className=" "+element.className+" ",match=NG_APP_CLASS_REGEXP.exec(className);match?(appElement=element,module=(match[2]||"").replace(/\s+/g,",")):forEach(element.attributes,function(attr){!appElement&&names[attr.name]&&(appElement=element,module=attr.value)})}}),appElement&&bootstrap(appElement,module?[module]:[])}function bootstrap(element,modules){var doBootstrap=function(){if(element=jqLite(element),element.injector()){var tag=element[0]===document?"document":startingTag(element);throw ngMinErr("btstrpd","App Already Bootstrapped with this Element '{0}'",tag.replace(/</,"&lt;").replace(/>/,"&gt;"))}modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),modules.unshift("ng");var injector=createInjector(modules);return injector.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&!NG_DEFER_BOOTSTRAP.test(window.name)?doBootstrap():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),void(angular.resumeBootstrap=function(extraModules){forEach(extraModules,function(module){modules.push(module)}),doBootstrap()}))}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){jQuery=window.jQuery,jQuery&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),jqLitePatchJQueryRemove("remove",!0,!0,!1),jqLitePatchJQueryRemove("empty",!1,!1,!1),jqLitePatchJQueryRemove("html",!1,!1,!0)):jqLite=JQLite,angular.element=jqLite}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;len>i;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function getBlockElements(nodes){var startNode=nodes[0],endNode=nodes[nodes.length-1];if(startNode===endNode)return jqLite(startNode);var element=startNode,elements=[element];do{if(element=element.nextSibling,!element)break;elements.push(element)}while(element!==endNode);return jqLite(elements)}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng"),angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var assertNotHasOwnProperty=function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)};return assertNotHasOwnProperty(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod){return function(){return invokeQueue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],runBlocks=[],config=invokeLater("$injector","invoke"),moduleInstance={_invokeQueue:invokeQueue,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLater("$provide","provider"),factory:invokeLater("$provide","factory"),service:invokeLater("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),animation:invokeLater("$animateProvider","register"),filter:invokeLater("$filterProvider","register"),controller:invokeLater("$controllerProvider","register"),directive:invokeLater("$compileProvider","directive"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{counter:0},$$minErr:minErr,$$csp:csp}),angularModule=setupModuleLoader(window);try{angularModule("ngLocale")}catch(e){angularModule("ngLocale",[]).provider("$locale",$LocaleProvider)}angularModule("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,required:requiredDirective,ngRequired:requiredDirective,ngValue:ngValueDirective}).directive({ngInclude:ngIncludeFillContentDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$http:$HttpProvider,$httpBackend:$HttpBackendProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$asyncCallback:$$AsyncCallbackProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function jqLitePatchJQueryRemove(name,dispatchThis,filterElems,getterIfNoArguments){function removePatch(param){var set,setIndex,setLength,element,childIndex,childLength,children,list=filterElems&&param?[this.filter(param)]:[this],fireEvent=dispatchThis;if(!getterIfNoArguments||null!=param)for(;list.length;)for(set=list.shift(),setIndex=0,setLength=set.length;setLength>setIndex;setIndex++)for(element=jqLite(set[setIndex]),fireEvent?element.triggerHandler("$destroy"):fireEvent=!fireEvent,childIndex=0,childLength=(children=element.children()).length;childLength>childIndex;childIndex++)list.push(jQuery(children[childIndex]));return originalJqFn.apply(this,arguments)}var originalJqFn=jQuery.fn[name];originalJqFn=originalJqFn.$original||originalJqFn,removePatch.$original=originalJqFn,jQuery.fn[name]=removePatch}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteBuildFragment(html,context){var tmp,tag,wrap,i,j,jj,fragment=context.createDocumentFragment(),nodes=[];if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{for(tmp=fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML="<div>&#160;</div>"+wrap[1]+html.replace(XHTML_TAG_REGEXP,"<$1></$2>")+wrap[2],tmp.removeChild(tmp.firstChild),i=wrap[0];i--;)tmp=tmp.lastChild;for(j=0,jj=tmp.childNodes.length;jj>j;++j)nodes.push(tmp.childNodes[j]);tmp=fragment.firstChild,tmp.textContent=""}return fragment.textContent="",fragment.innerHTML="",nodes}function jqLiteParseHTML(html,context){context=context||document;var parsed;return(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:jqLiteBuildFragment(html,context)}function JQLite(element){if(element instanceof JQLite)return element;if(isString(element)&&(element=trim(element)),!(this instanceof JQLite)){if(isString(element)&&"<"!=element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}if(isString(element)){jqLiteAddNodes(this,jqLiteParseHTML(element));var fragment=jqLite(document.createDocumentFragment());fragment.append(this)}else jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element){jqLiteRemoveData(element);for(var i=0,children=element.childNodes||[];i<children.length;i++)jqLiteDealoc(children[i])}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var events=jqLiteExpandoStore(element,"events"),handle=jqLiteExpandoStore(element,"handle");handle&&(isUndefined(type)?forEach(events,function(eventHandler,type){removeEventListenerFn(element,type,eventHandler),delete events[type]}):forEach(type.split(" "),function(type){isUndefined(fn)?(removeEventListenerFn(element,type,events[type]),delete events[type]):arrayRemove(events[type]||[],fn)}))}function jqLiteRemoveData(element,name){var expandoId=element.ng339,expandoStore=jqCache[expandoId];if(expandoStore){if(name)return void delete jqCache[expandoId].data[name];expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),jqLiteOff(element)),delete jqCache[expandoId],element.ng339=undefined}}function jqLiteExpandoStore(element,key,value){var expandoId=element.ng339,expandoStore=jqCache[expandoId||-1];return isDefined(value)?(expandoStore||(element.ng339=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={}),void(expandoStore[key]=value)):expandoStore&&expandoStore[key]}function jqLiteData(element,key,value){var data=jqLiteExpandoStore(element,"data"),isSetter=isDefined(value),keyDefined=!isSetter&&isDefined(key),isSimpleGetter=keyDefined&&!isObject(key);if(data||isSimpleGetter||jqLiteExpandoStore(element,"data",data={}),isSetter)data[key]=value;else{if(!keyDefined)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}function jqLiteHasClass(element,selector){return element.getAttribute?(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1:!1}function jqLiteRemoveClass(element,cssClasses){cssClasses&&element.setAttribute&&forEach(cssClasses.split(" "),function(cssClass){element.setAttribute("class",trim((" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," ")))})}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),-1===existingClasses.indexOf(" "+cssClass+" ")&&(existingClasses+=cssClass+" ")}),element.setAttribute("class",trim(existingClasses))}}function jqLiteAddNodes(root,elements){if(elements){elements=elements.nodeName||!isDefined(elements.length)||isWindow(elements)?[elements]:elements;for(var i=0;i<elements.length;i++)root.push(elements[i])}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){9==element.nodeType&&(element=element.documentElement);for(var names=isArray(name)?name:[name];element;){for(var i=0,ii=names.length;ii>i;i++)if((value=jqLite.data(element,names[i]))!==undefined)return value;element=element.parentNode||11===element.nodeType&&element.host}}function jqLiteEmpty(element){for(var i=0,childNodes=element.childNodes;i<childNodes.length;i++)jqLiteDealoc(childNodes[i]);for(;element.firstChild;)element.removeChild(element.firstChild)}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[element.nodeName]&&booleanAttr}function createEventHandler(element,events){var eventHandler=function(event,type){if(event.preventDefault||(event.preventDefault=function(){event.returnValue=!1}),event.stopPropagation||(event.stopPropagation=function(){event.cancelBubble=!0}),event.target||(event.target=event.srcElement||document),isUndefined(event.defaultPrevented)){var prevent=event.preventDefault;event.preventDefault=function(){event.defaultPrevented=!0,prevent.call(event)},event.defaultPrevented=!1}event.isDefaultPrevented=function(){return event.defaultPrevented||event.returnValue===!1};var eventHandlersCopy=shallowCopy(events[type||event.type]||[]);forEach(eventHandlersCopy,function(fn){fn.call(element,event)}),8>=msie?(event.preventDefault=null,event.stopPropagation=null,event.isDefaultPrevented=null):(delete event.preventDefault,delete event.stopPropagation,delete event.isDefaultPrevented)};return eventHandler.elem=element,eventHandler}function hashKey(obj,nextUidFn){var key,objType=typeof obj;return"function"==objType||"object"==objType&&null!==obj?"function"==typeof(key=obj.$$hashKey)?key=obj.$$hashKey():key===undefined&&(key=obj.$$hashKey=(nextUidFn||nextUid)()):key=obj,objType+":"+key}function HashMap(array,isolatedUid){if(isolatedUid){var uid=0;this.nextUid=function(){return++uid}}forEach(array,this.put,this)}function annotate(fn){var $inject,fnText,argDecl,last;return"function"==typeof fn?($inject=fn.$inject)||($inject=[],fn.length&&(fnText=fn.toString().replace(STRIP_COMMENTS,""),argDecl=fnText.match(FN_ARGS),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})),fn.$inject=$inject):isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0),$inject}function createInjector(modulesToLoad){function supportObject(delegate){return function(key,value){return isObject(key)?void forEach(key,reverseParams(delegate)):delegate(key,value)}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function factory(name,factoryFn){return provider(name,{$get:factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,val){return factory(name,valueFn(val))}function constant(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){var moduleFn,invokeQueue,i,ii,runBlocks=[];return forEach(modulesToLoad,function(module){if(!loadedModules.get(module)){loadedModules.put(module,!0);try{if(isString(module))for(moduleFn=angularModule(module),runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),invokeQueue=moduleFn._invokeQueue,i=0,ii=invokeQueue.length;ii>i;i++){var invokeArgs=invokeQueue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}else isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName)}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function invoke(fn,self,locals){var length,i,key,args=[],$inject=annotate(fn);for(i=0,length=$inject.length;length>i;i++){if(key=$inject[i],"string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key))}return isArray(fn)&&(fn=fn[length]),fn.apply(self,args)}function instantiate(Type,locals){var instance,returnedValue,Constructor=function(){};return Constructor.prototype=(isArray(Type)?Type[Type.length-1]:Type).prototype,instance=new Constructor,returnedValue=invoke(Type,instance,locals),isObject(returnedValue)||isFunction(returnedValue)?returnedValue:instance}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap([],!0),providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(){throw $injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},instanceInjector=instanceCache.$injector=createInternalInjector(instanceCache,function(servicename){var provider=providerInjector.get(servicename+providerSuffix);return instanceInjector.invoke(provider.$get,provider)});return forEach(loadModules(modulesToLoad),function(fn){instanceInjector.invoke(fn||noop)}),instanceInjector
}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return forEach(list,function(element){result||"a"!==lowercase(element.nodeName)||(result=element)}),result}function scroll(){var elm,hash=$location.hash();hash?(elm=document.getElementById(hash))?elm.scrollIntoView():(elm=getFirstAnchor(document.getElementsByName(hash)))?elm.scrollIntoView():"top"===hash&&$window.scrollTo(0,0):$window.scrollTo(0,0)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(){$rootScope.$evalAsync(scroll)}),scroll}]}function $$AsyncCallbackProvider(){this.$get=["$$rAF","$timeout",function($$rAF,$timeout){return $$rAF.supported?function(fn){return $$rAF(fn)}:function(fn){return $timeout(fn,0,!1)}}]}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function startPoller(interval,setTimeout){!function check(){forEach(pollFns,function(pollFn){pollFn()}),pollTimeout=setTimeout(check,interval)}()}function fireUrlChange(){lastBrowserUrl!=self.url()&&(lastBrowserUrl=self.url(),forEach(urlChangeListeners,function(listener){listener(self.url())}))}var self=this,rawDocument=document[0],location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){forEach(pollFns,function(pollFn){pollFn()}),0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var pollTimeout,pollFns=[];self.addPollFn=function(fn){return isUndefined(pollTimeout)&&startPoller(100,setTimeout),pollFns.push(fn),fn};var lastBrowserUrl=location.href,baseElement=document.find("base"),reloadLocation=null;self.url=function(url,replace){if(location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){if(lastBrowserUrl==url)return;var sameBase=lastBrowserUrl&&stripHash(lastBrowserUrl)===stripHash(url);return lastBrowserUrl=url,!sameBase&&$sniffer.history?replace?history.replaceState(null,"",url):(history.pushState(null,"",url),baseElement.attr("href",baseElement.attr("href"))):(sameBase||(reloadLocation=url),replace?location.replace(url):location.href=url),self}return reloadLocation||location.href.replace(/%27/g,"'")};var urlChangeListeners=[],urlChangeInit=!1;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",fireUrlChange),$sniffer.hashchange?jqLite(window).on("hashchange",fireUrlChange):self.addPollFn(fireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.$$checkUrlChange=fireUrlChange,self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var lastCookies={},lastCookieString="",cookiePath=self.baseHref();self.cookies=function(name,value){var cookieLength,cookieArray,cookie,i,index;if(!name){if(rawDocument.cookie!==lastCookieString)for(lastCookieString=rawDocument.cookie,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)cookie=cookieArray[i],index=cookie.indexOf("="),index>0&&(name=unescape(cookie.substring(0,index)),lastCookies[name]===undefined&&(lastCookies[name]=unescape(cookie.substring(index+1))));return lastCookies}value===undefined?rawDocument.cookie=escape(name)+"=;path="+cookiePath+";expires=Thu, 01 Jan 1970 00:00:00 GMT":isString(value)&&(cookieLength=(rawDocument.cookie=escape(name)+"="+escape(value)+";path="+cookiePath).length+1,cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"))},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return pendingDeferIds[deferId]?(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0):!1}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data={},capacity=options&&options.capacity||Number.MAX_VALUE,lruHash={},freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry)}if(!isUndefined(value))return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}delete data[key],size--},removeAll:function(){data={},size=0,lruHash={},freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function $CompileProvider($provide,$$sanitizeUriProvider){var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\d\w_\-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\d\w_\-]+)(?:\:([^;]+))?;?)/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/;this.directive=function registerDirective(name,directiveFactory){return assertNotHasOwnProperty(name,"directive"),isString(name)?(assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=directive.require||directive.controller&&directive.name,directive.restrict=directive.restrict||"A",directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function($injector,$interpolate,$exceptionHandler,$http,$templateCache,$parse,$controller,$rootScope,$document,$sce,$animate,$$sanitizeUri){function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes)),forEach($compileNodes,function(node,index){3==node.nodeType&&node.nodeValue.match(/\S+/)&&($compileNodes[index]=node=jqLite(node).wrap("<span></span>").parent()[0])});var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);return safeAddClass($compileNodes,"ng-scope"),function(scope,cloneConnectFn,transcludeControllers,parentBoundTranscludeFn){assertArg(scope,"scope");var $linkNode=cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes;forEach(transcludeControllers,function(instance,name){$linkNode.data("$"+name+"Controller",instance)});for(var i=0,ii=$linkNode.length;ii>i;i++){var node=$linkNode[i],nodeType=node.nodeType;(1===nodeType||9===nodeType)&&$linkNode.eq(i).data("$scope",scope)}return cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),$linkNode}}function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){function compositeLinkFn(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,i,ii,n,childBoundTranscludeFn,nodeListLength=nodeList.length,stableNodeList=new Array(nodeListLength);for(i=0;nodeListLength>i;i++)stableNodeList[i]=nodeList[i];for(i=0,n=0,ii=linkFns.length;ii>i;n++)node=stableNodeList[n],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),jqLite.data(node,"$scope",childScope)):childScope=scope,childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,undefined,parentBoundTranscludeFn)}for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:undefined,ignoreDirective),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null,nodeLinkFn&&nodeLinkFn.scope&&safeAddClass(attrs.$$element,"ng-scope"),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),linkFns.push(nodeLinkFn,childLinkFn),linkFnFound=linkFnFound||nodeLinkFn||childLinkFn,previousCompileContext=null;return linkFnFound?compositeLinkFn:null}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){var boundTranscludeFn=function(transcludedScope,cloneFn,controllers){var scopeCreated=!1;transcludedScope||(transcludedScope=scope.$new(),transcludedScope.$$transcluded=!0,scopeCreated=!0);var clone=transcludeFn(transcludedScope,cloneFn,controllers,previousBoundTranscludeFn);return scopeCreated&&clone.on("$destroy",function(){transcludedScope.$destroy()}),clone};return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case 1:addDirective(directives,directiveNormalize(nodeName_(node).toLowerCase()),"E",maxPriority,ignoreDirective);for(var attr,name,nName,ngAttrName,value,isNgAttr,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;jj>j;j++){var attrStartName=!1,attrEndName=!1;if(attr=nAttrs[j],!msie||msie>=8||attr.specified){name=attr.name,value=trim(attr.value),ngAttrName=directiveNormalize(name),(isNgAttr=NG_ATTR_BINDING.test(ngAttrName))&&(name=snake_case(ngAttrName.substr(6),"-"));var directiveNName=ngAttrName.replace(/(Start|End)$/,"");ngAttrName===directiveNName+"Start"&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,(isNgAttr||!attrs.hasOwnProperty(nName))&&(attrs[nName]=value,getBooleanAttrName(node,nName)&&(attrs[nName]=!0)),addAttrInterpolateDirective(node,directives,value,nName),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName)}}if(className=node.className,isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case 3:addTextInterpolateDirective(directives,node.nodeValue);break;case 8:try{match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue),match&&(nName=directiveNormalize(match[1]),addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2])))}catch(e){}}return directives.sort(byPriority),directives}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart)){do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);1==node.nodeType&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0)}else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function getControllers(directiveName,require,$element,elementControllers){var value,retrievalMethod="data",optional=!1;if(isString(require)){for(;"^"==(value=require.charAt(0))||"?"==value;)require=require.substr(1),"^"==value&&(retrievalMethod="inheritedData"),optional=optional||"?"==value;if(value=null,elementControllers&&"data"===retrievalMethod&&(value=elementControllers[require]),value=value||$element[retrievalMethod]("$"+require+"Controller"),!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",require,directiveName);return value}return isArray(require)&&(value=[],forEach(require,function(require){value.push(getControllers(directiveName,require,$element,elementControllers))})),value}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){function controllersBoundTransclude(scope,cloneAttachFn){var transcludeControllers;return arguments.length<2&&(cloneAttachFn=scope,scope=undefined),hasElementTranscludeDirective&&(transcludeControllers=elementControllers),boundTranscludeFn(scope,cloneAttachFn,transcludeControllers)}var attrs,$element,i,ii,linkFn,controller,isolateScope,transcludeFn,elementControllers={};if(attrs=compileNode===linkNode?templateAttrs:shallowCopy(templateAttrs,new Attributes(jqLite(linkNode),templateAttrs.$attr)),$element=attrs.$$element,newIsolateScopeDirective){var LOCAL_REGEXP=/^\s*([@=&])(\??)\s*(\w*)\s*$/;isolateScope=scope.$new(!0),!templateDirective||templateDirective!==newIsolateScopeDirective&&templateDirective!==newIsolateScopeDirective.$$originalDirective?$element.data("$isolateScopeNoTemplate",isolateScope):$element.data("$isolateScope",isolateScope),safeAddClass($element,"ng-isolate-scope"),forEach(newIsolateScopeDirective.scope,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,match=definition.match(LOCAL_REGEXP)||[],attrName=match[3]||scopeName,optional="?"==match[2],mode=match[1];switch(isolateScope.$$isolateBindings[scopeName]=mode+attrName,mode){case"@":attrs.$observe(attrName,function(value){isolateScope[scopeName]=value}),attrs.$$observers[attrName].$$scope=scope,attrs[attrName]&&(isolateScope[scopeName]=$interpolate(attrs[attrName])(scope));break;case"=":if(optional&&!attrs[attrName])return;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:function(a,b){return a===b||a!==a&&b!==b},parentSet=parentGet.assign||function(){throw lastValue=isolateScope[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",attrs[attrName],newIsolateScopeDirective.name)},lastValue=isolateScope[scopeName]=parentGet(scope),isolateScope.$watch(function(){var parentValue=parentGet(scope);return compare(parentValue,isolateScope[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=isolateScope[scopeName]):isolateScope[scopeName]=parentValue),lastValue=parentValue},null,parentGet.literal);break;case"&":parentGet=$parse(attrs[attrName]),isolateScope[scopeName]=function(locals){return parentGet(scope,locals)};break;default:throw $compileMinErr("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",newIsolateScopeDirective.name,scopeName,definition)}})}for(transcludeFn=boundTranscludeFn&&controllersBoundTransclude,controllerDirectives&&forEach(controllerDirectives,function(directive){var controllerInstance,locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn};controller=directive.controller,"@"==controller&&(controller=attrs[directive.name]),controllerInstance=$controller(controller,locals),elementControllers[directive.name]=controllerInstance,hasElementTranscludeDirective||$element.data("$"+directive.name+"Controller",controllerInstance),directive.controllerAs&&(locals.$scope[directive.controllerAs]=controllerInstance)}),i=0,ii=preLinkFns.length;ii>i;i++)try{linkFn=preLinkFns[i],linkFn(linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,undefined,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)try{linkFn=postLinkFns[i],linkFn(linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}previousCompileContext=previousCompileContext||{};for(var newScopeDirective,directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,i=0,ii=directives.length;ii>i;i++){directive=directives[i];var attrStart=directive.$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=undefined,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(newScopeDirective=newScopeDirective||directive,directive.templateUrl||(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode),isObject(directiveValue)&&(newIsolateScopeDirective=directive))),directiveName=directive.name,!directive.templateUrl&&directive.controller&&(directiveValue=directive.controller,controllerDirectives=controllerDirectives||{},assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),(directiveValue=directive.transclude)&&(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"==directiveValue?(hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=$compileNode,$compileNode=templateAttrs.$$element=jqLite(document.createComment(" "+directiveName+": "+templateAttrs[directiveName]+" ")),compileNode=$compileNode[0],replaceWith(jqCollection,sliceArgs($template),compileNode),childTranscludeFn=compile($template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective})):($template=jqLite(jqLiteClone(compileNode)).contents(),$compileNode.empty(),childTranscludeFn=compile($template,transcludeFn))),directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:jqLite(trim(directiveValue)),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));newIsolateScopeDirective&&markDirectivesAsIsolate(templateDirectives),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn),isFunction(linkFn)?addLinkFns(null,linkFn,attrStart,attrEnd):linkFn&&addLinkFns(linkFn.pre,linkFn.post,attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope===!0,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn}function markDirectivesAsIsolate(directives){for(var j=0,jj=directives.length;jj>j;j++)directives[j]=inherit(directives[j],{$$isolateScope:!0})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)try{directive=directives[i],(maxPriority===undefined||maxPriority>directive.priority)&&-1!=directive.restrict.indexOf(location)&&(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),tDirectives.push(directive),match=directive)}catch(e){$exceptionHandler(e)}return match}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr,$element=dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&src[key]!==value&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){"class"==key?(safeAddClass($element,value),dst["class"]=(dst["class"]?dst["class"]+" ":"")+value):"style"==key?($element.attr("style",$element.attr("style")+";"+value),dst.style=(dst.style?dst.style+";":"")+value):"$"==key.charAt(0)||dst.hasOwnProperty(key)||(dst[key]=value,dstAttr[key]=srcAttr[key])})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=extend({},origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl;return $compileNode.empty(),$http.get($sce.getTrustedResourceUrl(templateUrl),{cache:$templateCache}).success(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:jqLite(trim(content)),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectivesAsIsolate(templateDirectives),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node==compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}linkQueue=null}).error(function(response,code,headers,config){throw $compileMinErr("tpload","Failed to load template: {0}",config.url)}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;linkQueue?(linkQueue.push(scope),linkQueue.push(node),linkQueue.push(rootElement),linkQueue.push(childBoundTranscludeFn)):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",previousDirective.name,directive.name,what,startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function(templateNode){var parent=templateNode.parent(),hasCompileParent=parent.length;return hasCompileParent&&safeAddClass(templateNode.parent(),"ng-binding"),function(scope,node){var parent=node.parent(),bindings=parent.data("$binding")||[];bindings.push(interpolateFn),parent.data("$binding",bindings),hasCompileParent||safeAddClass(parent,"ng-binding"),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})}}})}function getTrustedContext(node,attrNormalizedName){if("srcdoc"==attrNormalizedName)return $sce.HTML;var tag=nodeName_(node);return"xlinkHref"==attrNormalizedName||"FORM"==tag&&"action"==attrNormalizedName||"IMG"!=tag&&("src"==attrNormalizedName||"ngSrc"==attrNormalizedName)?$sce.RESOURCE_URL:void 0}function addAttrInterpolateDirective(node,directives,value,name){var interpolateFn=$interpolate(value,!0);if(interpolateFn){if("multiple"===name&&"SELECT"===nodeName_(node))throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers={});if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");interpolateFn=$interpolate(attr[name],!0,getTrustedContext(node,name)),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!=oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;
if($rootElement)for(i=0,ii=$rootElement.length;ii>i;i++)if($rootElement[i]==firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;jj>j;j++,j2++)jj>j2?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1;break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=document.createDocumentFragment();fragment.appendChild(firstElementToRemove),newNode[jqLite.expando]=firstElementToRemove[jqLite.expando];for(var k=1,kk=elementsToRemove.length;kk>k;k++){var element=elementsToRemove[k];jqLite(element).remove(),fragment.appendChild(element),delete elementsToRemove[k]}elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}var Attributes=function(element,attr){this.$$element=element,this.$attr=attr||{}};Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses),toRemove=tokenDifference(oldClasses,newClasses);0===toAdd.length?$animate.removeClass(this.$$element,toRemove):0===toRemove.length?$animate.addClass(this.$$element,toAdd):$animate.setClass(this.$$element,toAdd,toRemove)},$set:function(key,value,writeAttr,attrName){var nodeName,booleanKey=getBooleanAttrName(this.$$element[0],key);booleanKey&&(this.$$element.prop(key,value),attrName=booleanKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),nodeName=nodeName_(this.$$element),("A"===nodeName&&"href"===key||"IMG"===nodeName&&"src"===key)&&(this[key]=value=$$sanitizeUri(value,"src"===key)),writeAttr!==!1&&(null===value||value===undefined?this.$$element.removeAttr(attrName):this.$$element.attr(attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[key],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers={}),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||fn(attrs[key])}),fn}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol||"}}"==endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_ATTR_BINDING=/^ngAttr[A-Z]/;return compile}]}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function $ControllerProvider(){var controllers={},CNTRL_REG=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.$get=["$injector","$window",function($injector,$window){return function(expression,locals){var instance,match,constructor,identifier;if(isString(expression)&&(match=expression.match(CNTRL_REG),constructor=match[1],identifier=match[3],expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:getter(locals.$scope,constructor,!0)||getter($window,constructor,!0),assertArgFn(expression,constructor,!0)),instance=$injector.instantiate(expression,locals),identifier){if(!locals||"object"!=typeof locals.$scope)throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",constructor||expression.name,identifier);locals.$scope[identifier]=instance}return instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(){$log.error.apply($log,arguments)}}]}function parseHeaders(headers){var key,val,i,parsed={};return headers?(forEach(headers.split("\n"),function(line){i=line.indexOf(":"),key=lowercase(trim(line.substr(0,i))),val=trim(line.substr(i+1)),key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}),parsed):parsed}function headersGetter(headers){var headersObj=isObject(headers)?headers:undefined;return function(name){return headersObj||(headersObj=parseHeaders(headers)),name?headersObj[lowercase(name)]||null:headersObj}}function transformData(data,headers,fns){return isFunction(fns)?fns(data,headers):(forEach(fns,function(fn){data=fn(data,headers)}),data)}function isSuccess(status){return status>=200&&300>status}function $HttpProvider(){var JSON_START=/^\s*(\[|\{[^\{])/,JSON_END=/[\}\]]\s*$/,PROTECTION_PREFIX=/^\)\]\}',?\n/,CONTENT_TYPE_APPLICATION_JSON={"Content-Type":"application/json;charset=utf-8"},defaults=this.defaults={transformResponse:[function(data){return isString(data)&&(data=data.replace(PROTECTION_PREFIX,""),JSON_START.test(data)&&JSON_END.test(data)&&(data=fromJson(data))),data}],transformRequest:[function(d){return!isObject(d)||isFile(d)||isBlob(d)?d:toJson(d)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},interceptorFactories=this.interceptors=[],responseInterceptorFactories=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$browser,$cacheFactory,$rootScope,$q,$injector){function $http(requestConfig){function transformResponse(response){var resp=extend({},response,{data:transformData(response.data,response.headers,config.transformResponse)});return isSuccess(response.status)?resp:$q.reject(resp)}function mergeHeaders(config){function execHeaders(headers){var headerContent;forEach(headers,function(headerFn,header){isFunction(headerFn)&&(headerContent=headerFn(),null!=headerContent?headers[header]=headerContent:delete headers[header])})}var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]);defaultHeadersIteration:for(defHeaderName in defHeaders){lowercaseDefHeaderName=lowercase(defHeaderName);for(reqHeaderName in reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return execHeaders(reqHeaders),reqHeaders}var config={method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse},headers=mergeHeaders(requestConfig);extend(config,requestConfig),config.headers=headers,config.method=uppercase(config.method);var serverRequest=function(config){headers=config.headers;var reqData=transformData(config.data,headersGetter(headers),config.transformRequest);return isUndefined(reqData)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]}),isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials),sendReq(config,reqData,headers).then(transformResponse,transformResponse)},chain=[serverRequest,undefined],promise=$q.when(config);for(forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&chain.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&chain.push(interceptor.response,interceptor.responseError)});chain.length;){var thenFn=chain.shift(),rejectFn=chain.shift();promise=promise.then(thenFn,rejectFn)}return promise.success=function(fn){return promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise},promise}function createShortMethods(){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend(config||{},{method:name,url:url}))}})}function createShortMethodsWithData(){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend(config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData,reqHeaders){function done(status,response,headersString,statusText){cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText]):cache.remove(url)),resolvePromise(response,status,headersString,statusText),$rootScope.$$phase||$rootScope.$apply()}function resolvePromise(response,status,headers,statusText){status=Math.max(status,0),(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText})}function removePendingReq(){var idx=indexOf($http.pendingRequests,config);-1!==idx&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,url=buildUrl(config.url,config.params);if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),!config.cache&&!defaults.cache||config.cache===!1||"GET"!==config.method&&"JSONP"!==config.method||(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache),cache)if(cachedResp=cache.get(url),isDefined(cachedResp)){if(isPromiseLike(cachedResp))return cachedResp.then(removePendingReq,removePendingReq),cachedResp;isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3]):resolvePromise(cachedResp,200,{},"OK")}else cache.put(url,promise);if(isUndefined(cachedResp)){var xsrfValue=urlIsSameOrigin(config.url)?$browser.cookies()[config.xsrfCookieName||defaults.xsrfCookieName]:undefined;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials,config.responseType)}return promise}function buildUrl(url,params){if(!params)return url;var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||(isArray(value)||(value=[value]),forEach(value,function(v){isObject(v)&&(v=isDate(v)?v.toISOString():toJson(v)),parts.push(encodeUriQuery(key)+"="+encodeUriQuery(v))}))}),parts.length>0&&(url+=(-1==url.indexOf("?")?"?":"&")+parts.join("&")),url}var defaultCache=$cacheFactory("$http"),reversedInterceptors=[];return forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))}),forEach(responseInterceptorFactories,function(interceptorFactory,index){var responseFn=isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory);reversedInterceptors.splice(index,0,{response:function(response){return responseFn($q.when(response))},responseError:function(response){return responseFn($q.reject(response))}})}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put","patch"),$http.defaults=defaults,$http}]}function createXhr(method){if(8>=msie&&(!method.match(/^(get|post|head|put|delete|options)$/i)||!window.XMLHttpRequest))return new window.ActiveXObject("Microsoft.XMLHTTP");if(window.XMLHttpRequest)return new window.XMLHttpRequest;throw minErr("$httpBackend")("noxhr","This browser does not support XMLHttpRequest.")}function $HttpBackendProvider(){this.$get=["$browser","$window","$document",function($browser,$window,$document){return createHttpBackend($browser,createXhr,$browser.defer,$window.angular.callbacks,$document[0])}]}function createHttpBackend($browser,createXhr,$browserDefer,callbacks,rawDocument){function jsonpReq(url,callbackId,done){var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){removeEventListenerFn(script,"load",callback),removeEventListenerFn(script,"error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks[callbackId].called||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},addEventListenerFn(script,"load",callback),addEventListenerFn(script,"error",callback),8>=msie&&(script.onreadystatechange=function(){isString(script.readyState)&&/loaded|complete/.test(script.readyState)&&(script.onreadystatechange=null,callback({type:"load"}))}),rawDocument.body.appendChild(script),callback}var ABORTED=-1;return function(method,url,post,callback,headers,timeout,withCredentials,responseType){function timeoutRequest(){status=ABORTED,jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText){timeoutId&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,0===status&&(status=response?200:"file"==urlResolve(url).protocol?404:0),status=1223===status?204:status,statusText=statusText||"",callback(status,response,headersString,statusText),$browser.$$completeOutstandingRequest(noop)}var status;if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data,callbacks[callbackId].called=!0};var jsonpDone=jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),callbackId,function(status,text){completeRequest(callback,status,callbacks[callbackId].data,"",text),callbacks[callbackId]=noop})}else{var xhr=createXhr(method);if(xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onreadystatechange=function(){if(xhr&&4==xhr.readyState){var responseHeaders=null,response=null,statusText="";status!==ABORTED&&(responseHeaders=xhr.getAllResponseHeaders(),response="response"in xhr?xhr.response:xhr.responseText),status===ABORTED&&10>msie||(statusText=xhr.statusText),completeRequest(callback,status||xhr.status,response,responseHeaders,statusText)}},withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(post||null)}if(timeout>0)var timeoutId=$browserDefer(timeoutRequest,timeout);else isPromiseLike(timeout)&&timeout.then(timeoutRequest)}}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){function $interpolate(text,mustHaveExpression,trustedContext){for(var startIndex,endIndex,fn,exp,index=0,parts=[],length=text.length,hasInterpolation=!1,concat=[];length>index;)-1!=(startIndex=text.indexOf(startSymbol,index))&&-1!=(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))?(index!=startIndex&&parts.push(text.substring(index,startIndex)),parts.push(fn=$parse(exp=text.substring(startIndex+startSymbolLength,endIndex))),fn.exp=exp,index=endIndex+endSymbolLength,hasInterpolation=!0):(index!=length&&parts.push(text.substring(index)),index=length);if((length=parts.length)||(parts.push(""),length=1),trustedContext&&parts.length>1)throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text);return!mustHaveExpression||hasInterpolation?(concat.length=length,fn=function(context){try{for(var part,i=0,ii=length;ii>i;i++){if("function"==typeof(part=parts[i]))if(part=part(context),part=trustedContext?$sce.getTrusted(trustedContext,part):$sce.valueOf(part),null==part)part="";else switch(typeof part){case"string":break;case"number":part=""+part;break;default:part=toJson(part)}concat[i]=part}return concat.join("")}catch(err){var newErr=$interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString());$exceptionHandler(newErr)}},fn.exp=text,fn.parts=parts,fn):void 0}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length;return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function $IntervalProvider(){this.$get=["$rootScope","$window","$q",function($rootScope,$window,$q){function interval(fn,delay,count,invokeApply){var setInterval=$window.setInterval,clearInterval=$window.clearInterval,deferred=$q.defer(),promise=deferred.promise,iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply;return count=isDefined(count)?count:0,promise.then(null,null,fn),promise.$$intervalId=setInterval(function(){deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId]),skipApply||$rootScope.$apply()},delay),intervals[promise.$$intervalId]=deferred,promise}var intervals={};return interval.cancel=function(promise){return promise&&promise.$$intervalId in intervals?(intervals[promise.$$intervalId].reject("canceled"),$window.clearInterval(promise.$$intervalId),delete intervals[promise.$$intervalId],!0):!1},interval}]}function $LocaleProvider(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"¤",posSuf:"",negPre:"(¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(num){return 1===num?"one":"other"}}}}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function parseAbsoluteUrl(absoluteUrl,locationObj,appBase){var parsedUrl=urlResolve(absoluteUrl,appBase);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=int(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}function parseAppUrl(relativeUrl,locationObj,appBase){var prefixed="/"!==relativeUrl.charAt(0);prefixed&&(relativeUrl="/"+relativeUrl);var match=urlResolve(relativeUrl,appBase);locationObj.$$path=decodeURIComponent(prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!=locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function beginsWith(begin,whole){return 0===whole.indexOf(begin)?whole.substr(begin.length):void 0}function stripHash(url){var index=url.indexOf("#");return-1==index?url:url.substr(0,index)}function stripFile(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}function serverBase(url){return url.substring(0,url.indexOf("/",url.indexOf("//")+2))}function LocationHtml5Url(appBase,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"";var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this,appBase),this.$$parse=function(url){var pathUrl=beginsWith(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this,appBase),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBaseNoFile+this.$$url.substr(1)},this.$$parseLinkUrl=function(url){var appUrl,prevAppUrl,rewrittenUrl;return(appUrl=beginsWith(appBase,url))!==undefined?(prevAppUrl=appUrl,rewrittenUrl=(appUrl=beginsWith(basePrefix,appUrl))!==undefined?appBaseNoFile+(beginsWith("/",appUrl)||appUrl):appBase+prevAppUrl):(appUrl=beginsWith(appBaseNoFile,url))!==undefined?rewrittenUrl=appBaseNoFile+appUrl:appBaseNoFile==url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl}}function LocationHashbangUrl(appBase,hashPrefix){var appBaseNoFile=stripFile(appBase);parseAbsoluteUrl(appBase,this,appBase),this.$$parse=function(url){function removeWindowsDriveName(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/[A-Z]:(\/.*)/;return 0===url.indexOf(base)&&(url=url.replace(base,"")),windowsFilePathExp.exec(url)?path:(firstPathSegmentMatch=windowsFilePathExp.exec(path),firstPathSegmentMatch?firstPathSegmentMatch[1]:path)}var withoutBaseUrl=beginsWith(appBase,url)||beginsWith(appBaseNoFile,url),withoutHashUrl="#"==withoutBaseUrl.charAt(0)?beginsWith(hashPrefix,withoutBaseUrl):this.$$html5?withoutBaseUrl:"";if(!isString(withoutHashUrl))throw $locationMinErr("ihshprfx",'Invalid url "{0}", missing hash prefix "{1}".',url,hashPrefix);parseAppUrl(withoutHashUrl,this,appBase),this.$$path=removeWindowsDriveName(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+(this.$$url?hashPrefix+this.$$url:"")},this.$$parseLinkUrl=function(url){return stripHash(appBase)==stripHash(url)?(this.$$parse(url),!0):!1}}function LocationHashbangInHtml5Url(appBase,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments);var appBaseNoFile=stripFile(appBase);this.$$parseLinkUrl=function(url){var rewrittenUrl,appUrl;return appBase==stripHash(url)?rewrittenUrl=url:(appUrl=beginsWith(appBaseNoFile,url))?rewrittenUrl=appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=appBase+hashPrefix+this.$$url}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode=!1;this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isDefined(mode)?(html5Mode=mode,this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function($rootScope,$browser,$sniffer,$rootElement){function afterLocationChange(oldUrl){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl)}var $location,LocationMode,appBase,baseHref=$browser.baseHref(),initialUrl=$browser.url();html5Mode?(appBase=serverBase(initialUrl)+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url):(appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl),$location=new LocationMode(appBase,"#"+hashPrefix),$location.$$parseLinkUrl(initialUrl,initialUrl);var IGNORE_URI_REGEXP=/^\s*(javascript|mailto):/i;$rootElement.on("click",function(event){if(!event.ctrlKey&&!event.metaKey&&2!=event.which){for(var elm=jqLite(event.target);"a"!==lowercase(elm[0].nodeName);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),relHref=elm.attr("href")||elm.attr("xlink:href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href),IGNORE_URI_REGEXP.test(absHref)||!absHref||elm.attr("target")||event.isDefaultPrevented()||$location.$$parseLinkUrl(absHref,relHref)&&(event.preventDefault(),$location.absUrl()!=$browser.url()&&($rootScope.$apply(),window.angular["ff-684208-preventDefault"]=!0))}}),$location.absUrl()!=initialUrl&&$browser.url($location.absUrl(),!0),$browser.onUrlChange(function(newUrl){$location.absUrl()!=newUrl&&($rootScope.$evalAsync(function(){var oldUrl=$location.absUrl();$location.$$parse(newUrl),$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl).defaultPrevented?($location.$$parse(oldUrl),$browser.url(oldUrl)):afterLocationChange(oldUrl)}),$rootScope.$$phase||$rootScope.$digest())});var changeCounter=0;return $rootScope.$watch(function(){var oldUrl=$browser.url(),currentReplace=$location.$$replace;return changeCounter&&oldUrl==$location.absUrl()||(changeCounter++,$rootScope.$evalAsync(function(){$rootScope.$broadcast("$locationChangeStart",$location.absUrl(),oldUrl).defaultPrevented?$location.$$parse(oldUrl):($browser.url($location.absUrl(),currentReplace),afterLocationChange(oldUrl))})),$location.$$replace=!1,changeCounter}),$location}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop,hasApply=!1;try{hasApply=!!logFn.apply}catch(e){}return hasApply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,null==arg2?"":arg2)}}return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:function(){var fn=consoleLog("debug");return function(){debug&&fn.apply(self,arguments)}}()}}]}function ensureSafeMemberName(name,fullExpression){if("__defineGetter__"===name||"__defineSetter__"===name||"__lookupGetter__"===name||"__lookupSetter__"===name||"__proto__"===name)throw $parseMinErr("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",fullExpression);return name}function ensureSafeObject(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.document&&obj.location&&obj.alert&&obj.setInterval)throw $parseMinErr("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj.children&&(obj.nodeName||obj.prop&&obj.attr&&obj.find))throw $parseMinErr("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===Object)throw $parseMinErr("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",fullExpression)}return obj}function ensureSafeFunction(obj,fullExpression){if(obj){if(obj.constructor===obj)throw $parseMinErr("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",fullExpression);if(obj===CALL||obj===APPLY||BIND&&obj===BIND)throw $parseMinErr("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",fullExpression)}}function setter(obj,path,setValue,fullExp,options){ensureSafeObject(obj,fullExp),options=options||{};for(var key,element=path.split("."),i=0;element.length>1;i++){key=ensureSafeMemberName(element.shift(),fullExp);var propertyObj=ensureSafeObject(obj[key],fullExp);propertyObj||(propertyObj={},obj[key]=propertyObj),obj=propertyObj,obj.then&&options.unwrapPromises&&(promiseWarning(fullExp),"$$v"in obj||!function(promise){promise.then(function(val){promise.$$v=val})}(obj),obj.$$v===undefined&&(obj.$$v={}),obj=obj.$$v)}return key=ensureSafeMemberName(element.shift(),fullExp),ensureSafeObject(obj[key],fullExp),obj[key]=setValue,setValue}function isPossiblyDangerousMemberName(name){return"constructor"==name}function cspSafeGetterFn(key0,key1,key2,key3,key4,fullExp,options){ensureSafeMemberName(key0,fullExp),ensureSafeMemberName(key1,fullExp),ensureSafeMemberName(key2,fullExp),ensureSafeMemberName(key3,fullExp),ensureSafeMemberName(key4,fullExp);var eso=function(o){return ensureSafeObject(o,fullExp)},expensiveChecks=options.expensiveChecks,eso0=expensiveChecks||isPossiblyDangerousMemberName(key0)?eso:identity,eso1=expensiveChecks||isPossiblyDangerousMemberName(key1)?eso:identity,eso2=expensiveChecks||isPossiblyDangerousMemberName(key2)?eso:identity,eso3=expensiveChecks||isPossiblyDangerousMemberName(key3)?eso:identity,eso4=expensiveChecks||isPossiblyDangerousMemberName(key4)?eso:identity;return options.unwrapPromises?function(scope,locals){var promise,pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null==pathVal?pathVal:(pathVal=eso0(pathVal[key0]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso0(val)})),pathVal=eso0(pathVal.$$v)),key1?null==pathVal?undefined:(pathVal=eso1(pathVal[key1]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso1(val)})),pathVal=eso1(pathVal.$$v)),key2?null==pathVal?undefined:(pathVal=eso2(pathVal[key2]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso2(val)})),pathVal=eso2(pathVal.$$v)),key3?null==pathVal?undefined:(pathVal=eso3(pathVal[key3]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso3(val)})),pathVal=eso3(pathVal.$$v)),key4?null==pathVal?undefined:(pathVal=eso4(pathVal[key4]),pathVal&&pathVal.then&&(promiseWarning(fullExp),"$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=eso4(val)})),pathVal=eso4(pathVal.$$v)),pathVal):pathVal):pathVal):pathVal):pathVal)}:function(scope,locals){var pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null==pathVal?pathVal:(pathVal=eso0(pathVal[key0]),key1?null==pathVal?undefined:(pathVal=eso1(pathVal[key1]),key2?null==pathVal?undefined:(pathVal=eso2(pathVal[key2]),key3?null==pathVal?undefined:(pathVal=eso3(pathVal[key3]),key4?null==pathVal?undefined:pathVal=eso4(pathVal[key4]):pathVal):pathVal):pathVal):pathVal)}}function getterFnWithExtraArgs(fn,fullExpression){return function(s,l){return fn(s,l,promiseWarning,ensureSafeObject,fullExpression)}}function getterFn(path,options,fullExp){var expensiveChecks=options.expensiveChecks,getterFnCache=expensiveChecks?getterFnCacheExpensive:getterFnCacheDefault;if(getterFnCache.hasOwnProperty(path))return getterFnCache[path];var fn,pathKeys=path.split("."),pathKeysLength=pathKeys.length;if(options.csp)fn=6>pathKeysLength?cspSafeGetterFn(pathKeys[0],pathKeys[1],pathKeys[2],pathKeys[3],pathKeys[4],fullExp,options):function(scope,locals){var val,i=0;do val=cspSafeGetterFn(pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],fullExp,options)(scope,locals),locals=undefined,scope=val;
while(pathKeysLength>i);return val};else{var code="var p;\n";expensiveChecks&&(code+="s = eso(s, fe);\nl = eso(l, fe);\n");var needsEnsureSafeObject=expensiveChecks;forEach(pathKeys,function(key,index){ensureSafeMemberName(key,fullExp);var lookupJs=(index?"s":'((l&&l.hasOwnProperty("'+key+'"))?l:s)')+'["'+key+'"]',wrapWithEso=expensiveChecks||isPossiblyDangerousMemberName(key);wrapWithEso&&(lookupJs="eso("+lookupJs+", fe)",needsEnsureSafeObject=!0),code+="if(s == null) return undefined;\ns="+lookupJs+";\n",options.unwrapPromises&&(code+='if (s && s.then) {\n pw("'+fullExp.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v='+(wrapWithEso?"eso(v)":"v")+";});\n}\n s="+(wrapWithEso?"eso(s.$$v)":"s.$$v")+"\n}\n")}),code+="return s;";var evaledFnGetter=new Function("s","l","pw","eso","fe",code);evaledFnGetter.toString=valueFn(code),(needsEnsureSafeObject||options.unwrapPromises)&&(evaledFnGetter=getterFnWithExtraArgs(evaledFnGetter,fullExp)),fn=evaledFnGetter}return"hasOwnProperty"!==path&&(getterFnCache[path]=fn),fn}function $ParseProvider(){var cacheDefault={},cacheExpensive={},$parseOptions={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0,expensiveChecks:!1};this.unwrapPromises=function(value){return isDefined(value)?($parseOptions.unwrapPromises=!!value,this):$parseOptions.unwrapPromises},this.logPromiseWarnings=function(value){return isDefined(value)?($parseOptions.logPromiseWarnings=value,this):$parseOptions.logPromiseWarnings},this.$get=["$filter","$sniffer","$log",function($filter,$sniffer,$log){$parseOptions.csp=$sniffer.csp;var $parseOptionsExpensive={csp:$parseOptions.csp,unwrapPromises:$parseOptions.unwrapPromises,logPromiseWarnings:$parseOptions.logPromiseWarnings,expensiveChecks:!0};return promiseWarning=function(fullExp){$parseOptions.logPromiseWarnings&&!promiseWarningCache.hasOwnProperty(fullExp)&&(promiseWarningCache[fullExp]=!0,$log.warn("[$parse] Promise found in the expression `"+fullExp+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))},function(exp,expensiveChecks){var parsedExpression;switch(typeof exp){case"string":var cache=expensiveChecks?cacheExpensive:cacheDefault;if(cache.hasOwnProperty(exp))return cache[exp];var parseOptions=expensiveChecks?$parseOptionsExpensive:$parseOptions,lexer=new Lexer(parseOptions),parser=new Parser(lexer,$filter,parseOptions);return parsedExpression=parser.parse(exp),"hasOwnProperty"!==exp&&(cache[exp]=parsedExpression),parsedExpression;case"function":return exp;default:return noop}}}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function defaultCallback(value){return value}function defaultErrback(reason){return reject(reason)}function all(promises){var deferred=defer(),counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,ref(promise).then(function(value){results.hasOwnProperty(key)||(results[key]=value,--counter||deferred.resolve(results))},function(reason){results.hasOwnProperty(key)||deferred.reject(reason)})}),0===counter&&deferred.resolve(results),deferred.promise}var defer=function(){var value,deferred,pending=[];return deferred={resolve:function(val){if(pending){var callbacks=pending;pending=undefined,value=ref(val),callbacks.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],value.then(callback[0],callback[1],callback[2])})}},reject:function(reason){deferred.resolve(createInternalRejectedPromise(reason))},notify:function(progress){if(pending){var callbacks=pending;pending.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],callback[2](progress)})}},promise:{then:function(callback,errback,progressback){var result=defer(),wrappedCallback=function(value){try{result.resolve((isFunction(callback)?callback:defaultCallback)(value))}catch(e){result.reject(e),exceptionHandler(e)}},wrappedErrback=function(reason){try{result.resolve((isFunction(errback)?errback:defaultErrback)(reason))}catch(e){result.reject(e),exceptionHandler(e)}},wrappedProgressback=function(progress){try{result.notify((isFunction(progressback)?progressback:defaultCallback)(progress))}catch(e){exceptionHandler(e)}};return pending?pending.push([wrappedCallback,wrappedErrback,wrappedProgressback]):value.then(wrappedCallback,wrappedErrback,wrappedProgressback),result.promise},"catch":function(callback){return this.then(null,callback)},"finally":function(callback){function makePromise(value,resolved){var result=defer();return resolved?result.resolve(value):result.reject(value),result.promise}function handleCallback(value,isResolved){var callbackOutput=null;try{callbackOutput=(callback||defaultCallback)()}catch(e){return makePromise(e,!1)}return isPromiseLike(callbackOutput)?callbackOutput.then(function(){return makePromise(value,isResolved)},function(error){return makePromise(error,!1)}):makePromise(value,isResolved)}return this.then(function(value){return handleCallback(value,!0)},function(error){return handleCallback(error,!1)})}}}},ref=function(value){return isPromiseLike(value)?value:{then:function(callback){var result=defer();return nextTick(function(){result.resolve(callback(value))}),result.promise}}},reject=function(reason){var result=defer();return result.reject(reason),result.promise},createInternalRejectedPromise=function(reason){return{then:function(callback,errback){var result=defer();return nextTick(function(){try{result.resolve((isFunction(errback)?errback:defaultErrback)(reason))}catch(e){result.reject(e),exceptionHandler(e)}}),result.promise}}},when=function(value,callback,errback,progressback){var done,result=defer(),wrappedCallback=function(value){try{return(isFunction(callback)?callback:defaultCallback)(value)}catch(e){return exceptionHandler(e),reject(e)}},wrappedErrback=function(reason){try{return(isFunction(errback)?errback:defaultErrback)(reason)}catch(e){return exceptionHandler(e),reject(e)}},wrappedProgressback=function(progress){try{return(isFunction(progressback)?progressback:defaultCallback)(progress)}catch(e){exceptionHandler(e)}};return nextTick(function(){ref(value).then(function(value){done||(done=!0,result.resolve(ref(value).then(wrappedCallback,wrappedErrback,wrappedProgressback)))},function(reason){done||(done=!0,result.resolve(wrappedErrback(reason)))},function(progress){done||result.notify(wrappedProgressback(progress))})}),result.promise};return{defer:defer,reject:reject,when:when,all:all}}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame||$window.mozRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.mozCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$injector","$exceptionHandler","$parse","$browser",function($injector,$exceptionHandler,$parse,$browser){function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this["this"]=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$postDigestQueue=[],this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings={}}function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function compileToFn(exp,name){var fn=$parse(exp);return assertArgFn(fn,name),fn}function decrementListenerCount(current,count,name){do current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name];while(current=current.$parent)}function initWatchVal(){}Scope.prototype={constructor:Scope,$new:function(isolate){var child;return isolate?(child=new Scope,child.$root=this.$root,child.$$asyncQueue=this.$$asyncQueue,child.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=nextUid(),this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),child=new this.$$childScopeClass),child["this"]=child,child.$parent=this,child.$$prevSibling=this.$$childTail,this.$$childHead?(this.$$childTail.$$nextSibling=child,this.$$childTail=child):this.$$childHead=this.$$childTail=child,child},$watch:function(watchExp,listener,objectEquality){var scope=this,get=compileToFn(watchExp,"watch"),array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:watchExp,eq:!!objectEquality};if(lastDirtyWatch=null,!isFunction(listener)){var listenFn=compileToFn(listener||noop,"listener");watcher.fn=function(newVal,oldVal,scope){listenFn(scope)}}if("string"==typeof watchExp&&get.constant){var originalFn=watcher.fn;watcher.fn=function(newVal,oldVal,scope){originalFn.call(this,newVal,oldVal,scope),arrayRemove(array,watcher)}}return array||(array=scope.$$watchers=[]),array.unshift(watcher),function(){arrayRemove(array,watcher),lastDirtyWatch=null}},$watchCollection:function(obj,listener){function $watchCollectionWatch(){newValue=objGetter(self);var newLength,key,bothNaN;if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldValue=internalArray,oldLength=oldValue.length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;newLength>i;i++)bothNaN=oldValue[i]!==oldValue[i]&&newValue[i]!==newValue[i],bothNaN||oldValue[i]===newValue[i]||(changeDetected++,oldValue[i]=newValue[i])}else{oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0;for(key in newValue)newValue.hasOwnProperty(key)&&(newLength++,oldValue.hasOwnProperty(key)?(bothNaN=oldValue[key]!==oldValue[key]&&newValue[key]!==newValue[key],bothNaN||oldValue[key]===newValue[key]||(changeDetected++,oldValue[key]=newValue[key])):(oldLength++,oldValue[key]=newValue[key],changeDetected++));if(oldLength>newLength){changeDetected++;for(key in oldValue)oldValue.hasOwnProperty(key)&&!newValue.hasOwnProperty(key)&&(oldLength--,delete oldValue[key])}}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}function $watchCollectionAction(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=new Array(newValue.length);for(var i=0;i<newValue.length;i++)veryOldValue[i]=newValue[i]}else{veryOldValue={};for(var key in newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key])}else veryOldValue=newValue}var newValue,oldValue,veryOldValue,self=this,trackVeryOldValue=listener.length>1,changeDetected=0,objGetter=$parse(obj),internalArray=[],internalObject={},initRun=!0,oldLength=0;return this.$watch($watchCollectionWatch,$watchCollectionAction)},$digest:function(){var watch,value,last,watchers,length,dirty,next,current,logIdx,logMsg,asyncTask,asyncQueue=this.$$asyncQueue,postDigestQueue=this.$$postDigestQueue,ttl=TTL,target=this,watchLog=[];beginPhase("$digest"),$browser.$$checkUrlChange(),lastDirtyWatch=null;do{for(dirty=!1,current=target;asyncQueue.length;){try{asyncTask=asyncQueue.shift(),asyncTask.scope.$eval(asyncTask.expression)}catch(e){clearPhase(),$exceptionHandler(e)}lastDirtyWatch=null}traverseScopesLoop:do{if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{if(watch=watchers[length])if((value=watch.get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,watch.fn(value,last===initWatchVal?value:last,current),5>ttl&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),logMsg=isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,logMsg+="; newVal: "+toJson(value)+"; oldVal: "+toJson(last),watchLog[logIdx].push(logMsg))}catch(e){clearPhase(),$exceptionHandler(e)}if(!(next=current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,toJson(watchLog))}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueue.length;)try{postDigestQueue.shift()()}catch(e){$exceptionHandler(e)}},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this!==$rootScope&&(forEach(this.$$listenerCount,bind(null,decrementListenerCount,this)),parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=noop,this.$on=this.$watch=function(){return noop})}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr){$rootScope.$$phase||$rootScope.$$asyncQueue.length||$browser.defer(function(){$rootScope.$$asyncQueue.length&&$rootScope.$digest()}),this.$$asyncQueue.push({scope:this,expression:expr})},$$postDigest:function(fn){this.$$postDigestQueue.push(fn)},$apply:function(expr){try{return beginPhase("$apply"),this.$eval(expr)}catch(e){$exceptionHandler(e)}finally{clearPhase();try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++;while(current=current.$parent);var self=this;return function(){var indexOfListener=indexOf(namedListeners,listener);-1!==indexOfListener&&(namedListeners[indexOfListener]=null,decrementListenerCount(self,1,name))}},$emit:function(name){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;length>i;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)return event;scope=scope.$parent}while(scope);return event},$broadcast:function(name){for(var listeners,i,length,target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;length>i;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}return event}};var $rootScope=new Scope;return $rootScope}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*((https?|ftp|file):|data:image\/)/;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isImage){var normalizedVal,regex=isImage?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist;return msie&&!(msie>=8)||(normalizedVal=urlResolve(uri).href,""===normalizedVal||normalizedVal.match(regex))?uri:"unsafe:"+normalizedVal}}}function escapeForRegexp(s){return s.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}function adjustMatcher(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(adjustMatcher(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector",function($injector){function matchUrl(matcher,parsedUrl){return"self"===matcher?urlIsSameOrigin(parsedUrl):!!matcher.exec(parsedUrl.href)}function isResourceUrlAllowedByPolicy(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;n>i;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;n>i;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}function trustAs(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||trustedValue===undefined||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)}function valueOf(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}function getTrusted(type,maybeTrusted){if(null===maybeTrusted||maybeTrusted===undefined||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(type===SCE_CONTEXTS.RESOURCE_URL){if(isResourceUrlAllowedByPolicy(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")}var htmlSanitizer=function(){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:trustAs,getTrusted:getTrusted,valueOf:valueOf}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sniffer","$sceDelegate",function($parse,$sniffer,$sceDelegate){if(enabled&&$sniffer.msie&&$sniffer.msieDocumentMode<8)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 9 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:function(self,locals){return sce.getTrusted(type,parsed(self,locals))}};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[camelCase("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[camelCase("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[camelCase("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var vendorPrefix,match,eventSupport={},android=int((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},documentMode=document.documentMode,vendorRegex=/^(Moz|webkit|O|ms)(?=[A-Z])/,bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;if(bodyStyle){for(var prop in bodyStyle)if(match=vendorRegex.exec(prop)){vendorPrefix=match[0],vendorPrefix=vendorPrefix.substr(0,1).toUpperCase()+vendorPrefix.substr(1);break}vendorPrefix||(vendorPrefix="WebkitOpacity"in bodyStyle&&"webkit"),transitions=!!("transition"in bodyStyle||vendorPrefix+"Transition"in bodyStyle),animations=!!("animation"in bodyStyle||vendorPrefix+"Animation"in bodyStyle),!android||transitions&&animations||(transitions=isString(document.body.style.webkitTransition),animations=isString(document.body.style.webkitAnimation))}return{history:!(!$window.history||!$window.history.pushState||4>android||boxee),hashchange:"onhashchange"in $window&&(!documentMode||documentMode>7),hasEvent:function(event){if("input"==event&&9==msie)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),vendorPrefix:vendorPrefix,transitions:transitions,animations:animations,android:android,msie:msie,msieDocumentMode:documentMode}}]}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function($rootScope,$browser,$q,$exceptionHandler){function timeout(fn,delay,invokeApply){var timeoutId,deferred=$q.defer(),promise=deferred.promise,skipApply=isDefined(invokeApply)&&!invokeApply;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn())}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}var deferreds={};return timeout.cancel=function(promise){return promise&&promise.$$timeoutId in deferreds?(deferreds[promise.$$timeoutId].reject("canceled"),delete deferreds[promise.$$timeoutId],$browser.defer.cancel(promise.$$timeoutId)):!1},timeout}]}function urlResolve(url){var href=url;return msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:urlParsingNode.hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlIsSameOrigin(requestUrl){var parsed=isString(requestUrl)?urlResolve(requestUrl):requestUrl;return parsed.protocol===originUrl.protocol&&parsed.host===originUrl.host}function $WindowProvider(){this.$get=valueFn(window)}function $FilterProvider($provide){function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator){if(!isArray(array))return array;var comparatorType=typeof comparator,predicates=[];predicates.check=function(value){for(var j=0;j<predicates.length;j++)if(!predicates[j](value))return!1;return!0},"function"!==comparatorType&&(comparator="boolean"===comparatorType&&comparator?function(obj,text){return angular.equals(obj,text)}:function(obj,text){if(obj&&text&&"object"==typeof obj&&"object"==typeof text){for(var objKey in obj)if("$"!==objKey.charAt(0)&&hasOwnProperty.call(obj,objKey)&&comparator(obj[objKey],text[objKey]))return!0;return!1}return text=(""+text).toLowerCase(),(""+obj).toLowerCase().indexOf(text)>-1});var search=function(obj,text){if("string"==typeof text&&"!"===text.charAt(0))return!search(obj,text.substr(1));switch(typeof obj){case"boolean":case"number":case"string":return comparator(obj,text);case"object":switch(typeof text){case"object":return comparator(obj,text);default:for(var objKey in obj)if("$"!==objKey.charAt(0)&&search(obj[objKey],text))return!0}return!1;case"array":for(var i=0;i<obj.length;i++)if(search(obj[i],text))return!0;return!1;default:return!1}};switch(typeof expression){case"boolean":case"number":case"string":expression={$:expression};case"object":for(var key in expression)!function(path){"undefined"!=typeof expression[path]&&predicates.push(function(value){return search("$"==path?value:value&&value[path],expression[path])})}(key);break;case"function":predicates.push(expression);break;default:return array}for(var filtered=[],j=0;j<array.length;j++){var value=array[j];predicates.check(value)&&filtered.push(value)}return filtered}}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,2).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(null==number||!isFinite(number)||isObject(number))return"";var isNegative=0>number;number=Math.abs(number);var numStr=number+"",formatedText="",parts=[],hasExponent=!1;if(-1!==numStr.indexOf("e")){var match=numStr.match(/([\d\.]+)e(-?)(\d+)/);match&&"-"==match[2]&&match[3]>fractionSize+1?(numStr="0",number=0):(formatedText=numStr,hasExponent=!0)}if(hasExponent)fractionSize>0&&number>-1&&1>number&&(formatedText=number.toFixed(fractionSize));else{var fractionLen=(numStr.split(DECIMAL_SEP)[1]||"").length;isUndefined(fractionSize)&&(fractionSize=Math.min(Math.max(pattern.minFrac,fractionLen),pattern.maxFrac)),number=+(Math.round(+(number.toString()+"e"+fractionSize)).toString()+"e"+-fractionSize),0===number&&(isNegative=!1);var fraction=(""+number).split(DECIMAL_SEP),whole=fraction[0];fraction=fraction[1]||"";var i,pos=0,lgroup=pattern.lgSize,group=pattern.gSize;if(whole.length>=lgroup+group)for(pos=whole.length-lgroup,i=0;pos>i;i++)(pos-i)%group===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(i=pos;i<whole.length;i++)(whole.length-i)%lgroup===0&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(;fraction.length<fractionSize;)fraction+="0";fractionSize&&"0"!==fractionSize&&(formatedText+=decimalSep+fraction.substr(0,fractionSize))}return parts.push(isNegative?pattern.negPre:pattern.posPre),parts.push(formatedText),parts.push(isNegative?pattern.negSuf:pattern.posSuf),parts.join("")}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12==offset&&(value=12),padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name](),get=uppercase(shortForm?"SHORT"+name:name);return formats[get][value]}}function timeZoneGetter(date){var zone=-1*date.getTimezoneOffset(),paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),dateSetter.call(date,int(match[1]),int(match[2])-1,int(match[3]));var h=int(match[4]||0)-tzHour,m=int(match[5]||0)-tzMin,s=int(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?int(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);
return forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS):value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object){return toJson(object,!0)}}function limitToFilter(){return function(input,limit){if(!isArray(input)&&!isString(input))return input;if(limit=1/0===Math.abs(Number(limit))?Number(limit):int(limit),isString(input))return limit?limit>=0?input.slice(0,limit):input.slice(limit,input.length):"";var i,n,out=[];for(limit>input.length?limit=input.length:limit<-input.length&&(limit=-input.length),limit>0?(i=0,n=limit):(i=input.length+limit,n=input.length);n>i;i++)out.push(input[i]);return out}}function orderByFilter($parse){return function(array,sortPredicate,reverseOrder){function comparator(o1,o2){for(var i=0;i<sortPredicate.length;i++){var comp=sortPredicate[i](o1,o2);if(0!==comp)return comp}return 0}function reverseComparator(comp,descending){return toBoolean(descending)?function(a,b){return comp(b,a)}:comp}function compare(v1,v2){var t1=typeof v1,t2=typeof v2;return t1==t2?(isDate(v1)&&isDate(v2)&&(v1=v1.valueOf(),v2=v2.valueOf()),"string"==t1&&(v1=v1.toLowerCase(),v2=v2.toLowerCase()),v1===v2?0:v2>v1?-1:1):t2>t1?-1:1}return isArrayLike(array)?(sortPredicate=isArray(sortPredicate)?sortPredicate:[sortPredicate],0===sortPredicate.length&&(sortPredicate=["+"]),sortPredicate=map(sortPredicate,function(predicate){var descending=!1,get=predicate||identity;if(isString(predicate)){if(("+"==predicate.charAt(0)||"-"==predicate.charAt(0))&&(descending="-"==predicate.charAt(0),predicate=predicate.substring(1)),""===predicate)return reverseComparator(function(a,b){return compare(a,b)},descending);if(get=$parse(predicate),get.constant){var key=get();return reverseComparator(function(a,b){return compare(a[key],b[key])},descending)}}return reverseComparator(function(a,b){return compare(get(a),get(b))},descending)}),slice.call(array).sort(reverseComparator(comparator,reverseOrder))):array}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function FormController(element,attrs,$scope,$animate){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",$animate.setClass(element,(isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey,(isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey)}var form=this,parentForm=element.parent().controller("form")||nullFormCtrl,invalidCount=0,errors=form.$error={},controls=[];form.$name=attrs.name||attrs.ngForm,form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,parentForm.$addControl(form),element.addClass(PRISTINE_CLASS),toggleValidCss(!0),form.$addControl=function(control){assertNotHasOwnProperty(control.$name,"input"),controls.push(control),control.$name&&(form[control.$name]=control)},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(errors,function(queue,validationToken){form.$setValidity(validationToken,!0,control)}),arrayRemove(controls,control)},form.$setValidity=function(validationToken,isValid,control){var queue=errors[validationToken];if(isValid)queue&&(arrayRemove(queue,control),queue.length||(invalidCount--,invalidCount||(toggleValidCss(isValid),form.$valid=!0,form.$invalid=!1),errors[validationToken]=!1,toggleValidCss(!0,validationToken),parentForm.$setValidity(validationToken,!0,form)));else{if(invalidCount||toggleValidCss(isValid),queue){if(includes(queue,control))return}else errors[validationToken]=queue=[],invalidCount++,toggleValidCss(!1,validationToken),parentForm.$setValidity(validationToken,!1,form);queue.push(control),form.$valid=!1,form.$invalid=!0}},form.$setDirty=function(){$animate.removeClass(element,PRISTINE_CLASS),$animate.addClass(element,DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,parentForm.$setDirty()},form.$setPristine=function(){$animate.removeClass(element,DIRTY_CLASS),$animate.addClass(element,PRISTINE_CLASS),form.$dirty=!1,form.$pristine=!0,forEach(controls,function(control){control.$setPristine()})}}function validate(ctrl,validatorName,validity,value){return ctrl.$setValidity(validatorName,validity),validity?value:undefined}function testFlags(validity,flags){var i,flag;if(flags)for(i=0;i<flags.length;++i)if(flag=flags[i],validity[flag])return!0;return!1}function addNativeHtml5Validators(ctrl,validatorName,badFlags,ignoreFlags,validity){if(isObject(validity)){ctrl.$$hasNativeValidators=!0;var validator=function(value){return ctrl.$error[validatorName]||testFlags(validity,ignoreFlags)||!testFlags(validity,badFlags)?value:void ctrl.$setValidity(validatorName,!1)};ctrl.$parsers.push(validator)}}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){var validity=element.prop(VALIDITY_STATE_PROPERTY),placeholder=element[0].placeholder,noevent={},type=lowercase(element[0].type);if(ctrl.$$validityState=validity,!$sniffer.android){var composing=!1;element.on("compositionstart",function(){composing=!0}),element.on("compositionend",function(){composing=!1,listener()})}var listener=function(ev){if(!composing){var value=element.val();if(msie&&"input"===(ev||noevent).type&&element[0].placeholder!==placeholder)return void(placeholder=element[0].placeholder);"password"!==type&&toBoolean(attr.ngTrim||"T")&&(value=trim(value));var revalidate=validity&&ctrl.$$hasNativeValidators;(ctrl.$viewValue!==value||""===value&&revalidate)&&(scope.$root.$$phase?ctrl.$setViewValue(value):scope.$apply(function(){ctrl.$setViewValue(value)}))}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var timeout,deferListener=function(){timeout||(timeout=$browser.defer(function(){listener(),timeout=null}))};element.on("keydown",function(event){var key=event.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||deferListener()}),$sniffer.hasEvent("paste")&&element.on("paste cut",deferListener)}element.on("change",listener),ctrl.$render=function(){element.val(ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue)};var patternValidator,match,pattern=attr.ngPattern;if(pattern){var validateRegex=function(regexp,value){return validate(ctrl,"pattern",ctrl.$isEmpty(value)||regexp.test(value),value)};match=pattern.match(/^\/(.*)\/([gim]*)$/),match?(pattern=new RegExp(match[1],match[2]),patternValidator=function(value){return validateRegex(pattern,value)}):patternValidator=function(value){var patternObj=scope.$eval(pattern);if(!patternObj||!patternObj.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",pattern,patternObj,startingTag(element));return validateRegex(patternObj,value)},ctrl.$formatters.push(patternValidator),ctrl.$parsers.push(patternValidator)}if(attr.ngMinlength){var minlength=int(attr.ngMinlength),minLengthValidator=function(value){return validate(ctrl,"minlength",ctrl.$isEmpty(value)||value.length>=minlength,value)};ctrl.$parsers.push(minLengthValidator),ctrl.$formatters.push(minLengthValidator)}if(attr.ngMaxlength){var maxlength=int(attr.ngMaxlength),maxLengthValidator=function(value){return validate(ctrl,"maxlength",ctrl.$isEmpty(value)||value.length<=maxlength,value)};ctrl.$parsers.push(maxLengthValidator),ctrl.$formatters.push(maxLengthValidator)}}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(textInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$parsers.push(function(value){var empty=ctrl.$isEmpty(value);return empty||NUMBER_REGEXP.test(value)?(ctrl.$setValidity("number",!0),""===value?null:empty?value:parseFloat(value)):(ctrl.$setValidity("number",!1),undefined)}),addNativeHtml5Validators(ctrl,"number",numberBadFlags,null,ctrl.$$validityState),ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?"":""+value}),attr.min){var minValidator=function(value){var min=parseFloat(attr.min);return validate(ctrl,"min",ctrl.$isEmpty(value)||value>=min,value)};ctrl.$parsers.push(minValidator),ctrl.$formatters.push(minValidator)}if(attr.max){var maxValidator=function(value){var max=parseFloat(attr.max);return validate(ctrl,"max",ctrl.$isEmpty(value)||max>=value,value)};ctrl.$parsers.push(maxValidator),ctrl.$formatters.push(maxValidator)}ctrl.$formatters.push(function(value){return validate(ctrl,"number",ctrl.$isEmpty(value)||isNumber(value),value)})}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var urlValidator=function(value){return validate(ctrl,"url",ctrl.$isEmpty(value)||URL_REGEXP.test(value),value)};ctrl.$formatters.push(urlValidator),ctrl.$parsers.push(urlValidator)}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var emailValidator=function(value){return validate(ctrl,"email",ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value),value)};ctrl.$formatters.push(emailValidator),ctrl.$parsers.push(emailValidator)}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid()),element.on("click",function(){element[0].checked&&scope.$apply(function(){ctrl.$setViewValue(attr.value)})}),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function checkboxInputType(scope,element,attr,ctrl){var trueValue=attr.ngTrueValue,falseValue=attr.ngFalseValue;isString(trueValue)||(trueValue=!0),isString(falseValue)||(falseValue=!1),element.on("click",function(){scope.$apply(function(){ctrl.$setViewValue(element[0].checked)})}),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return value!==trueValue},ctrl.$formatters.push(function(value){return value===trueValue}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,["$animate",function($animate){function arrayDifference(tokens1,tokens2){var values=[];outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token==tokens2[j])continue outer;values.push(token)}return values}function arrayClasses(classVal){if(isArray(classVal))return classVal;if(isString(classVal))return classVal.split(" ");if(isObject(classVal)){var classes=[];return forEach(classVal,function(v,k){v&&(classes=classes.concat(k.split(" ")))}),classes}return classVal}return{restrict:"AC",link:function(scope,element,attr){function addClasses(classes){var newClasses=digestClassCounts(classes,1);attr.$addClass(newClasses)}function removeClasses(classes){var newClasses=digestClassCounts(classes,-1);attr.$removeClass(newClasses)}function digestClassCounts(classes,count){var classCounts=element.data("$classCounts")||{},classesToUpdate=[];return forEach(classes,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),element.data("$classCounts",classCounts),classesToUpdate.join(" ")}function updateClasses(oldClasses,newClasses){var toAdd=arrayDifference(newClasses,oldClasses),toRemove=arrayDifference(oldClasses,newClasses);toRemove=digestClassCounts(toRemove,-1),toAdd=digestClassCounts(toAdd,1),0===toAdd.length?$animate.removeClass(element,toRemove):0===toRemove.length?$animate.addClass(element,toAdd):$animate.setClass(element,toAdd,toRemove)}function ngClassWatchAction(newVal){if(selector===!0||scope.$index%2===selector){var newClasses=arrayClasses(newVal||[]);if(oldVal){if(!equals(newVal,oldVal)){var oldClasses=arrayClasses(oldVal);updateClasses(oldClasses,newClasses)}}else addClasses(newClasses)}oldVal=shallowCopy(newVal)}var oldVal;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(){ngClassWatchAction(scope.$eval(attr[name]))}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;if(mod!==(1&old$index)){var classes=arrayClasses(scope.$eval(attr[name]));mod===selector?addClasses(classes):removeClasses(classes)}})}}}]}var VALIDITY_STATE_PROPERTY="validity",lowercase=function(string){return isString(string)?string.toLowerCase():string},hasOwnProperty=Object.prototype.hasOwnProperty,uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(-33&ch.charCodeAt(0))}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var msie,jqLite,jQuery,angularModule,nodeName_,slice=[].slice,push=[].push,toString=Object.prototype.toString,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),uid=["0","0","0"];msie=int((/msie (\d+)/.exec(lowercase(navigator.userAgent))||[])[1]),isNaN(msie)&&(msie=int((/trident\/.*; rv:(\d+)/.exec(lowercase(navigator.userAgent))||[])[1])),noop.$inject=[],identity.$inject=[];var isArray=function(){return isFunction(Array.isArray)?Array.isArray:function(value){return"[object Array]"===toString.call(value)}}(),trim=function(){return String.prototype.trim?function(value){return isString(value)?value.trim():value}:function(value){return isString(value)?value.replace(/^\s\s*/,"").replace(/\s\s*$/,""):value}}();nodeName_=9>msie?function(element){return element=element.nodeName?element:element[0],element.scopeName&&"HTML"!=element.scopeName?uppercase(element.scopeName+":"+element.nodeName):element.nodeName}:function(element){return element.nodeName?element.nodeName:element[0].nodeName};var csp=function(){if(isDefined(csp.isActive_))return csp.isActive_;var active=!(!document.querySelector("[ng-csp]")&&!document.querySelector("[data-ng-csp]"));if(!active)try{new Function("")}catch(e){active=!0}return csp.isActive_=active},SNAKE_CASE_REGEXP=/[A-Z]/g,version={full:"1.2.28",major:1,minor:2,dot:28,codeName:"finnish-disembarkation"};JQLite.expando="ng339";var jqCache=JQLite.cache={},jqId=1,addEventListenerFn=window.document.addEventListener?function(element,type,fn){element.addEventListener(type,fn,!1)}:function(element,type,fn){element.attachEvent("on"+type,fn)},removeEventListenerFn=window.document.removeEventListener?function(element,type,fn){element.removeEventListener(type,fn,!1)}:function(element,type,fn){element.detachEvent("on"+type,fn)},SPECIAL_CHARS_REGEXP=(JQLite._data=function(node){return this.cache[node[this.expando]]||{}},/([\:\-\_]+(.))/g),MOZ_HACK_REGEXP=/^moz([A-Z])/,jqLiteMinErr=minErr("jqLite"),SINGLE_TAG_REGEXP=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;"complete"===document.readyState?setTimeout(trigger):(this.on("DOMContentLoaded",trigger),JQLite(window).on("load",trigger))},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return jqLite(index>=0?this[index]:this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[uppercase(value)]=!0}),forEach({data:jqLiteData,removeData:jqLiteRemoveData},function(fn,name){JQLite[name]=fn}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite.data(element,"$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite.data(element,"$isolateScope")||jqLite.data(element,"$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){if(name=camelCase(name),!isDefined(value)){var val;return 8>=msie&&(val=element.currentStyle&&element.currentStyle[name],""===val&&(val="auto")),val=val||element.style[name],8>=msie&&(val=""===val?undefined:val),val}element.style[name]=value},attr:function(element,name,value){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:undefined;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?undefined:ret}},prop:function(element,name,value){return isDefined(value)?void(element[name]=value):element[name]},text:function(){function getText(element,value){var textProp=NODE_TYPE_TEXT_PROPERTY[element.nodeType];return isUndefined(value)?textProp?element[textProp]:"":void(element[textProp]=value)}var NODE_TYPE_TEXT_PROPERTY=[];return 9>msie?(NODE_TYPE_TEXT_PROPERTY[1]="innerText",NODE_TYPE_TEXT_PROPERTY[3]="nodeValue"):NODE_TYPE_TEXT_PROPERTY[1]=NODE_TYPE_TEXT_PROPERTY[3]="textContent",getText.$dv="",getText}(),val:function(element,value){if(isUndefined(value)){if("SELECT"===nodeName_(element)&&element.multiple){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),0===result.length?null:result}return element.value}element.value=value},html:function(element,value){if(isUndefined(value))return element.innerHTML;for(var i=0,childNodes=element.childNodes;i<childNodes.length;i++)jqLiteDealoc(childNodes[i]);element.innerHTML=value},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&(2==fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)===undefined){if(isObject(arg1)){for(i=0;nodeCount>i;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=value===undefined?Math.min(nodeCount,1):nodeCount,j=0;jj>j;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;nodeCount>i;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,dealoc:jqLiteDealoc,on:function onFn(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");var events=jqLiteExpandoStore(element,"events"),handle=jqLiteExpandoStore(element,"handle");events||jqLiteExpandoStore(element,"events",events={}),handle||jqLiteExpandoStore(element,"handle",handle=createEventHandler(element,events)),forEach(type.split(" "),function(type){var eventFns=events[type];if(!eventFns){if("mouseenter"==type||"mouseleave"==type){var contains=document.body.contains||document.body.compareDocumentPosition?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};events[type]=[];var eventmap={mouseleave:"mouseout",mouseenter:"mouseover"};onFn(element,eventmap[type],function(event){var target=this,related=event.relatedTarget;(!related||related!==target&&!contains(target,related))&&handle(event,type)})}else addEventListenerFn(element,type,handle),events[type]=[];eventFns=events[type]}eventFns.push(fn)})},off:jqLiteOff,one:function(element,type,fn){element=jqLite(element),element.on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){1===element.nodeType&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){forEach(new JQLite(node),function(child){(1===element.nodeType||11===element.nodeType)&&element.appendChild(child)})},prepend:function(element,node){if(1===element.nodeType){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){wrapNode=jqLite(wrapNode)[0];var parent=element.parentNode;parent&&parent.replaceChild(wrapNode,element),wrapNode.appendChild(element)},remove:function(element){jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)},after:function(element,newElement){var index=element,parent=element.parentNode;forEach(new JQLite(newElement),function(node){parent.insertBefore(node,index.nextSibling),index=node})},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&11!==parent.nodeType?parent:null},next:function(element){if(element.nextElementSibling)return element.nextElementSibling;for(var elm=element.nextSibling;null!=elm&&1!==elm.nodeType;)elm=elm.nextSibling;return elm},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,event,extraParameters){var dummyEvent,eventFnsCopy,handlerArgs,eventName=event.type||event,eventFns=(jqLiteExpandoStore(element,"events")||{})[eventName];eventFns&&(dummyEvent={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopPropagation:noop,type:eventName,target:element},event.type&&(dummyEvent=extend(dummyEvent,event)),eventFnsCopy=shallowCopy(eventFns),handlerArgs=extraParameters?[dummyEvent].concat(extraParameters):[dummyEvent],forEach(eventFnsCopy,function(fn){fn.apply(element,handlerArgs)}))}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0;i<this.length;i++)isUndefined(value)?(value=fn(this[i],arg1,arg2,arg3),isDefined(value)&&(value=jqLite(value))):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this},JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off}),HashMap.prototype={put:function(key,value){this[hashKey(key,this.nextUid)]=value},get:function(key){return this[hashKey(key,this.nextUid)]},remove:function(key){var value=this[key=hashKey(key,this.nextUid)];return delete this[key],value}};var FN_ARGS=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector"),$animateMinErr=minErr("$animate"),$AnimateProvider=["$provide",function($provide){this.$$selectors={},this.register=function(name,factory){var key=name+"-animation";if(name&&"."!=name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);this.$$selectors[name.substr(1)]=key,$provide.factory(key,factory)},this.classNameFilter=function(expression){return 1===arguments.length&&(this.$$classNameFilter=expression instanceof RegExp?expression:null),this.$$classNameFilter},this.$get=["$timeout","$$asyncCallback",function($timeout,$$asyncCallback){function async(fn){fn&&$$asyncCallback(fn)}return{enter:function(element,parent,after,done){after?after.after(element):(parent&&parent[0]||(parent=after.parent()),parent.append(element)),async(done)},leave:function(element,done){element.remove(),async(done)},move:function(element,parent,after,done){this.enter(element,parent,after,done)},addClass:function(element,className,done){className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteAddClass(element,className)}),async(done)},removeClass:function(element,className,done){className=isString(className)?className:isArray(className)?className.join(" "):"",forEach(element,function(element){jqLiteRemoveClass(element,className)}),async(done)},setClass:function(element,add,remove,done){forEach(element,function(element){jqLiteAddClass(element,add),jqLiteRemoveClass(element,remove)}),async(done)},enabled:noop}}]}],$compileMinErr=minErr("$compile");$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"];var PREFIX_REGEXP=/^(x[\:\-_]|data[\:\-_])/i,$interpolateMinErr=minErr("$interpolate"),PATH_MATCH=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location");LocationHashbangInHtml5Url.prototype=LocationHashbangUrl.prototype=LocationHtml5Url.prototype={$$html5:!1,$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return match[1]&&this.path(decodeURIComponent(match[1])),(match[2]||match[1])&&this.search(match[3]||""),this.hash(match[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return path=null!==path?path.toString():"","/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search)||isNumber(search))search=search.toString(),this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");forEach(search,function(value,key){null==value&&delete search[key]}),this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(hash){return null!==hash?hash.toString():""}),replace:function(){return this.$$replace=!0,this}};var promiseWarning,$parseMinErr=minErr("$parse"),promiseWarningCache={},CALL=Function.prototype.call,APPLY=Function.prototype.apply,BIND=Function.prototype.bind,OPERATORS={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:noop,"+":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),isDefined(a)?isDefined(b)?a+b:a:isDefined(b)?b:undefined},"-":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),(isDefined(a)?a:0)-(isDefined(b)?b:0)},"*":function(self,locals,a,b){return a(self,locals)*b(self,locals)},"/":function(self,locals,a,b){return a(self,locals)/b(self,locals)},"%":function(self,locals,a,b){return a(self,locals)%b(self,locals)},"^":function(self,locals,a,b){return a(self,locals)^b(self,locals)},"=":noop,"===":function(self,locals,a,b){return a(self,locals)===b(self,locals)},"!==":function(self,locals,a,b){return a(self,locals)!==b(self,locals)},"==":function(self,locals,a,b){return a(self,locals)==b(self,locals)},"!=":function(self,locals,a,b){return a(self,locals)!=b(self,locals)},"<":function(self,locals,a,b){return a(self,locals)<b(self,locals)},">":function(self,locals,a,b){return a(self,locals)>b(self,locals)},"<=":function(self,locals,a,b){return a(self,locals)<=b(self,locals)},">=":function(self,locals,a,b){return a(self,locals)>=b(self,locals)},"&&":function(self,locals,a,b){return a(self,locals)&&b(self,locals)},"||":function(self,locals,a,b){return a(self,locals)||b(self,locals)},"&":function(self,locals,a,b){return a(self,locals)&b(self,locals)},"|":function(self,locals,a,b){return b(self,locals)(self,locals,a(self,locals))},"!":function(self,locals,a){return!a(self,locals)}},ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.ch=undefined,this.lastCh=":",this.tokens=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent();else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch}),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var ch2=this.ch+this.peek(),ch3=ch2+this.peek(2),fn=OPERATORS[this.ch],fn2=OPERATORS[ch2],fn3=OPERATORS[ch3];fn3?(this.tokens.push({index:this.index,text:ch3,fn:fn3}),this.index+=3):fn2?(this.tokens.push({index:this.index,text:ch2,fn:fn2}),this.index+=2):fn?(this.tokens.push({index:this.index,text:this.ch,fn:fn}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(chars){return-1!==chars.indexOf(this.ch)},was:function(chars){return-1!==chars.indexOf(this.lastCh)},peek:function(i){var num=i||1;return this.index+num<this.text.length?this.text.charAt(this.index+num):!1},isNumber:function(ch){return ch>="0"&&"9">=ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"	"===ch||"\n"===ch||""===ch||" "===ch},isIdent:function(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||"_"===ch||"$"===ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."==ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"==ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}number=1*number,this.tokens.push({index:start,text:number,literal:!0,constant:!0,fn:function(){return number}})},readIdent:function(){for(var lastDot,peekIndex,methodName,ch,parser=this,ident="",start=this.index;this.index<this.text.length&&(ch=this.text.charAt(this.index),"."===ch||this.isIdent(ch)||this.isNumber(ch));)"."===ch&&(lastDot=this.index),ident+=ch,this.index++;if(lastDot)for(peekIndex=this.index;peekIndex<this.text.length;){if(ch=this.text.charAt(peekIndex),"("===ch){methodName=ident.substr(lastDot-start+1),ident=ident.substr(0,lastDot-start),this.index=peekIndex;break}if(!this.isWhitespace(ch))break;peekIndex++}var token={index:start,text:ident};if(OPERATORS.hasOwnProperty(ident))token.fn=OPERATORS[ident],token.literal=!0,token.constant=!0;else{var getter=getterFn(ident,this.options,this.text);token.fn=extend(function(self,locals){return getter(self,locals)},{assign:function(self,value){return setter(self,ident,value,parser.text,parser.options)
}})}this.tokens.push(token),methodName&&(this.tokens.push({index:lastDot,text:"."}),this.tokens.push({index:lastDot+1,text:methodName}))},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,void this.tokens.push({index:start,text:rawString,string:string,literal:!0,constant:!0,fn:function(){return string}});string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var Parser=function(lexer,$filter,options){this.lexer=lexer,this.$filter=$filter,this.options=options};Parser.ZERO=extend(function(){return 0},{constant:!0}),Parser.prototype={constructor:Parser,parse:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value.literal=!!value.literal,value.constant=!!value.constant,value},primary:function(){var primary;if(this.expect("("))primary=this.filterChain(),this.consume(")");else if(this.expect("["))primary=this.arrayDeclaration();else if(this.expect("{"))primary=this.object();else{var token=this.expect();primary=token.fn,primary||this.throwError("not a primary expression",token),primary.literal=!!token.literal,primary.constant=!!token.constant}for(var next,context;next=this.expect("(","[",".");)"("===next.text?(primary=this.functionCall(primary,context),context=null):"["===next.text?(context=primary,primary=this.objectIndex(primary)):"."===next.text?(context=primary,primary=this.fieldAccess(primary)):this.throwError("IMPOSSIBLE");return primary},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){if(this.tokens.length>0){var token=this.tokens[0],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return token?(this.tokens.shift(),token):!1},consume:function(e1){this.expect(e1)||this.throwError("is unexpected, expecting ["+e1+"]",this.peek())},unaryFn:function(fn,right){return extend(function(self,locals){return fn(self,locals,right)},{constant:right.constant})},ternaryFn:function(left,middle,right){return extend(function(self,locals){return left(self,locals)?middle(self,locals):right(self,locals)},{constant:left.constant&&middle.constant&&right.constant})},binaryFn:function(left,fn,right){return extend(function(self,locals){return fn(self,locals,left,right)},{constant:left.constant&&right.constant})},statements:function(){for(var statements=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&statements.push(this.filterChain()),!this.expect(";"))return 1===statements.length?statements[0]:function(self,locals){for(var value,i=0;i<statements.length;i++){var statement=statements[i];statement&&(value=statement(self,locals))}return value}},filterChain:function(){for(var token,left=this.expression();;){if(!(token=this.expect("|")))return left;left=this.binaryFn(left,token.fn,this.filter())}},filter:function(){for(var token=this.expect(),fn=this.$filter(token.text),argsFn=[];;){if(!(token=this.expect(":"))){var fnInvoke=function(self,locals,input){for(var args=[input],i=0;i<argsFn.length;i++)args.push(argsFn[i](self,locals));return fn.apply(self,args)};return function(){return fnInvoke}}argsFn.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var right,token,left=this.ternary();return(token=this.expect("="))?(left.assign||this.throwError("implies assignment but ["+this.text.substring(0,token.index)+"] can not be assigned to",token),right=this.ternary(),function(scope,locals){return left.assign(scope,right(scope,locals),locals)}):left},ternary:function(){var middle,token,left=this.logicalOR();return(token=this.expect("?"))?(middle=this.assignment(),(token=this.expect(":"))?this.ternaryFn(left,middle,this.assignment()):void this.throwError("expected :",token)):left},logicalOR:function(){for(var token,left=this.logicalAND();;){if(!(token=this.expect("||")))return left;left=this.binaryFn(left,token.fn,this.logicalAND())}},logicalAND:function(){var token,left=this.equality();return(token=this.expect("&&"))&&(left=this.binaryFn(left,token.fn,this.logicalAND())),left},equality:function(){var token,left=this.relational();return(token=this.expect("==","!=","===","!=="))&&(left=this.binaryFn(left,token.fn,this.equality())),left},relational:function(){var token,left=this.additive();return(token=this.expect("<",">","<=",">="))&&(left=this.binaryFn(left,token.fn,this.relational())),left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left=this.binaryFn(left,token.fn,this.multiplicative());return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left=this.binaryFn(left,token.fn,this.unary());return left},unary:function(){var token;return this.expect("+")?this.primary():(token=this.expect("-"))?this.binaryFn(Parser.ZERO,token.fn,this.unary()):(token=this.expect("!"))?this.unaryFn(token.fn,this.unary()):this.primary()},fieldAccess:function(object){var parser=this,field=this.expect().text,getter=getterFn(field,this.options,this.text);return extend(function(scope,locals,self){return getter(self||object(scope,locals))},{assign:function(scope,value,locals){var o=object(scope,locals);return o||object.assign(scope,o={}),setter(o,field,value,parser.text,parser.options)}})},objectIndex:function(obj){var parser=this,indexFn=this.expression();return this.consume("]"),extend(function(self,locals){var v,p,o=obj(self,locals),i=indexFn(self,locals);return ensureSafeMemberName(i,parser.text),o?(v=ensureSafeObject(o[i],parser.text),v&&v.then&&parser.options.unwrapPromises&&(p=v,"$$v"in v||(p.$$v=undefined,p.then(function(val){p.$$v=val})),v=v.$$v),v):undefined},{assign:function(self,value,locals){var key=ensureSafeMemberName(indexFn(self,locals),parser.text),o=ensureSafeObject(obj(self,locals),parser.text);return o||obj.assign(self,o={}),o[key]=value}})},functionCall:function(fn,contextGetter){var argsFn=[];if(")"!==this.peekToken().text)do argsFn.push(this.expression());while(this.expect(","));this.consume(")");var parser=this;return function(scope,locals){for(var args=[],context=contextGetter?contextGetter(scope,locals):scope,i=0;i<argsFn.length;i++)args.push(ensureSafeObject(argsFn[i](scope,locals),parser.text));var fnPtr=fn(scope,locals,context)||noop;ensureSafeObject(context,parser.text),ensureSafeFunction(fnPtr,parser.text);var v=fnPtr.apply?fnPtr.apply(context,args):fnPtr(args[0],args[1],args[2],args[3],args[4]);return ensureSafeObject(v,parser.text)}},arrayDeclaration:function(){var elementFns=[],allConstant=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var elementFn=this.expression();elementFns.push(elementFn),elementFn.constant||(allConstant=!1)}while(this.expect(","));return this.consume("]"),extend(function(self,locals){for(var array=[],i=0;i<elementFns.length;i++)array.push(elementFns[i](self,locals));return array},{literal:!0,constant:allConstant})},object:function(){var keyValues=[],allConstant=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var token=this.expect(),key=token.string||token.text;this.consume(":");var value=this.expression();keyValues.push({key:key,value:value}),value.constant||(allConstant=!1)}while(this.expect(","));return this.consume("}"),extend(function(self,locals){for(var object={},i=0;i<keyValues.length;i++){var keyValue=keyValues[i];object[keyValue.key]=keyValue.value(self,locals)}return object},{literal:!0,constant:allConstant})}};var getterFnCacheDefault={},getterFnCacheExpensive={},$sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},urlParsingNode=document.createElement("a"),originUrl=urlResolve(window.location.href,!0);$FilterProvider.$inject=["$provide"],currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DECIMAL_SEP=".",DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,!0),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter},DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,NUMBER_STRING=/^\-?\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){return 8>=msie&&(attr.href||attr.name||attr.$set("href",""),element.append(document.createComment("IE fix"))),attr.href||attr.xlinkHref||attr.name?void 0:function(scope,element){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){if("multiple"!=propName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:100,link:function(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$observe(normalized,function(value){return value?(attr.$set(name,value),void(msie&&propName&&element.prop(propName,attr[name]))):void("href"===attrName&&attr.$set(name,null))})}}}});var nullFormCtrl={$addControl:noop,$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop};FormController.$inject=["$element","$attrs","$scope","$animate"];var formDirectiveFactory=function(isNgForm){return["$timeout",function($timeout){var formDirective={name:"form",restrict:isNgForm?"EAC":"E",controller:FormController,compile:function(){return{pre:function(scope,formElement,attr,controller){if(!attr.action){var preventDefaultListener=function(event){event.preventDefault?event.preventDefault():event.returnValue=!1};addEventListenerFn(formElement[0],"submit",preventDefaultListener),formElement.on("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",preventDefaultListener)},0,!1)})}var parentFormCtrl=formElement.parent().controller("form"),alias=attr.name||attr.ngForm;alias&&setter(scope,alias,controller,alias),parentFormCtrl&&formElement.on("$destroy",function(){parentFormCtrl.$removeControl(controller),alias&&setter(scope,alias,undefined,alias),extend(controller,nullFormCtrl)})}}}};return formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),URL_REGEXP=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,EMAIL_REGEXP=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,inputType={text:textInputType,number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop,file:noop},numberBadFlags=["badInput"],inputDirective=["$browser","$sniffer",function($browser,$sniffer){return{restrict:"E",require:"?ngModel",link:function(scope,element,attr,ctrl){ctrl&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrl,$sniffer,$browser)}}}],VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function($scope,$exceptionHandler,$attr,$element,$parse,$animate){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",$animate.removeClass($element,(isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey),$animate.addClass($element,(isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey)}this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=$attr.name;var ngModelGet=$parse($attr.ngModel),ngModelSet=ngModelGet.assign;if(!ngModelSet)throw minErr("ngModel")("nonassign","Expression '{0}' is non-assignable. Element: {1}",$attr.ngModel,startingTag($element));this.$render=noop,this.$isEmpty=function(value){return isUndefined(value)||""===value||null===value||value!==value};var parentForm=$element.inheritedData("$formController")||nullFormCtrl,invalidCount=0,$error=this.$error={};$element.addClass(PRISTINE_CLASS),toggleValidCss(!0),this.$setValidity=function(validationErrorKey,isValid){$error[validationErrorKey]!==!isValid&&(isValid?($error[validationErrorKey]&&invalidCount--,invalidCount||(toggleValidCss(!0),this.$valid=!0,this.$invalid=!1)):(toggleValidCss(!1),this.$invalid=!0,this.$valid=!1,invalidCount++),$error[validationErrorKey]=!isValid,toggleValidCss(isValid,validationErrorKey),parentForm.$setValidity(validationErrorKey,isValid,this))},this.$setPristine=function(){this.$dirty=!1,this.$pristine=!0,$animate.removeClass($element,DIRTY_CLASS),$animate.addClass($element,PRISTINE_CLASS)},this.$setViewValue=function(value){this.$viewValue=value,this.$pristine&&(this.$dirty=!0,this.$pristine=!1,$animate.removeClass($element,PRISTINE_CLASS),$animate.addClass($element,DIRTY_CLASS),parentForm.$setDirty()),forEach(this.$parsers,function(fn){value=fn(value)}),this.$modelValue!==value&&(this.$modelValue=value,ngModelSet($scope,value),forEach(this.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}}))};var ctrl=this;$scope.$watch(function(){var value=ngModelGet($scope);if(ctrl.$modelValue!==value){var formatters=ctrl.$formatters,idx=formatters.length;for(ctrl.$modelValue=value;idx--;)value=formatters[idx](value);ctrl.$viewValue!==value&&(ctrl.$viewValue=value,ctrl.$render())}return value})}],ngModelDirective=function(){return{require:["ngModel","^?form"],controller:NgModelController,link:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||nullFormCtrl;formCtrl.$addControl(modelCtrl),scope.$on("$destroy",function(){formCtrl.$removeControl(modelCtrl)})}}},ngChangeDirective=valueFn({require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),requiredDirective=function(){return{require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){attr.required=!0;var validator=function(value){return attr.required&&ctrl.$isEmpty(value)?void ctrl.$setValidity("required",!1):(ctrl.$setValidity("required",!0),value)};ctrl.$formatters.push(validator),ctrl.$parsers.unshift(validator),attr.$observe("required",function(){validator(ctrl.$viewValue)})}}}},ngListDirective=function(){return{require:"ngModel",link:function(scope,element,attr,ctrl){var match=/\/(.*)\//.exec(attr.ngList),separator=match&&new RegExp(match[1])||attr.ngList||",",parse=function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trim(value))}),list}};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){return isArray(value)?value.join(", "):undefined}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value)})}}}},ngBindDirective=ngDirective({compile:function(templateElement){return templateElement.addClass("ng-binding"),function(scope,element,attr){element.data("$binding",attr.ngBind),scope.$watch(attr.ngBind,function(value){element.text(value==undefined?"":value)})}}}),ngBindTemplateDirective=["$interpolate",function($interpolate){return function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));element.addClass("ng-binding").data("$binding",interpolateFn),attr.$observe("ngBindTemplate",function(value){element.text(value)})}}],ngBindHtmlDirective=["$sce","$parse",function($sce,$parse){return{compile:function(tElement){return tElement.addClass("ng-binding"),function(scope,element,attr){function getStringValue(){return(parsed(scope)||"").toString()}element.data("$binding",attr.ngBindHtml);var parsed=$parse(attr.ngBindHtml);scope.$watch(getStringValue,function(){element.html($sce.getTrustedHtml(parsed(scope))||"")})}}}}],ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",undefined),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{scope:!0,controller:"@",priority:500}}],ngEventDirectives={},forceAsyncEvents={blur:!0,focus:!0};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(eventName){var directiveName=directiveNormalize("ng-"+eventName);ngEventDirectives[directiveName]=["$parse","$rootScope",function($parse,$rootScope){return{compile:function($element,attr){var fn=$parse(attr[directiveName],!0);return function(scope,element){element.on(eventName,function(event){var callback=function(){fn(scope,{$event:event})};forceAsyncEvents[eventName]&&$rootScope.$$phase?scope.$evalAsync(callback):scope.$apply(callback)})}}}}]});var ngIfDirective=["$animate",function($animate){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){toBoolean(value)?childScope||(childScope=$scope.$new(),$transclude(childScope,function(clone){clone[clone.length++]=document.createComment(" end ngIf: "+$attr.ngIf+" "),block={clone:clone},$animate.enter(clone,$element.parent(),$element)})):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockElements(block.clone),$animate.leave(previousElements,function(){previousElements=null}),block=null))})}}}],ngIncludeDirective=["$http","$templateCache","$anchorScroll","$animate","$sce",function($http,$templateCache,$anchorScroll,$animate,$sce){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement,function(){previousElement=null}),previousElement=currentElement,currentElement=null)};scope.$watch($sce.parseAsResourceUrl(srcExp),function(src){var afterAnimation=function(){!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($http.get(src,{cache:$templateCache}).success(function(response){if(thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element,afterAnimation)});currentScope=newScope,currentElement=clone,currentScope.$emit("$includeContentLoaded"),scope.$eval(onloadExp)}}).error(function(){thisChangeId===changeCounter&&cleanupLastIncludeContent()}),scope.$emit("$includeContentRequested")):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){$element.html(ctrl.template),$compile($element.contents())(scope)}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngPluralizeDirective=["$locale","$interpolate",function($locale,$interpolate){var BRACE=/{}/g;return{restrict:"EA",link:function(scope,element,attr){var numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),isWhen=/^when(Minus)?(.+)$/;forEach(attr,function(expression,attributeName){isWhen.test(attributeName)&&(whens[lowercase(attributeName.replace("when","").replace("Minus","-"))]=element.attr(attr.$attr[attributeName]))}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,startSymbol+numberExp+"-"+offset+endSymbol))}),scope.$watch(function(){var value=parseFloat(scope.$eval(numberExp));return isNaN(value)?"":(value in whens||(value=$locale.pluralCat(value-offset)),whensExpFns[value](scope,element,!0))},function(newVal){element.text(newVal)})}}}],ngRepeatDirective=["$parse","$animate",function($parse,$animate){function getBlockStart(block){return block.clone[0]}function getBlockEnd(block){return block.clone[block.clone.length-1]}var NG_REMOVED="$$NG_REMOVED",ngRepeatMinErr=minErr("ngRepeat");return{transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var trackByExp,trackByExpGetter,trackByIdExpFn,trackByIdArrayFn,trackByIdObjFn,lhs,rhs,valueIdentifier,keyIdentifier,expression=$attr.ngRepeat,match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),hashFnLocals={$id:hashKey};if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);if(lhs=match[1],rhs=match[2],trackByExp=match[3],trackByExp?(trackByExpGetter=$parse(trackByExp),trackByIdExpFn=function(key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)}):(trackByIdArrayFn=function(key,value){return hashKey(value)},trackByIdObjFn=function(key){return key}),match=lhs.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/),!match)throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);valueIdentifier=match[3]||match[1],keyIdentifier=match[2];var lastBlockMap={};$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,arrayLength,childScope,key,value,trackById,trackByIdFn,collectionKeys,block,elementsToRemove,previousNode=$element[0],nextBlockMap={},nextBlockOrder=[];if(isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else{trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[];for(key in collection)collection.hasOwnProperty(key)&&"$"!=key.charAt(0)&&collectionKeys.push(key);collectionKeys.sort()}for(arrayLength=collectionKeys.length,length=nextBlockOrder.length=collectionKeys.length,index=0;length>index;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn(key,value,index),assertNotHasOwnProperty(trackById,"`track by` id"),lastBlockMap.hasOwnProperty(trackById))block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap.hasOwnProperty(trackById))throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",expression,trackById,toJson(value));nextBlockOrder[index]={id:trackById},nextBlockMap[trackById]=!1}for(key in lastBlockMap)lastBlockMap.hasOwnProperty(key)&&(block=lastBlockMap[key],elementsToRemove=getBlockElements(block.clone),$animate.leave(elementsToRemove),forEach(elementsToRemove,function(element){element[NG_REMOVED]=!0}),block.scope.$destroy());for(index=0,length=collectionKeys.length;length>index;index++){if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],block=nextBlockOrder[index],nextBlockOrder[index-1]&&(previousNode=getBlockEnd(nextBlockOrder[index-1])),block.scope){childScope=block.scope,nextNode=previousNode;do nextNode=nextNode.nextSibling;while(nextNode&&nextNode[NG_REMOVED]);getBlockStart(block)!=nextNode&&$animate.move(getBlockElements(block.clone),null,jqLite(previousNode)),previousNode=getBlockEnd(block)}else childScope=$scope.$new();childScope[valueIdentifier]=value,keyIdentifier&&(childScope[keyIdentifier]=key),childScope.$index=index,childScope.$first=0===index,childScope.$last=index===arrayLength-1,childScope.$middle=!(childScope.$first||childScope.$last),childScope.$odd=!(childScope.$even=0===(1&index)),block.scope||$transclude(childScope,function(clone){clone[clone.length++]=document.createComment(" end ngRepeat: "+expression+" "),$animate.enter(clone,null,jqLite(previousNode)),previousNode=clone,block.scope=childScope,block.clone=clone,nextBlockMap[block.id]=block})}lastBlockMap=nextBlockMap})}}}],ngShowDirective=["$animate",function($animate){return function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[toBoolean(value)?"removeClass":"addClass"](element,"ng-hide")})}}],ngHideDirective=["$animate",function($animate){return function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[toBoolean(value)?"addClass":"removeClass"](element,"ng-hide")})}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=["$animate",function($animate){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousElements=[],selectedScopes=[];scope.$watch(watchExpr,function(value){var i,ii;for(i=0,ii=previousElements.length;ii>i;++i)previousElements[i].remove();for(previousElements.length=0,i=0,ii=selectedScopes.length;ii>i;++i){var selected=selectedElements[i];selectedScopes[i].$destroy(),previousElements[i]=selected,$animate.leave(selected,function(){previousElements.splice(i,1)})}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&(scope.$eval(attr.change),forEach(selectedTranscludes,function(selectedTransclude){var selectedScope=scope.$new();selectedScopes.push(selectedScope),selectedTransclude.transclude(selectedScope,function(caseElement){var anchor=selectedTransclude.element;selectedElements.push(caseElement),$animate.enter(caseElement,anchor.parent(),anchor)})}))})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:800,require:"^ngSwitch",link:function(scope,element,attrs,ctrl,$transclude){ctrl.cases["!"+attrs.ngSwitchWhen]=ctrl.cases["!"+attrs.ngSwitchWhen]||[],ctrl.cases["!"+attrs.ngSwitchWhen].push({transclude:$transclude,element:element})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:800,require:"^ngSwitch",link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeDirective=ngDirective({link:function($scope,$element,$attrs,controller,$transclude){if(!$transclude)throw minErr("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$transclude(function(clone){$element.empty(),$element.append(clone)})}}),scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],ngOptionsMinErr=minErr("ngOptions"),ngOptionsDirective=valueFn({terminal:!0}),selectDirective=["$compile","$parse",function($compile,$parse){var NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,nullModelCtrl={$setViewValue:noop};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function($element,$scope,$attrs){var nullOption,unknownOption,self=this,optionsMap={},ngModelCtrl=nullModelCtrl;self.databound=$attrs.ngModel,self.init=function(ngModelCtrl_,nullOption_,unknownOption_){ngModelCtrl=ngModelCtrl_,nullOption=nullOption_,unknownOption=unknownOption_},self.addOption=function(value){assertNotHasOwnProperty(value,'"option value"'),optionsMap[value]=!0,ngModelCtrl.$viewValue==value&&($element.val(value),unknownOption.parent()&&unknownOption.remove())},self.removeOption=function(value){this.hasOption(value)&&(delete optionsMap[value],ngModelCtrl.$viewValue==value&&this.renderUnknownOption(value))},self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";unknownOption.val(unknownVal),$element.prepend(unknownOption),$element.val(unknownVal),unknownOption.prop("selected",!0)},self.hasOption=function(value){return optionsMap.hasOwnProperty(value)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop})}],link:function(scope,element,attr,ctrls){function setupAsSingle(scope,selectElement,ngModelCtrl,selectCtrl){ngModelCtrl.$render=function(){var viewValue=ngModelCtrl.$viewValue;selectCtrl.hasOption(viewValue)?(unknownOption.parent()&&unknownOption.remove(),selectElement.val(viewValue),""===viewValue&&emptyOption.prop("selected",!0)):isUndefined(viewValue)&&emptyOption?selectElement.val(""):selectCtrl.renderUnknownOption(viewValue)},selectElement.on("change",function(){scope.$apply(function(){unknownOption.parent()&&unknownOption.remove(),ngModelCtrl.$setViewValue(selectElement.val())})})}function setupAsMultiple(scope,selectElement,ctrl){var lastView;
ctrl.$render=function(){var items=new HashMap(ctrl.$viewValue);forEach(selectElement.find("option"),function(option){option.selected=isDefined(items.get(option.value))})},scope.$watch(function(){equals(lastView,ctrl.$viewValue)||(lastView=shallowCopy(ctrl.$viewValue),ctrl.$render())}),selectElement.on("change",function(){scope.$apply(function(){var array=[];forEach(selectElement.find("option"),function(option){option.selected&&array.push(option.value)}),ctrl.$setViewValue(array)})})}function setupAsOptions(scope,selectElement,ctrl){function getSelectedSet(){var selectedSet=!1;if(multiple){var modelValue=ctrl.$modelValue;if(trackFn&&isArray(modelValue)){selectedSet=new HashMap([]);for(var locals={},trackIndex=0;trackIndex<modelValue.length;trackIndex++)locals[valueName]=modelValue[trackIndex],selectedSet.put(trackFn(scope,locals),modelValue[trackIndex])}else selectedSet=new HashMap(modelValue)}return selectedSet}function render(){var optionGroupName,optionGroup,option,existingParent,existingOptions,existingOption,key,groupLength,length,groupIndex,index,selected,lastElement,element,label,optionGroups={"":[]},optionGroupNames=[""],modelValue=ctrl.$modelValue,values=valuesFn(scope)||[],keys=keyName?sortedKeys(values):values,locals={},selectedSet=getSelectedSet();for(index=0;length=keys.length,length>index;index++){if(key=index,keyName){if(key=keys[index],"$"===key.charAt(0))continue;locals[keyName]=key}if(locals[valueName]=values[key],optionGroupName=groupByFn(scope,locals)||"",(optionGroup=optionGroups[optionGroupName])||(optionGroup=optionGroups[optionGroupName]=[],optionGroupNames.push(optionGroupName)),multiple)selected=isDefined(selectedSet.remove(trackFn?trackFn(scope,locals):valueFn(scope,locals)));else{if(trackFn){var modelCast={};modelCast[valueName]=modelValue,selected=trackFn(scope,modelCast)===trackFn(scope,locals)}else selected=modelValue===valueFn(scope,locals);selectedSet=selectedSet||selected}label=displayFn(scope,locals),label=isDefined(label)?label:"",optionGroup.push({id:trackFn?trackFn(scope,locals):keyName?keys[index]:index,label:label,selected:selected})}for(multiple||(nullOption||null===modelValue?optionGroups[""].unshift({id:"",label:"",selected:!selectedSet}):selectedSet||optionGroups[""].unshift({id:"?",label:"",selected:!0})),groupIndex=0,groupLength=optionGroupNames.length;groupLength>groupIndex;groupIndex++){for(optionGroupName=optionGroupNames[groupIndex],optionGroup=optionGroups[optionGroupName],optionGroupsCache.length<=groupIndex?(existingParent={element:optGroupTemplate.clone().attr("label",optionGroupName),label:optionGroup.label},existingOptions=[existingParent],optionGroupsCache.push(existingOptions),selectElement.append(existingParent.element)):(existingOptions=optionGroupsCache[groupIndex],existingParent=existingOptions[0],existingParent.label!=optionGroupName&&existingParent.element.attr("label",existingParent.label=optionGroupName)),lastElement=null,index=0,length=optionGroup.length;length>index;index++)option=optionGroup[index],(existingOption=existingOptions[index+1])?(lastElement=existingOption.element,existingOption.label!==option.label&&(lastElement.text(existingOption.label=option.label),lastElement.prop("label",existingOption.label)),existingOption.id!==option.id&&lastElement.val(existingOption.id=option.id),lastElement[0].selected!==option.selected&&(lastElement.prop("selected",existingOption.selected=option.selected),msie&&lastElement.prop("selected",existingOption.selected))):(""===option.id&&nullOption?element=nullOption:(element=optionTemplate.clone()).val(option.id).prop("selected",option.selected).attr("selected",option.selected).prop("label",option.label).text(option.label),existingOptions.push(existingOption={element:element,label:option.label,id:option.id,selected:option.selected}),selectCtrl.addOption(option.label,element),lastElement?lastElement.after(element):existingParent.element.append(element),lastElement=element);for(index++;existingOptions.length>index;)option=existingOptions.pop(),selectCtrl.removeOption(option.label),option.element.remove()}for(;optionGroupsCache.length>groupIndex;)optionGroupsCache.pop()[0].element.remove()}var match;if(!(match=optionsExp.match(NG_OPTIONS_REGEXP)))throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var displayFn=$parse(match[2]||match[1]),valueName=match[4]||match[6],keyName=match[5],groupByFn=$parse(match[3]||""),valueFn=$parse(match[2]?match[1]:valueName),valuesFn=$parse(match[7]),track=match[8],trackFn=track?$parse(match[8]):null,optionGroupsCache=[[{element:selectElement,label:""}]];nullOption&&($compile(nullOption)(scope),nullOption.removeClass("ng-scope"),nullOption.remove()),selectElement.empty(),selectElement.on("change",function(){scope.$apply(function(){var optionGroup,key,value,optionElement,index,groupIndex,length,groupLength,trackIndex,collection=valuesFn(scope)||[],locals={};if(multiple){for(value=[],groupIndex=0,groupLength=optionGroupsCache.length;groupLength>groupIndex;groupIndex++)for(optionGroup=optionGroupsCache[groupIndex],index=1,length=optionGroup.length;length>index;index++)if((optionElement=optionGroup[index].element)[0].selected){if(key=optionElement.val(),keyName&&(locals[keyName]=key),trackFn)for(trackIndex=0;trackIndex<collection.length&&(locals[valueName]=collection[trackIndex],trackFn(scope,locals)!=key);trackIndex++);else locals[valueName]=collection[key];value.push(valueFn(scope,locals))}}else if(key=selectElement.val(),"?"==key)value=undefined;else if(""===key)value=null;else if(trackFn){for(trackIndex=0;trackIndex<collection.length;trackIndex++)if(locals[valueName]=collection[trackIndex],trackFn(scope,locals)==key){value=valueFn(scope,locals);break}}else locals[valueName]=collection[key],keyName&&(locals[keyName]=key),value=valueFn(scope,locals);ctrl.$setViewValue(value),render()})}),ctrl.$render=render,scope.$watchCollection(valuesFn,render),scope.$watchCollection(function(){var locals={},values=valuesFn(scope);if(values){for(var toDisplay=new Array(values.length),i=0,ii=values.length;ii>i;i++)locals[valueName]=values[i],toDisplay[i]=displayFn(scope,locals);return toDisplay}},render),multiple&&scope.$watchCollection(function(){return ctrl.$modelValue},render)}if(ctrls[1]){for(var emptyOption,selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,optionsExp=attr.ngOptions,nullOption=!1,optionTemplate=jqLite(document.createElement("option")),optGroupTemplate=jqLite(document.createElement("optgroup")),unknownOption=optionTemplate.clone(),i=0,children=element.children(),ii=children.length;ii>i;i++)if(""===children[i].value){emptyOption=nullOption=children.eq(i);break}selectCtrl.init(ngModelCtrl,nullOption,unknownOption),multiple&&(ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}),optionsExp?setupAsOptions(scope,element,ngModelCtrl):multiple?setupAsMultiple(scope,element,ngModelCtrl):setupAsSingle(scope,element,ngModelCtrl,selectCtrl)}}}}],optionDirective=["$interpolate",function($interpolate){var nullSelectCtrl={addOption:noop,removeOption:noop};return{restrict:"E",priority:100,compile:function(element,attr){if(isUndefined(attr.value)){var interpolateFn=$interpolate(element.text(),!0);interpolateFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.databound?element.prop("selected",!1):selectCtrl=nullSelectCtrl,interpolateFn?scope.$watch(interpolateFn,function(newVal,oldVal){attr.$set("value",newVal),newVal!==oldVal&&selectCtrl.removeOption(oldVal),selectCtrl.addOption(newVal)}):selectCtrl.addOption(attr.value),element.on("$destroy",function(){selectCtrl.removeOption(attr.value)})}}}}],styleDirective=valueFn({restrict:"E",terminal:!0});return window.angular.bootstrap?void console.log("WARNING: Tried to load angular more than once."):(bindJQuery(),publishExternalAPI(angular),void jqLite(document).ready(function(){angularInit(document,bootstrap)}))}(window,document),!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}.ng-hide-add-active,.ng-hide-remove{display:block!important;}</style>'),function(window,angular,undefined){"use strict";angular.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function($rootScope,$browser){function push(){var name,value,browserCookies,updated;for(name in lastCookies)isUndefined(cookies[name])&&$browser.cookies(name,undefined);for(name in cookies)value=cookies[name],angular.isString(value)||(value=""+value,cookies[name]=value),value!==lastCookies[name]&&($browser.cookies(name,value),updated=!0);if(updated){updated=!1,browserCookies=$browser.cookies();for(name in cookies)cookies[name]!==browserCookies[name]&&(isUndefined(browserCookies[name])?delete cookies[name]:cookies[name]=browserCookies[name],updated=!0)}}var lastBrowserCookies,cookies={},lastCookies={},runEval=!1,copy=angular.copy,isUndefined=angular.isUndefined;return $browser.addPollFn(function(){var currentCookies=$browser.cookies();lastBrowserCookies!=currentCookies&&(lastBrowserCookies=currentCookies,copy(currentCookies,lastCookies),copy(currentCookies,cookies),runEval&&$rootScope.$apply())})(),runEval=!0,$rootScope.$watch(push),cookies}]).factory("$cookieStore",["$cookies",function($cookies){return{get:function(key){var value=$cookies[key];return value?angular.fromJson(value):value},put:function(key,value){$cookies[key]=angular.toJson(value)},remove:function(key){delete $cookies[key]}}}])}(window,window.angular),function(){"use strict";var angularLocalStorage=angular.module("LocalStorageModule",[]);angularLocalStorage.provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(prefix){this.prefix=prefix},this.setStorageType=function(storageType){this.storageType=storageType},this.setStorageCookie=function(exp,path){this.cookie={expiry:exp,path:path}},this.setStorageCookieDomain=function(domain){this.cookie.domain=domain},this.setNotify=function(itemSet,itemRemove){this.notify={setItem:itemSet,removeItem:itemRemove}},this.$get=["$rootScope","$window","$document",function($rootScope,$window,$document){var webStorage,self=this,prefix=self.prefix,cookie=self.cookie,notify=self.notify,storageType=self.storageType;$document?$document[0]&&($document=$document[0]):$document=document,"."!==prefix.substr(-1)&&(prefix=prefix?prefix+".":"");var deriveQualifiedKey=function(key){return prefix+key},browserSupportsLocalStorage=function(){try{var supported=storageType in $window&&null!==$window[storageType],key=deriveQualifiedKey("__"+Math.round(1e7*Math.random()));return supported&&(webStorage=$window[storageType],webStorage.setItem(key,""),webStorage.removeItem(key)),supported}catch(e){return storageType="cookie",$rootScope.$broadcast("LocalStorageModule.notification.error",e.message),!1}}(),addToLocalStorage=function(key,value){if(!browserSupportsLocalStorage||"cookie"===self.storageType)return $rootScope.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),notify.setItem&&$rootScope.$broadcast("LocalStorageModule.notification.setitem",{key:key,newvalue:value,storageType:"cookie"}),addToCookies(key,value);"undefined"==typeof value&&(value=null);try{(angular.isObject(value)||angular.isArray(value))&&(value=angular.toJson(value)),webStorage&&webStorage.setItem(deriveQualifiedKey(key),value),notify.setItem&&$rootScope.$broadcast("LocalStorageModule.notification.setitem",{key:key,newvalue:value,storageType:self.storageType})}catch(e){return $rootScope.$broadcast("LocalStorageModule.notification.error",e.message),addToCookies(key,value)}return!0},getFromLocalStorage=function(key){if(!browserSupportsLocalStorage||"cookie"===self.storageType)return $rootScope.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),getFromCookies(key);var item=webStorage?webStorage.getItem(deriveQualifiedKey(key)):null;return item&&"null"!==item?"{"===item.charAt(0)||"["===item.charAt(0)?angular.fromJson(item):item:null},removeFromLocalStorage=function(key){if(!browserSupportsLocalStorage)return $rootScope.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),notify.removeItem&&$rootScope.$broadcast("LocalStorageModule.notification.removeitem",{key:key,storageType:"cookie"}),removeFromCookies(key);try{webStorage.removeItem(deriveQualifiedKey(key)),notify.removeItem&&$rootScope.$broadcast("LocalStorageModule.notification.removeitem",{key:key,storageType:self.storageType})}catch(e){return $rootScope.$broadcast("LocalStorageModule.notification.error",e.message),removeFromCookies(key)}return!0},getKeysForLocalStorage=function(){if(!browserSupportsLocalStorage)return $rootScope.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var prefixLength=prefix.length,keys=[];for(var key in webStorage)if(key.substr(0,prefixLength)===prefix)try{keys.push(key.substr(prefixLength))}catch(e){return $rootScope.$broadcast("LocalStorageModule.notification.error",e.Description),[]}return keys},clearAllFromLocalStorage=function(regularExpression){regularExpression=regularExpression||"";var tempPrefix=prefix.slice(0,-1),testRegex=new RegExp(tempPrefix+"."+regularExpression);if(!browserSupportsLocalStorage)return $rootScope.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),clearAllFromCookies();var prefixLength=prefix.length;for(var key in webStorage)if(testRegex.test(key))try{removeFromLocalStorage(key.substr(prefixLength))}catch(e){return $rootScope.$broadcast("LocalStorageModule.notification.error",e.message),clearAllFromCookies()}return!0},browserSupportsCookies=function(){try{return navigator.cookieEnabled||"cookie"in $document&&($document.cookie.length>0||($document.cookie="test").indexOf.call($document.cookie,"test")>-1)}catch(e){return $rootScope.$broadcast("LocalStorageModule.notification.error",e.message),!1}},addToCookies=function(key,value){if("undefined"==typeof value)return!1;if(!browserSupportsCookies())return $rootScope.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var expiry="",expiryDate=new Date,cookieDomain="";if(null===value?(expiryDate.setTime(expiryDate.getTime()+-864e5),expiry="; expires="+expiryDate.toGMTString(),value=""):0!==cookie.expiry&&(expiryDate.setTime(expiryDate.getTime()+24*cookie.expiry*60*60*1e3),expiry="; expires="+expiryDate.toGMTString()),key){var cookiePath="; path="+cookie.path;cookie.domain&&(cookieDomain="; domain="+cookie.domain),$document.cookie=deriveQualifiedKey(key)+"="+encodeURIComponent(value)+expiry+cookiePath+cookieDomain}}catch(e){return $rootScope.$broadcast("LocalStorageModule.notification.error",e.message),!1}return!0},getFromCookies=function(key){if(!browserSupportsCookies())return $rootScope.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var cookies=$document.cookie&&$document.cookie.split(";")||[],i=0;i<cookies.length;i++){for(var thisCookie=cookies[i];" "===thisCookie.charAt(0);)thisCookie=thisCookie.substring(1,thisCookie.length);if(0===thisCookie.indexOf(deriveQualifiedKey(key)+"="))return decodeURIComponent(thisCookie.substring(prefix.length+key.length+1,thisCookie.length))}return null},removeFromCookies=function(key){addToCookies(key,null)},clearAllFromCookies=function(){for(var thisCookie=null,prefixLength=prefix.length,cookies=$document.cookie.split(";"),i=0;i<cookies.length;i++){for(thisCookie=cookies[i];" "===thisCookie.charAt(0);)thisCookie=thisCookie.substring(1,thisCookie.length);var key=thisCookie.substring(prefixLength,thisCookie.indexOf("="));removeFromCookies(key)}},getStorageType=function(){return storageType},bindToScope=function(scope,key,def){var value=getFromLocalStorage(key);null===value&&angular.isDefined(def)?value=def:angular.isObject(value)&&angular.isObject(def)&&(value=angular.extend(def,value)),scope[key]=value,scope.$watchCollection(key,function(newVal){addToLocalStorage(key,newVal)})};return{isSupported:browserSupportsLocalStorage,getStorageType:getStorageType,set:addToLocalStorage,add:addToLocalStorage,get:getFromLocalStorage,keys:getKeysForLocalStorage,remove:removeFromLocalStorage,clearAll:clearAllFromLocalStorage,bind:bindToScope,deriveKey:deriveQualifiedKey,cookie:{set:addToCookies,add:addToCookies,get:getFromCookies,remove:removeFromCookies,clearAll:clearAllFromCookies}}}]})}.call(this),function(window,angular,undefined){"use strict";function isValidDottedPath(path){return null!=path&&""!==path&&"hasOwnProperty"!==path&&MEMBER_NAME_REGEX.test("."+path)}function lookupDottedPath(obj,path){if(!isValidDottedPath(path))throw $resourceMinErr("badmember",'Dotted member path "@{0}" is invalid.',path);for(var keys=path.split("."),i=0,ii=keys.length;ii>i&&obj!==undefined;i++){var key=keys[i];obj=null!==obj?obj[key]:undefined}return obj}function shallowClearAndCopy(src,dst){dst=dst||{},angular.forEach(dst,function(value,key){delete dst[key]});for(var key in src)!src.hasOwnProperty(key)||"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key]);return dst}var $resourceMinErr=angular.$$minErr("$resource"),MEMBER_NAME_REGEX=/^(\.[a-zA-Z_$][0-9a-zA-Z_$]*)+$/;angular.module("ngResource",["ng"]).factory("$resource",["$http","$q",function($http,$q){function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function Route(template,defaults){this.template=template,this.defaults=defaults||{},this.urlParams={}}function resourceFactory(url,paramDefaults,actions){function extractParams(data,actionParams){var ids={};return actionParams=extend({},paramDefaults,actionParams),forEach(actionParams,function(value,key){isFunction(value)&&(value=value()),ids[key]=value&&value.charAt&&"@"==value.charAt(0)?lookupDottedPath(data,value.substr(1)):value}),ids}function defaultResponseInterceptor(response){return response.resource}function Resource(value){shallowClearAndCopy(value||{},this)}var route=new Route(url);return actions=extend({},DEFAULT_ACTIONS,actions),forEach(actions,function(action,name){var hasBody=/^(POST|PUT|PATCH)$/i.test(action.method);Resource[name]=function(a1,a2,a3,a4){var data,success,error,params={};switch(arguments.length){case 4:error=a4,success=a3;case 3:case 2:if(!isFunction(a2)){params=a1,data=a2,success=a3;break}if(isFunction(a1)){success=a1,error=a2;break}success=a2,error=a3;case 1:isFunction(a1)?success=a1:hasBody?data=a1:params=a1;break;case 0:break;default:throw $resourceMinErr("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var isInstanceCall=this instanceof Resource,value=isInstanceCall?data:action.isArray?[]:new Resource(data),httpConfig={},responseInterceptor=action.interceptor&&action.interceptor.response||defaultResponseInterceptor,responseErrorInterceptor=action.interceptor&&action.interceptor.responseError||undefined;forEach(action,function(value,key){"params"!=key&&"isArray"!=key&&"interceptor"!=key&&(httpConfig[key]=copy(value))}),hasBody&&(httpConfig.data=data),route.setUrlParams(httpConfig,extend({},extractParams(data,action.params||{}),params),action.url);var promise=$http(httpConfig).then(function(response){var data=response.data,promise=value.$promise;if(data){if(angular.isArray(data)!==!!action.isArray)throw $resourceMinErr("badcfg","Error in resource configuration. Expected response to contain an {0} but got an {1}",action.isArray?"array":"object",angular.isArray(data)?"array":"object");action.isArray?(value.length=0,forEach(data,function(item){value.push("object"==typeof item?new Resource(item):item)})):(shallowClearAndCopy(data,value),value.$promise=promise)}return value.$resolved=!0,response.resource=value,response},function(response){return value.$resolved=!0,(error||noop)(response),$q.reject(response)});return promise=promise.then(function(response){var value=responseInterceptor(response);return(success||noop)(value,response.headers),value},responseErrorInterceptor),isInstanceCall?promise:(value.$promise=promise,value.$resolved=!1,value)},Resource.prototype["$"+name]=function(params,success,error){isFunction(params)&&(error=success,success=params,params={});var result=Resource[name].call(this,params,this,success,error);return result.$promise||result}}),Resource.bind=function(additionalParamDefaults){return resourceFactory(url,extend({},paramDefaults,additionalParamDefaults),actions)},Resource}var DEFAULT_ACTIONS={get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}},noop=angular.noop,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,isFunction=angular.isFunction;return Route.prototype={setUrlParams:function(config,params,actionUrl){var val,encodedVal,self=this,url=actionUrl||self.template,urlParams=self.urlParams={};forEach(url.split(/\W/),function(param){if("hasOwnProperty"===param)throw $resourceMinErr("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(param)&&param&&new RegExp("(^|[^\\\\]):"+param+"(\\W|$)").test(url)&&(urlParams[param]=!0)}),url=url.replace(/\\:/g,":"),params=params||{},forEach(self.urlParams,function(_,urlParam){val=params.hasOwnProperty(urlParam)?params[urlParam]:self.defaults[urlParam],angular.isDefined(val)&&null!==val?(encodedVal=encodeUriSegment(val),url=url.replace(new RegExp(":"+urlParam+"(\\W|$)","g"),function(match,p1){return encodedVal+p1})):url=url.replace(new RegExp("(/?):"+urlParam+"(\\W|$)","g"),function(match,leadingSlashes,tail){return"/"==tail.charAt(0)?tail:leadingSlashes+tail})}),url=url.replace(/\/+$/,"")||"/",url=url.replace(/\/\.(?=\w+($|\?))/,"."),config.url=url.replace(/\/\\\./,"/."),forEach(params,function(value,key){self.urlParams[key]||(config.params=config.params||{},config.params[key]=value)})}},resourceFactory}])}(window,window.angular),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function($q,$timeout,$rootScope){function findEndEventName(endEventNames){for(var name in endEventNames)if(void 0!==transElement.style[name])return endEventNames[name]}var $transition=function(element,trigger,options){options=options||{};var deferred=$q.defer(),endEventName=$transition[options.animation?"animationEndEventName":"transitionEndEventName"],transitionEndHandler=function(){$rootScope.$apply(function(){element.unbind(endEventName,transitionEndHandler),deferred.resolve(element)})};return endEventName&&element.bind(endEventName,transitionEndHandler),$timeout(function(){angular.isString(trigger)?element.addClass(trigger):angular.isFunction(trigger)?trigger(element):angular.isObject(trigger)&&element.css(trigger),endEventName||deferred.resolve(element)}),deferred.promise.cancel=function(){endEventName&&element.unbind(endEventName,transitionEndHandler),deferred.reject("Transition cancelled")},deferred.promise},transElement=document.createElement("trans"),transitionEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},animationEndEventNames={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return $transition.transitionEndEventName=findEndEventName(transitionEndEventNames),$transition.animationEndEventName=findEndEventName(animationEndEventNames),$transition}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function($transition){return{link:function(scope,element,attrs){function doTransition(change){function newTransitionDone(){currentTransition===newTransition&&(currentTransition=void 0)}var newTransition=$transition(element,change);return currentTransition&&currentTransition.cancel(),currentTransition=newTransition,newTransition.then(newTransitionDone,newTransitionDone),newTransition}function expand(){initialAnimSkip?(initialAnimSkip=!1,expandDone()):(element.removeClass("collapse").addClass("collapsing"),doTransition({height:element[0].scrollHeight+"px"}).then(expandDone))}function expandDone(){element.removeClass("collapsing"),element.addClass("collapse in"),element.css({height:"auto"})}function collapse(){if(initialAnimSkip)initialAnimSkip=!1,collapseDone(),element.css({height:0});else{element.css({height:element[0].scrollHeight+"px"});{element[0].offsetWidth}element.removeClass("collapse in").addClass("collapsing"),doTransition({height:0}).then(collapseDone)}}function collapseDone(){element.removeClass("collapsing"),element.addClass("collapse")}var currentTransition,initialAnimSkip=!0;scope.$watch(attrs.collapse,function(shouldCollapse){shouldCollapse?collapse():expand()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function($scope,$attrs,accordionConfig){this.groups=[],this.closeOthers=function(openGroup){var closeOthers=angular.isDefined($attrs.closeOthers)?$scope.$eval($attrs.closeOthers):accordionConfig.closeOthers;closeOthers&&angular.forEach(this.groups,function(group){group!==openGroup&&(group.isOpen=!1)})},this.addGroup=function(groupScope){var that=this;this.groups.push(groupScope),groupScope.$on("$destroy",function(){that.removeGroup(groupScope)})},this.removeGroup=function(group){var index=this.groups.indexOf(group);-1!==index&&this.groups.splice(index,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(element){this.heading=element}},link:function(scope,element,attrs,accordionCtrl){accordionCtrl.addGroup(scope),scope.$watch("isOpen",function(value){value&&accordionCtrl.closeOthers(scope)}),scope.toggleOpen=function(){scope.isDisabled||(scope.isOpen=!scope.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(scope,element,attr,accordionGroupCtrl,transclude){accordionGroupCtrl.setHeading(transclude(scope,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(scope,element,attr,controller){scope.$watch(function(){return controller[attr.accordionTransclude]},function(heading){heading&&(element.html(""),element.append(heading))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function($scope,$attrs){$scope.closeable="close"in $attrs,this.close=$scope.close}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}).directive("dismissOnTimeout",["$timeout",function($timeout){return{require:"alert",link:function(scope,element,attrs,alertCtrl){$timeout(function(){alertCtrl.close()},parseInt(attrs.dismissOnTimeout,10))}}}]),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.bindHtmlUnsafe),scope.$watch(attr.bindHtmlUnsafe,function(value){element.html(value||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(buttonConfig){this.activeClass=buttonConfig.activeClass||"active",this.toggleEvent=buttonConfig.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(scope,element,attrs,ctrls){var buttonsCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl.$render=function(){element.toggleClass(buttonsCtrl.activeClass,angular.equals(ngModelCtrl.$modelValue,scope.$eval(attrs.btnRadio)))},element.bind(buttonsCtrl.toggleEvent,function(){var isActive=element.hasClass(buttonsCtrl.activeClass);(!isActive||angular.isDefined(attrs.uncheckable))&&scope.$apply(function(){ngModelCtrl.$setViewValue(isActive?null:scope.$eval(attrs.btnRadio)),ngModelCtrl.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(scope,element,attrs,ctrls){function getTrueValue(){return getCheckboxValue(attrs.btnCheckboxTrue,!0)}function getFalseValue(){return getCheckboxValue(attrs.btnCheckboxFalse,!1)}function getCheckboxValue(attributeValue,defaultValue){var val=scope.$eval(attributeValue);return angular.isDefined(val)?val:defaultValue}var buttonsCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl.$render=function(){element.toggleClass(buttonsCtrl.activeClass,angular.equals(ngModelCtrl.$modelValue,getTrueValue()))},element.bind(buttonsCtrl.toggleEvent,function(){scope.$apply(function(){ngModelCtrl.$setViewValue(element.hasClass(buttonsCtrl.activeClass)?getFalseValue():getTrueValue()),ngModelCtrl.$render()})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$interval","$transition",function($scope,$timeout,$interval,$transition){function restartTimer(){resetTimer();var interval=+$scope.interval;!isNaN(interval)&&interval>0&&(currentInterval=$interval(timerFn,interval))}function resetTimer(){currentInterval&&($interval.cancel(currentInterval),currentInterval=null)}function timerFn(){var interval=+$scope.interval;isPlaying&&!isNaN(interval)&&interval>0?$scope.next():$scope.pause()
}var currentInterval,isPlaying,self=this,slides=self.slides=$scope.slides=[],currentIndex=-1;self.currentSlide=null;var destroyed=!1;self.select=$scope.select=function(nextSlide,direction){function goNext(){if(!destroyed){if(self.currentSlide&&angular.isString(direction)&&!$scope.noTransition&&nextSlide.$element){nextSlide.$element.addClass(direction);{nextSlide.$element[0].offsetWidth}angular.forEach(slides,function(slide){angular.extend(slide,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(nextSlide,{direction:direction,active:!0,entering:!0}),angular.extend(self.currentSlide||{},{direction:direction,leaving:!0}),$scope.$currentTransition=$transition(nextSlide.$element,{}),function(next,current){$scope.$currentTransition.then(function(){transitionDone(next,current)},function(){transitionDone(next,current)})}(nextSlide,self.currentSlide)}else transitionDone(nextSlide,self.currentSlide);self.currentSlide=nextSlide,currentIndex=nextIndex,restartTimer()}}function transitionDone(next,current){angular.extend(next,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(current||{},{direction:"",active:!1,leaving:!1,entering:!1}),$scope.$currentTransition=null}var nextIndex=slides.indexOf(nextSlide);void 0===direction&&(direction=nextIndex>currentIndex?"next":"prev"),nextSlide&&nextSlide!==self.currentSlide&&($scope.$currentTransition?($scope.$currentTransition.cancel(),$timeout(goNext)):goNext())},$scope.$on("$destroy",function(){destroyed=!0}),self.indexOfSlide=function(slide){return slides.indexOf(slide)},$scope.next=function(){var newIndex=(currentIndex+1)%slides.length;return $scope.$currentTransition?void 0:self.select(slides[newIndex],"next")},$scope.prev=function(){var newIndex=0>currentIndex-1?slides.length-1:currentIndex-1;return $scope.$currentTransition?void 0:self.select(slides[newIndex],"prev")},$scope.isActive=function(slide){return self.currentSlide===slide},$scope.$watch("interval",restartTimer),$scope.$on("$destroy",resetTimer),$scope.play=function(){isPlaying||(isPlaying=!0,restartTimer())},$scope.pause=function(){$scope.noPause||(isPlaying=!1,resetTimer())},self.addSlide=function(slide,element){slide.$element=element,slides.push(slide),1===slides.length||slide.active?(self.select(slides[slides.length-1]),1==slides.length&&$scope.play()):slide.active=!1},self.removeSlide=function(slide){var index=slides.indexOf(slide);slides.splice(index,1),slides.length>0&&slide.active?self.select(index>=slides.length?slides[index-1]:slides[index]):currentIndex>index&&currentIndex--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(scope,element,attrs,carouselCtrl){carouselCtrl.addSlide(scope,element),scope.$on("$destroy",function(){carouselCtrl.removeSlide(scope)}),scope.$watch("active",function(active){active&&carouselCtrl.select(scope)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function($locale,orderByFilter){function createParser(format){var map=[],regex=format.split("");return angular.forEach(formatCodeToRegex,function(data,code){var index=format.indexOf(code);if(index>-1){format=format.split(""),regex[index]="("+data.regex+")",format[index]="$";for(var i=index+1,n=index+code.length;n>i;i++)regex[i]="",format[i]="$";format=format.join(""),map.push({index:index,apply:data.apply})}}),{regex:new RegExp("^"+regex.join("")+"$"),map:orderByFilter(map,"index")}}function isValid(year,month,date){return 1===month&&date>28?29===date&&(year%4===0&&year%100!==0||year%400===0):3===month||5===month||8===month||10===month?31>date:!0}this.parsers={};var formatCodeToRegex={yyyy:{regex:"\\d{4}",apply:function(value){this.year=+value}},yy:{regex:"\\d{2}",apply:function(value){this.year=+value+2e3}},y:{regex:"\\d{1,4}",apply:function(value){this.year=+value}},MMMM:{regex:$locale.DATETIME_FORMATS.MONTH.join("|"),apply:function(value){this.month=$locale.DATETIME_FORMATS.MONTH.indexOf(value)}},MMM:{regex:$locale.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(value){this.month=$locale.DATETIME_FORMATS.SHORTMONTH.indexOf(value)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(value){this.month=value-1}},M:{regex:"[1-9]|1[0-2]",apply:function(value){this.month=value-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(value){this.date=+value}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(value){this.date=+value}},EEEE:{regex:$locale.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:$locale.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(input,format){if(!angular.isString(input)||!format)return input;format=$locale.DATETIME_FORMATS[format]||format,this.parsers[format]||(this.parsers[format]=createParser(format));var parser=this.parsers[format],regex=parser.regex,map=parser.map,results=input.match(regex);if(results&&results.length){for(var dt,fields={year:1900,month:0,date:1,hours:0},i=1,n=results.length;n>i;i++){var mapper=map[i-1];mapper.apply&&mapper.apply.call(fields,results[i])}return isValid(fields.year,fields.month,fields.date)&&(dt=new Date(fields.year,fields.month,fields.date,fields.hours)),dt}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function($document,$window){function getStyle(el,cssprop){return el.currentStyle?el.currentStyle[cssprop]:$window.getComputedStyle?$window.getComputedStyle(el)[cssprop]:el.style[cssprop]}function isStaticPositioned(element){return"static"===(getStyle(element,"position")||"static")}var parentOffsetEl=function(element){for(var docDomEl=$document[0],offsetParent=element.offsetParent||docDomEl;offsetParent&&offsetParent!==docDomEl&&isStaticPositioned(offsetParent);)offsetParent=offsetParent.offsetParent;return offsetParent||docDomEl};return{position:function(element){var elBCR=this.offset(element),offsetParentBCR={top:0,left:0},offsetParentEl=parentOffsetEl(element[0]);offsetParentEl!=$document[0]&&(offsetParentBCR=this.offset(angular.element(offsetParentEl)),offsetParentBCR.top+=offsetParentEl.clientTop-offsetParentEl.scrollTop,offsetParentBCR.left+=offsetParentEl.clientLeft-offsetParentEl.scrollLeft);var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:elBCR.top-offsetParentBCR.top,left:elBCR.left-offsetParentBCR.left}},offset:function(element){var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||$document[0].documentElement.scrollTop),left:boundingClientRect.left+($window.pageXOffset||$document[0].documentElement.scrollLeft)}},positionElements:function(hostEl,targetEl,positionStr,appendToBody){var hostElPos,targetElWidth,targetElHeight,targetElPos,positionStrParts=positionStr.split("-"),pos0=positionStrParts[0],pos1=positionStrParts[1]||"center";hostElPos=appendToBody?this.offset(hostEl):this.position(hostEl),targetElWidth=targetEl.prop("offsetWidth"),targetElHeight=targetEl.prop("offsetHeight");var shiftWidth={center:function(){return hostElPos.left+hostElPos.width/2-targetElWidth/2},left:function(){return hostElPos.left},right:function(){return hostElPos.left+hostElPos.width}},shiftHeight={center:function(){return hostElPos.top+hostElPos.height/2-targetElHeight/2},top:function(){return hostElPos.top},bottom:function(){return hostElPos.top+hostElPos.height}};switch(pos0){case"right":targetElPos={top:shiftHeight[pos1](),left:shiftWidth[pos0]()};break;case"left":targetElPos={top:shiftHeight[pos1](),left:hostElPos.left-targetElWidth};break;case"bottom":targetElPos={top:shiftHeight[pos0](),left:shiftWidth[pos1]()};break;default:targetElPos={top:hostElPos.top-targetElHeight,left:shiftWidth[pos1]()}}return targetElPos}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function($scope,$attrs,$parse,$interpolate,$timeout,$log,dateFilter,datepickerConfig){var self=this,ngModelCtrl={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(key,index){self[key]=angular.isDefined($attrs[key])?8>index?$interpolate($attrs[key])($scope.$parent):$scope.$parent.$eval($attrs[key]):datepickerConfig[key]}),angular.forEach(["minDate","maxDate"],function(key){$attrs[key]?$scope.$parent.$watch($parse($attrs[key]),function(value){self[key]=value?new Date(value):null,self.refreshView()}):self[key]=datepickerConfig[key]?new Date(datepickerConfig[key]):null}),$scope.datepickerMode=$scope.datepickerMode||datepickerConfig.datepickerMode,$scope.uniqueId="datepicker-"+$scope.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined($attrs.initDate)?$scope.$parent.$eval($attrs.initDate):new Date,$scope.isActive=function(dateObject){return 0===self.compare(dateObject.date,self.activeDate)?($scope.activeDateId=dateObject.uid,!0):!1},this.init=function(ngModelCtrl_){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=function(){self.render()}},this.render=function(){if(ngModelCtrl.$modelValue){var date=new Date(ngModelCtrl.$modelValue),isValid=!isNaN(date);isValid?this.activeDate=date:$log.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),ngModelCtrl.$setValidity("date",isValid)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var date=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;ngModelCtrl.$setValidity("date-disabled",!date||this.element&&!this.isDisabled(date))}},this.createDateObject=function(date,format){var model=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;return{date:date,label:dateFilter(date,format),selected:model&&0===this.compare(date,model),disabled:this.isDisabled(date),current:0===this.compare(date,new Date)}},this.isDisabled=function(date){return this.minDate&&this.compare(date,this.minDate)<0||this.maxDate&&this.compare(date,this.maxDate)>0||$attrs.dateDisabled&&$scope.dateDisabled({date:date,mode:$scope.datepickerMode})},this.split=function(arr,size){for(var arrays=[];arr.length>0;)arrays.push(arr.splice(0,size));return arrays},$scope.select=function(date){if($scope.datepickerMode===self.minMode){var dt=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):new Date(0,0,0,0,0,0,0);dt.setFullYear(date.getFullYear(),date.getMonth(),date.getDate()),ngModelCtrl.$setViewValue(dt),ngModelCtrl.$render()}else self.activeDate=date,$scope.datepickerMode=self.modes[self.modes.indexOf($scope.datepickerMode)-1]},$scope.move=function(direction){var year=self.activeDate.getFullYear()+direction*(self.step.years||0),month=self.activeDate.getMonth()+direction*(self.step.months||0);self.activeDate.setFullYear(year,month,1),self.refreshView()},$scope.toggleMode=function(direction){direction=direction||1,$scope.datepickerMode===self.maxMode&&1===direction||$scope.datepickerMode===self.minMode&&-1===direction||($scope.datepickerMode=self.modes[self.modes.indexOf($scope.datepickerMode)+direction])},$scope.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var focusElement=function(){$timeout(function(){self.element[0].focus()},0,!1)};$scope.$on("datepicker.focus",focusElement),$scope.keydown=function(evt){var key=$scope.keys[evt.which];if(key&&!evt.shiftKey&&!evt.altKey)if(evt.preventDefault(),evt.stopPropagation(),"enter"===key||"space"===key){if(self.isDisabled(self.activeDate))return;$scope.select(self.activeDate),focusElement()}else!evt.ctrlKey||"up"!==key&&"down"!==key?(self.handleKeyDown(key,evt),self.refreshView()):($scope.toggleMode("up"===key?1:-1),focusElement())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(scope,element,attrs,ctrls){var datepickerCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&datepickerCtrl.init(ngModelCtrl)}}}).directive("daypicker",["dateFilter",function(dateFilter){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){function getDaysInMonth(year,month){return 1!==month||year%4!==0||year%100===0&&year%400!==0?DAYS_IN_MONTH[month]:29}function getDates(startDate,n){var dates=new Array(n),current=new Date(startDate),i=0;for(current.setHours(12);n>i;)dates[i++]=new Date(current),current.setDate(current.getDate()+1);return dates}function getISO8601WeekNumber(date){var checkDate=new Date(date);checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();return checkDate.setMonth(0),checkDate.setDate(1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1}scope.showWeeks=ctrl.showWeeks,ctrl.step={months:1},ctrl.element=element;var DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31];ctrl._refreshView=function(){var year=ctrl.activeDate.getFullYear(),month=ctrl.activeDate.getMonth(),firstDayOfMonth=new Date(year,month,1),difference=ctrl.startingDay-firstDayOfMonth.getDay(),numDisplayedFromPreviousMonth=difference>0?7-difference:-difference,firstDate=new Date(firstDayOfMonth);numDisplayedFromPreviousMonth>0&&firstDate.setDate(-numDisplayedFromPreviousMonth+1);for(var days=getDates(firstDate,42),i=0;42>i;i++)days[i]=angular.extend(ctrl.createDateObject(days[i],ctrl.formatDay),{secondary:days[i].getMonth()!==month,uid:scope.uniqueId+"-"+i});scope.labels=new Array(7);for(var j=0;7>j;j++)scope.labels[j]={abbr:dateFilter(days[j].date,ctrl.formatDayHeader),full:dateFilter(days[j].date,"EEEE")};if(scope.title=dateFilter(ctrl.activeDate,ctrl.formatDayTitle),scope.rows=ctrl.split(days,7),scope.showWeeks){scope.weekNumbers=[];for(var weekNumber=getISO8601WeekNumber(scope.rows[0][0].date),numWeeks=scope.rows.length;scope.weekNumbers.push(weekNumber++)<numWeeks;);}},ctrl.compare=function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth(),date1.getDate())-new Date(date2.getFullYear(),date2.getMonth(),date2.getDate())},ctrl.handleKeyDown=function(key){var date=ctrl.activeDate.getDate();if("left"===key)date-=1;else if("up"===key)date-=7;else if("right"===key)date+=1;else if("down"===key)date+=7;else if("pageup"===key||"pagedown"===key){var month=ctrl.activeDate.getMonth()+("pageup"===key?-1:1);ctrl.activeDate.setMonth(month,1),date=Math.min(getDaysInMonth(ctrl.activeDate.getFullYear(),ctrl.activeDate.getMonth()),date)}else"home"===key?date=1:"end"===key&&(date=getDaysInMonth(ctrl.activeDate.getFullYear(),ctrl.activeDate.getMonth()));ctrl.activeDate.setDate(date)},ctrl.refreshView()}}}]).directive("monthpicker",["dateFilter",function(dateFilter){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){ctrl.step={years:1},ctrl.element=element,ctrl._refreshView=function(){for(var months=new Array(12),year=ctrl.activeDate.getFullYear(),i=0;12>i;i++)months[i]=angular.extend(ctrl.createDateObject(new Date(year,i,1),ctrl.formatMonth),{uid:scope.uniqueId+"-"+i});scope.title=dateFilter(ctrl.activeDate,ctrl.formatMonthTitle),scope.rows=ctrl.split(months,3)},ctrl.compare=function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth())-new Date(date2.getFullYear(),date2.getMonth())},ctrl.handleKeyDown=function(key){var date=ctrl.activeDate.getMonth();if("left"===key)date-=1;else if("up"===key)date-=3;else if("right"===key)date+=1;else if("down"===key)date+=3;else if("pageup"===key||"pagedown"===key){var year=ctrl.activeDate.getFullYear()+("pageup"===key?-1:1);ctrl.activeDate.setFullYear(year)}else"home"===key?date=0:"end"===key&&(date=11);ctrl.activeDate.setMonth(date)},ctrl.refreshView()}}}]).directive("yearpicker",["dateFilter",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){function getStartingYear(year){return parseInt((year-1)/range,10)*range+1}var range=ctrl.yearRange;ctrl.step={years:range},ctrl.element=element,ctrl._refreshView=function(){for(var years=new Array(range),i=0,start=getStartingYear(ctrl.activeDate.getFullYear());range>i;i++)years[i]=angular.extend(ctrl.createDateObject(new Date(start+i,0,1),ctrl.formatYear),{uid:scope.uniqueId+"-"+i});scope.title=[years[0].label,years[range-1].label].join(" - "),scope.rows=ctrl.split(years,5)},ctrl.compare=function(date1,date2){return date1.getFullYear()-date2.getFullYear()},ctrl.handleKeyDown=function(key){var date=ctrl.activeDate.getFullYear();"left"===key?date-=1:"up"===key?date-=5:"right"===key?date+=1:"down"===key?date+=5:"pageup"===key||"pagedown"===key?date+=("pageup"===key?-1:1)*ctrl.step.years:"home"===key?date=getStartingYear(ctrl.activeDate.getFullYear()):"end"===key&&(date=getStartingYear(ctrl.activeDate.getFullYear())+range-1),ctrl.activeDate.setFullYear(date)},ctrl.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function($compile,$parse,$document,$position,dateFilter,dateParser,datepickerPopupConfig){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(scope,element,attrs,ngModel){function cameltoDash(string){return string.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()})}function parseDate(viewValue){if(viewValue){if(angular.isDate(viewValue)&&!isNaN(viewValue))return ngModel.$setValidity("date",!0),viewValue;if(angular.isString(viewValue)){var date=dateParser.parse(viewValue,dateFormat)||new Date(viewValue);return isNaN(date)?void ngModel.$setValidity("date",!1):(ngModel.$setValidity("date",!0),date)}return void ngModel.$setValidity("date",!1)}return ngModel.$setValidity("date",!0),null}var dateFormat,closeOnDateSelection=angular.isDefined(attrs.closeOnDateSelection)?scope.$parent.$eval(attrs.closeOnDateSelection):datepickerPopupConfig.closeOnDateSelection,appendToBody=angular.isDefined(attrs.datepickerAppendToBody)?scope.$parent.$eval(attrs.datepickerAppendToBody):datepickerPopupConfig.appendToBody;scope.showButtonBar=angular.isDefined(attrs.showButtonBar)?scope.$parent.$eval(attrs.showButtonBar):datepickerPopupConfig.showButtonBar,scope.getText=function(key){return scope[key+"Text"]||datepickerPopupConfig[key+"Text"]},attrs.$observe("datepickerPopup",function(value){dateFormat=value||datepickerPopupConfig.datepickerPopup,ngModel.$render()});var popupEl=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");popupEl.attr({"ng-model":"date","ng-change":"dateSelection()"});var datepickerEl=angular.element(popupEl.children()[0]);attrs.datepickerOptions&&angular.forEach(scope.$parent.$eval(attrs.datepickerOptions),function(value,option){datepickerEl.attr(cameltoDash(option),value)}),scope.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(key){if(attrs[key]){var getAttribute=$parse(attrs[key]);if(scope.$parent.$watch(getAttribute,function(value){scope.watchData[key]=value}),datepickerEl.attr(cameltoDash(key),"watchData."+key),"datepickerMode"===key){var setAttribute=getAttribute.assign;scope.$watch("watchData."+key,function(value,oldvalue){value!==oldvalue&&setAttribute(scope.$parent,value)})}}}),attrs.dateDisabled&&datepickerEl.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),ngModel.$parsers.unshift(parseDate),scope.dateSelection=function(dt){angular.isDefined(dt)&&(scope.date=dt),ngModel.$setViewValue(scope.date),ngModel.$render(),closeOnDateSelection&&(scope.isOpen=!1,element[0].focus())},element.bind("input change keyup",function(){scope.$apply(function(){scope.date=ngModel.$modelValue})}),ngModel.$render=function(){var date=ngModel.$viewValue?dateFilter(ngModel.$viewValue,dateFormat):"";element.val(date),scope.date=parseDate(ngModel.$modelValue)};var documentClickBind=function(event){scope.isOpen&&event.target!==element[0]&&scope.$apply(function(){scope.isOpen=!1})},keydown=function(evt){scope.keydown(evt)};element.bind("keydown",keydown),scope.keydown=function(evt){27===evt.which?(evt.preventDefault(),evt.stopPropagation(),scope.close()):40!==evt.which||scope.isOpen||(scope.isOpen=!0)},scope.$watch("isOpen",function(value){value?(scope.$broadcast("datepicker.focus"),scope.position=appendToBody?$position.offset(element):$position.position(element),scope.position.top=scope.position.top+element.prop("offsetHeight"),$document.bind("click",documentClickBind)):$document.unbind("click",documentClickBind)}),scope.select=function(date){if("today"===date){var today=new Date;angular.isDate(ngModel.$modelValue)?(date=new Date(ngModel.$modelValue),date.setFullYear(today.getFullYear(),today.getMonth(),today.getDate())):date=new Date(today.setHours(0,0,0,0))}scope.dateSelection(date)},scope.close=function(){scope.isOpen=!1,element[0].focus()};var $popup=$compile(popupEl)(scope);popupEl.remove(),appendToBody?$document.find("body").append($popup):element.after($popup),scope.$on("$destroy",function(){$popup.remove(),element.unbind("keydown",keydown),$document.unbind("click",documentClickBind)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(scope,element){element.bind("click",function(event){event.preventDefault(),event.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function($document){var openScope=null;this.open=function(dropdownScope){openScope||($document.bind("click",closeDropdown),$document.bind("keydown",escapeKeyBind)),openScope&&openScope!==dropdownScope&&(openScope.isOpen=!1),openScope=dropdownScope},this.close=function(dropdownScope){openScope===dropdownScope&&(openScope=null,$document.unbind("click",closeDropdown),$document.unbind("keydown",escapeKeyBind))};var closeDropdown=function(evt){if(openScope){var toggleElement=openScope.getToggleElement();evt&&toggleElement&&toggleElement[0].contains(evt.target)||openScope.$apply(function(){openScope.isOpen=!1})}},escapeKeyBind=function(evt){27===evt.which&&(openScope.focusToggleElement(),closeDropdown())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function($scope,$attrs,$parse,dropdownConfig,dropdownService,$animate){var getIsOpen,self=this,scope=$scope.$new(),openClass=dropdownConfig.openClass,setIsOpen=angular.noop,toggleInvoker=$attrs.onToggle?$parse($attrs.onToggle):angular.noop;this.init=function(element){self.$element=element,$attrs.isOpen&&(getIsOpen=$parse($attrs.isOpen),setIsOpen=getIsOpen.assign,$scope.$watch(getIsOpen,function(value){scope.isOpen=!!value}))},this.toggle=function(open){return scope.isOpen=arguments.length?!!open:!scope.isOpen},this.isOpen=function(){return scope.isOpen},scope.getToggleElement=function(){return self.toggleElement},scope.focusToggleElement=function(){self.toggleElement&&self.toggleElement[0].focus()},scope.$watch("isOpen",function(isOpen,wasOpen){$animate[isOpen?"addClass":"removeClass"](self.$element,openClass),isOpen?(scope.focusToggleElement(),dropdownService.open(scope)):dropdownService.close(scope),setIsOpen($scope,isOpen),angular.isDefined(isOpen)&&isOpen!==wasOpen&&toggleInvoker($scope,{open:!!isOpen})}),$scope.$on("$locationChangeSuccess",function(){scope.isOpen=!1}),$scope.$on("$destroy",function(){scope.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(scope,element,attrs,dropdownCtrl){dropdownCtrl.init(element)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(scope,element,attrs,dropdownCtrl){if(dropdownCtrl){dropdownCtrl.toggleElement=element;var toggleDropdown=function(event){event.preventDefault(),element.hasClass("disabled")||attrs.disabled||scope.$apply(function(){dropdownCtrl.toggle()})};element.bind("click",toggleDropdown),element.attr({"aria-haspopup":!0,"aria-expanded":!1}),scope.$watch(dropdownCtrl.isOpen,function(isOpen){element.attr("aria-expanded",!!isOpen)}),scope.$on("$destroy",function(){element.unbind("click",toggleDropdown)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var stack=[];return{add:function(key,value){stack.push({key:key,value:value})},get:function(key){for(var i=0;i<stack.length;i++)if(key==stack[i].key)return stack[i]},keys:function(){for(var keys=[],i=0;i<stack.length;i++)keys.push(stack[i].key);return keys},top:function(){return stack[stack.length-1]},remove:function(key){for(var idx=-1,i=0;i<stack.length;i++)if(key==stack[i].key){idx=i;break}return stack.splice(idx,1)[0]},removeTop:function(){return stack.splice(stack.length-1,1)[0]},length:function(){return stack.length}}}}}).directive("modalBackdrop",["$timeout",function($timeout){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(scope,element,attrs){scope.backdropClass=attrs.backdropClass||"",scope.animate=!1,$timeout(function(){scope.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function($modalStack,$timeout){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(tElement,tAttrs){return tAttrs.templateUrl||"template/modal/window.html"},link:function(scope,element,attrs){element.addClass(attrs.windowClass||""),scope.size=attrs.size,$timeout(function(){scope.animate=!0,element[0].querySelectorAll("[autofocus]").length||element[0].focus()}),scope.close=function(evt){var modal=$modalStack.getTop();modal&&modal.value.backdrop&&"static"!=modal.value.backdrop&&evt.target===evt.currentTarget&&(evt.preventDefault(),evt.stopPropagation(),$modalStack.dismiss(modal.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function($scope,$element,$attrs,controller,$transclude){$transclude($scope.$parent,function(clone){$element.empty(),$element.append(clone)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function($transition,$timeout,$document,$compile,$rootScope,$$stackedMap){function backdropIndex(){for(var topBackdropIndex=-1,opened=openedWindows.keys(),i=0;i<opened.length;i++)openedWindows.get(opened[i]).value.backdrop&&(topBackdropIndex=i);return topBackdropIndex}function removeModalWindow(modalInstance){var body=$document.find("body").eq(0),modalWindow=openedWindows.get(modalInstance).value;openedWindows.remove(modalInstance),removeAfterAnimate(modalWindow.modalDomEl,modalWindow.modalScope,300,function(){modalWindow.modalScope.$destroy(),body.toggleClass(OPENED_MODAL_CLASS,openedWindows.length()>0),checkRemoveBackdrop()})}function checkRemoveBackdrop(){if(backdropDomEl&&-1==backdropIndex()){var backdropScopeRef=backdropScope;removeAfterAnimate(backdropDomEl,backdropScope,150,function(){backdropScopeRef.$destroy(),backdropScopeRef=null}),backdropDomEl=void 0,backdropScope=void 0}}function removeAfterAnimate(domEl,scope,emulateTime,done){function afterAnimating(){afterAnimating.done||(afterAnimating.done=!0,domEl.remove(),done&&done())}scope.animate=!1;var transitionEndEventName=$transition.transitionEndEventName;if(transitionEndEventName){var timeout=$timeout(afterAnimating,emulateTime);domEl.bind(transitionEndEventName,function(){$timeout.cancel(timeout),afterAnimating(),scope.$apply()})}else $timeout(afterAnimating)}var backdropDomEl,backdropScope,OPENED_MODAL_CLASS="modal-open",openedWindows=$$stackedMap.createNew(),$modalStack={};return $rootScope.$watch(backdropIndex,function(newBackdropIndex){backdropScope&&(backdropScope.index=newBackdropIndex)}),$document.bind("keydown",function(evt){var modal;27===evt.which&&(modal=openedWindows.top(),modal&&modal.value.keyboard&&(evt.preventDefault(),$rootScope.$apply(function(){$modalStack.dismiss(modal.key,"escape key press")})))}),$modalStack.open=function(modalInstance,modal){openedWindows.add(modalInstance,{deferred:modal.deferred,modalScope:modal.scope,backdrop:modal.backdrop,keyboard:modal.keyboard});var body=$document.find("body").eq(0),currBackdropIndex=backdropIndex();if(currBackdropIndex>=0&&!backdropDomEl){backdropScope=$rootScope.$new(!0),backdropScope.index=currBackdropIndex;var angularBackgroundDomEl=angular.element("<div modal-backdrop></div>");angularBackgroundDomEl.attr("backdrop-class",modal.backdropClass),backdropDomEl=$compile(angularBackgroundDomEl)(backdropScope),body.append(backdropDomEl)}var angularDomEl=angular.element("<div modal-window></div>");angularDomEl.attr({"template-url":modal.windowTemplateUrl,"window-class":modal.windowClass,size:modal.size,index:openedWindows.length()-1,animate:"animate"}).html(modal.content);var modalDomEl=$compile(angularDomEl)(modal.scope);openedWindows.top().value.modalDomEl=modalDomEl,body.append(modalDomEl),body.addClass(OPENED_MODAL_CLASS)},$modalStack.close=function(modalInstance,result){var modalWindow=openedWindows.get(modalInstance);modalWindow&&(modalWindow.value.deferred.resolve(result),removeModalWindow(modalInstance))},$modalStack.dismiss=function(modalInstance,reason){var modalWindow=openedWindows.get(modalInstance);modalWindow&&(modalWindow.value.deferred.reject(reason),removeModalWindow(modalInstance))},$modalStack.dismissAll=function(reason){for(var topModal=this.getTop();topModal;)this.dismiss(topModal.key,reason),topModal=this.getTop()},$modalStack.getTop=function(){return openedWindows.top()},$modalStack}]).provider("$modal",function(){var $modalProvider={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function($injector,$rootScope,$q,$http,$templateCache,$controller,$modalStack){function getTemplatePromise(options){return options.template?$q.when(options.template):$http.get(angular.isFunction(options.templateUrl)?options.templateUrl():options.templateUrl,{cache:$templateCache}).then(function(result){return result.data})}function getResolvePromises(resolves){var promisesArr=[];return angular.forEach(resolves,function(value){(angular.isFunction(value)||angular.isArray(value))&&promisesArr.push($q.when($injector.invoke(value)))}),promisesArr}var $modal={};return $modal.open=function(modalOptions){var modalResultDeferred=$q.defer(),modalOpenedDeferred=$q.defer(),modalInstance={result:modalResultDeferred.promise,opened:modalOpenedDeferred.promise,close:function(result){$modalStack.close(modalInstance,result)},dismiss:function(reason){$modalStack.dismiss(modalInstance,reason)}};if(modalOptions=angular.extend({},$modalProvider.options,modalOptions),modalOptions.resolve=modalOptions.resolve||{},!modalOptions.template&&!modalOptions.templateUrl)throw new Error("One of template or templateUrl options is required.");
var templateAndResolvePromise=$q.all([getTemplatePromise(modalOptions)].concat(getResolvePromises(modalOptions.resolve)));return templateAndResolvePromise.then(function(tplAndVars){var modalScope=(modalOptions.scope||$rootScope).$new();modalScope.$close=modalInstance.close,modalScope.$dismiss=modalInstance.dismiss;var ctrlInstance,ctrlLocals={},resolveIter=1;modalOptions.controller&&(ctrlLocals.$scope=modalScope,ctrlLocals.$modalInstance=modalInstance,angular.forEach(modalOptions.resolve,function(value,key){ctrlLocals[key]=tplAndVars[resolveIter++]}),ctrlInstance=$controller(modalOptions.controller,ctrlLocals),modalOptions.controllerAs&&(modalScope[modalOptions.controllerAs]=ctrlInstance)),$modalStack.open(modalInstance,{scope:modalScope,deferred:modalResultDeferred,content:tplAndVars[0],backdrop:modalOptions.backdrop,keyboard:modalOptions.keyboard,backdropClass:modalOptions.backdropClass,windowClass:modalOptions.windowClass,windowTemplateUrl:modalOptions.windowTemplateUrl,size:modalOptions.size})},function(reason){modalResultDeferred.reject(reason)}),templateAndResolvePromise.then(function(){modalOpenedDeferred.resolve(!0)},function(){modalOpenedDeferred.reject(!1)}),modalInstance},$modal}]};return $modalProvider}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function($scope,$attrs,$parse){var self=this,ngModelCtrl={$setViewValue:angular.noop},setNumPages=$attrs.numPages?$parse($attrs.numPages).assign:angular.noop;this.init=function(ngModelCtrl_,config){ngModelCtrl=ngModelCtrl_,this.config=config,ngModelCtrl.$render=function(){self.render()},$attrs.itemsPerPage?$scope.$parent.$watch($parse($attrs.itemsPerPage),function(value){self.itemsPerPage=parseInt(value,10),$scope.totalPages=self.calculateTotalPages()}):this.itemsPerPage=config.itemsPerPage},this.calculateTotalPages=function(){var totalPages=this.itemsPerPage<1?1:Math.ceil($scope.totalItems/this.itemsPerPage);return Math.max(totalPages||0,1)},this.render=function(){$scope.page=parseInt(ngModelCtrl.$viewValue,10)||1},$scope.selectPage=function(page){$scope.page!==page&&page>0&&page<=$scope.totalPages&&(ngModelCtrl.$setViewValue(page),ngModelCtrl.$render())},$scope.getText=function(key){return $scope[key+"Text"]||self.config[key+"Text"]},$scope.noPrevious=function(){return 1===$scope.page},$scope.noNext=function(){return $scope.page===$scope.totalPages},$scope.$watch("totalItems",function(){$scope.totalPages=self.calculateTotalPages()}),$scope.$watch("totalPages",function(value){setNumPages($scope.$parent,value),$scope.page>value?$scope.selectPage(value):ngModelCtrl.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function($parse,paginationConfig){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(scope,element,attrs,ctrls){function makePage(number,text,isActive){return{number:number,text:text,active:isActive}}function getPages(currentPage,totalPages){var pages=[],startPage=1,endPage=totalPages,isMaxSized=angular.isDefined(maxSize)&&totalPages>maxSize;isMaxSized&&(rotate?(startPage=Math.max(currentPage-Math.floor(maxSize/2),1),endPage=startPage+maxSize-1,endPage>totalPages&&(endPage=totalPages,startPage=endPage-maxSize+1)):(startPage=(Math.ceil(currentPage/maxSize)-1)*maxSize+1,endPage=Math.min(startPage+maxSize-1,totalPages)));for(var number=startPage;endPage>=number;number++){var page=makePage(number,number,number===currentPage);pages.push(page)}if(isMaxSized&&!rotate){if(startPage>1){var previousPageSet=makePage(startPage-1,"...",!1);pages.unshift(previousPageSet)}if(totalPages>endPage){var nextPageSet=makePage(endPage+1,"...",!1);pages.push(nextPageSet)}}return pages}var paginationCtrl=ctrls[0],ngModelCtrl=ctrls[1];if(ngModelCtrl){var maxSize=angular.isDefined(attrs.maxSize)?scope.$parent.$eval(attrs.maxSize):paginationConfig.maxSize,rotate=angular.isDefined(attrs.rotate)?scope.$parent.$eval(attrs.rotate):paginationConfig.rotate;scope.boundaryLinks=angular.isDefined(attrs.boundaryLinks)?scope.$parent.$eval(attrs.boundaryLinks):paginationConfig.boundaryLinks,scope.directionLinks=angular.isDefined(attrs.directionLinks)?scope.$parent.$eval(attrs.directionLinks):paginationConfig.directionLinks,paginationCtrl.init(ngModelCtrl,paginationConfig),attrs.maxSize&&scope.$parent.$watch($parse(attrs.maxSize),function(value){maxSize=parseInt(value,10),paginationCtrl.render()});var originalRender=paginationCtrl.render;paginationCtrl.render=function(){originalRender(),scope.page>0&&scope.page<=scope.totalPages&&(scope.pages=getPages(scope.page,scope.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("pager",["pagerConfig",function(pagerConfig){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(scope,element,attrs,ctrls){var paginationCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&(scope.align=angular.isDefined(attrs.align)?scope.$parent.$eval(attrs.align):pagerConfig.align,paginationCtrl.init(ngModelCtrl,pagerConfig))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function snake_case(name){var regexp=/[A-Z]/g,separator="-";return name.replace(regexp,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}var defaultOptions={placement:"top",animation:!0,popupDelay:0},triggerMap={mouseenter:"mouseleave",click:"click",focus:"blur"},globalOptions={};this.options=function(value){angular.extend(globalOptions,value)},this.setTriggers=function(triggers){angular.extend(triggerMap,triggers)},this.$get=["$window","$compile","$timeout","$document","$position","$interpolate",function($window,$compile,$timeout,$document,$position,$interpolate){return function(type,prefix,defaultTriggerShow){function getTriggers(trigger){var show=trigger||options.trigger||defaultTriggerShow,hide=triggerMap[show]||show;return{show:show,hide:hide}}var options=angular.extend({},defaultOptions,globalOptions),directiveName=snake_case(type),startSym=$interpolate.startSymbol(),endSym=$interpolate.endSymbol(),template="<div "+directiveName+'-popup title="'+startSym+"title"+endSym+'" content="'+startSym+"content"+endSym+'" placement="'+startSym+"placement"+endSym+'" animation="animation" is-open="isOpen"></div>';return{restrict:"EA",compile:function(){var tooltipLinker=$compile(template);return function(scope,element,attrs){function toggleTooltipBind(){ttScope.isOpen?hideTooltipBind():showTooltipBind()}function showTooltipBind(){(!hasEnableExp||scope.$eval(attrs[prefix+"Enable"]))&&(prepareTooltip(),ttScope.popupDelay?popupTimeout||(popupTimeout=$timeout(show,ttScope.popupDelay,!1),popupTimeout.then(function(reposition){reposition()})):show()())}function hideTooltipBind(){scope.$apply(function(){hide()})}function show(){return popupTimeout=null,transitionTimeout&&($timeout.cancel(transitionTimeout),transitionTimeout=null),ttScope.content?(createTooltip(),tooltip.css({top:0,left:0,display:"block"}),ttScope.$digest(),positionTooltip(),ttScope.isOpen=!0,ttScope.$digest(),positionTooltip):angular.noop}function hide(){ttScope.isOpen=!1,$timeout.cancel(popupTimeout),popupTimeout=null,ttScope.animation?transitionTimeout||(transitionTimeout=$timeout(removeTooltip,500)):removeTooltip()}function createTooltip(){tooltip&&removeTooltip(),tooltipLinkedScope=ttScope.$new(),tooltip=tooltipLinker(tooltipLinkedScope,function(tooltip){appendToBody?$document.find("body").append(tooltip):element.after(tooltip)})}function removeTooltip(){transitionTimeout=null,tooltip&&(tooltip.remove(),tooltip=null),tooltipLinkedScope&&(tooltipLinkedScope.$destroy(),tooltipLinkedScope=null)}function prepareTooltip(){prepPlacement(),prepPopupDelay()}function prepPlacement(){var val=attrs[prefix+"Placement"];ttScope.placement=angular.isDefined(val)?val:options.placement}function prepPopupDelay(){var val=attrs[prefix+"PopupDelay"],delay=parseInt(val,10);ttScope.popupDelay=isNaN(delay)?options.popupDelay:delay}function prepTriggers(){var val=attrs[prefix+"Trigger"];unregisterTriggers(),triggers=getTriggers(val),triggers.show===triggers.hide?element.bind(triggers.show,toggleTooltipBind):(element.bind(triggers.show,showTooltipBind),element.bind(triggers.hide,hideTooltipBind))}var tooltip,tooltipLinkedScope,transitionTimeout,popupTimeout,appendToBody=angular.isDefined(options.appendToBody)?options.appendToBody:!1,triggers=getTriggers(void 0),hasEnableExp=angular.isDefined(attrs[prefix+"Enable"]),ttScope=scope.$new(!0),positionTooltip=function(){var ttPosition=$position.positionElements(element,tooltip,ttScope.placement,appendToBody);ttPosition.top+="px",ttPosition.left+="px",tooltip.css(ttPosition)};ttScope.isOpen=!1,attrs.$observe(type,function(val){ttScope.content=val,!val&&ttScope.isOpen&&hide()}),attrs.$observe(prefix+"Title",function(val){ttScope.title=val});var unregisterTriggers=function(){element.unbind(triggers.show,showTooltipBind),element.unbind(triggers.hide,hideTooltipBind)};prepTriggers();var animation=scope.$eval(attrs[prefix+"Animation"]);ttScope.animation=angular.isDefined(animation)?!!animation:options.animation;var appendToBodyVal=scope.$eval(attrs[prefix+"AppendToBody"]);appendToBody=angular.isDefined(appendToBodyVal)?appendToBodyVal:appendToBody,appendToBody&&scope.$on("$locationChangeSuccess",function(){ttScope.isOpen&&hide()}),scope.$on("$destroy",function(){$timeout.cancel(transitionTimeout),$timeout.cancel(popupTimeout),unregisterTriggers(),removeTooltip(),ttScope=null})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function($tooltip){return $tooltip("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function($tooltip){return $tooltip("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function($tooltip){return $tooltip("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function($scope,$attrs,progressConfig){var self=this,animate=angular.isDefined($attrs.animate)?$scope.$parent.$eval($attrs.animate):progressConfig.animate;this.bars=[],$scope.max=angular.isDefined($attrs.max)?$scope.$parent.$eval($attrs.max):progressConfig.max,this.addBar=function(bar,element){animate||element.css({transition:"none"}),this.bars.push(bar),bar.$watch("value",function(value){bar.percent=+(100*value/$scope.max).toFixed(2)}),bar.$on("$destroy",function(){element=null,self.removeBar(bar)})},this.removeBar=function(bar){this.bars.splice(this.bars.indexOf(bar),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(scope,element,attrs,progressCtrl){progressCtrl.addBar(scope,element)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(scope,element,attrs,progressCtrl){progressCtrl.addBar(scope,angular.element(element.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function($scope,$attrs,ratingConfig){var ngModelCtrl={$setViewValue:angular.noop};this.init=function(ngModelCtrl_){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=this.render,this.stateOn=angular.isDefined($attrs.stateOn)?$scope.$parent.$eval($attrs.stateOn):ratingConfig.stateOn,this.stateOff=angular.isDefined($attrs.stateOff)?$scope.$parent.$eval($attrs.stateOff):ratingConfig.stateOff;var ratingStates=angular.isDefined($attrs.ratingStates)?$scope.$parent.$eval($attrs.ratingStates):new Array(angular.isDefined($attrs.max)?$scope.$parent.$eval($attrs.max):ratingConfig.max);$scope.range=this.buildTemplateObjects(ratingStates)},this.buildTemplateObjects=function(states){for(var i=0,n=states.length;n>i;i++)states[i]=angular.extend({index:i},{stateOn:this.stateOn,stateOff:this.stateOff},states[i]);return states},$scope.rate=function(value){!$scope.readonly&&value>=0&&value<=$scope.range.length&&(ngModelCtrl.$setViewValue(value),ngModelCtrl.$render())},$scope.enter=function(value){$scope.readonly||($scope.value=value),$scope.onHover({value:value})},$scope.reset=function(){$scope.value=ngModelCtrl.$viewValue,$scope.onLeave()},$scope.onKeydown=function(evt){/(37|38|39|40)/.test(evt.which)&&(evt.preventDefault(),evt.stopPropagation(),$scope.rate($scope.value+(38===evt.which||39===evt.which?1:-1)))},this.render=function(){$scope.value=ngModelCtrl.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(scope,element,attrs,ctrls){var ratingCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&ratingCtrl.init(ngModelCtrl)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function($scope){var ctrl=this,tabs=ctrl.tabs=$scope.tabs=[];ctrl.select=function(selectedTab){angular.forEach(tabs,function(tab){tab.active&&tab!==selectedTab&&(tab.active=!1,tab.onDeselect())}),selectedTab.active=!0,selectedTab.onSelect()},ctrl.addTab=function(tab){tabs.push(tab),1===tabs.length?tab.active=!0:tab.active&&ctrl.select(tab)},ctrl.removeTab=function(tab){var index=tabs.indexOf(tab);if(tab.active&&tabs.length>1&&!destroyed){var newActiveIndex=index==tabs.length-1?index-1:index+1;ctrl.select(tabs[newActiveIndex])}tabs.splice(index,1)};var destroyed;$scope.$on("$destroy",function(){destroyed=!0})}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(scope,element,attrs){scope.vertical=angular.isDefined(attrs.vertical)?scope.$parent.$eval(attrs.vertical):!1,scope.justified=angular.isDefined(attrs.justified)?scope.$parent.$eval(attrs.justified):!1}}}).directive("tab",["$parse",function($parse){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(elm,attrs,transclude){return function(scope,elm,attrs,tabsetCtrl){scope.$watch("active",function(active){active&&tabsetCtrl.select(scope)}),scope.disabled=!1,attrs.disabled&&scope.$parent.$watch($parse(attrs.disabled),function(value){scope.disabled=!!value}),scope.select=function(){scope.disabled||(scope.active=!0)},tabsetCtrl.addTab(scope),scope.$on("$destroy",function(){tabsetCtrl.removeTab(scope)}),scope.$transcludeFn=transclude}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(scope,elm){scope.$watch("headingElement",function(heading){heading&&(elm.html(""),elm.append(heading))})}}}]).directive("tabContentTransclude",function(){function isTabHeading(node){return node.tagName&&(node.hasAttribute("tab-heading")||node.hasAttribute("data-tab-heading")||"tab-heading"===node.tagName.toLowerCase()||"data-tab-heading"===node.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(scope,elm,attrs){var tab=scope.$eval(attrs.tabContentTransclude);tab.$transcludeFn(tab.$parent,function(contents){angular.forEach(contents,function(node){isTabHeading(node)?tab.headingElement=node:elm.append(node)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function($scope,$attrs,$parse,$log,$locale,timepickerConfig){function getHoursFromTemplate(){var hours=parseInt($scope.hours,10),valid=$scope.showMeridian?hours>0&&13>hours:hours>=0&&24>hours;return valid?($scope.showMeridian&&(12===hours&&(hours=0),$scope.meridian===meridians[1]&&(hours+=12)),hours):void 0}function getMinutesFromTemplate(){var minutes=parseInt($scope.minutes,10);return minutes>=0&&60>minutes?minutes:void 0}function pad(value){return angular.isDefined(value)&&value.toString().length<2?"0"+value:value}function refresh(keyboardChange){makeValid(),ngModelCtrl.$setViewValue(new Date(selected)),updateTemplate(keyboardChange)}function makeValid(){ngModelCtrl.$setValidity("time",!0),$scope.invalidHours=!1,$scope.invalidMinutes=!1}function updateTemplate(keyboardChange){var hours=selected.getHours(),minutes=selected.getMinutes();$scope.showMeridian&&(hours=0===hours||12===hours?12:hours%12),$scope.hours="h"===keyboardChange?hours:pad(hours),$scope.minutes="m"===keyboardChange?minutes:pad(minutes),$scope.meridian=selected.getHours()<12?meridians[0]:meridians[1]}function addMinutes(minutes){var dt=new Date(selected.getTime()+6e4*minutes);selected.setHours(dt.getHours(),dt.getMinutes()),refresh()}var selected=new Date,ngModelCtrl={$setViewValue:angular.noop},meridians=angular.isDefined($attrs.meridians)?$scope.$parent.$eval($attrs.meridians):timepickerConfig.meridians||$locale.DATETIME_FORMATS.AMPMS;this.init=function(ngModelCtrl_,inputs){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=this.render;var hoursInputEl=inputs.eq(0),minutesInputEl=inputs.eq(1),mousewheel=angular.isDefined($attrs.mousewheel)?$scope.$parent.$eval($attrs.mousewheel):timepickerConfig.mousewheel;mousewheel&&this.setupMousewheelEvents(hoursInputEl,minutesInputEl),$scope.readonlyInput=angular.isDefined($attrs.readonlyInput)?$scope.$parent.$eval($attrs.readonlyInput):timepickerConfig.readonlyInput,this.setupInputEvents(hoursInputEl,minutesInputEl)};var hourStep=timepickerConfig.hourStep;$attrs.hourStep&&$scope.$parent.$watch($parse($attrs.hourStep),function(value){hourStep=parseInt(value,10)});var minuteStep=timepickerConfig.minuteStep;$attrs.minuteStep&&$scope.$parent.$watch($parse($attrs.minuteStep),function(value){minuteStep=parseInt(value,10)}),$scope.showMeridian=timepickerConfig.showMeridian,$attrs.showMeridian&&$scope.$parent.$watch($parse($attrs.showMeridian),function(value){if($scope.showMeridian=!!value,ngModelCtrl.$error.time){var hours=getHoursFromTemplate(),minutes=getMinutesFromTemplate();angular.isDefined(hours)&&angular.isDefined(minutes)&&(selected.setHours(hours),refresh())}else updateTemplate()}),this.setupMousewheelEvents=function(hoursInputEl,minutesInputEl){var isScrollingUp=function(e){e.originalEvent&&(e=e.originalEvent);var delta=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||delta>0};hoursInputEl.bind("mousewheel wheel",function(e){$scope.$apply(isScrollingUp(e)?$scope.incrementHours():$scope.decrementHours()),e.preventDefault()}),minutesInputEl.bind("mousewheel wheel",function(e){$scope.$apply(isScrollingUp(e)?$scope.incrementMinutes():$scope.decrementMinutes()),e.preventDefault()})},this.setupInputEvents=function(hoursInputEl,minutesInputEl){if($scope.readonlyInput)return $scope.updateHours=angular.noop,void($scope.updateMinutes=angular.noop);var invalidate=function(invalidHours,invalidMinutes){ngModelCtrl.$setViewValue(null),ngModelCtrl.$setValidity("time",!1),angular.isDefined(invalidHours)&&($scope.invalidHours=invalidHours),angular.isDefined(invalidMinutes)&&($scope.invalidMinutes=invalidMinutes)};$scope.updateHours=function(){var hours=getHoursFromTemplate();angular.isDefined(hours)?(selected.setHours(hours),refresh("h")):invalidate(!0)},hoursInputEl.bind("blur",function(){!$scope.invalidHours&&$scope.hours<10&&$scope.$apply(function(){$scope.hours=pad($scope.hours)})}),$scope.updateMinutes=function(){var minutes=getMinutesFromTemplate();angular.isDefined(minutes)?(selected.setMinutes(minutes),refresh("m")):invalidate(void 0,!0)},minutesInputEl.bind("blur",function(){!$scope.invalidMinutes&&$scope.minutes<10&&$scope.$apply(function(){$scope.minutes=pad($scope.minutes)})})},this.render=function(){var date=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;isNaN(date)?(ngModelCtrl.$setValidity("time",!1),$log.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(date&&(selected=date),makeValid(),updateTemplate())},$scope.incrementHours=function(){addMinutes(60*hourStep)},$scope.decrementHours=function(){addMinutes(60*-hourStep)},$scope.incrementMinutes=function(){addMinutes(minuteStep)},$scope.decrementMinutes=function(){addMinutes(-minuteStep)},$scope.toggleMeridian=function(){addMinutes(720*(selected.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(scope,element,attrs,ctrls){var timepickerCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&timepickerCtrl.init(ngModelCtrl,element.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function($parse){var TYPEAHEAD_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(input){var match=input.match(TYPEAHEAD_REGEXP);if(!match)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+input+'".');return{itemName:match[3],source:$parse(match[4]),viewMapper:$parse(match[2]||match[1]),modelMapper:$parse(match[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function($compile,$parse,$q,$timeout,$document,$position,typeaheadParser){var HOT_KEYS=[9,13,27,38,40];return{require:"ngModel",link:function(originalScope,element,attrs,modelCtrl){var hasFocus,minSearch=originalScope.$eval(attrs.typeaheadMinLength)||1,waitTime=originalScope.$eval(attrs.typeaheadWaitMs)||0,isEditable=originalScope.$eval(attrs.typeaheadEditable)!==!1,isLoadingSetter=$parse(attrs.typeaheadLoading).assign||angular.noop,onSelectCallback=$parse(attrs.typeaheadOnSelect),inputFormatter=attrs.typeaheadInputFormatter?$parse(attrs.typeaheadInputFormatter):void 0,appendToBody=attrs.typeaheadAppendToBody?originalScope.$eval(attrs.typeaheadAppendToBody):!1,focusFirst=originalScope.$eval(attrs.typeaheadFocusFirst)!==!1,$setModelValue=$parse(attrs.ngModel).assign,parserResult=typeaheadParser.parse(attrs.typeahead),scope=originalScope.$new();originalScope.$on("$destroy",function(){scope.$destroy()});var popupId="typeahead-"+scope.$id+"-"+Math.floor(1e4*Math.random());element.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":popupId});var popUpEl=angular.element("<div typeahead-popup></div>");popUpEl.attr({id:popupId,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(attrs.typeaheadTemplateUrl)&&popUpEl.attr("template-url",attrs.typeaheadTemplateUrl);var resetMatches=function(){scope.matches=[],scope.activeIdx=-1,element.attr("aria-expanded",!1)},getMatchId=function(index){return popupId+"-option-"+index};scope.$watch("activeIdx",function(index){0>index?element.removeAttr("aria-activedescendant"):element.attr("aria-activedescendant",getMatchId(index))});var getMatchesAsync=function(inputValue){var locals={$viewValue:inputValue};isLoadingSetter(originalScope,!0),$q.when(parserResult.source(originalScope,locals)).then(function(matches){var onCurrentRequest=inputValue===modelCtrl.$viewValue;if(onCurrentRequest&&hasFocus)if(matches.length>0){scope.activeIdx=focusFirst?0:-1,scope.matches.length=0;for(var i=0;i<matches.length;i++)locals[parserResult.itemName]=matches[i],scope.matches.push({id:getMatchId(i),label:parserResult.viewMapper(scope,locals),model:matches[i]});scope.query=inputValue,scope.position=appendToBody?$position.offset(element):$position.position(element),scope.position.top=scope.position.top+element.prop("offsetHeight"),element.attr("aria-expanded",!0)}else resetMatches();onCurrentRequest&&isLoadingSetter(originalScope,!1)},function(){resetMatches(),isLoadingSetter(originalScope,!1)})};resetMatches(),scope.query=void 0;var timeoutPromise,scheduleSearchWithTimeout=function(inputValue){timeoutPromise=$timeout(function(){getMatchesAsync(inputValue)},waitTime)},cancelPreviousTimeout=function(){timeoutPromise&&$timeout.cancel(timeoutPromise)};modelCtrl.$parsers.unshift(function(inputValue){return hasFocus=!0,inputValue&&inputValue.length>=minSearch?waitTime>0?(cancelPreviousTimeout(),scheduleSearchWithTimeout(inputValue)):getMatchesAsync(inputValue):(isLoadingSetter(originalScope,!1),cancelPreviousTimeout(),resetMatches()),isEditable?inputValue:inputValue?void modelCtrl.$setValidity("editable",!1):(modelCtrl.$setValidity("editable",!0),inputValue)}),modelCtrl.$formatters.push(function(modelValue){var candidateViewValue,emptyViewValue,locals={};return inputFormatter?(locals.$model=modelValue,inputFormatter(originalScope,locals)):(locals[parserResult.itemName]=modelValue,candidateViewValue=parserResult.viewMapper(originalScope,locals),locals[parserResult.itemName]=void 0,emptyViewValue=parserResult.viewMapper(originalScope,locals),candidateViewValue!==emptyViewValue?candidateViewValue:modelValue)}),scope.select=function(activeIdx){var model,item,locals={};locals[parserResult.itemName]=item=scope.matches[activeIdx].model,model=parserResult.modelMapper(originalScope,locals),$setModelValue(originalScope,model),modelCtrl.$setValidity("editable",!0),onSelectCallback(originalScope,{$item:item,$model:model,$label:parserResult.viewMapper(originalScope,locals)}),resetMatches(),$timeout(function(){element[0].focus()},0,!1)},element.bind("keydown",function(evt){0!==scope.matches.length&&-1!==HOT_KEYS.indexOf(evt.which)&&(-1!=scope.activeIdx||13!==evt.which&&9!==evt.which)&&(evt.preventDefault(),40===evt.which?(scope.activeIdx=(scope.activeIdx+1)%scope.matches.length,scope.$digest()):38===evt.which?(scope.activeIdx=(scope.activeIdx>0?scope.activeIdx:scope.matches.length)-1,scope.$digest()):13===evt.which||9===evt.which?scope.$apply(function(){scope.select(scope.activeIdx)}):27===evt.which&&(evt.stopPropagation(),resetMatches(),scope.$digest()))}),element.bind("blur",function(){hasFocus=!1});var dismissClickHandler=function(evt){element[0]!==evt.target&&(resetMatches(),scope.$digest())};$document.bind("click",dismissClickHandler),originalScope.$on("$destroy",function(){$document.unbind("click",dismissClickHandler),appendToBody&&$popup.remove()});var $popup=$compile(popUpEl)(scope);appendToBody?$document.find("body").append($popup):element.after($popup)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(scope,element,attrs){scope.templateUrl=attrs.templateUrl,scope.isOpen=function(){return scope.matches.length>0},scope.isActive=function(matchIdx){return scope.active==matchIdx},scope.selectActive=function(matchIdx){scope.active=matchIdx},scope.selectMatch=function(activeIdx){scope.select({activeIdx:activeIdx})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function($http,$templateCache,$compile,$parse){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(scope,element,attrs){var tplUrl=$parse(attrs.templateUrl)(scope.$parent)||"template/typeahead/typeahead-match.html";$http.get(tplUrl,{cache:$templateCache}).success(function(tplContent){element.replaceWith($compile(tplContent.trim())(scope))})}}}]).filter("typeaheadHighlight",function(){function escapeRegexp(queryToEscape){return queryToEscape.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(matchItem,query){return query?(""+matchItem).replace(new RegExp(escapeRegexp(query),"gi"),"<strong>$&</strong>"):matchItem}}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading">\n    <h4 class="panel-title">\n      <a href class="accordion-toggle" ng-click="toggleOpen()" accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></a>\n    </h4>\n  </div>\n  <div class="panel-collapse" collapse="!isOpen">\n	  <div class="panel-body" ng-transclude></div>\n  </div>\n</div>\n')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/alert/alert.html",'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissable\' : null]" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close()">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ol class="carousel-indicators" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides track by $index" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-left"></span></a>\n    <a class="right carousel-control" ng-click="next()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/carousel/slide.html","<div ng-class=\"{\n    'active': leaving || (active && !entering),\n    'prev': (next || active) && direction=='prev',\n    'next': (next || active) && direction=='next',\n    'right': direction=='prev',\n    'left': direction=='next'\n  }\" class=\"item text-center\" ng-transclude></div>\n")}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>')
}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n	<li ng-transclude></li>\n	<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n		<span class="btn-group pull-left">\n			<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n			<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n		</span>\n		<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n	</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/modal/backdrop.html",'<div class="modal-backdrop fade {{ backdropClass }}"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/modal/window.html",'<div tabindex="-1" role="dialog" class="modal fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="{\'modal-sm\': size == \'sm\', \'modal-lg\': size == \'lg\'}"><div class="modal-content" modal-transclude></div></div>\n</div>')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/progress.html",'<div class="progress" ng-transclude></div>')}]),angular.module("template/progressbar/progressbar.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n</div>')}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <i ng-repeat="r in range track by $index" ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')">\n        <span class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    </i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a href ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/timepicker/timepicker.html",'<table>\n	<tbody>\n		<tr class="text-center">\n			<td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n		<tr>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidHours}">\n				<input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td>:</td>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidMinutes}">\n				<input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>\n		</tr>\n		<tr class="text-center">\n			<td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n	</tbody>\n</table>\n')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{match.id}}">\n        <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')}]),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(window,angular,undefined){"use strict";function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function merge(dst){return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst.hasOwnProperty(key)||(dst[key]=value)})}),dst}function ancestors(first,second){var path=[];for(var n in first.path)if(""!==first.path[n]){if(!second.path[n])break;path.push(first.path[n])}return path}function arraySearch(array,value){if(Array.prototype.indexOf)return array.indexOf(value,Number(arguments[2])||0);var len=array.length>>>0,from=Number(arguments[2])||0;for(from=0>from?Math.ceil(from):Math.floor(from),0>from&&(from+=len);len>from;from++)if(from in array&&array[from]===value)return from;return-1}function inheritParams(currentParams,newParams,$current,$to){var parentParams,parents=ancestors($current,$to),inherited={},inheritList=[];for(var i in parents)if(parents[i].params&&parents[i].params.length){parentParams=parents[i].params;for(var j in parentParams)arraySearch(inheritList,parentParams[j])>=0||(inheritList.push(parentParams[j]),inherited[parentParams[j]]=currentParams[parentParams[j]])}return extend({},inherited,newParams)}function normalize(keys,values){var normalized={};return forEach(keys,function(name){var value=values[name];normalized[name]=null!=value?String(value):null}),normalized}function equalForKeys(a,b,keys){if(!keys){keys=[];for(var n in a)keys.push(n)}for(var i=0;i<keys.length;i++){var k=keys[i];if(a[k]!=b[k])return!1}return!0}function filterByKeys(keys,values){var filtered={};return forEach(keys,function(name){filtered[name]=values[name]}),filtered}function $Resolve($q,$injector){var VISIT_IN_PROGRESS=1,VISIT_DONE=2,NOTHING={},NO_DEPENDENCIES=[],NO_LOCALS=NOTHING,NO_PARENT=extend($q.when(NOTHING),{$$promises:NOTHING,$$values:NOTHING});this.study=function(invocables){function visit(value,key){if(visited[key]!==VISIT_DONE){if(cycle.push(key),visited[key]===VISIT_IN_PROGRESS)throw cycle.splice(0,cycle.indexOf(key)),new Error("Cyclic dependency: "+cycle.join(" -> "));if(visited[key]=VISIT_IN_PROGRESS,isString(value))plan.push(key,[function(){return $injector.get(value)}],NO_DEPENDENCIES);else{var params=$injector.annotate(value);forEach(params,function(param){param!==key&&invocables.hasOwnProperty(param)&&visit(invocables[param],param)}),plan.push(key,value,params)}cycle.pop(),visited[key]=VISIT_DONE}}function isResolve(value){return isObject(value)&&value.then&&value.$$promises}if(!isObject(invocables))throw new Error("'invocables' must be an object");var plan=[],cycle=[],visited={};return forEach(invocables,visit),invocables=cycle=visited=null,function(locals,parent,self){function done(){--wait||(merged||merge(values,parent.$$values),result.$$values=values,result.$$promises=!0,resolution.resolve(values))}function fail(reason){result.$$failure=reason,resolution.reject(reason)}function invoke(key,invocable,params){function onfailure(reason){invocation.reject(reason),fail(reason)}function proceed(){if(!isDefined(result.$$failure))try{invocation.resolve($injector.invoke(invocable,self,values)),invocation.promise.then(function(result){values[key]=result,done()},onfailure)}catch(e){onfailure(e)}}var invocation=$q.defer(),waitParams=0;forEach(params,function(dep){promises.hasOwnProperty(dep)&&!locals.hasOwnProperty(dep)&&(waitParams++,promises[dep].then(function(result){values[dep]=result,--waitParams||proceed()},onfailure))}),waitParams||proceed(),promises[key]=invocation.promise}if(isResolve(locals)&&self===undefined&&(self=parent,parent=locals,locals=null),locals){if(!isObject(locals))throw new Error("'locals' must be an object")}else locals=NO_LOCALS;if(parent){if(!isResolve(parent))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else parent=NO_PARENT;var resolution=$q.defer(),result=resolution.promise,promises=result.$$promises={},values=extend({},locals),wait=1+plan.length/3,merged=!1;if(isDefined(parent.$$failure))return fail(parent.$$failure),result;parent.$$values?(merged=merge(values,parent.$$values),done()):(extend(promises,parent.$$promises),parent.then(done,fail));for(var i=0,ii=plan.length;ii>i;i+=3)locals.hasOwnProperty(plan[i])?done():invoke(plan[i],plan[i+1],plan[i+2]);return result}},this.resolve=function(invocables,locals,parent,self){return this.study(invocables)(locals,parent,self)}}function $TemplateFactory($http,$templateCache,$injector){this.fromConfig=function(config,params,locals){return isDefined(config.template)?this.fromString(config.template,params):isDefined(config.templateUrl)?this.fromUrl(config.templateUrl,params):isDefined(config.templateProvider)?this.fromProvider(config.templateProvider,params,locals):null},this.fromString=function(template,params){return isFunction(template)?template(params):template},this.fromUrl=function(url,params){return isFunction(url)&&(url=url(params)),null==url?null:$http.get(url,{cache:$templateCache}).then(function(response){return response.data})},this.fromProvider=function(provider,params,locals){return $injector.invoke(provider,null,locals||{params:params})}}function UrlMatcher(pattern){function addParameter(id){if(!/^\w+(-+\w+)*$/.test(id))throw new Error("Invalid parameter name '"+id+"' in pattern '"+pattern+"'");if(names[id])throw new Error("Duplicate parameter name '"+id+"' in pattern '"+pattern+"'");names[id]=!0,params.push(id)}function quoteRegExp(string){return string.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&")}var m,placeholder=/([:*])(\w+)|\{(\w+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,names={},compiled="^",last=0,segments=this.segments=[],params=this.params=[];this.source=pattern;for(var id,regexp,segment;(m=placeholder.exec(pattern))&&(id=m[2]||m[3],regexp=m[4]||("*"==m[1]?".*":"[^/]*"),segment=pattern.substring(last,m.index),!(segment.indexOf("?")>=0));)compiled+=quoteRegExp(segment)+"("+regexp+")",addParameter(id),segments.push(segment),last=placeholder.lastIndex;segment=pattern.substring(last);var i=segment.indexOf("?");if(i>=0){var search=this.sourceSearch=segment.substring(i);segment=segment.substring(0,i),this.sourcePath=pattern.substring(0,last+i),forEach(search.substring(1).split(/[&?]/),addParameter)}else this.sourcePath=pattern,this.sourceSearch="";compiled+=quoteRegExp(segment)+"$",segments.push(segment),this.regexp=new RegExp(compiled),this.prefix=segments[0]}function $UrlMatcherFactory(){this.compile=function(pattern){return new UrlMatcher(pattern)},this.isMatcher=function(o){return isObject(o)&&isFunction(o.exec)&&isFunction(o.format)&&isFunction(o.concat)},this.$get=function(){return this}}function $UrlRouterProvider($urlMatcherFactory){function regExpPrefix(re){var prefix=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(re.source);return null!=prefix?prefix[1].replace(/\\(.)/g,"$1"):""}function interpolate(pattern,match){return pattern.replace(/\$(\$|\d{1,2})/,function(m,what){return match["$"===what?0:Number(what)]})}function handleIfMatch($injector,handler,match){if(!match)return!1;var result=$injector.invoke(handler,handler,{$match:match});return isDefined(result)?result:!0}var rules=[],otherwise=null;this.rule=function(rule){if(!isFunction(rule))throw new Error("'rule' must be a function");return rules.push(rule),this},this.otherwise=function(rule){if(isString(rule)){var redirect=rule;rule=function(){return redirect}}else if(!isFunction(rule))throw new Error("'rule' must be a function");return otherwise=rule,this},this.when=function(what,handler){var redirect,handlerIsString=isString(handler);if(isString(what)&&(what=$urlMatcherFactory.compile(what)),!handlerIsString&&!isFunction(handler)&&!isArray(handler))throw new Error("invalid 'handler' in when()");var strategies={matcher:function(what,handler){return handlerIsString&&(redirect=$urlMatcherFactory.compile(handler),handler=["$match",function($match){return redirect.format($match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path(),$location.search()))},{prefix:isString(what.prefix)?what.prefix:""})},regex:function(what,handler){if(what.global||what.sticky)throw new Error("when() RegExp must not be global or sticky");return handlerIsString&&(redirect=handler,handler=["$match",function($match){return interpolate(redirect,$match)}]),extend(function($injector,$location){return handleIfMatch($injector,handler,what.exec($location.path()))},{prefix:regExpPrefix(what)})}},check={matcher:$urlMatcherFactory.isMatcher(what),regex:what instanceof RegExp};for(var n in check)if(check[n])return this.rule(strategies[n](what,handler));throw new Error("invalid 'what' in when()")},this.$get=["$location","$rootScope","$injector",function($location,$rootScope,$injector){function update(evt){function check(rule){var handled=rule($injector,$location);return handled?(isString(handled)&&$location.replace().url(handled),!0):!1}if(!evt||!evt.defaultPrevented){var i,n=rules.length;for(i=0;n>i;i++)if(check(rules[i]))return;otherwise&&check(otherwise)}}return $rootScope.$on("$locationChangeSuccess",update),{sync:function(){update()}}}]}function $StateProvider($urlRouterProvider,$urlMatcherFactory,$locationProvider){function isRelative(stateName){return 0===stateName.indexOf(".")||0===stateName.indexOf("^")}function findState(stateOrName,base){var isStr=isString(stateOrName),name=isStr?stateOrName:stateOrName.name,path=isRelative(name);if(path){if(!base)throw new Error("No reference point given for path '"+name+"'");for(var rel=name.split("."),i=0,pathLength=rel.length,current=base;pathLength>i;i++)if(""!==rel[i]||0!==i){if("^"!==rel[i])break;if(!current.parent)throw new Error("Path '"+name+"' not valid for state '"+base.name+"'");current=current.parent}else current=base;rel=rel.slice(i).join("."),name=current.name+(current.name&&rel?".":"")+rel}var state=states[name];return!state||!isStr&&(isStr||state!==stateOrName&&state.self!==stateOrName)?undefined:state}function queueState(parentName,state){queue[parentName]||(queue[parentName]=[]),queue[parentName].push(state)}function registerState(state){state=inherit(state,{self:state,resolve:state.resolve||{},toString:function(){return this.name}});var name=state.name;if(!isString(name)||name.indexOf("@")>=0)throw new Error("State must have a valid name");if(states.hasOwnProperty(name))throw new Error("State '"+name+"'' is already defined");var parentName=-1!==name.indexOf(".")?name.substring(0,name.lastIndexOf(".")):isString(state.parent)?state.parent:"";if(parentName&&!states[parentName])return queueState(parentName,state.self);for(var key in stateBuilder)isFunction(stateBuilder[key])&&(state[key]=stateBuilder[key](state,stateBuilder.$delegates[key]));if(states[name]=state,!state[abstractKey]&&state.url&&$urlRouterProvider.when(state.url,["$match","$stateParams",function($match,$stateParams){$state.$current.navigable==state&&equalForKeys($match,$stateParams)||$state.transitionTo(state,$match,{location:!1})}]),queue[name])for(var i=0;i<queue[name].length;i++)registerState(queue[name][i]);return state}function decorator(name,func){return isString(name)&&!isDefined(func)?stateBuilder[name]:isFunction(func)&&isString(name)?(stateBuilder[name]&&!stateBuilder.$delegates[name]&&(stateBuilder.$delegates[name]=stateBuilder[name]),stateBuilder[name]=func,this):this}function state(name,definition){return isObject(name)?definition=name:definition.name=name,registerState(definition),this}function $get($rootScope,$q,$view,$injector,$resolve,$stateParams,$location){function syncUrl(){$location.url()!==currentLocation&&($location.url(currentLocation),$location.replace())}function resolveState(state,params,paramsAreFiltered,inherited,dst){var $stateParams=paramsAreFiltered?params:filterByKeys(state.params,params),locals={$stateParams:$stateParams};dst.resolve=$resolve.resolve(state.resolve,locals,dst.resolve,state);var promises=[dst.resolve.then(function(globals){dst.globals=globals})];return inherited&&promises.push(inherited),forEach(state.views,function(view,name){var injectables=view.resolve&&view.resolve!==state.resolve?view.resolve:{};injectables.$template=[function(){return $view.load(name,{view:view,locals:locals,params:$stateParams,notify:!1})||""}],promises.push($resolve.resolve(injectables,locals,dst.resolve,state).then(function(result){if(isFunction(view.controllerProvider)||isArray(view.controllerProvider)){var injectLocals=angular.extend({},injectables,locals);result.$$controller=$injector.invoke(view.controllerProvider,null,injectLocals)}else result.$$controller=view.controller;result.$$state=state,dst[name]=result}))}),$q.all(promises).then(function(){return dst})}var TransitionSuperseded=$q.reject(new Error("transition superseded")),TransitionPrevented=$q.reject(new Error("transition prevented")),TransitionAborted=$q.reject(new Error("transition aborted")),TransitionFailed=$q.reject(new Error("transition failed")),currentLocation=$location.url();return root.locals={resolve:null,globals:{$stateParams:{}}},$state={params:{},current:root.self,$current:root,transition:null},$state.reload=function(){$state.transitionTo($state.current,$stateParams,{reload:!0,inherit:!1,notify:!1})},$state.go=function(to,params,options){return this.transitionTo(to,params,extend({inherit:!0,relative:$state.$current},options))},$state.transitionTo=function(to,toParams,options){toParams=toParams||{},options=extend({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},options||{});var evt,from=$state.$current,fromParams=$state.params,fromPath=from.path,toState=findState(to,options.relative);if(!isDefined(toState)){var redirect={to:to,toParams:toParams,options:options};if(evt=$rootScope.$broadcast("$stateNotFound",redirect,from.self,fromParams),evt.defaultPrevented)return syncUrl(),TransitionAborted;if(evt.retry){if(options.$retry)return syncUrl(),TransitionFailed;var retryTransition=$state.transition=$q.when(evt.retry);return retryTransition.then(function(){return retryTransition!==$state.transition?TransitionSuperseded:(redirect.options.$retry=!0,$state.transitionTo(redirect.to,redirect.toParams,redirect.options))},function(){return TransitionAborted}),syncUrl(),retryTransition}if(to=redirect.to,toParams=redirect.toParams,options=redirect.options,toState=findState(to,options.relative),!isDefined(toState)){if(options.relative)throw new Error("Could not resolve '"+to+"' from state '"+options.relative+"'");throw new Error("No such state '"+to+"'")}}if(toState[abstractKey])throw new Error("Cannot transition to abstract state '"+to+"'");options.inherit&&(toParams=inheritParams($stateParams,toParams||{},$state.$current,toState)),to=toState;var keep,state,toPath=to.path,locals=root.locals,toLocals=[];for(keep=0,state=toPath[keep];state&&state===fromPath[keep]&&equalForKeys(toParams,fromParams,state.ownParams)&&!options.reload;keep++,state=toPath[keep])locals=toLocals[keep]=state.locals;if(shouldTriggerReload(to,from,locals,options))return to.self.reloadOnSearch!==!1&&syncUrl(),$state.transition=null,$q.when($state.current);if(toParams=normalize(to.params,toParams||{}),options.notify&&(evt=$rootScope.$broadcast("$stateChangeStart",to.self,toParams,from.self,fromParams),evt.defaultPrevented))return syncUrl(),TransitionPrevented;for(var resolved=$q.when(locals),l=keep;l<toPath.length;l++,state=toPath[l])locals=toLocals[l]=inherit(locals),resolved=resolveState(state,toParams,state===to,resolved,locals);var transition=$state.transition=resolved.then(function(){var l,entering,exiting;if($state.transition!==transition)return TransitionSuperseded;for(l=fromPath.length-1;l>=keep;l--)exiting=fromPath[l],exiting.self.onExit&&$injector.invoke(exiting.self.onExit,exiting.self,exiting.locals.globals),exiting.locals=null;for(l=keep;l<toPath.length;l++)entering=toPath[l],entering.locals=toLocals[l],entering.self.onEnter&&$injector.invoke(entering.self.onEnter,entering.self,entering.locals.globals);if($state.transition!==transition)return TransitionSuperseded;$state.$current=to,$state.current=to.self,$state.params=toParams,copy($state.params,$stateParams),$state.transition=null;var toNav=to.navigable;return options.location&&toNav&&($location.url(toNav.url.format(toNav.locals.globals.$stateParams)),"replace"===options.location&&$location.replace()),options.notify&&$rootScope.$broadcast("$stateChangeSuccess",to.self,toParams,from.self,fromParams),currentLocation=$location.url(),$state.current},function(error){return $state.transition!==transition?TransitionSuperseded:($state.transition=null,$rootScope.$broadcast("$stateChangeError",to.self,toParams,from.self,fromParams,error),syncUrl(),$q.reject(error))});return transition},$state.is=function(stateOrName,params){var state=findState(stateOrName);return isDefined(state)?$state.$current!==state?!1:isDefined(params)?angular.equals($stateParams,params):!0:undefined},$state.includes=function(stateOrName,params){var state=findState(stateOrName);if(!isDefined(state))return undefined;if(!isDefined($state.$current.includes[state.name]))return!1;var validParams=!0;return angular.forEach(params,function(value,key){isDefined($stateParams[key])&&$stateParams[key]===value||(validParams=!1)}),validParams},$state.href=function(stateOrName,params,options){options=extend({lossy:!0,inherit:!1,absolute:!1,relative:$state.$current},options||{});var state=findState(stateOrName,options.relative);if(!isDefined(state))return null;params=inheritParams($stateParams,params||{},$state.$current,state);var nav=state&&options.lossy?state.navigable:state,url=nav&&nav.url?nav.url.format(normalize(state.params,params||{})):null;return!$locationProvider.html5Mode()&&url&&(url="#"+$locationProvider.hashPrefix()+url),options.absolute&&url&&(url=$location.protocol()+"://"+$location.host()+(80==$location.port()||443==$location.port()?"":":"+$location.port())+(!$locationProvider.html5Mode()&&url?"/":"")+url),url},$state.get=function(stateOrName,context){if(!isDefined(stateOrName)){var list=[];return forEach(states,function(state){list.push(state.self)}),list}var state=findState(stateOrName,context);return state&&state.self?state.self:null},$state}function shouldTriggerReload(to,from,locals,options){return to!==from||(locals!==from.locals||options.reload)&&to.self.reloadOnSearch!==!1?void 0:!0
}var root,$state,states={},queue={},abstractKey="abstract",stateBuilder={parent:function(state){if(isDefined(state.parent)&&state.parent)return findState(state.parent);var compositeName=/^(.+)\.[^.]+$/.exec(state.name);return compositeName?findState(compositeName[1]):root},data:function(state){return state.parent&&state.parent.data&&(state.data=state.self.data=extend({},state.parent.data,state.data)),state.data},url:function(state){var url=state.url;if(isString(url))return"^"==url.charAt(0)?$urlMatcherFactory.compile(url.substring(1)):(state.parent.navigable||root).url.concat(url);if($urlMatcherFactory.isMatcher(url)||null==url)return url;throw new Error("Invalid url '"+url+"' in state '"+state+"'")},navigable:function(state){return state.url?state:state.parent?state.parent.navigable:null},params:function(state){if(!state.params)return state.url?state.url.parameters():state.parent.params;if(!isArray(state.params))throw new Error("Invalid params in state '"+state+"'");if(state.url)throw new Error("Both params and url specicified in state '"+state+"'");return state.params},views:function(state){var views={};return forEach(isDefined(state.views)?state.views:{"":state},function(view,name){name.indexOf("@")<0&&(name+="@"+state.parent.name),views[name]=view}),views},ownParams:function(state){if(!state.parent)return state.params;var paramNames={};forEach(state.params,function(p){paramNames[p]=!0}),forEach(state.parent.params,function(p){if(!paramNames[p])throw new Error("Missing required parameter '"+p+"' in state '"+state.name+"'");paramNames[p]=!1});var ownParams=[];return forEach(paramNames,function(own,p){own&&ownParams.push(p)}),ownParams},path:function(state){return state.parent?state.parent.path.concat(state):[]},includes:function(state){var includes=state.parent?extend({},state.parent.includes):{};return includes[state.name]=!0,includes},$delegates:{}};root=registerState({name:"",url:"^",views:null,"abstract":!0}),root.navigable=null,this.decorator=decorator,this.state=state,this.$get=$get,$get.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$location","$urlRouter"]}function $ViewProvider(){function $get($rootScope,$templateFactory){return{load:function(name,options){var result,defaults={template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}};return options=extend(defaults,options),options.view&&(result=$templateFactory.fromConfig(options.view,options.params,options.locals)),result&&options.notify&&$rootScope.$broadcast("$viewContentLoading",options),result}}}this.$get=$get,$get.$inject=["$rootScope","$templateFactory"]}function $ViewDirective($state,$compile,$controller,$injector,$anchorScroll){var $animator=$injector.has("$animator")?$injector.get("$animator"):!1,viewIsUpdating=!1,directive={restrict:"ECA",terminal:!0,priority:1e3,transclude:!0,compile:function(element,attr,transclude){return function(scope,element,attr){function updateView(doAnimate){var locals=$state.$current&&$state.$current.locals[name];if(locals!==viewLocals){var render=renderer(animate&&doAnimate);if(render.remove(element),viewScope&&(viewScope.$destroy(),viewScope=null),!locals)return viewLocals=null,view.state=null,render.restore(initialView,element);viewLocals=locals,view.state=locals.$$state;var link=$compile(render.populate(locals.$template,element));if(viewScope=scope.$new(),locals.$$controller){locals.$scope=viewScope;var controller=$controller(locals.$$controller,locals);element.children().data("$ngControllerController",controller)}link(viewScope),viewScope.$emit("$viewContentLoaded"),onloadExp&&viewScope.$eval(onloadExp),$anchorScroll()}}var viewScope,viewLocals,name=attr[directive.name]||attr.name||"",onloadExp=attr.onload||"",animate=$animator&&$animator(scope,attr),initialView=transclude(scope),renderer=function(doAnimate){return{"true":{remove:function(element){animate.leave(element.contents(),element)},restore:function(compiled,element){animate.enter(compiled,element)},populate:function(template,element){var contents=angular.element("<div></div>").html(template).contents();return animate.enter(contents,element),contents}},"false":{remove:function(element){element.html("")},restore:function(compiled,element){element.append(compiled)},populate:function(template,element){return element.html(template),element.contents()}}}[doAnimate.toString()]};element.append(initialView);var parent=element.parent().inheritedData("$uiView");name.indexOf("@")<0&&(name=name+"@"+(parent?parent.state.name:""));var view={name:name,state:null};element.data("$uiView",view);var eventHook=function(){if(!viewIsUpdating){viewIsUpdating=!0;try{updateView(!0)}catch(e){throw viewIsUpdating=!1,e}viewIsUpdating=!1}};scope.$on("$stateChangeSuccess",eventHook),scope.$on("$viewContentLoading",eventHook),updateView(!1)}}};return directive}function parseStateRef(ref){var parsed=ref.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/);if(!parsed||4!==parsed.length)throw new Error("Invalid state ref '"+ref+"'");return{state:parsed[1],paramExpr:parsed[3]||null}}function stateContext(el){var stateData=el.parent().inheritedData("$uiView");return stateData&&stateData.state&&stateData.state.name?stateData.state:void 0}function $StateRefDirective($state,$timeout){return{restrict:"A",require:"?^uiSrefActive",link:function(scope,element,attrs,uiSrefActive){var ref=parseStateRef(attrs.uiSref),params=null,base=stateContext(element)||$state.$current,isForm="FORM"===element[0].nodeName,attr=isForm?"action":"href",nav=!0,update=function(newVal){if(newVal&&(params=newVal),nav){var newHref=$state.href(ref.state,params,{relative:base});if(!newHref)return nav=!1,!1;element[0][attr]=newHref,uiSrefActive&&uiSrefActive.$$setStateInfo(ref.state,params)}};ref.paramExpr&&(scope.$watch(ref.paramExpr,function(newVal){newVal!==params&&update(newVal)},!0),params=scope.$eval(ref.paramExpr)),update(),isForm||element.bind("click",function(e){var button=e.which||e.button;0!==button&&1!=button||e.ctrlKey||e.metaKey||e.shiftKey||($timeout(function(){scope.$apply(function(){$state.go(ref.state,params,{relative:base})})}),e.preventDefault())})}}}function $StateActiveDirective($state,$stateParams,$interpolate){return{restrict:"A",controller:function($scope,$element,$attrs){function update(){$state.$current.self===state&&matchesParams()?$element.addClass(activeClass):$element.removeClass(activeClass)}function matchesParams(){return!params||equalForKeys(params,$stateParams)}var state,params,activeClass;activeClass=$interpolate($attrs.uiSrefActive||"",!1)($scope),this.$$setStateInfo=function(newState,newParams){state=$state.get(newState,stateContext($element)),params=newParams,update()},$scope.$on("$stateChangeSuccess",update)}}}function $RouteProvider($stateProvider,$urlRouterProvider){function onEnterRoute($$state){this.locals=$$state.locals.globals,this.params=this.locals.$stateParams}function onExitRoute(){this.locals=null,this.params=null}function when(url,route){if(null!=route.redirectTo){var handler,redirect=route.redirectTo;if(isString(redirect))handler=redirect;else{if(!isFunction(redirect))throw new Error("Invalid 'redirectTo' in when()");handler=function(params,$location){return redirect(params,$location.path(),$location.search())}}$urlRouterProvider.when(url,handler)}else $stateProvider.state(inherit(route,{parent:null,name:"route:"+encodeURIComponent(url),url:url,onEnter:onEnterRoute,onExit:onExitRoute}));return routes.push(route),this}function $get($state,$rootScope,$routeParams){function stateAsRoute(state){return""!==state.name?state:undefined}var $route={routes:routes,params:$routeParams,current:undefined};return $rootScope.$on("$stateChangeStart",function(ev,to,toParams,from){$rootScope.$broadcast("$routeChangeStart",stateAsRoute(to),stateAsRoute(from))}),$rootScope.$on("$stateChangeSuccess",function(ev,to,toParams,from){$route.current=stateAsRoute(to),$rootScope.$broadcast("$routeChangeSuccess",stateAsRoute(to),stateAsRoute(from)),copy(toParams,$route.params)}),$rootScope.$on("$stateChangeError",function(ev,to,toParams,from,fromParams,error){$rootScope.$broadcast("$routeChangeError",stateAsRoute(to),stateAsRoute(from),error)}),$route}var routes=[];onEnterRoute.$inject=["$$state"],this.when=when,this.$get=$get,$get.$inject=["$state","$rootScope","$routeParams"]}var isDefined=angular.isDefined,isFunction=angular.isFunction,isString=angular.isString,isObject=angular.isObject,isArray=angular.isArray,forEach=angular.forEach,extend=angular.extend,copy=angular.copy;angular.module("ui.router.util",["ng"]),angular.module("ui.router.router",["ui.router.util"]),angular.module("ui.router.state",["ui.router.router","ui.router.util"]),angular.module("ui.router",["ui.router.state"]),angular.module("ui.router.compat",["ui.router"]),$Resolve.$inject=["$q","$injector"],angular.module("ui.router.util").service("$resolve",$Resolve),$TemplateFactory.$inject=["$http","$templateCache","$injector"],angular.module("ui.router.util").service("$templateFactory",$TemplateFactory),UrlMatcher.prototype.concat=function(pattern){return new UrlMatcher(this.sourcePath+pattern+this.sourceSearch)},UrlMatcher.prototype.toString=function(){return this.source},UrlMatcher.prototype.exec=function(path,searchParams){var m=this.regexp.exec(path);if(!m)return null;var i,params=this.params,nTotal=params.length,nPath=this.segments.length-1,values={};if(nPath!==m.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(i=0;nPath>i;i++)values[params[i]]=m[i+1];for(;nTotal>i;i++)values[params[i]]=searchParams[params[i]];return values},UrlMatcher.prototype.parameters=function(){return this.params},UrlMatcher.prototype.format=function(values){var segments=this.segments,params=this.params;if(!values)return segments.join("");var i,search,value,nPath=segments.length-1,nTotal=params.length,result=segments[0];for(i=0;nPath>i;i++)value=values[params[i]],null!=value&&(result+=encodeURIComponent(value)),result+=segments[i+1];for(;nTotal>i;i++)value=values[params[i]],null!=value&&(result+=(search?"&":"?")+params[i]+"="+encodeURIComponent(value),search=!0);return result},angular.module("ui.router.util").provider("$urlMatcherFactory",$UrlMatcherFactory),$UrlRouterProvider.$inject=["$urlMatcherFactoryProvider"],angular.module("ui.router.router").provider("$urlRouter",$UrlRouterProvider),$StateProvider.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider","$locationProvider"],angular.module("ui.router.state").value("$stateParams",{}).provider("$state",$StateProvider),$ViewProvider.$inject=[],angular.module("ui.router.state").provider("$view",$ViewProvider),$ViewDirective.$inject=["$state","$compile","$controller","$injector","$anchorScroll"],angular.module("ui.router.state").directive("uiView",$ViewDirective),$StateRefDirective.$inject=["$state","$timeout"],$StateActiveDirective.$inject=["$state","$stateParams","$interpolate"],angular.module("ui.router.state").directive("uiSref",$StateRefDirective).directive("uiSrefActive",$StateActiveDirective),$RouteProvider.$inject=["$stateProvider","$urlRouterProvider"],angular.module("ui.router.compat").provider("$route",$RouteProvider).directive("ngView",$ViewDirective)}(window,window.angular),!function(){function d3_documentElement(node){return node&&(node.ownerDocument||node.document||node).documentElement}function d3_window(node){return node&&(node.ownerDocument&&node.ownerDocument.defaultView||node.document&&node||node.defaultView)}function d3_ascending(a,b){return b>a?-1:a>b?1:a>=b?0:0/0}function d3_number(x){return null===x?0/0:+x}function d3_numeric(x){return!isNaN(x)}function d3_bisector(compare){return{left:function(a,x,lo,hi){for(arguments.length<3&&(lo=0),arguments.length<4&&(hi=a.length);hi>lo;){var mid=lo+hi>>>1;compare(a[mid],x)<0?lo=mid+1:hi=mid}return lo},right:function(a,x,lo,hi){for(arguments.length<3&&(lo=0),arguments.length<4&&(hi=a.length);hi>lo;){var mid=lo+hi>>>1;compare(a[mid],x)>0?hi=mid:lo=mid+1}return lo}}}function d3_zipLength(d){return d.length}function d3_range_integerScale(x){for(var k=1;x*k%1;)k*=10;return k}function d3_class(ctor,properties){for(var key in properties)Object.defineProperty(ctor.prototype,key,{value:properties[key],enumerable:!1})}function d3_Map(){this._=Object.create(null)}function d3_map_escape(key){return(key+="")===d3_map_proto||key[0]===d3_map_zero?d3_map_zero+key:key}function d3_map_unescape(key){return(key+="")[0]===d3_map_zero?key.slice(1):key}function d3_map_has(key){return d3_map_escape(key)in this._}function d3_map_remove(key){return(key=d3_map_escape(key))in this._&&delete this._[key]}function d3_map_keys(){var keys=[];for(var key in this._)keys.push(d3_map_unescape(key));return keys}function d3_map_size(){var size=0;for(var key in this._)++size;return size}function d3_map_empty(){for(var key in this._)return!1;return!0}function d3_Set(){this._=Object.create(null)}function d3_identity(d){return d}function d3_rebind(target,source,method){return function(){var value=method.apply(source,arguments);return value===source?target:value}}function d3_vendorSymbol(object,name){if(name in object)return name;name=name.charAt(0).toUpperCase()+name.slice(1);for(var i=0,n=d3_vendorPrefixes.length;n>i;++i){var prefixName=d3_vendorPrefixes[i]+name;if(prefixName in object)return prefixName}}function d3_noop(){}function d3_dispatch(){}function d3_dispatch_event(dispatch){function event(){for(var l,z=listeners,i=-1,n=z.length;++i<n;)(l=z[i].on)&&l.apply(this,arguments);return dispatch}var listeners=[],listenerByName=new d3_Map;return event.on=function(name,listener){var i,l=listenerByName.get(name);return arguments.length<2?l&&l.on:(l&&(l.on=null,listeners=listeners.slice(0,i=listeners.indexOf(l)).concat(listeners.slice(i+1)),listenerByName.remove(name)),listener&&listeners.push(listenerByName.set(name,{on:listener})),dispatch)},event}function d3_eventPreventDefault(){d3.event.preventDefault()}function d3_eventSource(){for(var s,e=d3.event;s=e.sourceEvent;)e=s;return e}function d3_eventDispatch(target){for(var dispatch=new d3_dispatch,i=0,n=arguments.length;++i<n;)dispatch[arguments[i]]=d3_dispatch_event(dispatch);return dispatch.of=function(thiz,argumentz){return function(e1){try{var e0=e1.sourceEvent=d3.event;e1.target=target,d3.event=e1,dispatch[e1.type].apply(thiz,argumentz)}finally{d3.event=e0}}},dispatch}function d3_selection(groups){return d3_subclass(groups,d3_selectionPrototype),groups}function d3_selection_selector(selector){return"function"==typeof selector?selector:function(){return d3_select(selector,this)}}function d3_selection_selectorAll(selector){return"function"==typeof selector?selector:function(){return d3_selectAll(selector,this)}}function d3_selection_attr(name,value){function attrNull(){this.removeAttribute(name)}function attrNullNS(){this.removeAttributeNS(name.space,name.local)}function attrConstant(){this.setAttribute(name,value)}function attrConstantNS(){this.setAttributeNS(name.space,name.local,value)}function attrFunction(){var x=value.apply(this,arguments);null==x?this.removeAttribute(name):this.setAttribute(name,x)}function attrFunctionNS(){var x=value.apply(this,arguments);null==x?this.removeAttributeNS(name.space,name.local):this.setAttributeNS(name.space,name.local,x)}return name=d3.ns.qualify(name),null==value?name.local?attrNullNS:attrNull:"function"==typeof value?name.local?attrFunctionNS:attrFunction:name.local?attrConstantNS:attrConstant}function d3_collapse(s){return s.trim().replace(/\s+/g," ")}function d3_selection_classedRe(name){return new RegExp("(?:^|\\s+)"+d3.requote(name)+"(?:\\s+|$)","g")}function d3_selection_classes(name){return(name+"").trim().split(/^|\s+/)}function d3_selection_classed(name,value){function classedConstant(){for(var i=-1;++i<n;)name[i](this,value)}function classedFunction(){for(var i=-1,x=value.apply(this,arguments);++i<n;)name[i](this,x)}name=d3_selection_classes(name).map(d3_selection_classedName);var n=name.length;return"function"==typeof value?classedFunction:classedConstant}function d3_selection_classedName(name){var re=d3_selection_classedRe(name);return function(node,value){if(c=node.classList)return value?c.add(name):c.remove(name);var c=node.getAttribute("class")||"";value?(re.lastIndex=0,re.test(c)||node.setAttribute("class",d3_collapse(c+" "+name))):node.setAttribute("class",d3_collapse(c.replace(re," ")))}}function d3_selection_style(name,value,priority){function styleNull(){this.style.removeProperty(name)}function styleConstant(){this.style.setProperty(name,value,priority)}function styleFunction(){var x=value.apply(this,arguments);null==x?this.style.removeProperty(name):this.style.setProperty(name,x,priority)}return null==value?styleNull:"function"==typeof value?styleFunction:styleConstant}function d3_selection_property(name,value){function propertyNull(){delete this[name]}function propertyConstant(){this[name]=value}function propertyFunction(){var x=value.apply(this,arguments);null==x?delete this[name]:this[name]=x}return null==value?propertyNull:"function"==typeof value?propertyFunction:propertyConstant}function d3_selection_creator(name){function create(){var document=this.ownerDocument,namespace=this.namespaceURI;return namespace?document.createElementNS(namespace,name):document.createElement(name)}function createNS(){return this.ownerDocument.createElementNS(name.space,name.local)}return"function"==typeof name?name:(name=d3.ns.qualify(name)).local?createNS:create}function d3_selectionRemove(){var parent=this.parentNode;parent&&parent.removeChild(this)}function d3_selection_dataNode(data){return{__data__:data}}function d3_selection_filter(selector){return function(){return d3_selectMatches(this,selector)}}function d3_selection_sortComparator(comparator){return arguments.length||(comparator=d3_ascending),function(a,b){return a&&b?comparator(a.__data__,b.__data__):!a-!b}}function d3_selection_each(groups,callback){for(var j=0,m=groups.length;m>j;j++)for(var node,group=groups[j],i=0,n=group.length;n>i;i++)(node=group[i])&&callback(node,i,j);return groups}function d3_selection_enter(selection){return d3_subclass(selection,d3_selection_enterPrototype),selection}function d3_selection_enterInsertBefore(enter){var i0,j0;return function(d,i,j){var node,group=enter[j].update,n=group.length;for(j!=j0&&(j0=j,i0=0),i>=i0&&(i0=i+1);!(node=group[i0])&&++i0<n;);return node}}function d3_selection_on(type,listener,capture){function onRemove(){var l=this[name];l&&(this.removeEventListener(type,l,l.$),delete this[name])}function onAdd(){var l=wrap(listener,d3_array(arguments));onRemove.call(this),this.addEventListener(type,this[name]=l,l.$=capture),l._=listener}function removeAll(){var match,re=new RegExp("^__on([^.]+)"+d3.requote(type)+"$");for(var name in this)if(match=name.match(re)){var l=this[name];this.removeEventListener(match[1],l,l.$),delete this[name]}}var name="__on"+type,i=type.indexOf("."),wrap=d3_selection_onListener;i>0&&(type=type.slice(0,i));var filter=d3_selection_onFilters.get(type);return filter&&(type=filter,wrap=d3_selection_onFilter),i?listener?onAdd:onRemove:listener?d3_noop:removeAll}function d3_selection_onListener(listener,argumentz){return function(e){var o=d3.event;d3.event=e,argumentz[0]=this.__data__;try{listener.apply(this,argumentz)}finally{d3.event=o}}}function d3_selection_onFilter(listener,argumentz){var l=d3_selection_onListener(listener,argumentz);return function(e){var target=this,related=e.relatedTarget;related&&(related===target||8&related.compareDocumentPosition(target))||l.call(target,e)}}function d3_event_dragSuppress(node){var name=".dragsuppress-"+ ++d3_event_dragId,click="click"+name,w=d3.select(d3_window(node)).on("touchmove"+name,d3_eventPreventDefault).on("dragstart"+name,d3_eventPreventDefault).on("selectstart"+name,d3_eventPreventDefault);if(null==d3_event_dragSelect&&(d3_event_dragSelect="onselectstart"in node?!1:d3_vendorSymbol(node.style,"userSelect")),d3_event_dragSelect){var style=d3_documentElement(node).style,select=style[d3_event_dragSelect];style[d3_event_dragSelect]="none"}return function(suppressClick){if(w.on(name,null),d3_event_dragSelect&&(style[d3_event_dragSelect]=select),suppressClick){var off=function(){w.on(click,null)};w.on(click,function(){d3_eventPreventDefault(),off()},!0),setTimeout(off,0)}}}function d3_mousePoint(container,e){e.changedTouches&&(e=e.changedTouches[0]);var svg=container.ownerSVGElement||container;if(svg.createSVGPoint){var point=svg.createSVGPoint();if(0>d3_mouse_bug44083){var window=d3_window(container);if(window.scrollX||window.scrollY){svg=d3.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var ctm=svg[0][0].getScreenCTM();d3_mouse_bug44083=!(ctm.f||ctm.e),svg.remove()}}return d3_mouse_bug44083?(point.x=e.pageX,point.y=e.pageY):(point.x=e.clientX,point.y=e.clientY),point=point.matrixTransform(container.getScreenCTM().inverse()),[point.x,point.y]}var rect=container.getBoundingClientRect();return[e.clientX-rect.left-container.clientLeft,e.clientY-rect.top-container.clientTop]}function d3_behavior_dragTouchId(){return d3.event.changedTouches[0].identifier}function d3_sgn(x){return x>0?1:0>x?-1:0}function d3_cross2d(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function d3_acos(x){return x>1?0:-1>x?π:Math.acos(x)}function d3_asin(x){return x>1?halfπ:-1>x?-halfπ:Math.asin(x)}function d3_sinh(x){return((x=Math.exp(x))-1/x)/2}function d3_cosh(x){return((x=Math.exp(x))+1/x)/2}function d3_tanh(x){return((x=Math.exp(2*x))-1)/(x+1)}function d3_haversin(x){return(x=Math.sin(x/2))*x}function d3_color(){}function d3_hsl(h,s,l){return this instanceof d3_hsl?(this.h=+h,this.s=+s,void(this.l=+l)):arguments.length<2?h instanceof d3_hsl?new d3_hsl(h.h,h.s,h.l):d3_rgb_parse(""+h,d3_rgb_hsl,d3_hsl):new d3_hsl(h,s,l)}function d3_hsl_rgb(h,s,l){function v(h){return h>360?h-=360:0>h&&(h+=360),60>h?m1+(m2-m1)*h/60:180>h?m2:240>h?m1+(m2-m1)*(240-h)/60:m1}function vv(h){return Math.round(255*v(h))}var m1,m2;return h=isNaN(h)?0:(h%=360)<0?h+360:h,s=isNaN(s)?0:0>s?0:s>1?1:s,l=0>l?0:l>1?1:l,m2=.5>=l?l*(1+s):l+s-l*s,m1=2*l-m2,new d3_rgb(vv(h+120),vv(h),vv(h-120))}function d3_hcl(h,c,l){return this instanceof d3_hcl?(this.h=+h,this.c=+c,void(this.l=+l)):arguments.length<2?h instanceof d3_hcl?new d3_hcl(h.h,h.c,h.l):h instanceof d3_lab?d3_lab_hcl(h.l,h.a,h.b):d3_lab_hcl((h=d3_rgb_lab((h=d3.rgb(h)).r,h.g,h.b)).l,h.a,h.b):new d3_hcl(h,c,l)}function d3_hcl_lab(h,c,l){return isNaN(h)&&(h=0),isNaN(c)&&(c=0),new d3_lab(l,Math.cos(h*=d3_radians)*c,Math.sin(h)*c)}function d3_lab(l,a,b){return this instanceof d3_lab?(this.l=+l,this.a=+a,void(this.b=+b)):arguments.length<2?l instanceof d3_lab?new d3_lab(l.l,l.a,l.b):l instanceof d3_hcl?d3_hcl_lab(l.h,l.c,l.l):d3_rgb_lab((l=d3_rgb(l)).r,l.g,l.b):new d3_lab(l,a,b)}function d3_lab_rgb(l,a,b){var y=(l+16)/116,x=y+a/500,z=y-b/200;return x=d3_lab_xyz(x)*d3_lab_X,y=d3_lab_xyz(y)*d3_lab_Y,z=d3_lab_xyz(z)*d3_lab_Z,new d3_rgb(d3_xyz_rgb(3.2404542*x-1.5371385*y-.4985314*z),d3_xyz_rgb(-.969266*x+1.8760108*y+.041556*z),d3_xyz_rgb(.0556434*x-.2040259*y+1.0572252*z))}function d3_lab_hcl(l,a,b){return l>0?new d3_hcl(Math.atan2(b,a)*d3_degrees,Math.sqrt(a*a+b*b),l):new d3_hcl(0/0,0/0,l)}function d3_lab_xyz(x){return x>.206893034?x*x*x:(x-4/29)/7.787037}function d3_xyz_lab(x){return x>.008856?Math.pow(x,1/3):7.787037*x+4/29}function d3_xyz_rgb(r){return Math.round(255*(.00304>=r?12.92*r:1.055*Math.pow(r,1/2.4)-.055))}function d3_rgb(r,g,b){return this instanceof d3_rgb?(this.r=~~r,this.g=~~g,void(this.b=~~b)):arguments.length<2?r instanceof d3_rgb?new d3_rgb(r.r,r.g,r.b):d3_rgb_parse(""+r,d3_rgb,d3_hsl_rgb):new d3_rgb(r,g,b)}function d3_rgbNumber(value){return new d3_rgb(value>>16,value>>8&255,255&value)}function d3_rgbString(value){return d3_rgbNumber(value)+""}function d3_rgb_hex(v){return 16>v?"0"+Math.max(0,v).toString(16):Math.min(255,v).toString(16)}function d3_rgb_parse(format,rgb,hsl){var m1,m2,color,r=0,g=0,b=0;if(m1=/([a-z]+)\((.*)\)/.exec(format=format.toLowerCase()))switch(m2=m1[2].split(","),m1[1]){case"hsl":return hsl(parseFloat(m2[0]),parseFloat(m2[1])/100,parseFloat(m2[2])/100);case"rgb":return rgb(d3_rgb_parseNumber(m2[0]),d3_rgb_parseNumber(m2[1]),d3_rgb_parseNumber(m2[2]))}return(color=d3_rgb_names.get(format))?rgb(color.r,color.g,color.b):(null==format||"#"!==format.charAt(0)||isNaN(color=parseInt(format.slice(1),16))||(4===format.length?(r=(3840&color)>>4,r=r>>4|r,g=240&color,g=g>>4|g,b=15&color,b=b<<4|b):7===format.length&&(r=(16711680&color)>>16,g=(65280&color)>>8,b=255&color)),rgb(r,g,b))}function d3_rgb_hsl(r,g,b){var h,s,min=Math.min(r/=255,g/=255,b/=255),max=Math.max(r,g,b),d=max-min,l=(max+min)/2;return d?(s=.5>l?d/(max+min):d/(2-max-min),h=r==max?(g-b)/d+(b>g?6:0):g==max?(b-r)/d+2:(r-g)/d+4,h*=60):(h=0/0,s=l>0&&1>l?0:h),new d3_hsl(h,s,l)}function d3_rgb_lab(r,g,b){r=d3_rgb_xyz(r),g=d3_rgb_xyz(g),b=d3_rgb_xyz(b);var x=d3_xyz_lab((.4124564*r+.3575761*g+.1804375*b)/d3_lab_X),y=d3_xyz_lab((.2126729*r+.7151522*g+.072175*b)/d3_lab_Y),z=d3_xyz_lab((.0193339*r+.119192*g+.9503041*b)/d3_lab_Z);return d3_lab(116*y-16,500*(x-y),200*(y-z))}function d3_rgb_xyz(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function d3_rgb_parseNumber(c){var f=parseFloat(c);return"%"===c.charAt(c.length-1)?Math.round(2.55*f):f}function d3_functor(v){return"function"==typeof v?v:function(){return v}}function d3_xhrType(response){return function(url,mimeType,callback){return 2===arguments.length&&"function"==typeof mimeType&&(callback=mimeType,mimeType=null),d3_xhr(url,mimeType,response,callback)}}function d3_xhr(url,mimeType,response,callback){function respond(){var result,status=request.status;if(!status&&d3_xhrHasResponse(request)||status>=200&&300>status||304===status){try{result=response.call(xhr,request)}catch(e){return void dispatch.error.call(xhr,e)}dispatch.load.call(xhr,result)}else dispatch.error.call(xhr,request)}var xhr={},dispatch=d3.dispatch("beforesend","progress","load","error"),headers={},request=new XMLHttpRequest,responseType=null;return!this.XDomainRequest||"withCredentials"in request||!/^(http(s)?:)?\/\//.test(url)||(request=new XDomainRequest),"onload"in request?request.onload=request.onerror=respond:request.onreadystatechange=function(){request.readyState>3&&respond()},request.onprogress=function(event){var o=d3.event;d3.event=event;try{dispatch.progress.call(xhr,request)}finally{d3.event=o}},xhr.header=function(name,value){return name=(name+"").toLowerCase(),arguments.length<2?headers[name]:(null==value?delete headers[name]:headers[name]=value+"",xhr)},xhr.mimeType=function(value){return arguments.length?(mimeType=null==value?null:value+"",xhr):mimeType},xhr.responseType=function(value){return arguments.length?(responseType=value,xhr):responseType},xhr.response=function(value){return response=value,xhr},["get","post"].forEach(function(method){xhr[method]=function(){return xhr.send.apply(xhr,[method].concat(d3_array(arguments)))}}),xhr.send=function(method,data,callback){if(2===arguments.length&&"function"==typeof data&&(callback=data,data=null),request.open(method,url,!0),null==mimeType||"accept"in headers||(headers.accept=mimeType+",*/*"),request.setRequestHeader)for(var name in headers)request.setRequestHeader(name,headers[name]);return null!=mimeType&&request.overrideMimeType&&request.overrideMimeType(mimeType),null!=responseType&&(request.responseType=responseType),null!=callback&&xhr.on("error",callback).on("load",function(request){callback(null,request)}),dispatch.beforesend.call(xhr,request),request.send(null==data?null:data),xhr},xhr.abort=function(){return request.abort(),xhr},d3.rebind(xhr,dispatch,"on"),null==callback?xhr:xhr.get(d3_xhr_fixCallback(callback))}function d3_xhr_fixCallback(callback){return 1===callback.length?function(error,request){callback(null==error?request:null)}:callback}function d3_xhrHasResponse(request){var type=request.responseType;return type&&"text"!==type?request.response:request.responseText}function d3_timer(callback,delay,then){var n=arguments.length;2>n&&(delay=0),3>n&&(then=Date.now());var time=then+delay,timer={c:callback,t:time,n:null};return d3_timer_queueTail?d3_timer_queueTail.n=timer:d3_timer_queueHead=timer,d3_timer_queueTail=timer,d3_timer_interval||(d3_timer_timeout=clearTimeout(d3_timer_timeout),d3_timer_interval=1,d3_timer_frame(d3_timer_step)),timer}function d3_timer_step(){var now=d3_timer_mark(),delay=d3_timer_sweep()-now;delay>24?(isFinite(delay)&&(clearTimeout(d3_timer_timeout),d3_timer_timeout=setTimeout(d3_timer_step,delay)),d3_timer_interval=0):(d3_timer_interval=1,d3_timer_frame(d3_timer_step))}function d3_timer_mark(){for(var now=Date.now(),timer=d3_timer_queueHead;timer;)now>=timer.t&&timer.c(now-timer.t)&&(timer.c=null),timer=timer.n;return now}function d3_timer_sweep(){for(var t0,t1=d3_timer_queueHead,time=1/0;t1;)t1.c?(t1.t<time&&(time=t1.t),t1=(t0=t1).n):t1=t0?t0.n=t1.n:d3_timer_queueHead=t1.n;return d3_timer_queueTail=t0,time}function d3_format_precision(x,p){return p-(x?Math.ceil(Math.log(x)/Math.LN10):1)}function d3_formatPrefix(d,i){var k=Math.pow(10,3*abs(8-i));return{scale:i>8?function(d){return d/k}:function(d){return d*k},symbol:d}}function d3_locale_numberFormat(locale){var locale_decimal=locale.decimal,locale_thousands=locale.thousands,locale_grouping=locale.grouping,locale_currency=locale.currency,formatGroup=locale_grouping&&locale_thousands?function(value,width){for(var i=value.length,t=[],j=0,g=locale_grouping[0],length=0;i>0&&g>0&&(length+g+1>width&&(g=Math.max(1,width-length)),t.push(value.substring(i-=g,i+g)),!((length+=g+1)>width));)g=locale_grouping[j=(j+1)%locale_grouping.length];return t.reverse().join(locale_thousands)}:d3_identity;return function(specifier){var match=d3_format_re.exec(specifier),fill=match[1]||" ",align=match[2]||">",sign=match[3]||"-",symbol=match[4]||"",zfill=match[5],width=+match[6],comma=match[7],precision=match[8],type=match[9],scale=1,prefix="",suffix="",integer=!1,exponent=!0;switch(precision&&(precision=+precision.substring(1)),(zfill||"0"===fill&&"="===align)&&(zfill=fill="0",align="="),type){case"n":comma=!0,type="g";break;case"%":scale=100,suffix="%",type="f";break;case"p":scale=100,suffix="%",type="r";break;case"b":case"o":case"x":case"X":"#"===symbol&&(prefix="0"+type.toLowerCase());case"c":exponent=!1;case"d":integer=!0,precision=0;break;case"s":scale=-1,type="r"}"$"===symbol&&(prefix=locale_currency[0],suffix=locale_currency[1]),"r"!=type||precision||(type="g"),null!=precision&&("g"==type?precision=Math.max(1,Math.min(21,precision)):("e"==type||"f"==type)&&(precision=Math.max(0,Math.min(20,precision)))),type=d3_format_types.get(type)||d3_format_typeDefault;var zcomma=zfill&&comma;return function(value){var fullSuffix=suffix;if(integer&&value%1)return"";var negative=0>value||0===value&&0>1/value?(value=-value,"-"):"-"===sign?"":sign;if(0>scale){var unit=d3.formatPrefix(value,precision);value=unit.scale(value),fullSuffix=unit.symbol+suffix}else value*=scale;value=type(value,precision);var before,after,i=value.lastIndexOf(".");if(0>i){var j=exponent?value.lastIndexOf("e"):-1;0>j?(before=value,after=""):(before=value.substring(0,j),after=value.substring(j))}else before=value.substring(0,i),after=locale_decimal+value.substring(i+1);!zfill&&comma&&(before=formatGroup(before,1/0));var length=prefix.length+before.length+after.length+(zcomma?0:negative.length),padding=width>length?new Array(length=width-length+1).join(fill):"";return zcomma&&(before=formatGroup(padding+before,padding.length?width-after.length:1/0)),negative+=prefix,value=before+after,("<"===align?negative+value+padding:">"===align?padding+negative+value:"^"===align?padding.substring(0,length>>=1)+negative+value+padding.substring(length):negative+(zcomma?value:padding+value))+fullSuffix}}}function d3_format_typeDefault(x){return x+""}function d3_date_utc(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function d3_time_interval(local,step,number){function round(date){var d0=local(date),d1=offset(d0,1);
return d1-date>date-d0?d0:d1}function ceil(date){return step(date=local(new d3_date(date-1)),1),date}function offset(date,k){return step(date=new d3_date(+date),k),date}function range(t0,t1,dt){var time=ceil(t0),times=[];if(dt>1)for(;t1>time;)number(time)%dt||times.push(new Date(+time)),step(time,1);else for(;t1>time;)times.push(new Date(+time)),step(time,1);return times}function range_utc(t0,t1,dt){try{d3_date=d3_date_utc;var utc=new d3_date_utc;return utc._=t0,range(utc,t1,dt)}finally{d3_date=Date}}local.floor=local,local.round=round,local.ceil=ceil,local.offset=offset,local.range=range;var utc=local.utc=d3_time_interval_utc(local);return utc.floor=utc,utc.round=d3_time_interval_utc(round),utc.ceil=d3_time_interval_utc(ceil),utc.offset=d3_time_interval_utc(offset),utc.range=range_utc,local}function d3_time_interval_utc(method){return function(date,k){try{d3_date=d3_date_utc;var utc=new d3_date_utc;return utc._=date,method(utc,k)._}finally{d3_date=Date}}}function d3_locale_timeFormat(locale){function d3_time_format(template){function format(date){for(var c,p,f,string=[],i=-1,j=0;++i<n;)37===template.charCodeAt(i)&&(string.push(template.slice(j,i)),null!=(p=d3_time_formatPads[c=template.charAt(++i)])&&(c=template.charAt(++i)),(f=d3_time_formats[c])&&(c=f(date,null==p?"e"===c?" ":"0":p)),string.push(c),j=i+1);return string.push(template.slice(j,i)),string.join("")}var n=template.length;return format.parse=function(string){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},i=d3_time_parse(d,template,string,0);if(i!=string.length)return null;"p"in d&&(d.H=d.H%12+12*d.p);var localZ=null!=d.Z&&d3_date!==d3_date_utc,date=new(localZ?d3_date_utc:d3_date);return"j"in d?date.setFullYear(d.y,0,d.j):"W"in d||"U"in d?("w"in d||(d.w="W"in d?1:0),date.setFullYear(d.y,0,1),date.setFullYear(d.y,0,"W"in d?(d.w+6)%7+7*d.W-(date.getDay()+5)%7:d.w+7*d.U-(date.getDay()+6)%7)):date.setFullYear(d.y,d.m,d.d),date.setHours(d.H+(d.Z/100|0),d.M+d.Z%100,d.S,d.L),localZ?date._:date},format.toString=function(){return template},format}function d3_time_parse(date,template,string,j){for(var c,p,t,i=0,n=template.length,m=string.length;n>i;){if(j>=m)return-1;if(c=template.charCodeAt(i++),37===c){if(t=template.charAt(i++),p=d3_time_parsers[t in d3_time_formatPads?template.charAt(i++):t],!p||(j=p(date,string,j))<0)return-1}else if(c!=string.charCodeAt(j++))return-1}return j}function d3_time_parseWeekdayAbbrev(date,string,i){d3_time_dayAbbrevRe.lastIndex=0;var n=d3_time_dayAbbrevRe.exec(string.slice(i));return n?(date.w=d3_time_dayAbbrevLookup.get(n[0].toLowerCase()),i+n[0].length):-1}function d3_time_parseWeekday(date,string,i){d3_time_dayRe.lastIndex=0;var n=d3_time_dayRe.exec(string.slice(i));return n?(date.w=d3_time_dayLookup.get(n[0].toLowerCase()),i+n[0].length):-1}function d3_time_parseMonthAbbrev(date,string,i){d3_time_monthAbbrevRe.lastIndex=0;var n=d3_time_monthAbbrevRe.exec(string.slice(i));return n?(date.m=d3_time_monthAbbrevLookup.get(n[0].toLowerCase()),i+n[0].length):-1}function d3_time_parseMonth(date,string,i){d3_time_monthRe.lastIndex=0;var n=d3_time_monthRe.exec(string.slice(i));return n?(date.m=d3_time_monthLookup.get(n[0].toLowerCase()),i+n[0].length):-1}function d3_time_parseLocaleFull(date,string,i){return d3_time_parse(date,d3_time_formats.c.toString(),string,i)}function d3_time_parseLocaleDate(date,string,i){return d3_time_parse(date,d3_time_formats.x.toString(),string,i)}function d3_time_parseLocaleTime(date,string,i){return d3_time_parse(date,d3_time_formats.X.toString(),string,i)}function d3_time_parseAmPm(date,string,i){var n=d3_time_periodLookup.get(string.slice(i,i+=2).toLowerCase());return null==n?-1:(date.p=n,i)}var locale_dateTime=locale.dateTime,locale_date=locale.date,locale_time=locale.time,locale_periods=locale.periods,locale_days=locale.days,locale_shortDays=locale.shortDays,locale_months=locale.months,locale_shortMonths=locale.shortMonths;d3_time_format.utc=function(template){function format(date){try{d3_date=d3_date_utc;var utc=new d3_date;return utc._=date,local(utc)}finally{d3_date=Date}}var local=d3_time_format(template);return format.parse=function(string){try{d3_date=d3_date_utc;var date=local.parse(string);return date&&date._}finally{d3_date=Date}},format.toString=local.toString,format},d3_time_format.multi=d3_time_format.utc.multi=d3_time_formatMulti;var d3_time_periodLookup=d3.map(),d3_time_dayRe=d3_time_formatRe(locale_days),d3_time_dayLookup=d3_time_formatLookup(locale_days),d3_time_dayAbbrevRe=d3_time_formatRe(locale_shortDays),d3_time_dayAbbrevLookup=d3_time_formatLookup(locale_shortDays),d3_time_monthRe=d3_time_formatRe(locale_months),d3_time_monthLookup=d3_time_formatLookup(locale_months),d3_time_monthAbbrevRe=d3_time_formatRe(locale_shortMonths),d3_time_monthAbbrevLookup=d3_time_formatLookup(locale_shortMonths);locale_periods.forEach(function(p,i){d3_time_periodLookup.set(p.toLowerCase(),i)});var d3_time_formats={a:function(d){return locale_shortDays[d.getDay()]},A:function(d){return locale_days[d.getDay()]},b:function(d){return locale_shortMonths[d.getMonth()]},B:function(d){return locale_months[d.getMonth()]},c:d3_time_format(locale_dateTime),d:function(d,p){return d3_time_formatPad(d.getDate(),p,2)},e:function(d,p){return d3_time_formatPad(d.getDate(),p,2)},H:function(d,p){return d3_time_formatPad(d.getHours(),p,2)},I:function(d,p){return d3_time_formatPad(d.getHours()%12||12,p,2)},j:function(d,p){return d3_time_formatPad(1+d3_time.dayOfYear(d),p,3)},L:function(d,p){return d3_time_formatPad(d.getMilliseconds(),p,3)},m:function(d,p){return d3_time_formatPad(d.getMonth()+1,p,2)},M:function(d,p){return d3_time_formatPad(d.getMinutes(),p,2)},p:function(d){return locale_periods[+(d.getHours()>=12)]},S:function(d,p){return d3_time_formatPad(d.getSeconds(),p,2)},U:function(d,p){return d3_time_formatPad(d3_time.sundayOfYear(d),p,2)},w:function(d){return d.getDay()},W:function(d,p){return d3_time_formatPad(d3_time.mondayOfYear(d),p,2)},x:d3_time_format(locale_date),X:d3_time_format(locale_time),y:function(d,p){return d3_time_formatPad(d.getFullYear()%100,p,2)},Y:function(d,p){return d3_time_formatPad(d.getFullYear()%1e4,p,4)},Z:d3_time_zone,"%":function(){return"%"}},d3_time_parsers={a:d3_time_parseWeekdayAbbrev,A:d3_time_parseWeekday,b:d3_time_parseMonthAbbrev,B:d3_time_parseMonth,c:d3_time_parseLocaleFull,d:d3_time_parseDay,e:d3_time_parseDay,H:d3_time_parseHour24,I:d3_time_parseHour24,j:d3_time_parseDayOfYear,L:d3_time_parseMilliseconds,m:d3_time_parseMonthNumber,M:d3_time_parseMinutes,p:d3_time_parseAmPm,S:d3_time_parseSeconds,U:d3_time_parseWeekNumberSunday,w:d3_time_parseWeekdayNumber,W:d3_time_parseWeekNumberMonday,x:d3_time_parseLocaleDate,X:d3_time_parseLocaleTime,y:d3_time_parseYear,Y:d3_time_parseFullYear,Z:d3_time_parseZone,"%":d3_time_parseLiteralPercent};return d3_time_format}function d3_time_formatPad(value,fill,width){var sign=0>value?"-":"",string=(sign?-value:value)+"",length=string.length;return sign+(width>length?new Array(width-length+1).join(fill)+string:string)}function d3_time_formatRe(names){return new RegExp("^(?:"+names.map(d3.requote).join("|")+")","i")}function d3_time_formatLookup(names){for(var map=new d3_Map,i=-1,n=names.length;++i<n;)map.set(names[i].toLowerCase(),i);return map}function d3_time_parseWeekdayNumber(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+1));return n?(date.w=+n[0],i+n[0].length):-1}function d3_time_parseWeekNumberSunday(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i));return n?(date.U=+n[0],i+n[0].length):-1}function d3_time_parseWeekNumberMonday(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i));return n?(date.W=+n[0],i+n[0].length):-1}function d3_time_parseFullYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+4));return n?(date.y=+n[0],i+n[0].length):-1}function d3_time_parseYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.y=d3_time_expandYear(+n[0]),i+n[0].length):-1}function d3_time_parseZone(date,string,i){return/^[+-]\d{4}$/.test(string=string.slice(i,i+5))?(date.Z=-string,i+5):-1}function d3_time_expandYear(d){return d+(d>68?1900:2e3)}function d3_time_parseMonthNumber(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.m=n[0]-1,i+n[0].length):-1}function d3_time_parseDay(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.d=+n[0],i+n[0].length):-1}function d3_time_parseDayOfYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+3));return n?(date.j=+n[0],i+n[0].length):-1}function d3_time_parseHour24(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.H=+n[0],i+n[0].length):-1}function d3_time_parseMinutes(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.M=+n[0],i+n[0].length):-1}function d3_time_parseSeconds(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.S=+n[0],i+n[0].length):-1}function d3_time_parseMilliseconds(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+3));return n?(date.L=+n[0],i+n[0].length):-1}function d3_time_zone(d){var z=d.getTimezoneOffset(),zs=z>0?"-":"+",zh=abs(z)/60|0,zm=abs(z)%60;return zs+d3_time_formatPad(zh,"0",2)+d3_time_formatPad(zm,"0",2)}function d3_time_parseLiteralPercent(date,string,i){d3_time_percentRe.lastIndex=0;var n=d3_time_percentRe.exec(string.slice(i,i+1));return n?i+n[0].length:-1}function d3_time_formatMulti(formats){for(var n=formats.length,i=-1;++i<n;)formats[i][0]=this(formats[i][0]);return function(date){for(var i=0,f=formats[i];!f[1](date);)f=formats[++i];return f[0](date)}}function d3_adder(){}function d3_adderSum(a,b,o){var x=o.s=a+b,bv=x-a,av=x-bv;o.t=a-av+(b-bv)}function d3_geo_streamGeometry(geometry,listener){geometry&&d3_geo_streamGeometryType.hasOwnProperty(geometry.type)&&d3_geo_streamGeometryType[geometry.type](geometry,listener)}function d3_geo_streamLine(coordinates,listener,closed){var coordinate,i=-1,n=coordinates.length-closed;for(listener.lineStart();++i<n;)coordinate=coordinates[i],listener.point(coordinate[0],coordinate[1],coordinate[2]);listener.lineEnd()}function d3_geo_streamPolygon(coordinates,listener){var i=-1,n=coordinates.length;for(listener.polygonStart();++i<n;)d3_geo_streamLine(coordinates[i],listener,1);listener.polygonEnd()}function d3_geo_areaRingStart(){function nextPoint(λ,φ){λ*=d3_radians,φ=φ*d3_radians/2+π/4;var dλ=λ-λ0,sdλ=dλ>=0?1:-1,adλ=sdλ*dλ,cosφ=Math.cos(φ),sinφ=Math.sin(φ),k=sinφ0*sinφ,u=cosφ0*cosφ+k*Math.cos(adλ),v=k*sdλ*Math.sin(adλ);d3_geo_areaRingSum.add(Math.atan2(v,u)),λ0=λ,cosφ0=cosφ,sinφ0=sinφ}var λ00,φ00,λ0,cosφ0,sinφ0;d3_geo_area.point=function(λ,φ){d3_geo_area.point=nextPoint,λ0=(λ00=λ)*d3_radians,cosφ0=Math.cos(φ=(φ00=φ)*d3_radians/2+π/4),sinφ0=Math.sin(φ)},d3_geo_area.lineEnd=function(){nextPoint(λ00,φ00)}}function d3_geo_cartesian(spherical){var λ=spherical[0],φ=spherical[1],cosφ=Math.cos(φ);return[cosφ*Math.cos(λ),cosφ*Math.sin(λ),Math.sin(φ)]}function d3_geo_cartesianDot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function d3_geo_cartesianCross(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function d3_geo_cartesianAdd(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function d3_geo_cartesianScale(vector,k){return[vector[0]*k,vector[1]*k,vector[2]*k]}function d3_geo_cartesianNormalize(d){var l=Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]);d[0]/=l,d[1]/=l,d[2]/=l}function d3_geo_spherical(cartesian){return[Math.atan2(cartesian[1],cartesian[0]),d3_asin(cartesian[2])]}function d3_geo_sphericalEqual(a,b){return abs(a[0]-b[0])<ε&&abs(a[1]-b[1])<ε}function d3_geo_centroidPoint(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians);d3_geo_centroidPointXYZ(cosφ*Math.cos(λ),cosφ*Math.sin(λ),Math.sin(φ))}function d3_geo_centroidPointXYZ(x,y,z){++d3_geo_centroidW0,d3_geo_centroidX0+=(x-d3_geo_centroidX0)/d3_geo_centroidW0,d3_geo_centroidY0+=(y-d3_geo_centroidY0)/d3_geo_centroidW0,d3_geo_centroidZ0+=(z-d3_geo_centroidZ0)/d3_geo_centroidW0}function d3_geo_centroidLineStart(){function nextPoint(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians),x=cosφ*Math.cos(λ),y=cosφ*Math.sin(λ),z=Math.sin(φ),w=Math.atan2(Math.sqrt((w=y0*z-z0*y)*w+(w=z0*x-x0*z)*w+(w=x0*y-y0*x)*w),x0*x+y0*y+z0*z);d3_geo_centroidW1+=w,d3_geo_centroidX1+=w*(x0+(x0=x)),d3_geo_centroidY1+=w*(y0+(y0=y)),d3_geo_centroidZ1+=w*(z0+(z0=z)),d3_geo_centroidPointXYZ(x0,y0,z0)}var x0,y0,z0;d3_geo_centroid.point=function(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians);x0=cosφ*Math.cos(λ),y0=cosφ*Math.sin(λ),z0=Math.sin(φ),d3_geo_centroid.point=nextPoint,d3_geo_centroidPointXYZ(x0,y0,z0)}}function d3_geo_centroidLineEnd(){d3_geo_centroid.point=d3_geo_centroidPoint}function d3_geo_centroidRingStart(){function nextPoint(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians),x=cosφ*Math.cos(λ),y=cosφ*Math.sin(λ),z=Math.sin(φ),cx=y0*z-z0*y,cy=z0*x-x0*z,cz=x0*y-y0*x,m=Math.sqrt(cx*cx+cy*cy+cz*cz),u=x0*x+y0*y+z0*z,v=m&&-d3_acos(u)/m,w=Math.atan2(m,u);d3_geo_centroidX2+=v*cx,d3_geo_centroidY2+=v*cy,d3_geo_centroidZ2+=v*cz,d3_geo_centroidW1+=w,d3_geo_centroidX1+=w*(x0+(x0=x)),d3_geo_centroidY1+=w*(y0+(y0=y)),d3_geo_centroidZ1+=w*(z0+(z0=z)),d3_geo_centroidPointXYZ(x0,y0,z0)}var λ00,φ00,x0,y0,z0;d3_geo_centroid.point=function(λ,φ){λ00=λ,φ00=φ,d3_geo_centroid.point=nextPoint,λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians);x0=cosφ*Math.cos(λ),y0=cosφ*Math.sin(λ),z0=Math.sin(φ),d3_geo_centroidPointXYZ(x0,y0,z0)},d3_geo_centroid.lineEnd=function(){nextPoint(λ00,φ00),d3_geo_centroid.lineEnd=d3_geo_centroidLineEnd,d3_geo_centroid.point=d3_geo_centroidPoint}}function d3_geo_compose(a,b){function compose(x,y){return x=a(x,y),b(x[0],x[1])}return a.invert&&b.invert&&(compose.invert=function(x,y){return x=b.invert(x,y),x&&a.invert(x[0],x[1])}),compose}function d3_true(){return!0}function d3_geo_clipPolygon(segments,compare,clipStartInside,interpolate,listener){var subject=[],clip=[];if(segments.forEach(function(segment){if(!((n=segment.length-1)<=0)){var n,p0=segment[0],p1=segment[n];if(d3_geo_sphericalEqual(p0,p1)){listener.lineStart();for(var i=0;n>i;++i)listener.point((p0=segment[i])[0],p0[1]);return void listener.lineEnd()}var a=new d3_geo_clipPolygonIntersection(p0,segment,null,!0),b=new d3_geo_clipPolygonIntersection(p0,null,a,!1);a.o=b,subject.push(a),clip.push(b),a=new d3_geo_clipPolygonIntersection(p1,segment,null,!1),b=new d3_geo_clipPolygonIntersection(p1,null,a,!0),a.o=b,subject.push(a),clip.push(b)}}),clip.sort(compare),d3_geo_clipPolygonLinkCircular(subject),d3_geo_clipPolygonLinkCircular(clip),subject.length){for(var i=0,entry=clipStartInside,n=clip.length;n>i;++i)clip[i].e=entry=!entry;for(var points,point,start=subject[0];;){for(var current=start,isSubject=!0;current.v;)if((current=current.n)===start)return;points=current.z,listener.lineStart();do{if(current.v=current.o.v=!0,current.e){if(isSubject)for(var i=0,n=points.length;n>i;++i)listener.point((point=points[i])[0],point[1]);else interpolate(current.x,current.n.x,1,listener);current=current.n}else{if(isSubject){points=current.p.z;for(var i=points.length-1;i>=0;--i)listener.point((point=points[i])[0],point[1])}else interpolate(current.x,current.p.x,-1,listener);current=current.p}current=current.o,points=current.z,isSubject=!isSubject}while(!current.v);listener.lineEnd()}}}function d3_geo_clipPolygonLinkCircular(array){if(n=array.length){for(var n,b,i=0,a=array[0];++i<n;)a.n=b=array[i],b.p=a,a=b;a.n=b=array[0],b.p=a}}function d3_geo_clipPolygonIntersection(point,points,other,entry){this.x=point,this.z=points,this.o=other,this.e=entry,this.v=!1,this.n=this.p=null}function d3_geo_clip(pointVisible,clipLine,interpolate,clipStart){return function(rotate,listener){function point(λ,φ){var point=rotate(λ,φ);pointVisible(λ=point[0],φ=point[1])&&listener.point(λ,φ)}function pointLine(λ,φ){var point=rotate(λ,φ);line.point(point[0],point[1])}function lineStart(){clip.point=pointLine,line.lineStart()}function lineEnd(){clip.point=point,line.lineEnd()}function pointRing(λ,φ){ring.push([λ,φ]);var point=rotate(λ,φ);ringListener.point(point[0],point[1])}function ringStart(){ringListener.lineStart(),ring=[]}function ringEnd(){pointRing(ring[0][0],ring[0][1]),ringListener.lineEnd();var segment,clean=ringListener.clean(),ringSegments=buffer.buffer(),n=ringSegments.length;if(ring.pop(),polygon.push(ring),ring=null,n)if(1&clean){segment=ringSegments[0];var point,n=segment.length-1,i=-1;if(n>0){for(polygonStarted||(listener.polygonStart(),polygonStarted=!0),listener.lineStart();++i<n;)listener.point((point=segment[i])[0],point[1]);listener.lineEnd()}}else n>1&&2&clean&&ringSegments.push(ringSegments.pop().concat(ringSegments.shift())),segments.push(ringSegments.filter(d3_geo_clipSegmentLength1))}var segments,polygon,ring,line=clipLine(listener),rotatedClipStart=rotate.invert(clipStart[0],clipStart[1]),clip={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){clip.point=pointRing,clip.lineStart=ringStart,clip.lineEnd=ringEnd,segments=[],polygon=[]},polygonEnd:function(){clip.point=point,clip.lineStart=lineStart,clip.lineEnd=lineEnd,segments=d3.merge(segments);var clipStartInside=d3_geo_pointInPolygon(rotatedClipStart,polygon);segments.length?(polygonStarted||(listener.polygonStart(),polygonStarted=!0),d3_geo_clipPolygon(segments,d3_geo_clipSort,clipStartInside,interpolate,listener)):clipStartInside&&(polygonStarted||(listener.polygonStart(),polygonStarted=!0),listener.lineStart(),interpolate(null,null,1,listener),listener.lineEnd()),polygonStarted&&(listener.polygonEnd(),polygonStarted=!1),segments=polygon=null},sphere:function(){listener.polygonStart(),listener.lineStart(),interpolate(null,null,1,listener),listener.lineEnd(),listener.polygonEnd()}},buffer=d3_geo_clipBufferListener(),ringListener=clipLine(buffer),polygonStarted=!1;return clip}}function d3_geo_clipSegmentLength1(segment){return segment.length>1}function d3_geo_clipBufferListener(){var line,lines=[];return{lineStart:function(){lines.push(line=[])},point:function(λ,φ){line.push([λ,φ])},lineEnd:d3_noop,buffer:function(){var buffer=lines;return lines=[],line=null,buffer},rejoin:function(){lines.length>1&&lines.push(lines.pop().concat(lines.shift()))}}}function d3_geo_clipSort(a,b){return((a=a.x)[0]<0?a[1]-halfπ-ε:halfπ-a[1])-((b=b.x)[0]<0?b[1]-halfπ-ε:halfπ-b[1])}function d3_geo_clipAntimeridianLine(listener){var clean,λ0=0/0,φ0=0/0,sλ0=0/0;return{lineStart:function(){listener.lineStart(),clean=1},point:function(λ1,φ1){var sλ1=λ1>0?π:-π,dλ=abs(λ1-λ0);abs(dλ-π)<ε?(listener.point(λ0,φ0=(φ0+φ1)/2>0?halfπ:-halfπ),listener.point(sλ0,φ0),listener.lineEnd(),listener.lineStart(),listener.point(sλ1,φ0),listener.point(λ1,φ0),clean=0):sλ0!==sλ1&&dλ>=π&&(abs(λ0-sλ0)<ε&&(λ0-=sλ0*ε),abs(λ1-sλ1)<ε&&(λ1-=sλ1*ε),φ0=d3_geo_clipAntimeridianIntersect(λ0,φ0,λ1,φ1),listener.point(sλ0,φ0),listener.lineEnd(),listener.lineStart(),listener.point(sλ1,φ0),clean=0),listener.point(λ0=λ1,φ0=φ1),sλ0=sλ1},lineEnd:function(){listener.lineEnd(),λ0=φ0=0/0},clean:function(){return 2-clean}}}function d3_geo_clipAntimeridianIntersect(λ0,φ0,λ1,φ1){var cosφ0,cosφ1,sinλ0_λ1=Math.sin(λ0-λ1);return abs(sinλ0_λ1)>ε?Math.atan((Math.sin(φ0)*(cosφ1=Math.cos(φ1))*Math.sin(λ1)-Math.sin(φ1)*(cosφ0=Math.cos(φ0))*Math.sin(λ0))/(cosφ0*cosφ1*sinλ0_λ1)):(φ0+φ1)/2}function d3_geo_clipAntimeridianInterpolate(from,to,direction,listener){var φ;if(null==from)φ=direction*halfπ,listener.point(-π,φ),listener.point(0,φ),listener.point(π,φ),listener.point(π,0),listener.point(π,-φ),listener.point(0,-φ),listener.point(-π,-φ),listener.point(-π,0),listener.point(-π,φ);else if(abs(from[0]-to[0])>ε){var s=from[0]<to[0]?π:-π;φ=direction*s/2,listener.point(-s,φ),listener.point(0,φ),listener.point(s,φ)}else listener.point(to[0],to[1])}function d3_geo_pointInPolygon(point,polygon){var meridian=point[0],parallel=point[1],meridianNormal=[Math.sin(meridian),-Math.cos(meridian),0],polarAngle=0,winding=0;d3_geo_areaRingSum.reset();for(var i=0,n=polygon.length;n>i;++i){var ring=polygon[i],m=ring.length;if(m)for(var point0=ring[0],λ0=point0[0],φ0=point0[1]/2+π/4,sinφ0=Math.sin(φ0),cosφ0=Math.cos(φ0),j=1;;){j===m&&(j=0),point=ring[j];var λ=point[0],φ=point[1]/2+π/4,sinφ=Math.sin(φ),cosφ=Math.cos(φ),dλ=λ-λ0,sdλ=dλ>=0?1:-1,adλ=sdλ*dλ,antimeridian=adλ>π,k=sinφ0*sinφ;if(d3_geo_areaRingSum.add(Math.atan2(k*sdλ*Math.sin(adλ),cosφ0*cosφ+k*Math.cos(adλ))),polarAngle+=antimeridian?dλ+sdλ*τ:dλ,antimeridian^λ0>=meridian^λ>=meridian){var arc=d3_geo_cartesianCross(d3_geo_cartesian(point0),d3_geo_cartesian(point));d3_geo_cartesianNormalize(arc);var intersection=d3_geo_cartesianCross(meridianNormal,arc);d3_geo_cartesianNormalize(intersection);var φarc=(antimeridian^dλ>=0?-1:1)*d3_asin(intersection[2]);(parallel>φarc||parallel===φarc&&(arc[0]||arc[1]))&&(winding+=antimeridian^dλ>=0?1:-1)}if(!j++)break;λ0=λ,sinφ0=sinφ,cosφ0=cosφ,point0=point}}return(-ε>polarAngle||ε>polarAngle&&0>d3_geo_areaRingSum)^1&winding}function d3_geo_clipCircle(radius){function visible(λ,φ){return Math.cos(λ)*Math.cos(φ)>cr}function clipLine(listener){var point0,c0,v0,v00,clean;return{lineStart:function(){v00=v0=!1,clean=1},point:function(λ,φ){var point2,point1=[λ,φ],v=visible(λ,φ),c=smallRadius?v?0:code(λ,φ):v?code(λ+(0>λ?π:-π),φ):0;if(!point0&&(v00=v0=v)&&listener.lineStart(),v!==v0&&(point2=intersect(point0,point1),(d3_geo_sphericalEqual(point0,point2)||d3_geo_sphericalEqual(point1,point2))&&(point1[0]+=ε,point1[1]+=ε,v=visible(point1[0],point1[1]))),v!==v0)clean=0,v?(listener.lineStart(),point2=intersect(point1,point0),listener.point(point2[0],point2[1])):(point2=intersect(point0,point1),listener.point(point2[0],point2[1]),listener.lineEnd()),point0=point2;else if(notHemisphere&&point0&&smallRadius^v){var t;c&c0||!(t=intersect(point1,point0,!0))||(clean=0,smallRadius?(listener.lineStart(),listener.point(t[0][0],t[0][1]),listener.point(t[1][0],t[1][1]),listener.lineEnd()):(listener.point(t[1][0],t[1][1]),listener.lineEnd(),listener.lineStart(),listener.point(t[0][0],t[0][1])))}!v||point0&&d3_geo_sphericalEqual(point0,point1)||listener.point(point1[0],point1[1]),point0=point1,v0=v,c0=c},lineEnd:function(){v0&&listener.lineEnd(),point0=null},clean:function(){return clean|(v00&&v0)<<1}}}function intersect(a,b,two){var pa=d3_geo_cartesian(a),pb=d3_geo_cartesian(b),n1=[1,0,0],n2=d3_geo_cartesianCross(pa,pb),n2n2=d3_geo_cartesianDot(n2,n2),n1n2=n2[0],determinant=n2n2-n1n2*n1n2;if(!determinant)return!two&&a;var c1=cr*n2n2/determinant,c2=-cr*n1n2/determinant,n1xn2=d3_geo_cartesianCross(n1,n2),A=d3_geo_cartesianScale(n1,c1),B=d3_geo_cartesianScale(n2,c2);d3_geo_cartesianAdd(A,B);var u=n1xn2,w=d3_geo_cartesianDot(A,u),uu=d3_geo_cartesianDot(u,u),t2=w*w-uu*(d3_geo_cartesianDot(A,A)-1);if(!(0>t2)){var t=Math.sqrt(t2),q=d3_geo_cartesianScale(u,(-w-t)/uu);if(d3_geo_cartesianAdd(q,A),q=d3_geo_spherical(q),!two)return q;var z,λ0=a[0],λ1=b[0],φ0=a[1],φ1=b[1];λ0>λ1&&(z=λ0,λ0=λ1,λ1=z);var δλ=λ1-λ0,polar=abs(δλ-π)<ε,meridian=polar||ε>δλ;if(!polar&&φ0>φ1&&(z=φ0,φ0=φ1,φ1=z),meridian?polar?φ0+φ1>0^q[1]<(abs(q[0]-λ0)<ε?φ0:φ1):φ0<=q[1]&&q[1]<=φ1:δλ>π^(λ0<=q[0]&&q[0]<=λ1)){var q1=d3_geo_cartesianScale(u,(-w+t)/uu);return d3_geo_cartesianAdd(q1,A),[q,d3_geo_spherical(q1)]}}}function code(λ,φ){var r=smallRadius?radius:π-radius,code=0;return-r>λ?code|=1:λ>r&&(code|=2),-r>φ?code|=4:φ>r&&(code|=8),code}var cr=Math.cos(radius),smallRadius=cr>0,notHemisphere=abs(cr)>ε,interpolate=d3_geo_circleInterpolate(radius,6*d3_radians);return d3_geo_clip(visible,clipLine,interpolate,smallRadius?[0,-radius]:[-π,radius-π])}function d3_geom_clipLine(x0,y0,x1,y1){return function(line){var r,a=line.a,b=line.b,ax=a.x,ay=a.y,bx=b.x,by=b.y,t0=0,t1=1,dx=bx-ax,dy=by-ay;if(r=x0-ax,dx||!(r>0)){if(r/=dx,0>dx){if(t0>r)return;t1>r&&(t1=r)}else if(dx>0){if(r>t1)return;r>t0&&(t0=r)}if(r=x1-ax,dx||!(0>r)){if(r/=dx,0>dx){if(r>t1)return;r>t0&&(t0=r)}else if(dx>0){if(t0>r)return;t1>r&&(t1=r)}if(r=y0-ay,dy||!(r>0)){if(r/=dy,0>dy){if(t0>r)return;t1>r&&(t1=r)}else if(dy>0){if(r>t1)return;r>t0&&(t0=r)}if(r=y1-ay,dy||!(0>r)){if(r/=dy,0>dy){if(r>t1)return;r>t0&&(t0=r)}else if(dy>0){if(t0>r)return;t1>r&&(t1=r)}return t0>0&&(line.a={x:ax+t0*dx,y:ay+t0*dy}),1>t1&&(line.b={x:ax+t1*dx,y:ay+t1*dy}),line}}}}}}function d3_geo_clipExtent(x0,y0,x1,y1){function corner(p,direction){return abs(p[0]-x0)<ε?direction>0?0:3:abs(p[0]-x1)<ε?direction>0?2:1:abs(p[1]-y0)<ε?direction>0?1:0:direction>0?3:2}function compare(a,b){return comparePoints(a.x,b.x)}function comparePoints(a,b){var ca=corner(a,1),cb=corner(b,1);return ca!==cb?ca-cb:0===ca?b[1]-a[1]:1===ca?a[0]-b[0]:2===ca?a[1]-b[1]:b[0]-a[0]}return function(listener){function insidePolygon(p){for(var wn=0,n=polygon.length,y=p[1],i=0;n>i;++i)for(var b,j=1,v=polygon[i],m=v.length,a=v[0];m>j;++j)b=v[j],a[1]<=y?b[1]>y&&d3_cross2d(a,b,p)>0&&++wn:b[1]<=y&&d3_cross2d(a,b,p)<0&&--wn,a=b;return 0!==wn}function interpolate(from,to,direction,listener){var a=0,a1=0;if(null==from||(a=corner(from,direction))!==(a1=corner(to,direction))||comparePoints(from,to)<0^direction>0){do listener.point(0===a||3===a?x0:x1,a>1?y1:y0);while((a=(a+direction+4)%4)!==a1)}else listener.point(to[0],to[1])}function pointVisible(x,y){return x>=x0&&x1>=x&&y>=y0&&y1>=y}function point(x,y){pointVisible(x,y)&&listener.point(x,y)}function lineStart(){clip.point=linePoint,polygon&&polygon.push(ring=[]),first=!0,v_=!1,x_=y_=0/0}function lineEnd(){segments&&(linePoint(x__,y__),v__&&v_&&bufferListener.rejoin(),segments.push(bufferListener.buffer())),clip.point=point,v_&&listener.lineEnd()}function linePoint(x,y){x=Math.max(-d3_geo_clipExtentMAX,Math.min(d3_geo_clipExtentMAX,x)),y=Math.max(-d3_geo_clipExtentMAX,Math.min(d3_geo_clipExtentMAX,y));var v=pointVisible(x,y);if(polygon&&ring.push([x,y]),first)x__=x,y__=y,v__=v,first=!1,v&&(listener.lineStart(),listener.point(x,y));else if(v&&v_)listener.point(x,y);else{var l={a:{x:x_,y:y_},b:{x:x,y:y}};clipLine(l)?(v_||(listener.lineStart(),listener.point(l.a.x,l.a.y)),listener.point(l.b.x,l.b.y),v||listener.lineEnd(),clean=!1):v&&(listener.lineStart(),listener.point(x,y),clean=!1)}x_=x,y_=y,v_=v}var segments,polygon,ring,x__,y__,v__,x_,y_,v_,first,clean,listener_=listener,bufferListener=d3_geo_clipBufferListener(),clipLine=d3_geom_clipLine(x0,y0,x1,y1),clip={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){listener=bufferListener,segments=[],polygon=[],clean=!0},polygonEnd:function(){listener=listener_,segments=d3.merge(segments);var clipStartInside=insidePolygon([x0,y1]),inside=clean&&clipStartInside,visible=segments.length;(inside||visible)&&(listener.polygonStart(),inside&&(listener.lineStart(),interpolate(null,null,1,listener),listener.lineEnd()),visible&&d3_geo_clipPolygon(segments,compare,clipStartInside,interpolate,listener),listener.polygonEnd()),segments=polygon=ring=null}};return clip}}function d3_geo_conic(projectAt){var φ0=0,φ1=π/3,m=d3_geo_projectionMutator(projectAt),p=m(φ0,φ1);return p.parallels=function(_){return arguments.length?m(φ0=_[0]*π/180,φ1=_[1]*π/180):[φ0/π*180,φ1/π*180]},p}function d3_geo_conicEqualArea(φ0,φ1){function forward(λ,φ){var ρ=Math.sqrt(C-2*n*Math.sin(φ))/n;return[ρ*Math.sin(λ*=n),ρ0-ρ*Math.cos(λ)]}var sinφ0=Math.sin(φ0),n=(sinφ0+Math.sin(φ1))/2,C=1+sinφ0*(2*n-sinφ0),ρ0=Math.sqrt(C)/n;return forward.invert=function(x,y){var ρ0_y=ρ0-y;return[Math.atan2(x,ρ0_y)/n,d3_asin((C-(x*x+ρ0_y*ρ0_y)*n*n)/(2*n))]},forward}function d3_geo_pathAreaRingStart(){function nextPoint(x,y){d3_geo_pathAreaPolygon+=y0*x-x0*y,x0=x,y0=y}var x00,y00,x0,y0;d3_geo_pathArea.point=function(x,y){d3_geo_pathArea.point=nextPoint,x00=x0=x,y00=y0=y},d3_geo_pathArea.lineEnd=function(){nextPoint(x00,y00)}}function d3_geo_pathBoundsPoint(x,y){d3_geo_pathBoundsX0>x&&(d3_geo_pathBoundsX0=x),x>d3_geo_pathBoundsX1&&(d3_geo_pathBoundsX1=x),d3_geo_pathBoundsY0>y&&(d3_geo_pathBoundsY0=y),y>d3_geo_pathBoundsY1&&(d3_geo_pathBoundsY1=y)}function d3_geo_pathBuffer(){function point(x,y){buffer.push("M",x,",",y,pointCircle)}function pointLineStart(x,y){buffer.push("M",x,",",y),stream.point=pointLine}function pointLine(x,y){buffer.push("L",x,",",y)}function lineEnd(){stream.point=point}function lineEndPolygon(){buffer.push("Z")}var pointCircle=d3_geo_pathBufferCircle(4.5),buffer=[],stream={point:point,lineStart:function(){stream.point=pointLineStart},lineEnd:lineEnd,polygonStart:function(){stream.lineEnd=lineEndPolygon},polygonEnd:function(){stream.lineEnd=lineEnd,stream.point=point},pointRadius:function(_){return pointCircle=d3_geo_pathBufferCircle(_),stream},result:function(){if(buffer.length){var result=buffer.join("");return buffer=[],result}}};return stream}function d3_geo_pathBufferCircle(radius){return"m0,"+radius+"a"+radius+","+radius+" 0 1,1 0,"+-2*radius+"a"+radius+","+radius+" 0 1,1 0,"+2*radius+"z"}function d3_geo_pathCentroidPoint(x,y){d3_geo_centroidX0+=x,d3_geo_centroidY0+=y,++d3_geo_centroidZ0}function d3_geo_pathCentroidLineStart(){function nextPoint(x,y){var dx=x-x0,dy=y-y0,z=Math.sqrt(dx*dx+dy*dy);d3_geo_centroidX1+=z*(x0+x)/2,d3_geo_centroidY1+=z*(y0+y)/2,d3_geo_centroidZ1+=z,d3_geo_pathCentroidPoint(x0=x,y0=y)}var x0,y0;d3_geo_pathCentroid.point=function(x,y){d3_geo_pathCentroid.point=nextPoint,d3_geo_pathCentroidPoint(x0=x,y0=y)}}function d3_geo_pathCentroidLineEnd(){d3_geo_pathCentroid.point=d3_geo_pathCentroidPoint}function d3_geo_pathCentroidRingStart(){function nextPoint(x,y){var dx=x-x0,dy=y-y0,z=Math.sqrt(dx*dx+dy*dy);d3_geo_centroidX1+=z*(x0+x)/2,d3_geo_centroidY1+=z*(y0+y)/2,d3_geo_centroidZ1+=z,z=y0*x-x0*y,d3_geo_centroidX2+=z*(x0+x),d3_geo_centroidY2+=z*(y0+y),d3_geo_centroidZ2+=3*z,d3_geo_pathCentroidPoint(x0=x,y0=y)}var x00,y00,x0,y0;d3_geo_pathCentroid.point=function(x,y){d3_geo_pathCentroid.point=nextPoint,d3_geo_pathCentroidPoint(x00=x0=x,y00=y0=y)},d3_geo_pathCentroid.lineEnd=function(){nextPoint(x00,y00)}}function d3_geo_pathContext(context){function point(x,y){context.moveTo(x+pointRadius,y),context.arc(x,y,pointRadius,0,τ)}function pointLineStart(x,y){context.moveTo(x,y),stream.point=pointLine}function pointLine(x,y){context.lineTo(x,y)}function lineEnd(){stream.point=point}function lineEndPolygon(){context.closePath()}var pointRadius=4.5,stream={point:point,lineStart:function(){stream.point=pointLineStart},lineEnd:lineEnd,polygonStart:function(){stream.lineEnd=lineEndPolygon},polygonEnd:function(){stream.lineEnd=lineEnd,stream.point=point},pointRadius:function(_){return pointRadius=_,stream},result:d3_noop};return stream}function d3_geo_resample(project){function resample(stream){return(maxDepth?resampleRecursive:resampleNone)(stream)}function resampleNone(stream){return d3_geo_transformPoint(stream,function(x,y){x=project(x,y),stream.point(x[0],x[1])})}function resampleRecursive(stream){function point(x,y){x=project(x,y),stream.point(x[0],x[1])}function lineStart(){x0=0/0,resample.point=linePoint,stream.lineStart()}function linePoint(λ,φ){var c=d3_geo_cartesian([λ,φ]),p=project(λ,φ);resampleLineTo(x0,y0,λ0,a0,b0,c0,x0=p[0],y0=p[1],λ0=λ,a0=c[0],b0=c[1],c0=c[2],maxDepth,stream),stream.point(x0,y0)}function lineEnd(){resample.point=point,stream.lineEnd()}function ringStart(){lineStart(),resample.point=ringPoint,resample.lineEnd=ringEnd}function ringPoint(λ,φ){linePoint(λ00=λ,φ00=φ),x00=x0,y00=y0,a00=a0,b00=b0,c00=c0,resample.point=linePoint}function ringEnd(){resampleLineTo(x0,y0,λ0,a0,b0,c0,x00,y00,λ00,a00,b00,c00,maxDepth,stream),resample.lineEnd=lineEnd,lineEnd()}var λ00,φ00,x00,y00,a00,b00,c00,λ0,x0,y0,a0,b0,c0,resample={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){stream.polygonStart(),resample.lineStart=ringStart},polygonEnd:function(){stream.polygonEnd(),resample.lineStart=lineStart}};return resample}function resampleLineTo(x0,y0,λ0,a0,b0,c0,x1,y1,λ1,a1,b1,c1,depth,stream){var dx=x1-x0,dy=y1-y0,d2=dx*dx+dy*dy;
if(d2>4*δ2&&depth--){var a=a0+a1,b=b0+b1,c=c0+c1,m=Math.sqrt(a*a+b*b+c*c),φ2=Math.asin(c/=m),λ2=abs(abs(c)-1)<ε||abs(λ0-λ1)<ε?(λ0+λ1)/2:Math.atan2(b,a),p=project(λ2,φ2),x2=p[0],y2=p[1],dx2=x2-x0,dy2=y2-y0,dz=dy*dx2-dx*dy2;(dz*dz/d2>δ2||abs((dx*dx2+dy*dy2)/d2-.5)>.3||cosMinDistance>a0*a1+b0*b1+c0*c1)&&(resampleLineTo(x0,y0,λ0,a0,b0,c0,x2,y2,λ2,a/=m,b/=m,c,depth,stream),stream.point(x2,y2),resampleLineTo(x2,y2,λ2,a,b,c,x1,y1,λ1,a1,b1,c1,depth,stream))}}var δ2=.5,cosMinDistance=Math.cos(30*d3_radians),maxDepth=16;return resample.precision=function(_){return arguments.length?(maxDepth=(δ2=_*_)>0&&16,resample):Math.sqrt(δ2)},resample}function d3_geo_pathProjectStream(project){var resample=d3_geo_resample(function(x,y){return project([x*d3_degrees,y*d3_degrees])});return function(stream){return d3_geo_projectionRadians(resample(stream))}}function d3_geo_transform(stream){this.stream=stream}function d3_geo_transformPoint(stream,point){return{point:point,sphere:function(){stream.sphere()},lineStart:function(){stream.lineStart()},lineEnd:function(){stream.lineEnd()},polygonStart:function(){stream.polygonStart()},polygonEnd:function(){stream.polygonEnd()}}}function d3_geo_projection(project){return d3_geo_projectionMutator(function(){return project})()}function d3_geo_projectionMutator(projectAt){function projection(point){return point=projectRotate(point[0]*d3_radians,point[1]*d3_radians),[point[0]*k+δx,δy-point[1]*k]}function invert(point){return point=projectRotate.invert((point[0]-δx)/k,(δy-point[1])/k),point&&[point[0]*d3_degrees,point[1]*d3_degrees]}function reset(){projectRotate=d3_geo_compose(rotate=d3_geo_rotation(δλ,δφ,δγ),project);var center=project(λ,φ);return δx=x-center[0]*k,δy=y+center[1]*k,invalidate()}function invalidate(){return stream&&(stream.valid=!1,stream=null),projection}var project,rotate,projectRotate,δx,δy,stream,projectResample=d3_geo_resample(function(x,y){return x=project(x,y),[x[0]*k+δx,δy-x[1]*k]}),k=150,x=480,y=250,λ=0,φ=0,δλ=0,δφ=0,δγ=0,preclip=d3_geo_clipAntimeridian,postclip=d3_identity,clipAngle=null,clipExtent=null;return projection.stream=function(output){return stream&&(stream.valid=!1),stream=d3_geo_projectionRadians(preclip(rotate,projectResample(postclip(output)))),stream.valid=!0,stream},projection.clipAngle=function(_){return arguments.length?(preclip=null==_?(clipAngle=_,d3_geo_clipAntimeridian):d3_geo_clipCircle((clipAngle=+_)*d3_radians),invalidate()):clipAngle},projection.clipExtent=function(_){return arguments.length?(clipExtent=_,postclip=_?d3_geo_clipExtent(_[0][0],_[0][1],_[1][0],_[1][1]):d3_identity,invalidate()):clipExtent},projection.scale=function(_){return arguments.length?(k=+_,reset()):k},projection.translate=function(_){return arguments.length?(x=+_[0],y=+_[1],reset()):[x,y]},projection.center=function(_){return arguments.length?(λ=_[0]%360*d3_radians,φ=_[1]%360*d3_radians,reset()):[λ*d3_degrees,φ*d3_degrees]},projection.rotate=function(_){return arguments.length?(δλ=_[0]%360*d3_radians,δφ=_[1]%360*d3_radians,δγ=_.length>2?_[2]%360*d3_radians:0,reset()):[δλ*d3_degrees,δφ*d3_degrees,δγ*d3_degrees]},d3.rebind(projection,projectResample,"precision"),function(){return project=projectAt.apply(this,arguments),projection.invert=project.invert&&invert,reset()}}function d3_geo_projectionRadians(stream){return d3_geo_transformPoint(stream,function(x,y){stream.point(x*d3_radians,y*d3_radians)})}function d3_geo_equirectangular(λ,φ){return[λ,φ]}function d3_geo_identityRotation(λ,φ){return[λ>π?λ-τ:-π>λ?λ+τ:λ,φ]}function d3_geo_rotation(δλ,δφ,δγ){return δλ?δφ||δγ?d3_geo_compose(d3_geo_rotationλ(δλ),d3_geo_rotationφγ(δφ,δγ)):d3_geo_rotationλ(δλ):δφ||δγ?d3_geo_rotationφγ(δφ,δγ):d3_geo_identityRotation}function d3_geo_forwardRotationλ(δλ){return function(λ,φ){return λ+=δλ,[λ>π?λ-τ:-π>λ?λ+τ:λ,φ]}}function d3_geo_rotationλ(δλ){var rotation=d3_geo_forwardRotationλ(δλ);return rotation.invert=d3_geo_forwardRotationλ(-δλ),rotation}function d3_geo_rotationφγ(δφ,δγ){function rotation(λ,φ){var cosφ=Math.cos(φ),x=Math.cos(λ)*cosφ,y=Math.sin(λ)*cosφ,z=Math.sin(φ),k=z*cosδφ+x*sinδφ;return[Math.atan2(y*cosδγ-k*sinδγ,x*cosδφ-z*sinδφ),d3_asin(k*cosδγ+y*sinδγ)]}var cosδφ=Math.cos(δφ),sinδφ=Math.sin(δφ),cosδγ=Math.cos(δγ),sinδγ=Math.sin(δγ);return rotation.invert=function(λ,φ){var cosφ=Math.cos(φ),x=Math.cos(λ)*cosφ,y=Math.sin(λ)*cosφ,z=Math.sin(φ),k=z*cosδγ-y*sinδγ;return[Math.atan2(y*cosδγ+z*sinδγ,x*cosδφ+k*sinδφ),d3_asin(k*cosδφ-x*sinδφ)]},rotation}function d3_geo_circleInterpolate(radius,precision){var cr=Math.cos(radius),sr=Math.sin(radius);return function(from,to,direction,listener){var step=direction*precision;null!=from?(from=d3_geo_circleAngle(cr,from),to=d3_geo_circleAngle(cr,to),(direction>0?to>from:from>to)&&(from+=direction*τ)):(from=radius+direction*τ,to=radius-.5*step);for(var point,t=from;direction>0?t>to:to>t;t-=step)listener.point((point=d3_geo_spherical([cr,-sr*Math.cos(t),-sr*Math.sin(t)]))[0],point[1])}}function d3_geo_circleAngle(cr,point){var a=d3_geo_cartesian(point);a[0]-=cr,d3_geo_cartesianNormalize(a);var angle=d3_acos(-a[1]);return((-a[2]<0?-angle:angle)+2*Math.PI-ε)%(2*Math.PI)}function d3_geo_graticuleX(y0,y1,dy){var y=d3.range(y0,y1-ε,dy).concat(y1);return function(x){return y.map(function(y){return[x,y]})}}function d3_geo_graticuleY(x0,x1,dx){var x=d3.range(x0,x1-ε,dx).concat(x1);return function(y){return x.map(function(x){return[x,y]})}}function d3_source(d){return d.source}function d3_target(d){return d.target}function d3_geo_interpolate(x0,y0,x1,y1){var cy0=Math.cos(y0),sy0=Math.sin(y0),cy1=Math.cos(y1),sy1=Math.sin(y1),kx0=cy0*Math.cos(x0),ky0=cy0*Math.sin(x0),kx1=cy1*Math.cos(x1),ky1=cy1*Math.sin(x1),d=2*Math.asin(Math.sqrt(d3_haversin(y1-y0)+cy0*cy1*d3_haversin(x1-x0))),k=1/Math.sin(d),interpolate=d?function(t){var B=Math.sin(t*=d)*k,A=Math.sin(d-t)*k,x=A*kx0+B*kx1,y=A*ky0+B*ky1,z=A*sy0+B*sy1;return[Math.atan2(y,x)*d3_degrees,Math.atan2(z,Math.sqrt(x*x+y*y))*d3_degrees]}:function(){return[x0*d3_degrees,y0*d3_degrees]};return interpolate.distance=d,interpolate}function d3_geo_lengthLineStart(){function nextPoint(λ,φ){var sinφ=Math.sin(φ*=d3_radians),cosφ=Math.cos(φ),t=abs((λ*=d3_radians)-λ0),cosΔλ=Math.cos(t);d3_geo_lengthSum+=Math.atan2(Math.sqrt((t=cosφ*Math.sin(t))*t+(t=cosφ0*sinφ-sinφ0*cosφ*cosΔλ)*t),sinφ0*sinφ+cosφ0*cosφ*cosΔλ),λ0=λ,sinφ0=sinφ,cosφ0=cosφ}var λ0,sinφ0,cosφ0;d3_geo_length.point=function(λ,φ){λ0=λ*d3_radians,sinφ0=Math.sin(φ*=d3_radians),cosφ0=Math.cos(φ),d3_geo_length.point=nextPoint},d3_geo_length.lineEnd=function(){d3_geo_length.point=d3_geo_length.lineEnd=d3_noop}}function d3_geo_azimuthal(scale,angle){function azimuthal(λ,φ){var cosλ=Math.cos(λ),cosφ=Math.cos(φ),k=scale(cosλ*cosφ);return[k*cosφ*Math.sin(λ),k*Math.sin(φ)]}return azimuthal.invert=function(x,y){var ρ=Math.sqrt(x*x+y*y),c=angle(ρ),sinc=Math.sin(c),cosc=Math.cos(c);return[Math.atan2(x*sinc,ρ*cosc),Math.asin(ρ&&y*sinc/ρ)]},azimuthal}function d3_geo_conicConformal(φ0,φ1){function forward(λ,φ){F>0?-halfπ+ε>φ&&(φ=-halfπ+ε):φ>halfπ-ε&&(φ=halfπ-ε);var ρ=F/Math.pow(t(φ),n);return[ρ*Math.sin(n*λ),F-ρ*Math.cos(n*λ)]}var cosφ0=Math.cos(φ0),t=function(φ){return Math.tan(π/4+φ/2)},n=φ0===φ1?Math.sin(φ0):Math.log(cosφ0/Math.cos(φ1))/Math.log(t(φ1)/t(φ0)),F=cosφ0*Math.pow(t(φ0),n)/n;return n?(forward.invert=function(x,y){var ρ0_y=F-y,ρ=d3_sgn(n)*Math.sqrt(x*x+ρ0_y*ρ0_y);return[Math.atan2(x,ρ0_y)/n,2*Math.atan(Math.pow(F/ρ,1/n))-halfπ]},forward):d3_geo_mercator}function d3_geo_conicEquidistant(φ0,φ1){function forward(λ,φ){var ρ=G-φ;return[ρ*Math.sin(n*λ),G-ρ*Math.cos(n*λ)]}var cosφ0=Math.cos(φ0),n=φ0===φ1?Math.sin(φ0):(cosφ0-Math.cos(φ1))/(φ1-φ0),G=cosφ0/n+φ0;return abs(n)<ε?d3_geo_equirectangular:(forward.invert=function(x,y){var ρ0_y=G-y;return[Math.atan2(x,ρ0_y)/n,G-d3_sgn(n)*Math.sqrt(x*x+ρ0_y*ρ0_y)]},forward)}function d3_geo_mercator(λ,φ){return[λ,Math.log(Math.tan(π/4+φ/2))]}function d3_geo_mercatorProjection(project){var clipAuto,m=d3_geo_projection(project),scale=m.scale,translate=m.translate,clipExtent=m.clipExtent;return m.scale=function(){var v=scale.apply(m,arguments);return v===m?clipAuto?m.clipExtent(null):m:v},m.translate=function(){var v=translate.apply(m,arguments);return v===m?clipAuto?m.clipExtent(null):m:v},m.clipExtent=function(_){var v=clipExtent.apply(m,arguments);if(v===m){if(clipAuto=null==_){var k=π*scale(),t=translate();clipExtent([[t[0]-k,t[1]-k],[t[0]+k,t[1]+k]])}}else clipAuto&&(v=null);return v},m.clipExtent(null)}function d3_geo_transverseMercator(λ,φ){return[Math.log(Math.tan(π/4+φ/2)),-λ]}function d3_geom_pointX(d){return d[0]}function d3_geom_pointY(d){return d[1]}function d3_geom_hullUpper(points){for(var n=points.length,hull=[0,1],hs=2,i=2;n>i;i++){for(;hs>1&&d3_cross2d(points[hull[hs-2]],points[hull[hs-1]],points[i])<=0;)--hs;hull[hs++]=i}return hull.slice(0,hs)}function d3_geom_hullOrder(a,b){return a[0]-b[0]||a[1]-b[1]}function d3_geom_polygonInside(p,a,b){return(b[0]-a[0])*(p[1]-a[1])<(b[1]-a[1])*(p[0]-a[0])}function d3_geom_polygonIntersect(c,d,a,b){var x1=c[0],x3=a[0],x21=d[0]-x1,x43=b[0]-x3,y1=c[1],y3=a[1],y21=d[1]-y1,y43=b[1]-y3,ua=(x43*(y1-y3)-y43*(x1-x3))/(y43*x21-x43*y21);return[x1+ua*x21,y1+ua*y21]}function d3_geom_polygonClosed(coordinates){var a=coordinates[0],b=coordinates[coordinates.length-1];return!(a[0]-b[0]||a[1]-b[1])}function d3_geom_voronoiBeach(){d3_geom_voronoiRedBlackNode(this),this.edge=this.site=this.circle=null}function d3_geom_voronoiCreateBeach(site){var beach=d3_geom_voronoiBeachPool.pop()||new d3_geom_voronoiBeach;return beach.site=site,beach}function d3_geom_voronoiDetachBeach(beach){d3_geom_voronoiDetachCircle(beach),d3_geom_voronoiBeaches.remove(beach),d3_geom_voronoiBeachPool.push(beach),d3_geom_voronoiRedBlackNode(beach)}function d3_geom_voronoiRemoveBeach(beach){var circle=beach.circle,x=circle.x,y=circle.cy,vertex={x:x,y:y},previous=beach.P,next=beach.N,disappearing=[beach];d3_geom_voronoiDetachBeach(beach);for(var lArc=previous;lArc.circle&&abs(x-lArc.circle.x)<ε&&abs(y-lArc.circle.cy)<ε;)previous=lArc.P,disappearing.unshift(lArc),d3_geom_voronoiDetachBeach(lArc),lArc=previous;disappearing.unshift(lArc),d3_geom_voronoiDetachCircle(lArc);for(var rArc=next;rArc.circle&&abs(x-rArc.circle.x)<ε&&abs(y-rArc.circle.cy)<ε;)next=rArc.N,disappearing.push(rArc),d3_geom_voronoiDetachBeach(rArc),rArc=next;disappearing.push(rArc),d3_geom_voronoiDetachCircle(rArc);var iArc,nArcs=disappearing.length;for(iArc=1;nArcs>iArc;++iArc)rArc=disappearing[iArc],lArc=disappearing[iArc-1],d3_geom_voronoiSetEdgeEnd(rArc.edge,lArc.site,rArc.site,vertex);lArc=disappearing[0],rArc=disappearing[nArcs-1],rArc.edge=d3_geom_voronoiCreateEdge(lArc.site,rArc.site,null,vertex),d3_geom_voronoiAttachCircle(lArc),d3_geom_voronoiAttachCircle(rArc)}function d3_geom_voronoiAddBeach(site){for(var lArc,rArc,dxl,dxr,x=site.x,directrix=site.y,node=d3_geom_voronoiBeaches._;node;)if(dxl=d3_geom_voronoiLeftBreakPoint(node,directrix)-x,dxl>ε)node=node.L;else{if(dxr=x-d3_geom_voronoiRightBreakPoint(node,directrix),!(dxr>ε)){dxl>-ε?(lArc=node.P,rArc=node):dxr>-ε?(lArc=node,rArc=node.N):lArc=rArc=node;break}if(!node.R){lArc=node;break}node=node.R}var newArc=d3_geom_voronoiCreateBeach(site);if(d3_geom_voronoiBeaches.insert(lArc,newArc),lArc||rArc){if(lArc===rArc)return d3_geom_voronoiDetachCircle(lArc),rArc=d3_geom_voronoiCreateBeach(lArc.site),d3_geom_voronoiBeaches.insert(newArc,rArc),newArc.edge=rArc.edge=d3_geom_voronoiCreateEdge(lArc.site,newArc.site),d3_geom_voronoiAttachCircle(lArc),void d3_geom_voronoiAttachCircle(rArc);if(!rArc)return void(newArc.edge=d3_geom_voronoiCreateEdge(lArc.site,newArc.site));d3_geom_voronoiDetachCircle(lArc),d3_geom_voronoiDetachCircle(rArc);var lSite=lArc.site,ax=lSite.x,ay=lSite.y,bx=site.x-ax,by=site.y-ay,rSite=rArc.site,cx=rSite.x-ax,cy=rSite.y-ay,d=2*(bx*cy-by*cx),hb=bx*bx+by*by,hc=cx*cx+cy*cy,vertex={x:(cy*hb-by*hc)/d+ax,y:(bx*hc-cx*hb)/d+ay};d3_geom_voronoiSetEdgeEnd(rArc.edge,lSite,rSite,vertex),newArc.edge=d3_geom_voronoiCreateEdge(lSite,site,null,vertex),rArc.edge=d3_geom_voronoiCreateEdge(site,rSite,null,vertex),d3_geom_voronoiAttachCircle(lArc),d3_geom_voronoiAttachCircle(rArc)}}function d3_geom_voronoiLeftBreakPoint(arc,directrix){var site=arc.site,rfocx=site.x,rfocy=site.y,pby2=rfocy-directrix;if(!pby2)return rfocx;var lArc=arc.P;if(!lArc)return-1/0;site=lArc.site;var lfocx=site.x,lfocy=site.y,plby2=lfocy-directrix;if(!plby2)return lfocx;var hl=lfocx-rfocx,aby2=1/pby2-1/plby2,b=hl/plby2;return aby2?(-b+Math.sqrt(b*b-2*aby2*(hl*hl/(-2*plby2)-lfocy+plby2/2+rfocy-pby2/2)))/aby2+rfocx:(rfocx+lfocx)/2}function d3_geom_voronoiRightBreakPoint(arc,directrix){var rArc=arc.N;if(rArc)return d3_geom_voronoiLeftBreakPoint(rArc,directrix);var site=arc.site;return site.y===directrix?site.x:1/0}function d3_geom_voronoiCell(site){this.site=site,this.edges=[]}function d3_geom_voronoiCloseCells(extent){for(var x2,y2,x3,y3,cell,iHalfEdge,halfEdges,nHalfEdges,start,end,x0=extent[0][0],x1=extent[1][0],y0=extent[0][1],y1=extent[1][1],cells=d3_geom_voronoiCells,iCell=cells.length;iCell--;)if(cell=cells[iCell],cell&&cell.prepare())for(halfEdges=cell.edges,nHalfEdges=halfEdges.length,iHalfEdge=0;nHalfEdges>iHalfEdge;)end=halfEdges[iHalfEdge].end(),x3=end.x,y3=end.y,start=halfEdges[++iHalfEdge%nHalfEdges].start(),x2=start.x,y2=start.y,(abs(x3-x2)>ε||abs(y3-y2)>ε)&&(halfEdges.splice(iHalfEdge,0,new d3_geom_voronoiHalfEdge(d3_geom_voronoiCreateBorderEdge(cell.site,end,abs(x3-x0)<ε&&y1-y3>ε?{x:x0,y:abs(x2-x0)<ε?y2:y1}:abs(y3-y1)<ε&&x1-x3>ε?{x:abs(y2-y1)<ε?x2:x1,y:y1}:abs(x3-x1)<ε&&y3-y0>ε?{x:x1,y:abs(x2-x1)<ε?y2:y0}:abs(y3-y0)<ε&&x3-x0>ε?{x:abs(y2-y0)<ε?x2:x0,y:y0}:null),cell.site,null)),++nHalfEdges)}function d3_geom_voronoiHalfEdgeOrder(a,b){return b.angle-a.angle}function d3_geom_voronoiCircle(){d3_geom_voronoiRedBlackNode(this),this.x=this.y=this.arc=this.site=this.cy=null}function d3_geom_voronoiAttachCircle(arc){var lArc=arc.P,rArc=arc.N;if(lArc&&rArc){var lSite=lArc.site,cSite=arc.site,rSite=rArc.site;if(lSite!==rSite){var bx=cSite.x,by=cSite.y,ax=lSite.x-bx,ay=lSite.y-by,cx=rSite.x-bx,cy=rSite.y-by,d=2*(ax*cy-ay*cx);if(!(d>=-ε2)){var ha=ax*ax+ay*ay,hc=cx*cx+cy*cy,x=(cy*ha-ay*hc)/d,y=(ax*hc-cx*ha)/d,cy=y+by,circle=d3_geom_voronoiCirclePool.pop()||new d3_geom_voronoiCircle;circle.arc=arc,circle.site=cSite,circle.x=x+bx,circle.y=cy+Math.sqrt(x*x+y*y),circle.cy=cy,arc.circle=circle;for(var before=null,node=d3_geom_voronoiCircles._;node;)if(circle.y<node.y||circle.y===node.y&&circle.x<=node.x){if(!node.L){before=node.P;break}node=node.L}else{if(!node.R){before=node;break}node=node.R}d3_geom_voronoiCircles.insert(before,circle),before||(d3_geom_voronoiFirstCircle=circle)}}}}function d3_geom_voronoiDetachCircle(arc){var circle=arc.circle;circle&&(circle.P||(d3_geom_voronoiFirstCircle=circle.N),d3_geom_voronoiCircles.remove(circle),d3_geom_voronoiCirclePool.push(circle),d3_geom_voronoiRedBlackNode(circle),arc.circle=null)}function d3_geom_voronoiClipEdges(extent){for(var e,edges=d3_geom_voronoiEdges,clip=d3_geom_clipLine(extent[0][0],extent[0][1],extent[1][0],extent[1][1]),i=edges.length;i--;)e=edges[i],(!d3_geom_voronoiConnectEdge(e,extent)||!clip(e)||abs(e.a.x-e.b.x)<ε&&abs(e.a.y-e.b.y)<ε)&&(e.a=e.b=null,edges.splice(i,1))}function d3_geom_voronoiConnectEdge(edge,extent){var vb=edge.b;if(vb)return!0;var fm,fb,va=edge.a,x0=extent[0][0],x1=extent[1][0],y0=extent[0][1],y1=extent[1][1],lSite=edge.l,rSite=edge.r,lx=lSite.x,ly=lSite.y,rx=rSite.x,ry=rSite.y,fx=(lx+rx)/2,fy=(ly+ry)/2;if(ry===ly){if(x0>fx||fx>=x1)return;if(lx>rx){if(va){if(va.y>=y1)return}else va={x:fx,y:y0};vb={x:fx,y:y1}}else{if(va){if(va.y<y0)return}else va={x:fx,y:y1};vb={x:fx,y:y0}}}else if(fm=(lx-rx)/(ry-ly),fb=fy-fm*fx,-1>fm||fm>1)if(lx>rx){if(va){if(va.y>=y1)return}else va={x:(y0-fb)/fm,y:y0};vb={x:(y1-fb)/fm,y:y1}}else{if(va){if(va.y<y0)return}else va={x:(y1-fb)/fm,y:y1};vb={x:(y0-fb)/fm,y:y0}}else if(ry>ly){if(va){if(va.x>=x1)return}else va={x:x0,y:fm*x0+fb};vb={x:x1,y:fm*x1+fb}}else{if(va){if(va.x<x0)return}else va={x:x1,y:fm*x1+fb};vb={x:x0,y:fm*x0+fb}}return edge.a=va,edge.b=vb,!0}function d3_geom_voronoiEdge(lSite,rSite){this.l=lSite,this.r=rSite,this.a=this.b=null}function d3_geom_voronoiCreateEdge(lSite,rSite,va,vb){var edge=new d3_geom_voronoiEdge(lSite,rSite);return d3_geom_voronoiEdges.push(edge),va&&d3_geom_voronoiSetEdgeEnd(edge,lSite,rSite,va),vb&&d3_geom_voronoiSetEdgeEnd(edge,rSite,lSite,vb),d3_geom_voronoiCells[lSite.i].edges.push(new d3_geom_voronoiHalfEdge(edge,lSite,rSite)),d3_geom_voronoiCells[rSite.i].edges.push(new d3_geom_voronoiHalfEdge(edge,rSite,lSite)),edge}function d3_geom_voronoiCreateBorderEdge(lSite,va,vb){var edge=new d3_geom_voronoiEdge(lSite,null);return edge.a=va,edge.b=vb,d3_geom_voronoiEdges.push(edge),edge}function d3_geom_voronoiSetEdgeEnd(edge,lSite,rSite,vertex){edge.a||edge.b?edge.l===rSite?edge.b=vertex:edge.a=vertex:(edge.a=vertex,edge.l=lSite,edge.r=rSite)}function d3_geom_voronoiHalfEdge(edge,lSite,rSite){var va=edge.a,vb=edge.b;this.edge=edge,this.site=lSite,this.angle=rSite?Math.atan2(rSite.y-lSite.y,rSite.x-lSite.x):edge.l===lSite?Math.atan2(vb.x-va.x,va.y-vb.y):Math.atan2(va.x-vb.x,vb.y-va.y)}function d3_geom_voronoiRedBlackTree(){this._=null}function d3_geom_voronoiRedBlackNode(node){node.U=node.C=node.L=node.R=node.P=node.N=null}function d3_geom_voronoiRedBlackRotateLeft(tree,node){var p=node,q=node.R,parent=p.U;parent?parent.L===p?parent.L=q:parent.R=q:tree._=q,q.U=parent,p.U=q,p.R=q.L,p.R&&(p.R.U=p),q.L=p}function d3_geom_voronoiRedBlackRotateRight(tree,node){var p=node,q=node.L,parent=p.U;parent?parent.L===p?parent.L=q:parent.R=q:tree._=q,q.U=parent,p.U=q,p.L=q.R,p.L&&(p.L.U=p),q.R=p}function d3_geom_voronoiRedBlackFirst(node){for(;node.L;)node=node.L;return node}function d3_geom_voronoi(sites,bbox){var x0,y0,circle,site=sites.sort(d3_geom_voronoiVertexOrder).pop();for(d3_geom_voronoiEdges=[],d3_geom_voronoiCells=new Array(sites.length),d3_geom_voronoiBeaches=new d3_geom_voronoiRedBlackTree,d3_geom_voronoiCircles=new d3_geom_voronoiRedBlackTree;;)if(circle=d3_geom_voronoiFirstCircle,site&&(!circle||site.y<circle.y||site.y===circle.y&&site.x<circle.x))(site.x!==x0||site.y!==y0)&&(d3_geom_voronoiCells[site.i]=new d3_geom_voronoiCell(site),d3_geom_voronoiAddBeach(site),x0=site.x,y0=site.y),site=sites.pop();else{if(!circle)break;d3_geom_voronoiRemoveBeach(circle.arc)}bbox&&(d3_geom_voronoiClipEdges(bbox),d3_geom_voronoiCloseCells(bbox));var diagram={cells:d3_geom_voronoiCells,edges:d3_geom_voronoiEdges};return d3_geom_voronoiBeaches=d3_geom_voronoiCircles=d3_geom_voronoiEdges=d3_geom_voronoiCells=null,diagram}function d3_geom_voronoiVertexOrder(a,b){return b.y-a.y||b.x-a.x}function d3_geom_voronoiTriangleArea(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}function d3_geom_quadtreeCompatX(d){return d.x}function d3_geom_quadtreeCompatY(d){return d.y}function d3_geom_quadtreeNode(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function d3_geom_quadtreeVisit(f,node,x1,y1,x2,y2){if(!f(node,x1,y1,x2,y2)){var sx=.5*(x1+x2),sy=.5*(y1+y2),children=node.nodes;children[0]&&d3_geom_quadtreeVisit(f,children[0],x1,y1,sx,sy),children[1]&&d3_geom_quadtreeVisit(f,children[1],sx,y1,x2,sy),children[2]&&d3_geom_quadtreeVisit(f,children[2],x1,sy,sx,y2),children[3]&&d3_geom_quadtreeVisit(f,children[3],sx,sy,x2,y2)}}function d3_geom_quadtreeFind(root,x,y,x0,y0,x3,y3){var closestPoint,minDistance2=1/0;return function find(node,x1,y1,x2,y2){if(!(x1>x3||y1>y3||x0>x2||y0>y2)){if(point=node.point){var point,dx=x-node.x,dy=y-node.y,distance2=dx*dx+dy*dy;if(minDistance2>distance2){var distance=Math.sqrt(minDistance2=distance2);x0=x-distance,y0=y-distance,x3=x+distance,y3=y+distance,closestPoint=point}}for(var children=node.nodes,xm=.5*(x1+x2),ym=.5*(y1+y2),right=x>=xm,below=y>=ym,i=below<<1|right,j=i+4;j>i;++i)if(node=children[3&i])switch(3&i){case 0:find(node,x1,y1,xm,ym);break;case 1:find(node,xm,y1,x2,ym);break;case 2:find(node,x1,ym,xm,y2);break;case 3:find(node,xm,ym,x2,y2)}}}(root,x0,y0,x3,y3),closestPoint}function d3_interpolateRgb(a,b){a=d3.rgb(a),b=d3.rgb(b);var ar=a.r,ag=a.g,ab=a.b,br=b.r-ar,bg=b.g-ag,bb=b.b-ab;return function(t){return"#"+d3_rgb_hex(Math.round(ar+br*t))+d3_rgb_hex(Math.round(ag+bg*t))+d3_rgb_hex(Math.round(ab+bb*t))}}function d3_interpolateObject(a,b){var k,i={},c={};for(k in a)k in b?i[k]=d3_interpolate(a[k],b[k]):c[k]=a[k];for(k in b)k in a||(c[k]=b[k]);return function(t){for(k in i)c[k]=i[k](t);return c}}function d3_interpolateNumber(a,b){return a=+a,b=+b,function(t){return a*(1-t)+b*t}}function d3_interpolateString(a,b){var am,bm,bs,bi=d3_interpolate_numberA.lastIndex=d3_interpolate_numberB.lastIndex=0,i=-1,s=[],q=[];for(a+="",b+="";(am=d3_interpolate_numberA.exec(a))&&(bm=d3_interpolate_numberB.exec(b));)(bs=bm.index)>bi&&(bs=b.slice(bi,bs),s[i]?s[i]+=bs:s[++i]=bs),(am=am[0])===(bm=bm[0])?s[i]?s[i]+=bm:s[++i]=bm:(s[++i]=null,q.push({i:i,x:d3_interpolateNumber(am,bm)})),bi=d3_interpolate_numberB.lastIndex;return bi<b.length&&(bs=b.slice(bi),s[i]?s[i]+=bs:s[++i]=bs),s.length<2?q[0]?(b=q[0].x,function(t){return b(t)+""}):function(){return b}:(b=q.length,function(t){for(var o,i=0;b>i;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})}function d3_interpolate(a,b){for(var f,i=d3.interpolators.length;--i>=0&&!(f=d3.interpolators[i](a,b)););return f}function d3_interpolateArray(a,b){var i,x=[],c=[],na=a.length,nb=b.length,n0=Math.min(a.length,b.length);for(i=0;n0>i;++i)x.push(d3_interpolate(a[i],b[i]));for(;na>i;++i)c[i]=a[i];for(;nb>i;++i)c[i]=b[i];return function(t){for(i=0;n0>i;++i)c[i]=x[i](t);return c}}function d3_ease_clamp(f){return function(t){return 0>=t?0:t>=1?1:f(t)}}function d3_ease_reverse(f){return function(t){return 1-f(1-t)}}function d3_ease_reflect(f){return function(t){return.5*(.5>t?f(2*t):2-f(2-2*t))}}function d3_ease_quad(t){return t*t}function d3_ease_cubic(t){return t*t*t}function d3_ease_cubicInOut(t){if(0>=t)return 0;if(t>=1)return 1;var t2=t*t,t3=t2*t;return 4*(.5>t?t3:3*(t-t2)+t3-.75)}function d3_ease_poly(e){return function(t){return Math.pow(t,e)}}function d3_ease_sin(t){return 1-Math.cos(t*halfπ)}function d3_ease_exp(t){return Math.pow(2,10*(t-1))}function d3_ease_circle(t){return 1-Math.sqrt(1-t*t)}function d3_ease_elastic(a,p){var s;return arguments.length<2&&(p=.45),arguments.length?s=p/τ*Math.asin(1/a):(a=1,s=p/4),function(t){return 1+a*Math.pow(2,-10*t)*Math.sin((t-s)*τ/p)}}function d3_ease_back(s){return s||(s=1.70158),function(t){return t*t*((s+1)*t-s)}}function d3_ease_bounce(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function d3_interpolateHcl(a,b){a=d3.hcl(a),b=d3.hcl(b);var ah=a.h,ac=a.c,al=a.l,bh=b.h-ah,bc=b.c-ac,bl=b.l-al;return isNaN(bc)&&(bc=0,ac=isNaN(ac)?b.c:ac),isNaN(bh)?(bh=0,ah=isNaN(ah)?b.h:ah):bh>180?bh-=360:-180>bh&&(bh+=360),function(t){return d3_hcl_lab(ah+bh*t,ac+bc*t,al+bl*t)+""}}function d3_interpolateHsl(a,b){a=d3.hsl(a),b=d3.hsl(b);var ah=a.h,as=a.s,al=a.l,bh=b.h-ah,bs=b.s-as,bl=b.l-al;return isNaN(bs)&&(bs=0,as=isNaN(as)?b.s:as),isNaN(bh)?(bh=0,ah=isNaN(ah)?b.h:ah):bh>180?bh-=360:-180>bh&&(bh+=360),function(t){return d3_hsl_rgb(ah+bh*t,as+bs*t,al+bl*t)+""}}function d3_interpolateLab(a,b){a=d3.lab(a),b=d3.lab(b);var al=a.l,aa=a.a,ab=a.b,bl=b.l-al,ba=b.a-aa,bb=b.b-ab;return function(t){return d3_lab_rgb(al+bl*t,aa+ba*t,ab+bb*t)+""}}function d3_interpolateRound(a,b){return b-=a,function(t){return Math.round(a+b*t)}}function d3_transform(m){var r0=[m.a,m.b],r1=[m.c,m.d],kx=d3_transformNormalize(r0),kz=d3_transformDot(r0,r1),ky=d3_transformNormalize(d3_transformCombine(r1,r0,-kz))||0;r0[0]*r1[1]<r1[0]*r0[1]&&(r0[0]*=-1,r0[1]*=-1,kx*=-1,kz*=-1),this.rotate=(kx?Math.atan2(r0[1],r0[0]):Math.atan2(-r1[0],r1[1]))*d3_degrees,this.translate=[m.e,m.f],this.scale=[kx,ky],this.skew=ky?Math.atan2(kz,ky)*d3_degrees:0}function d3_transformDot(a,b){return a[0]*b[0]+a[1]*b[1]}function d3_transformNormalize(a){var k=Math.sqrt(d3_transformDot(a,a));return k&&(a[0]/=k,a[1]/=k),k}function d3_transformCombine(a,b,k){return a[0]+=k*b[0],a[1]+=k*b[1],a}function d3_interpolateTransformPop(s){return s.length?s.pop()+",":""}function d3_interpolateTranslate(ta,tb,s,q){if(ta[0]!==tb[0]||ta[1]!==tb[1]){var i=s.push("translate(",null,",",null,")");q.push({i:i-4,x:d3_interpolateNumber(ta[0],tb[0])},{i:i-2,x:d3_interpolateNumber(ta[1],tb[1])})}else(tb[0]||tb[1])&&s.push("translate("+tb+")")}function d3_interpolateRotate(ra,rb,s,q){ra!==rb?(ra-rb>180?rb+=360:rb-ra>180&&(ra+=360),q.push({i:s.push(d3_interpolateTransformPop(s)+"rotate(",null,")")-2,x:d3_interpolateNumber(ra,rb)})):rb&&s.push(d3_interpolateTransformPop(s)+"rotate("+rb+")")}function d3_interpolateSkew(wa,wb,s,q){wa!==wb?q.push({i:s.push(d3_interpolateTransformPop(s)+"skewX(",null,")")-2,x:d3_interpolateNumber(wa,wb)}):wb&&s.push(d3_interpolateTransformPop(s)+"skewX("+wb+")")}function d3_interpolateScale(ka,kb,s,q){if(ka[0]!==kb[0]||ka[1]!==kb[1]){var i=s.push(d3_interpolateTransformPop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:d3_interpolateNumber(ka[0],kb[0])},{i:i-2,x:d3_interpolateNumber(ka[1],kb[1])})}else(1!==kb[0]||1!==kb[1])&&s.push(d3_interpolateTransformPop(s)+"scale("+kb+")")}function d3_interpolateTransform(a,b){var s=[],q=[];return a=d3.transform(a),b=d3.transform(b),d3_interpolateTranslate(a.translate,b.translate,s,q),d3_interpolateRotate(a.rotate,b.rotate,s,q),d3_interpolateSkew(a.skew,b.skew,s,q),d3_interpolateScale(a.scale,b.scale,s,q),a=b=null,function(t){for(var o,i=-1,n=q.length;++i<n;)s[(o=q[i]).i]=o.x(t);return s.join("")}}function d3_uninterpolateNumber(a,b){return b=(b-=a=+a)||1/b,function(x){return(x-a)/b}}function d3_uninterpolateClamp(a,b){return b=(b-=a=+a)||1/b,function(x){return Math.max(0,Math.min(1,(x-a)/b))}}function d3_layout_bundlePath(link){for(var start=link.source,end=link.target,lca=d3_layout_bundleLeastCommonAncestor(start,end),points=[start];start!==lca;)start=start.parent,points.push(start);for(var k=points.length;end!==lca;)points.splice(k,0,end),end=end.parent;return points}function d3_layout_bundleAncestors(node){for(var ancestors=[],parent=node.parent;null!=parent;)ancestors.push(node),node=parent,parent=parent.parent;return ancestors.push(node),ancestors}function d3_layout_bundleLeastCommonAncestor(a,b){if(a===b)return a;for(var aNodes=d3_layout_bundleAncestors(a),bNodes=d3_layout_bundleAncestors(b),aNode=aNodes.pop(),bNode=bNodes.pop(),sharedNode=null;aNode===bNode;)sharedNode=aNode,aNode=aNodes.pop(),bNode=bNodes.pop();return sharedNode}function d3_layout_forceDragstart(d){d.fixed|=2}function d3_layout_forceDragend(d){d.fixed&=-7}function d3_layout_forceMouseover(d){d.fixed|=4,d.px=d.x,d.py=d.y}function d3_layout_forceMouseout(d){d.fixed&=-5}function d3_layout_forceAccumulate(quad,alpha,charges){var cx=0,cy=0;if(quad.charge=0,!quad.leaf)for(var c,nodes=quad.nodes,n=nodes.length,i=-1;++i<n;)c=nodes[i],null!=c&&(d3_layout_forceAccumulate(c,alpha,charges),quad.charge+=c.charge,cx+=c.charge*c.cx,cy+=c.charge*c.cy);if(quad.point){quad.leaf||(quad.point.x+=Math.random()-.5,quad.point.y+=Math.random()-.5);var k=alpha*charges[quad.point.index];quad.charge+=quad.pointCharge=k,cx+=k*quad.point.x,cy+=k*quad.point.y}quad.cx=cx/quad.charge,quad.cy=cy/quad.charge}function d3_layout_hierarchyRebind(object,hierarchy){return d3.rebind(object,hierarchy,"sort","children","value"),object.nodes=object,object.links=d3_layout_hierarchyLinks,object}function d3_layout_hierarchyVisitBefore(node,callback){for(var nodes=[node];null!=(node=nodes.pop());)if(callback(node),(children=node.children)&&(n=children.length))for(var n,children;--n>=0;)nodes.push(children[n])}function d3_layout_hierarchyVisitAfter(node,callback){for(var nodes=[node],nodes2=[];null!=(node=nodes.pop());)if(nodes2.push(node),(children=node.children)&&(n=children.length))for(var n,children,i=-1;++i<n;)nodes.push(children[i]);for(;null!=(node=nodes2.pop());)callback(node)}function d3_layout_hierarchyChildren(d){return d.children}function d3_layout_hierarchyValue(d){return d.value}function d3_layout_hierarchySort(a,b){return b.value-a.value}function d3_layout_hierarchyLinks(nodes){return d3.merge(nodes.map(function(parent){return(parent.children||[]).map(function(child){return{source:parent,target:child}})}))}function d3_layout_stackX(d){return d.x}function d3_layout_stackY(d){return d.y}function d3_layout_stackOut(d,y0,y){d.y0=y0,d.y=y}function d3_layout_stackOrderDefault(data){return d3.range(data.length)}function d3_layout_stackOffsetZero(data){for(var j=-1,m=data[0].length,y0=[];++j<m;)y0[j]=0;return y0}function d3_layout_stackMaxIndex(array){for(var k,i=1,j=0,v=array[0][1],n=array.length;n>i;++i)(k=array[i][1])>v&&(j=i,v=k);return j}function d3_layout_stackReduceSum(d){return d.reduce(d3_layout_stackSum,0)}function d3_layout_stackSum(p,d){return p+d[1]}function d3_layout_histogramBinSturges(range,values){return d3_layout_histogramBinFixed(range,Math.ceil(Math.log(values.length)/Math.LN2+1))}function d3_layout_histogramBinFixed(range,n){for(var x=-1,b=+range[0],m=(range[1]-b)/n,f=[];++x<=n;)f[x]=m*x+b;return f}function d3_layout_histogramRange(values){return[d3.min(values),d3.max(values)]}function d3_layout_packSort(a,b){return a.value-b.value}function d3_layout_packInsert(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function d3_layout_packSplice(a,b){a._pack_next=b,b._pack_prev=a}function d3_layout_packIntersects(a,b){var dx=b.x-a.x,dy=b.y-a.y,dr=a.r+b.r;return.999*dr*dr>dx*dx+dy*dy}function d3_layout_packSiblings(node){function bound(node){xMin=Math.min(node.x-node.r,xMin),xMax=Math.max(node.x+node.r,xMax),yMin=Math.min(node.y-node.r,yMin),yMax=Math.max(node.y+node.r,yMax)}if((nodes=node.children)&&(n=nodes.length)){var nodes,a,b,c,i,j,k,n,xMin=1/0,xMax=-1/0,yMin=1/0,yMax=-1/0;if(nodes.forEach(d3_layout_packLink),a=nodes[0],a.x=-a.r,a.y=0,bound(a),n>1&&(b=nodes[1],b.x=b.r,b.y=0,bound(b),n>2))for(c=nodes[2],d3_layout_packPlace(a,b,c),bound(c),d3_layout_packInsert(a,c),a._pack_prev=c,d3_layout_packInsert(c,b),b=a._pack_next,i=3;n>i;i++){d3_layout_packPlace(a,b,c=nodes[i]);var isect=0,s1=1,s2=1;for(j=b._pack_next;j!==b;j=j._pack_next,s1++)if(d3_layout_packIntersects(j,c)){isect=1;break}if(1==isect)for(k=a._pack_prev;k!==j._pack_prev&&!d3_layout_packIntersects(k,c);k=k._pack_prev,s2++);isect?(s2>s1||s1==s2&&b.r<a.r?d3_layout_packSplice(a,b=j):d3_layout_packSplice(a=k,b),i--):(d3_layout_packInsert(a,c),b=c,bound(c))}var cx=(xMin+xMax)/2,cy=(yMin+yMax)/2,cr=0;for(i=0;n>i;i++)c=nodes[i],c.x-=cx,c.y-=cy,cr=Math.max(cr,c.r+Math.sqrt(c.x*c.x+c.y*c.y));node.r=cr,nodes.forEach(d3_layout_packUnlink)}}function d3_layout_packLink(node){node._pack_next=node._pack_prev=node}function d3_layout_packUnlink(node){delete node._pack_next,delete node._pack_prev}function d3_layout_packTransform(node,x,y,k){var children=node.children;if(node.x=x+=k*node.x,node.y=y+=k*node.y,node.r*=k,children)for(var i=-1,n=children.length;++i<n;)d3_layout_packTransform(children[i],x,y,k)}function d3_layout_packPlace(a,b,c){var db=a.r+c.r,dx=b.x-a.x,dy=b.y-a.y;if(db&&(dx||dy)){var da=b.r+c.r,dc=dx*dx+dy*dy;da*=da,db*=db;var x=.5+(db-da)/(2*dc),y=Math.sqrt(Math.max(0,2*da*(db+dc)-(db-=dc)*db-da*da))/(2*dc);c.x=a.x+x*dx+y*dy,c.y=a.y+x*dy-y*dx}else c.x=a.x+db,c.y=a.y}function d3_layout_treeSeparation(a,b){return a.parent==b.parent?1:2}function d3_layout_treeLeft(v){var children=v.children;return children.length?children[0]:v.t}function d3_layout_treeRight(v){var n,children=v.children;return(n=children.length)?children[n-1]:v.t}function d3_layout_treeMove(wm,wp,shift){var change=shift/(wp.i-wm.i);wp.c-=change,wp.s+=shift,wm.c+=change,wp.z+=shift,wp.m+=shift}function d3_layout_treeShift(v){for(var w,shift=0,change=0,children=v.children,i=children.length;--i>=0;)w=children[i],w.z+=shift,w.m+=shift,shift+=w.s+(change+=w.c)}function d3_layout_treeAncestor(vim,v,ancestor){return vim.a.parent===v.parent?vim.a:ancestor}function d3_layout_clusterY(children){return 1+d3.max(children,function(child){return child.y})}function d3_layout_clusterX(children){return children.reduce(function(x,child){return x+child.x
},0)/children.length}function d3_layout_clusterLeft(node){var children=node.children;return children&&children.length?d3_layout_clusterLeft(children[0]):node}function d3_layout_clusterRight(node){var n,children=node.children;return children&&(n=children.length)?d3_layout_clusterRight(children[n-1]):node}function d3_layout_treemapPadNull(node){return{x:node.x,y:node.y,dx:node.dx,dy:node.dy}}function d3_layout_treemapPad(node,padding){var x=node.x+padding[3],y=node.y+padding[0],dx=node.dx-padding[1]-padding[3],dy=node.dy-padding[0]-padding[2];return 0>dx&&(x+=dx/2,dx=0),0>dy&&(y+=dy/2,dy=0),{x:x,y:y,dx:dx,dy:dy}}function d3_scaleExtent(domain){var start=domain[0],stop=domain[domain.length-1];return stop>start?[start,stop]:[stop,start]}function d3_scaleRange(scale){return scale.rangeExtent?scale.rangeExtent():d3_scaleExtent(scale.range())}function d3_scale_bilinear(domain,range,uninterpolate,interpolate){var u=uninterpolate(domain[0],domain[1]),i=interpolate(range[0],range[1]);return function(x){return i(u(x))}}function d3_scale_nice(domain,nice){var dx,i0=0,i1=domain.length-1,x0=domain[i0],x1=domain[i1];return x0>x1&&(dx=i0,i0=i1,i1=dx,dx=x0,x0=x1,x1=dx),domain[i0]=nice.floor(x0),domain[i1]=nice.ceil(x1),domain}function d3_scale_niceStep(step){return step?{floor:function(x){return Math.floor(x/step)*step},ceil:function(x){return Math.ceil(x/step)*step}}:d3_scale_niceIdentity}function d3_scale_polylinear(domain,range,uninterpolate,interpolate){var u=[],i=[],j=0,k=Math.min(domain.length,range.length)-1;for(domain[k]<domain[0]&&(domain=domain.slice().reverse(),range=range.slice().reverse());++j<=k;)u.push(uninterpolate(domain[j-1],domain[j])),i.push(interpolate(range[j-1],range[j]));return function(x){var j=d3.bisect(domain,x,1,k)-1;return i[j](u[j](x))}}function d3_scale_linear(domain,range,interpolate,clamp){function rescale(){var linear=Math.min(domain.length,range.length)>2?d3_scale_polylinear:d3_scale_bilinear,uninterpolate=clamp?d3_uninterpolateClamp:d3_uninterpolateNumber;return output=linear(domain,range,uninterpolate,interpolate),input=linear(range,domain,uninterpolate,d3_interpolate),scale}function scale(x){return output(x)}var output,input;return scale.invert=function(y){return input(y)},scale.domain=function(x){return arguments.length?(domain=x.map(Number),rescale()):domain},scale.range=function(x){return arguments.length?(range=x,rescale()):range},scale.rangeRound=function(x){return scale.range(x).interpolate(d3_interpolateRound)},scale.clamp=function(x){return arguments.length?(clamp=x,rescale()):clamp},scale.interpolate=function(x){return arguments.length?(interpolate=x,rescale()):interpolate},scale.ticks=function(m){return d3_scale_linearTicks(domain,m)},scale.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)},scale.nice=function(m){return d3_scale_linearNice(domain,m),rescale()},scale.copy=function(){return d3_scale_linear(domain,range,interpolate,clamp)},rescale()}function d3_scale_linearRebind(scale,linear){return d3.rebind(scale,linear,"range","rangeRound","interpolate","clamp")}function d3_scale_linearNice(domain,m){return d3_scale_nice(domain,d3_scale_niceStep(d3_scale_linearTickRange(domain,m)[2]))}function d3_scale_linearTickRange(domain,m){null==m&&(m=10);var extent=d3_scaleExtent(domain),span=extent[1]-extent[0],step=Math.pow(10,Math.floor(Math.log(span/m)/Math.LN10)),err=m/span*step;return.15>=err?step*=10:.35>=err?step*=5:.75>=err&&(step*=2),extent[0]=Math.ceil(extent[0]/step)*step,extent[1]=Math.floor(extent[1]/step)*step+.5*step,extent[2]=step,extent}function d3_scale_linearTicks(domain,m){return d3.range.apply(d3,d3_scale_linearTickRange(domain,m))}function d3_scale_linearTickFormat(domain,m,format){var range=d3_scale_linearTickRange(domain,m);if(format){var match=d3_format_re.exec(format);if(match.shift(),"s"===match[8]){var prefix=d3.formatPrefix(Math.max(abs(range[0]),abs(range[1])));return match[7]||(match[7]="."+d3_scale_linearPrecision(prefix.scale(range[2]))),match[8]="f",format=d3.format(match.join("")),function(d){return format(prefix.scale(d))+prefix.symbol}}match[7]||(match[7]="."+d3_scale_linearFormatPrecision(match[8],range)),format=match.join("")}else format=",."+d3_scale_linearPrecision(range[2])+"f";return d3.format(format)}function d3_scale_linearPrecision(value){return-Math.floor(Math.log(value)/Math.LN10+.01)}function d3_scale_linearFormatPrecision(type,range){var p=d3_scale_linearPrecision(range[2]);return type in d3_scale_linearFormatSignificant?Math.abs(p-d3_scale_linearPrecision(Math.max(abs(range[0]),abs(range[1]))))+ +("e"!==type):p-2*("%"===type)}function d3_scale_log(linear,base,positive,domain){function log(x){return(positive?Math.log(0>x?0:x):-Math.log(x>0?0:-x))/Math.log(base)}function pow(x){return positive?Math.pow(base,x):-Math.pow(base,-x)}function scale(x){return linear(log(x))}return scale.invert=function(x){return pow(linear.invert(x))},scale.domain=function(x){return arguments.length?(positive=x[0]>=0,linear.domain((domain=x.map(Number)).map(log)),scale):domain},scale.base=function(_){return arguments.length?(base=+_,linear.domain(domain.map(log)),scale):base},scale.nice=function(){var niced=d3_scale_nice(domain.map(log),positive?Math:d3_scale_logNiceNegative);return linear.domain(niced),domain=niced.map(pow),scale},scale.ticks=function(){var extent=d3_scaleExtent(domain),ticks=[],u=extent[0],v=extent[1],i=Math.floor(log(u)),j=Math.ceil(log(v)),n=base%1?2:base;if(isFinite(j-i)){if(positive){for(;j>i;i++)for(var k=1;n>k;k++)ticks.push(pow(i)*k);ticks.push(pow(i))}else for(ticks.push(pow(i));i++<j;)for(var k=n-1;k>0;k--)ticks.push(pow(i)*k);for(i=0;ticks[i]<u;i++);for(j=ticks.length;ticks[j-1]>v;j--);ticks=ticks.slice(i,j)}return ticks},scale.tickFormat=function(n,format){if(!arguments.length)return d3_scale_logFormat;arguments.length<2?format=d3_scale_logFormat:"function"!=typeof format&&(format=d3.format(format));var e,k=Math.max(.1,n/scale.ticks().length),f=positive?(e=1e-12,Math.ceil):(e=-1e-12,Math.floor);return function(d){return d/pow(f(log(d)+e))<=k?format(d):""}},scale.copy=function(){return d3_scale_log(linear.copy(),base,positive,domain)},d3_scale_linearRebind(scale,linear)}function d3_scale_pow(linear,exponent,domain){function scale(x){return linear(powp(x))}var powp=d3_scale_powPow(exponent),powb=d3_scale_powPow(1/exponent);return scale.invert=function(x){return powb(linear.invert(x))},scale.domain=function(x){return arguments.length?(linear.domain((domain=x.map(Number)).map(powp)),scale):domain},scale.ticks=function(m){return d3_scale_linearTicks(domain,m)},scale.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)},scale.nice=function(m){return scale.domain(d3_scale_linearNice(domain,m))},scale.exponent=function(x){return arguments.length?(powp=d3_scale_powPow(exponent=x),powb=d3_scale_powPow(1/exponent),linear.domain(domain.map(powp)),scale):exponent},scale.copy=function(){return d3_scale_pow(linear.copy(),exponent,domain)},d3_scale_linearRebind(scale,linear)}function d3_scale_powPow(e){return function(x){return 0>x?-Math.pow(-x,e):Math.pow(x,e)}}function d3_scale_ordinal(domain,ranger){function scale(x){return range[((index.get(x)||("range"===ranger.t?index.set(x,domain.push(x)):0/0))-1)%range.length]}function steps(start,step){return d3.range(domain.length).map(function(i){return start+step*i})}var index,range,rangeBand;return scale.domain=function(x){if(!arguments.length)return domain;domain=[],index=new d3_Map;for(var xi,i=-1,n=x.length;++i<n;)index.has(xi=x[i])||index.set(xi,domain.push(xi));return scale[ranger.t].apply(scale,ranger.a)},scale.range=function(x){return arguments.length?(range=x,rangeBand=0,ranger={t:"range",a:arguments},scale):range},scale.rangePoints=function(x,padding){arguments.length<2&&(padding=0);var start=x[0],stop=x[1],step=domain.length<2?(start=(start+stop)/2,0):(stop-start)/(domain.length-1+padding);return range=steps(start+step*padding/2,step),rangeBand=0,ranger={t:"rangePoints",a:arguments},scale},scale.rangeRoundPoints=function(x,padding){arguments.length<2&&(padding=0);var start=x[0],stop=x[1],step=domain.length<2?(start=stop=Math.round((start+stop)/2),0):(stop-start)/(domain.length-1+padding)|0;return range=steps(start+Math.round(step*padding/2+(stop-start-(domain.length-1+padding)*step)/2),step),rangeBand=0,ranger={t:"rangeRoundPoints",a:arguments},scale},scale.rangeBands=function(x,padding,outerPadding){arguments.length<2&&(padding=0),arguments.length<3&&(outerPadding=padding);var reverse=x[1]<x[0],start=x[reverse-0],stop=x[1-reverse],step=(stop-start)/(domain.length-padding+2*outerPadding);return range=steps(start+step*outerPadding,step),reverse&&range.reverse(),rangeBand=step*(1-padding),ranger={t:"rangeBands",a:arguments},scale},scale.rangeRoundBands=function(x,padding,outerPadding){arguments.length<2&&(padding=0),arguments.length<3&&(outerPadding=padding);var reverse=x[1]<x[0],start=x[reverse-0],stop=x[1-reverse],step=Math.floor((stop-start)/(domain.length-padding+2*outerPadding));return range=steps(start+Math.round((stop-start-(domain.length-padding)*step)/2),step),reverse&&range.reverse(),rangeBand=Math.round(step*(1-padding)),ranger={t:"rangeRoundBands",a:arguments},scale},scale.rangeBand=function(){return rangeBand},scale.rangeExtent=function(){return d3_scaleExtent(ranger.a[0])},scale.copy=function(){return d3_scale_ordinal(domain,ranger)},scale.domain(domain)}function d3_scale_quantile(domain,range){function rescale(){var k=0,q=range.length;for(thresholds=[];++k<q;)thresholds[k-1]=d3.quantile(domain,k/q);return scale}function scale(x){return isNaN(x=+x)?void 0:range[d3.bisect(thresholds,x)]}var thresholds;return scale.domain=function(x){return arguments.length?(domain=x.map(d3_number).filter(d3_numeric).sort(d3_ascending),rescale()):domain},scale.range=function(x){return arguments.length?(range=x,rescale()):range},scale.quantiles=function(){return thresholds},scale.invertExtent=function(y){return y=range.indexOf(y),0>y?[0/0,0/0]:[y>0?thresholds[y-1]:domain[0],y<thresholds.length?thresholds[y]:domain[domain.length-1]]},scale.copy=function(){return d3_scale_quantile(domain,range)},rescale()}function d3_scale_quantize(x0,x1,range){function scale(x){return range[Math.max(0,Math.min(i,Math.floor(kx*(x-x0))))]}function rescale(){return kx=range.length/(x1-x0),i=range.length-1,scale}var kx,i;return scale.domain=function(x){return arguments.length?(x0=+x[0],x1=+x[x.length-1],rescale()):[x0,x1]},scale.range=function(x){return arguments.length?(range=x,rescale()):range},scale.invertExtent=function(y){return y=range.indexOf(y),y=0>y?0/0:y/kx+x0,[y,y+1/kx]},scale.copy=function(){return d3_scale_quantize(x0,x1,range)},rescale()}function d3_scale_threshold(domain,range){function scale(x){return x>=x?range[d3.bisect(domain,x)]:void 0}return scale.domain=function(_){return arguments.length?(domain=_,scale):domain},scale.range=function(_){return arguments.length?(range=_,scale):range},scale.invertExtent=function(y){return y=range.indexOf(y),[domain[y-1],domain[y]]},scale.copy=function(){return d3_scale_threshold(domain,range)},scale}function d3_scale_identity(domain){function identity(x){return+x}return identity.invert=identity,identity.domain=identity.range=function(x){return arguments.length?(domain=x.map(identity),identity):domain},identity.ticks=function(m){return d3_scale_linearTicks(domain,m)},identity.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)},identity.copy=function(){return d3_scale_identity(domain)},identity}function d3_zero(){return 0}function d3_svg_arcInnerRadius(d){return d.innerRadius}function d3_svg_arcOuterRadius(d){return d.outerRadius}function d3_svg_arcStartAngle(d){return d.startAngle}function d3_svg_arcEndAngle(d){return d.endAngle}function d3_svg_arcPadAngle(d){return d&&d.padAngle}function d3_svg_arcSweep(x0,y0,x1,y1){return(x0-x1)*y0-(y0-y1)*x0>0?0:1}function d3_svg_arcCornerTangents(p0,p1,r1,rc,cw){var x01=p0[0]-p1[0],y01=p0[1]-p1[1],lo=(cw?rc:-rc)/Math.sqrt(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x1=p0[0]+ox,y1=p0[1]+oy,x2=p1[0]+ox,y2=p1[1]+oy,x3=(x1+x2)/2,y3=(y1+y2)/2,dx=x2-x1,dy=y2-y1,d2=dx*dx+dy*dy,r=r1-rc,D=x1*y2-x2*y1,d=(0>dy?-1:1)*Math.sqrt(Math.max(0,r*r*d2-D*D)),cx0=(D*dy-dx*d)/d2,cy0=(-D*dx-dy*d)/d2,cx1=(D*dy+dx*d)/d2,cy1=(-D*dx+dy*d)/d2,dx0=cx0-x3,dy0=cy0-y3,dx1=cx1-x3,dy1=cy1-y3;return dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1&&(cx0=cx1,cy0=cy1),[[cx0-ox,cy0-oy],[cx0*r1/r,cy0*r1/r]]}function d3_svg_line(projection){function line(data){function segment(){segments.push("M",interpolate(projection(points),tension))}for(var d,segments=[],points=[],i=-1,n=data.length,fx=d3_functor(x),fy=d3_functor(y);++i<n;)defined.call(this,d=data[i],i)?points.push([+fx.call(this,d,i),+fy.call(this,d,i)]):points.length&&(segment(),points=[]);return points.length&&segment(),segments.length?segments.join(""):null}var x=d3_geom_pointX,y=d3_geom_pointY,defined=d3_true,interpolate=d3_svg_lineLinear,interpolateKey=interpolate.key,tension=.7;return line.x=function(_){return arguments.length?(x=_,line):x},line.y=function(_){return arguments.length?(y=_,line):y},line.defined=function(_){return arguments.length?(defined=_,line):defined},line.interpolate=function(_){return arguments.length?(interpolateKey="function"==typeof _?interpolate=_:(interpolate=d3_svg_lineInterpolators.get(_)||d3_svg_lineLinear).key,line):interpolateKey},line.tension=function(_){return arguments.length?(tension=_,line):tension},line}function d3_svg_lineLinear(points){return points.length>1?points.join("L"):points+"Z"}function d3_svg_lineLinearClosed(points){return points.join("L")+"Z"}function d3_svg_lineStep(points){for(var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];++i<n;)path.push("H",(p[0]+(p=points[i])[0])/2,"V",p[1]);return n>1&&path.push("H",p[0]),path.join("")}function d3_svg_lineStepBefore(points){for(var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];++i<n;)path.push("V",(p=points[i])[1],"H",p[0]);return path.join("")}function d3_svg_lineStepAfter(points){for(var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];++i<n;)path.push("H",(p=points[i])[0],"V",p[1]);return path.join("")}function d3_svg_lineCardinalOpen(points,tension){return points.length<4?d3_svg_lineLinear(points):points[1]+d3_svg_lineHermite(points.slice(1,-1),d3_svg_lineCardinalTangents(points,tension))}function d3_svg_lineCardinalClosed(points,tension){return points.length<3?d3_svg_lineLinearClosed(points):points[0]+d3_svg_lineHermite((points.push(points[0]),points),d3_svg_lineCardinalTangents([points[points.length-2]].concat(points,[points[1]]),tension))}function d3_svg_lineCardinal(points,tension){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite(points,d3_svg_lineCardinalTangents(points,tension))}function d3_svg_lineHermite(points,tangents){if(tangents.length<1||points.length!=tangents.length&&points.length!=tangents.length+2)return d3_svg_lineLinear(points);var quad=points.length!=tangents.length,path="",p0=points[0],p=points[1],t0=tangents[0],t=t0,pi=1;if(quad&&(path+="Q"+(p[0]-2*t0[0]/3)+","+(p[1]-2*t0[1]/3)+","+p[0]+","+p[1],p0=points[1],pi=2),tangents.length>1){t=tangents[1],p=points[pi],pi++,path+="C"+(p0[0]+t0[0])+","+(p0[1]+t0[1])+","+(p[0]-t[0])+","+(p[1]-t[1])+","+p[0]+","+p[1];for(var i=2;i<tangents.length;i++,pi++)p=points[pi],t=tangents[i],path+="S"+(p[0]-t[0])+","+(p[1]-t[1])+","+p[0]+","+p[1]}if(quad){var lp=points[pi];path+="Q"+(p[0]+2*t[0]/3)+","+(p[1]+2*t[1]/3)+","+lp[0]+","+lp[1]}return path}function d3_svg_lineCardinalTangents(points,tension){for(var p0,tangents=[],a=(1-tension)/2,p1=points[0],p2=points[1],i=1,n=points.length;++i<n;)p0=p1,p1=p2,p2=points[i],tangents.push([a*(p2[0]-p0[0]),a*(p2[1]-p0[1])]);return tangents}function d3_svg_lineBasis(points){if(points.length<3)return d3_svg_lineLinear(points);var i=1,n=points.length,pi=points[0],x0=pi[0],y0=pi[1],px=[x0,x0,x0,(pi=points[1])[0]],py=[y0,y0,y0,pi[1]],path=[x0,",",y0,"L",d3_svg_lineDot4(d3_svg_lineBasisBezier3,px),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,py)];for(points.push(points[n-1]);++i<=n;)pi=points[i],px.shift(),px.push(pi[0]),py.shift(),py.push(pi[1]),d3_svg_lineBasisBezier(path,px,py);return points.pop(),path.push("L",pi),path.join("")}function d3_svg_lineBasisOpen(points){if(points.length<4)return d3_svg_lineLinear(points);for(var pi,path=[],i=-1,n=points.length,px=[0],py=[0];++i<3;)pi=points[i],px.push(pi[0]),py.push(pi[1]);for(path.push(d3_svg_lineDot4(d3_svg_lineBasisBezier3,px)+","+d3_svg_lineDot4(d3_svg_lineBasisBezier3,py)),--i;++i<n;)pi=points[i],px.shift(),px.push(pi[0]),py.shift(),py.push(pi[1]),d3_svg_lineBasisBezier(path,px,py);return path.join("")}function d3_svg_lineBasisClosed(points){for(var path,pi,i=-1,n=points.length,m=n+4,px=[],py=[];++i<4;)pi=points[i%n],px.push(pi[0]),py.push(pi[1]);for(path=[d3_svg_lineDot4(d3_svg_lineBasisBezier3,px),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,py)],--i;++i<m;)pi=points[i%n],px.shift(),px.push(pi[0]),py.shift(),py.push(pi[1]),d3_svg_lineBasisBezier(path,px,py);return path.join("")}function d3_svg_lineBundle(points,tension){var n=points.length-1;if(n)for(var p,t,x0=points[0][0],y0=points[0][1],dx=points[n][0]-x0,dy=points[n][1]-y0,i=-1;++i<=n;)p=points[i],t=i/n,p[0]=tension*p[0]+(1-tension)*(x0+t*dx),p[1]=tension*p[1]+(1-tension)*(y0+t*dy);return d3_svg_lineBasis(points)}function d3_svg_lineDot4(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function d3_svg_lineBasisBezier(path,x,y){path.push("C",d3_svg_lineDot4(d3_svg_lineBasisBezier1,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier1,y),",",d3_svg_lineDot4(d3_svg_lineBasisBezier2,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier2,y),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,y))}function d3_svg_lineSlope(p0,p1){return(p1[1]-p0[1])/(p1[0]-p0[0])}function d3_svg_lineFiniteDifferences(points){for(var i=0,j=points.length-1,m=[],p0=points[0],p1=points[1],d=m[0]=d3_svg_lineSlope(p0,p1);++i<j;)m[i]=(d+(d=d3_svg_lineSlope(p0=p1,p1=points[i+1])))/2;return m[i]=d,m}function d3_svg_lineMonotoneTangents(points){for(var d,a,b,s,tangents=[],m=d3_svg_lineFiniteDifferences(points),i=-1,j=points.length-1;++i<j;)d=d3_svg_lineSlope(points[i],points[i+1]),abs(d)<ε?m[i]=m[i+1]=0:(a=m[i]/d,b=m[i+1]/d,s=a*a+b*b,s>9&&(s=3*d/Math.sqrt(s),m[i]=s*a,m[i+1]=s*b));for(i=-1;++i<=j;)s=(points[Math.min(j,i+1)][0]-points[Math.max(0,i-1)][0])/(6*(1+m[i]*m[i])),tangents.push([s||0,m[i]*s||0]);return tangents}function d3_svg_lineMonotone(points){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite(points,d3_svg_lineMonotoneTangents(points))}function d3_svg_lineRadial(points){for(var point,r,a,i=-1,n=points.length;++i<n;)point=points[i],r=point[0],a=point[1]-halfπ,point[0]=r*Math.cos(a),point[1]=r*Math.sin(a);return points}function d3_svg_area(projection){function area(data){function segment(){segments.push("M",interpolate(projection(points1),tension),L,interpolateReverse(projection(points0.reverse()),tension),"Z")}for(var d,x,y,segments=[],points0=[],points1=[],i=-1,n=data.length,fx0=d3_functor(x0),fy0=d3_functor(y0),fx1=x0===x1?function(){return x}:d3_functor(x1),fy1=y0===y1?function(){return y}:d3_functor(y1);++i<n;)defined.call(this,d=data[i],i)?(points0.push([x=+fx0.call(this,d,i),y=+fy0.call(this,d,i)]),points1.push([+fx1.call(this,d,i),+fy1.call(this,d,i)])):points0.length&&(segment(),points0=[],points1=[]);return points0.length&&segment(),segments.length?segments.join(""):null}var x0=d3_geom_pointX,x1=d3_geom_pointX,y0=0,y1=d3_geom_pointY,defined=d3_true,interpolate=d3_svg_lineLinear,interpolateKey=interpolate.key,interpolateReverse=interpolate,L="L",tension=.7;return area.x=function(_){return arguments.length?(x0=x1=_,area):x1},area.x0=function(_){return arguments.length?(x0=_,area):x0},area.x1=function(_){return arguments.length?(x1=_,area):x1},area.y=function(_){return arguments.length?(y0=y1=_,area):y1},area.y0=function(_){return arguments.length?(y0=_,area):y0},area.y1=function(_){return arguments.length?(y1=_,area):y1},area.defined=function(_){return arguments.length?(defined=_,area):defined},area.interpolate=function(_){return arguments.length?(interpolateKey="function"==typeof _?interpolate=_:(interpolate=d3_svg_lineInterpolators.get(_)||d3_svg_lineLinear).key,interpolateReverse=interpolate.reverse||interpolate,L=interpolate.closed?"M":"L",area):interpolateKey},area.tension=function(_){return arguments.length?(tension=_,area):tension},area}function d3_svg_chordRadius(d){return d.radius}function d3_svg_diagonalProjection(d){return[d.x,d.y]}function d3_svg_diagonalRadialProjection(projection){return function(){var d=projection.apply(this,arguments),r=d[0],a=d[1]-halfπ;return[r*Math.cos(a),r*Math.sin(a)]}}function d3_svg_symbolSize(){return 64}function d3_svg_symbolType(){return"circle"}function d3_svg_symbolCircle(size){var r=Math.sqrt(size/π);return"M0,"+r+"A"+r+","+r+" 0 1,1 0,"+-r+"A"+r+","+r+" 0 1,1 0,"+r+"Z"}function d3_selection_interruptNS(ns){return function(){var lock,activeId,active;(lock=this[ns])&&(active=lock[activeId=lock.active])&&(active.timer.c=null,active.timer.t=0/0,--lock.count?delete lock[activeId]:delete this[ns],lock.active+=.5,active.event&&active.event.interrupt.call(this,this.__data__,active.index))}}function d3_transition(groups,ns,id){return d3_subclass(groups,d3_transitionPrototype),groups.namespace=ns,groups.id=id,groups}function d3_transition_tween(groups,name,value,tween){var id=groups.id,ns=groups.namespace;return d3_selection_each(groups,"function"==typeof value?function(node,i,j){node[ns][id].tween.set(name,tween(value.call(node,node.__data__,i,j)))}:(value=tween(value),function(node){node[ns][id].tween.set(name,value)}))}function d3_transition_text(b){return null==b&&(b=""),function(){this.textContent=b}}function d3_transitionNamespace(name){return null==name?"__transition__":"__transition_"+name+"__"}function d3_transitionNode(node,i,ns,id,inherit){function schedule(elapsed){var delay=transition.delay;return timer.t=delay+time,elapsed>=delay?start(elapsed-delay):void(timer.c=start)}function start(elapsed){var activeId=lock.active,active=lock[activeId];active&&(active.timer.c=null,active.timer.t=0/0,--lock.count,delete lock[activeId],active.event&&active.event.interrupt.call(node,node.__data__,active.index));for(var cancelId in lock)if(id>+cancelId){var cancel=lock[cancelId];cancel.timer.c=null,cancel.timer.t=0/0,--lock.count,delete lock[cancelId]}lock.active=id,transition.event&&transition.event.start.call(node,node.__data__,i),tweens=[],transition.tween.forEach(function(key,value){(value=value.call(node,node.__data__,i))&&tweens.push(value)}),ease=transition.ease,duration=transition.duration,timer.c=tick,d3_timer(function(){return timer.c&&tick(elapsed||1)&&(timer.c=null,timer.t=0/0),1},0,time)}function tick(elapsed){for(var t=elapsed/duration,e=ease(t),n=tweens.length;n>0;)tweens[--n].call(node,e);return t>=1?(transition.event&&transition.event.end.call(node,node.__data__,i),--lock.count?delete lock[id]:delete node[ns],1):void 0}var time,timer,duration,ease,tweens,lock=node[ns]||(node[ns]={active:0,count:0}),transition=lock[id];transition||(time=inherit.time,timer=d3_timer(schedule,0,time),transition=lock[id]={tween:new d3_Map,time:time,timer:timer,delay:inherit.delay,duration:inherit.duration,ease:inherit.ease,index:i},inherit=null,++lock.count)}function d3_svg_axisX(selection,x0,x1){selection.attr("transform",function(d){var v0=x0(d);return"translate("+(isFinite(v0)?v0:x1(d))+",0)"})}function d3_svg_axisY(selection,y0,y1){selection.attr("transform",function(d){var v0=y0(d);return"translate(0,"+(isFinite(v0)?v0:y1(d))+")"})}function d3_time_formatIsoNative(date){return date.toISOString()}function d3_time_scale(linear,methods,format){function scale(x){return linear(x)}function tickMethod(extent,count){var span=extent[1]-extent[0],target=span/count,i=d3.bisect(d3_time_scaleSteps,target);return i==d3_time_scaleSteps.length?[methods.year,d3_scale_linearTickRange(extent.map(function(d){return d/31536e6}),count)[2]]:i?methods[target/d3_time_scaleSteps[i-1]<d3_time_scaleSteps[i]/target?i-1:i]:[d3_time_scaleMilliseconds,d3_scale_linearTickRange(extent,count)[2]]}return scale.invert=function(x){return d3_time_scaleDate(linear.invert(x))},scale.domain=function(x){return arguments.length?(linear.domain(x),scale):linear.domain().map(d3_time_scaleDate)},scale.nice=function(interval,skip){function skipped(date){return!isNaN(date)&&!interval.range(date,d3_time_scaleDate(+date+1),skip).length}var domain=scale.domain(),extent=d3_scaleExtent(domain),method=null==interval?tickMethod(extent,10):"number"==typeof interval&&tickMethod(extent,interval);return method&&(interval=method[0],skip=method[1]),scale.domain(d3_scale_nice(domain,skip>1?{floor:function(date){for(;skipped(date=interval.floor(date));)date=d3_time_scaleDate(date-1);return date},ceil:function(date){for(;skipped(date=interval.ceil(date));)date=d3_time_scaleDate(+date+1);return date}}:interval))},scale.ticks=function(interval,skip){var extent=d3_scaleExtent(scale.domain()),method=null==interval?tickMethod(extent,10):"number"==typeof interval?tickMethod(extent,interval):!interval.range&&[{range:interval},skip];return method&&(interval=method[0],skip=method[1]),interval.range(extent[0],d3_time_scaleDate(+extent[1]+1),1>skip?1:skip)},scale.tickFormat=function(){return format},scale.copy=function(){return d3_time_scale(linear.copy(),methods,format)},d3_scale_linearRebind(scale,linear)}function d3_time_scaleDate(t){return new Date(t)}function d3_json(request){return JSON.parse(request.responseText)}function d3_html(request){var range=d3_document.createRange();return range.selectNode(d3_document.body),range.createContextualFragment(request.responseText)}var d3={version:"3.5.8"},d3_arraySlice=[].slice,d3_array=function(list){return d3_arraySlice.call(list)},d3_document=this.document;if(d3_document)try{d3_array(d3_document.documentElement.childNodes)[0].nodeType}catch(e){d3_array=function(list){for(var i=list.length,array=new Array(i);i--;)array[i]=list[i];return array}}if(Date.now||(Date.now=function(){return+new Date}),d3_document)try{d3_document.createElement("DIV").style.setProperty("opacity",0,"")}catch(error){var d3_element_prototype=this.Element.prototype,d3_element_setAttribute=d3_element_prototype.setAttribute,d3_element_setAttributeNS=d3_element_prototype.setAttributeNS,d3_style_prototype=this.CSSStyleDeclaration.prototype,d3_style_setProperty=d3_style_prototype.setProperty;d3_element_prototype.setAttribute=function(name,value){d3_element_setAttribute.call(this,name,value+"")},d3_element_prototype.setAttributeNS=function(space,local,value){d3_element_setAttributeNS.call(this,space,local,value+"")},d3_style_prototype.setProperty=function(name,value,priority){d3_style_setProperty.call(this,name,value+"",priority)}}d3.ascending=d3_ascending,d3.descending=function(a,b){return a>b?-1:b>a?1:b>=a?0:0/0},d3.min=function(array,f){var a,b,i=-1,n=array.length;if(1===arguments.length){for(;++i<n;)if(null!=(b=array[i])&&b>=b){a=b;break}for(;++i<n;)null!=(b=array[i])&&a>b&&(a=b)}else{for(;++i<n;)if(null!=(b=f.call(array,array[i],i))&&b>=b){a=b;break}for(;++i<n;)null!=(b=f.call(array,array[i],i))&&a>b&&(a=b)}return a},d3.max=function(array,f){var a,b,i=-1,n=array.length;if(1===arguments.length){for(;++i<n;)if(null!=(b=array[i])&&b>=b){a=b;break}for(;++i<n;)null!=(b=array[i])&&b>a&&(a=b)}else{for(;++i<n;)if(null!=(b=f.call(array,array[i],i))&&b>=b){a=b;break}for(;++i<n;)null!=(b=f.call(array,array[i],i))&&b>a&&(a=b)}return a},d3.extent=function(array,f){var a,b,c,i=-1,n=array.length;if(1===arguments.length){for(;++i<n;)if(null!=(b=array[i])&&b>=b){a=c=b;break}for(;++i<n;)null!=(b=array[i])&&(a>b&&(a=b),b>c&&(c=b))}else{for(;++i<n;)if(null!=(b=f.call(array,array[i],i))&&b>=b){a=c=b;break}for(;++i<n;)null!=(b=f.call(array,array[i],i))&&(a>b&&(a=b),b>c&&(c=b))}return[a,c]},d3.sum=function(array,f){var a,s=0,n=array.length,i=-1;if(1===arguments.length)for(;++i<n;)d3_numeric(a=+array[i])&&(s+=a);else for(;++i<n;)d3_numeric(a=+f.call(array,array[i],i))&&(s+=a);return s},d3.mean=function(array,f){var a,s=0,n=array.length,i=-1,j=n;if(1===arguments.length)for(;++i<n;)d3_numeric(a=d3_number(array[i]))?s+=a:--j;else for(;++i<n;)d3_numeric(a=d3_number(f.call(array,array[i],i)))?s+=a:--j;return j?s/j:void 0},d3.quantile=function(values,p){var H=(values.length-1)*p+1,h=Math.floor(H),v=+values[h-1],e=H-h;return e?v+e*(values[h]-v):v},d3.median=function(array,f){var a,numbers=[],n=array.length,i=-1;if(1===arguments.length)for(;++i<n;)d3_numeric(a=d3_number(array[i]))&&numbers.push(a);else for(;++i<n;)d3_numeric(a=d3_number(f.call(array,array[i],i)))&&numbers.push(a);return numbers.length?d3.quantile(numbers.sort(d3_ascending),.5):void 0},d3.variance=function(array,f){var a,d,n=array.length,m=0,s=0,i=-1,j=0;if(1===arguments.length)for(;++i<n;)d3_numeric(a=d3_number(array[i]))&&(d=a-m,m+=d/++j,s+=d*(a-m));else for(;++i<n;)d3_numeric(a=d3_number(f.call(array,array[i],i)))&&(d=a-m,m+=d/++j,s+=d*(a-m));return j>1?s/(j-1):void 0},d3.deviation=function(){var v=d3.variance.apply(this,arguments);return v?Math.sqrt(v):v};var d3_bisect=d3_bisector(d3_ascending);d3.bisectLeft=d3_bisect.left,d3.bisect=d3.bisectRight=d3_bisect.right,d3.bisector=function(f){return d3_bisector(1===f.length?function(d,x){return d3_ascending(f(d),x)}:f)},d3.shuffle=function(array,i0,i1){(m=arguments.length)<3&&(i1=array.length,2>m&&(i0=0));for(var t,i,m=i1-i0;m;)i=Math.random()*m--|0,t=array[m+i0],array[m+i0]=array[i+i0],array[i+i0]=t;return array},d3.permute=function(array,indexes){for(var i=indexes.length,permutes=new Array(i);i--;)permutes[i]=array[indexes[i]];return permutes},d3.pairs=function(array){for(var p0,i=0,n=array.length-1,p1=array[0],pairs=new Array(0>n?0:n);n>i;)pairs[i]=[p0=p1,p1=array[++i]];return pairs},d3.zip=function(){if(!(n=arguments.length))return[];for(var i=-1,m=d3.min(arguments,d3_zipLength),zips=new Array(m);++i<m;)for(var n,j=-1,zip=zips[i]=new Array(n);++j<n;)zip[j]=arguments[j][i];return zips},d3.transpose=function(matrix){return d3.zip.apply(d3,matrix)},d3.keys=function(map){var keys=[];for(var key in map)keys.push(key);return keys},d3.values=function(map){var values=[];for(var key in map)values.push(map[key]);return values},d3.entries=function(map){var entries=[];for(var key in map)entries.push({key:key,value:map[key]});return entries},d3.merge=function(arrays){for(var m,merged,array,n=arrays.length,i=-1,j=0;++i<n;)j+=arrays[i].length;for(merged=new Array(j);--n>=0;)for(array=arrays[n],m=array.length;--m>=0;)merged[--j]=array[m];return merged};var abs=Math.abs;d3.range=function(start,stop,step){if(arguments.length<3&&(step=1,arguments.length<2&&(stop=start,start=0)),(stop-start)/step===1/0)throw new Error("infinite range");var j,range=[],k=d3_range_integerScale(abs(step)),i=-1;if(start*=k,stop*=k,step*=k,0>step)for(;(j=start+step*++i)>stop;)range.push(j/k);else for(;(j=start+step*++i)<stop;)range.push(j/k);return range},d3.map=function(object,f){var map=new d3_Map;if(object instanceof d3_Map)object.forEach(function(key,value){map.set(key,value)});else if(Array.isArray(object)){var o,i=-1,n=object.length;if(1===arguments.length)for(;++i<n;)map.set(i,object[i]);else for(;++i<n;)map.set(f.call(object,o=object[i],i),o)}else for(var key in object)map.set(key,object[key]);return map};var d3_map_proto="__proto__",d3_map_zero="\x00";d3_class(d3_Map,{has:d3_map_has,get:function(key){return this._[d3_map_escape(key)]},set:function(key,value){return this._[d3_map_escape(key)]=value},remove:d3_map_remove,keys:d3_map_keys,values:function(){var values=[];for(var key in this._)values.push(this._[key]);return values},entries:function(){var entries=[];for(var key in this._)entries.push({key:d3_map_unescape(key),value:this._[key]});return entries},size:d3_map_size,empty:d3_map_empty,forEach:function(f){for(var key in this._)f.call(this,d3_map_unescape(key),this._[key])}}),d3.nest=function(){function map(mapType,array,depth){if(depth>=keys.length)return rollup?rollup.call(nest,array):sortValues?array.sort(sortValues):array;
for(var keyValue,object,setter,values,i=-1,n=array.length,key=keys[depth++],valuesByKey=new d3_Map;++i<n;)(values=valuesByKey.get(keyValue=key(object=array[i])))?values.push(object):valuesByKey.set(keyValue,[object]);return mapType?(object=mapType(),setter=function(keyValue,values){object.set(keyValue,map(mapType,values,depth))}):(object={},setter=function(keyValue,values){object[keyValue]=map(mapType,values,depth)}),valuesByKey.forEach(setter),object}function entries(map,depth){if(depth>=keys.length)return map;var array=[],sortKey=sortKeys[depth++];return map.forEach(function(key,keyMap){array.push({key:key,values:entries(keyMap,depth)})}),sortKey?array.sort(function(a,b){return sortKey(a.key,b.key)}):array}var sortValues,rollup,nest={},keys=[],sortKeys=[];return nest.map=function(array,mapType){return map(mapType,array,0)},nest.entries=function(array){return entries(map(d3.map,array,0),0)},nest.key=function(d){return keys.push(d),nest},nest.sortKeys=function(order){return sortKeys[keys.length-1]=order,nest},nest.sortValues=function(order){return sortValues=order,nest},nest.rollup=function(f){return rollup=f,nest},nest},d3.set=function(array){var set=new d3_Set;if(array)for(var i=0,n=array.length;n>i;++i)set.add(array[i]);return set},d3_class(d3_Set,{has:d3_map_has,add:function(key){return this._[d3_map_escape(key+="")]=!0,key},remove:d3_map_remove,values:d3_map_keys,size:d3_map_size,empty:d3_map_empty,forEach:function(f){for(var key in this._)f.call(this,d3_map_unescape(key))}}),d3.behavior={},d3.rebind=function(target,source){for(var method,i=1,n=arguments.length;++i<n;)target[method=arguments[i]]=d3_rebind(target,source,source[method]);return target};var d3_vendorPrefixes=["webkit","ms","moz","Moz","o","O"];d3.dispatch=function(){for(var dispatch=new d3_dispatch,i=-1,n=arguments.length;++i<n;)dispatch[arguments[i]]=d3_dispatch_event(dispatch);return dispatch},d3_dispatch.prototype.on=function(type,listener){var i=type.indexOf("."),name="";if(i>=0&&(name=type.slice(i+1),type=type.slice(0,i)),type)return arguments.length<2?this[type].on(name):this[type].on(name,listener);if(2===arguments.length){if(null==listener)for(type in this)this.hasOwnProperty(type)&&this[type].on(name,null);return this}},d3.event=null,d3.requote=function(s){return s.replace(d3_requote_re,"\\$&")};var d3_requote_re=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,d3_subclass={}.__proto__?function(object,prototype){object.__proto__=prototype}:function(object,prototype){for(var property in prototype)object[property]=prototype[property]},d3_select=function(s,n){return n.querySelector(s)},d3_selectAll=function(s,n){return n.querySelectorAll(s)},d3_selectMatches=function(n,s){var d3_selectMatcher=n.matches||n[d3_vendorSymbol(n,"matchesSelector")];return(d3_selectMatches=function(n,s){return d3_selectMatcher.call(n,s)})(n,s)};"function"==typeof Sizzle&&(d3_select=function(s,n){return Sizzle(s,n)[0]||null},d3_selectAll=Sizzle,d3_selectMatches=Sizzle.matchesSelector),d3.selection=function(){return d3.select(d3_document.documentElement)};var d3_selectionPrototype=d3.selection.prototype=[];d3_selectionPrototype.select=function(selector){var subgroup,subnode,group,node,subgroups=[];selector=d3_selection_selector(selector);for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]),subgroup.parentNode=(group=this[j]).parentNode;for(var i=-1,n=group.length;++i<n;)(node=group[i])?(subgroup.push(subnode=selector.call(node,node.__data__,i,j)),subnode&&"__data__"in node&&(subnode.__data__=node.__data__)):subgroup.push(null)}return d3_selection(subgroups)},d3_selectionPrototype.selectAll=function(selector){var subgroup,node,subgroups=[];selector=d3_selection_selectorAll(selector);for(var j=-1,m=this.length;++j<m;)for(var group=this[j],i=-1,n=group.length;++i<n;)(node=group[i])&&(subgroups.push(subgroup=d3_array(selector.call(node,node.__data__,i,j))),subgroup.parentNode=node);return d3_selection(subgroups)};var d3_nsPrefix={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:d3_nsPrefix,qualify:function(name){var i=name.indexOf(":"),prefix=name;return i>=0&&"xmlns"!==(prefix=name.slice(0,i))&&(name=name.slice(i+1)),d3_nsPrefix.hasOwnProperty(prefix)?{space:d3_nsPrefix[prefix],local:name}:name}},d3_selectionPrototype.attr=function(name,value){if(arguments.length<2){if("string"==typeof name){var node=this.node();return name=d3.ns.qualify(name),name.local?node.getAttributeNS(name.space,name.local):node.getAttribute(name)}for(value in name)this.each(d3_selection_attr(value,name[value]));return this}return this.each(d3_selection_attr(name,value))},d3_selectionPrototype.classed=function(name,value){if(arguments.length<2){if("string"==typeof name){var node=this.node(),n=(name=d3_selection_classes(name)).length,i=-1;if(value=node.classList){for(;++i<n;)if(!value.contains(name[i]))return!1}else for(value=node.getAttribute("class");++i<n;)if(!d3_selection_classedRe(name[i]).test(value))return!1;return!0}for(value in name)this.each(d3_selection_classed(value,name[value]));return this}return this.each(d3_selection_classed(name,value))},d3_selectionPrototype.style=function(name,value,priority){var n=arguments.length;if(3>n){if("string"!=typeof name){2>n&&(value="");for(priority in name)this.each(d3_selection_style(priority,name[priority],value));return this}if(2>n){var node=this.node();return d3_window(node).getComputedStyle(node,null).getPropertyValue(name)}priority=""}return this.each(d3_selection_style(name,value,priority))},d3_selectionPrototype.property=function(name,value){if(arguments.length<2){if("string"==typeof name)return this.node()[name];for(value in name)this.each(d3_selection_property(value,name[value]));return this}return this.each(d3_selection_property(name,value))},d3_selectionPrototype.text=function(value){return arguments.length?this.each("function"==typeof value?function(){var v=value.apply(this,arguments);this.textContent=null==v?"":v}:null==value?function(){this.textContent=""}:function(){this.textContent=value}):this.node().textContent},d3_selectionPrototype.html=function(value){return arguments.length?this.each("function"==typeof value?function(){var v=value.apply(this,arguments);this.innerHTML=null==v?"":v}:null==value?function(){this.innerHTML=""}:function(){this.innerHTML=value}):this.node().innerHTML},d3_selectionPrototype.append=function(name){return name=d3_selection_creator(name),this.select(function(){return this.appendChild(name.apply(this,arguments))})},d3_selectionPrototype.insert=function(name,before){return name=d3_selection_creator(name),before=d3_selection_selector(before),this.select(function(){return this.insertBefore(name.apply(this,arguments),before.apply(this,arguments)||null)})},d3_selectionPrototype.remove=function(){return this.each(d3_selectionRemove)},d3_selectionPrototype.data=function(value,key){function bind(group,groupData){var i,node,nodeData,n=group.length,m=groupData.length,n0=Math.min(n,m),updateNodes=new Array(m),enterNodes=new Array(m),exitNodes=new Array(n);if(key){var keyValue,nodeByKeyValue=new d3_Map,keyValues=new Array(n);for(i=-1;++i<n;)(node=group[i])&&(nodeByKeyValue.has(keyValue=key.call(node,node.__data__,i))?exitNodes[i]=node:nodeByKeyValue.set(keyValue,node),keyValues[i]=keyValue);for(i=-1;++i<m;)(node=nodeByKeyValue.get(keyValue=key.call(groupData,nodeData=groupData[i],i)))?node!==!0&&(updateNodes[i]=node,node.__data__=nodeData):enterNodes[i]=d3_selection_dataNode(nodeData),nodeByKeyValue.set(keyValue,!0);for(i=-1;++i<n;)i in keyValues&&nodeByKeyValue.get(keyValues[i])!==!0&&(exitNodes[i]=group[i])}else{for(i=-1;++i<n0;)node=group[i],nodeData=groupData[i],node?(node.__data__=nodeData,updateNodes[i]=node):enterNodes[i]=d3_selection_dataNode(nodeData);for(;m>i;++i)enterNodes[i]=d3_selection_dataNode(groupData[i]);for(;n>i;++i)exitNodes[i]=group[i]}enterNodes.update=updateNodes,enterNodes.parentNode=updateNodes.parentNode=exitNodes.parentNode=group.parentNode,enter.push(enterNodes),update.push(updateNodes),exit.push(exitNodes)}var group,node,i=-1,n=this.length;if(!arguments.length){for(value=new Array(n=(group=this[0]).length);++i<n;)(node=group[i])&&(value[i]=node.__data__);return value}var enter=d3_selection_enter([]),update=d3_selection([]),exit=d3_selection([]);if("function"==typeof value)for(;++i<n;)bind(group=this[i],value.call(group,group.parentNode.__data__,i));else for(;++i<n;)bind(group=this[i],value);return update.enter=function(){return enter},update.exit=function(){return exit},update},d3_selectionPrototype.datum=function(value){return arguments.length?this.property("__data__",value):this.property("__data__")},d3_selectionPrototype.filter=function(filter){var subgroup,group,node,subgroups=[];"function"!=typeof filter&&(filter=d3_selection_filter(filter));for(var j=0,m=this.length;m>j;j++){subgroups.push(subgroup=[]),subgroup.parentNode=(group=this[j]).parentNode;for(var i=0,n=group.length;n>i;i++)(node=group[i])&&filter.call(node,node.__data__,i,j)&&subgroup.push(node)}return d3_selection(subgroups)},d3_selectionPrototype.order=function(){for(var j=-1,m=this.length;++j<m;)for(var node,group=this[j],i=group.length-1,next=group[i];--i>=0;)(node=group[i])&&(next&&next!==node.nextSibling&&next.parentNode.insertBefore(node,next),next=node);return this},d3_selectionPrototype.sort=function(comparator){comparator=d3_selection_sortComparator.apply(this,arguments);for(var j=-1,m=this.length;++j<m;)this[j].sort(comparator);return this.order()},d3_selectionPrototype.each=function(callback){return d3_selection_each(this,function(node,i,j){callback.call(node,node.__data__,i,j)})},d3_selectionPrototype.call=function(callback){var args=d3_array(arguments);return callback.apply(args[0]=this,args),this},d3_selectionPrototype.empty=function(){return!this.node()},d3_selectionPrototype.node=function(){for(var j=0,m=this.length;m>j;j++)for(var group=this[j],i=0,n=group.length;n>i;i++){var node=group[i];if(node)return node}return null},d3_selectionPrototype.size=function(){var n=0;return d3_selection_each(this,function(){++n}),n};var d3_selection_enterPrototype=[];d3.selection.enter=d3_selection_enter,d3.selection.enter.prototype=d3_selection_enterPrototype,d3_selection_enterPrototype.append=d3_selectionPrototype.append,d3_selection_enterPrototype.empty=d3_selectionPrototype.empty,d3_selection_enterPrototype.node=d3_selectionPrototype.node,d3_selection_enterPrototype.call=d3_selectionPrototype.call,d3_selection_enterPrototype.size=d3_selectionPrototype.size,d3_selection_enterPrototype.select=function(selector){for(var subgroup,subnode,upgroup,group,node,subgroups=[],j=-1,m=this.length;++j<m;){upgroup=(group=this[j]).update,subgroups.push(subgroup=[]),subgroup.parentNode=group.parentNode;for(var i=-1,n=group.length;++i<n;)(node=group[i])?(subgroup.push(upgroup[i]=subnode=selector.call(group.parentNode,node.__data__,i,j)),subnode.__data__=node.__data__):subgroup.push(null)}return d3_selection(subgroups)},d3_selection_enterPrototype.insert=function(name,before){return arguments.length<2&&(before=d3_selection_enterInsertBefore(this)),d3_selectionPrototype.insert.call(this,name,before)},d3.select=function(node){var group;return"string"==typeof node?(group=[d3_select(node,d3_document)],group.parentNode=d3_document.documentElement):(group=[node],group.parentNode=d3_documentElement(node)),d3_selection([group])},d3.selectAll=function(nodes){var group;return"string"==typeof nodes?(group=d3_array(d3_selectAll(nodes,d3_document)),group.parentNode=d3_document.documentElement):(group=d3_array(nodes),group.parentNode=null),d3_selection([group])},d3_selectionPrototype.on=function(type,listener,capture){var n=arguments.length;if(3>n){if("string"!=typeof type){2>n&&(listener=!1);for(capture in type)this.each(d3_selection_on(capture,type[capture],listener));return this}if(2>n)return(n=this.node()["__on"+type])&&n._;capture=!1}return this.each(d3_selection_on(type,listener,capture))};var d3_selection_onFilters=d3.map({mouseenter:"mouseover",mouseleave:"mouseout"});d3_document&&d3_selection_onFilters.forEach(function(k){"on"+k in d3_document&&d3_selection_onFilters.remove(k)});var d3_event_dragSelect,d3_event_dragId=0;d3.mouse=function(container){return d3_mousePoint(container,d3_eventSource())};var d3_mouse_bug44083=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;d3.touch=function(container,touches,identifier){if(arguments.length<3&&(identifier=touches,touches=d3_eventSource().changedTouches),touches)for(var touch,i=0,n=touches.length;n>i;++i)if((touch=touches[i]).identifier===identifier)return d3_mousePoint(container,touch)},d3.behavior.drag=function(){function drag(){this.on("mousedown.drag",mousedown).on("touchstart.drag",touchstart)}function dragstart(id,position,subject,move,end){return function(){function moved(){var dx,dy,position1=position(parent,dragId);position1&&(dx=position1[0]-position0[0],dy=position1[1]-position0[1],dragged|=dx|dy,position0=position1,dispatch({type:"drag",x:position1[0]+dragOffset[0],y:position1[1]+dragOffset[1],dx:dx,dy:dy}))}function ended(){position(parent,dragId)&&(dragSubject.on(move+dragName,null).on(end+dragName,null),dragRestore(dragged&&d3.event.target===target),dispatch({type:"dragend"}))}var dragOffset,that=this,target=d3.event.target,parent=that.parentNode,dispatch=event.of(that,arguments),dragged=0,dragId=id(),dragName=".drag"+(null==dragId?"":"-"+dragId),dragSubject=d3.select(subject(target)).on(move+dragName,moved).on(end+dragName,ended),dragRestore=d3_event_dragSuppress(target),position0=position(parent,dragId);origin?(dragOffset=origin.apply(that,arguments),dragOffset=[dragOffset.x-position0[0],dragOffset.y-position0[1]]):dragOffset=[0,0],dispatch({type:"dragstart"})}}var event=d3_eventDispatch(drag,"drag","dragstart","dragend"),origin=null,mousedown=dragstart(d3_noop,d3.mouse,d3_window,"mousemove","mouseup"),touchstart=dragstart(d3_behavior_dragTouchId,d3.touch,d3_identity,"touchmove","touchend");return drag.origin=function(x){return arguments.length?(origin=x,drag):origin},d3.rebind(drag,event,"on")},d3.touches=function(container,touches){return arguments.length<2&&(touches=d3_eventSource().touches),touches?d3_array(touches).map(function(touch){var point=d3_mousePoint(container,touch);return point.identifier=touch.identifier,point}):[]};var ε=1e-6,ε2=ε*ε,π=Math.PI,τ=2*π,τε=τ-ε,halfπ=π/2,d3_radians=π/180,d3_degrees=180/π,ρ=Math.SQRT2,ρ2=2,ρ4=4;d3.interpolateZoom=function(p0,p1){var i,S,ux0=p0[0],uy0=p0[1],w0=p0[2],ux1=p1[0],uy1=p1[1],w1=p1[2],dx=ux1-ux0,dy=uy1-uy0,d2=dx*dx+dy*dy;if(ε2>d2)S=Math.log(w1/w0)/ρ,i=function(t){return[ux0+t*dx,uy0+t*dy,w0*Math.exp(ρ*t*S)]};else{var d1=Math.sqrt(d2),b0=(w1*w1-w0*w0+ρ4*d2)/(2*w0*ρ2*d1),b1=(w1*w1-w0*w0-ρ4*d2)/(2*w1*ρ2*d1),r0=Math.log(Math.sqrt(b0*b0+1)-b0),r1=Math.log(Math.sqrt(b1*b1+1)-b1);S=(r1-r0)/ρ,i=function(t){var s=t*S,coshr0=d3_cosh(r0),u=w0/(ρ2*d1)*(coshr0*d3_tanh(ρ*s+r0)-d3_sinh(r0));return[ux0+u*dx,uy0+u*dy,w0*coshr0/d3_cosh(ρ*s+r0)]}}return i.duration=1e3*S,i},d3.behavior.zoom=function(){function zoom(g){g.on(mousedown,mousedowned).on(d3_behavior_zoomWheel+".zoom",mousewheeled).on("dblclick.zoom",dblclicked).on(touchstart,touchstarted)}function location(p){return[(p[0]-view.x)/view.k,(p[1]-view.y)/view.k]}function point(l){return[l[0]*view.k+view.x,l[1]*view.k+view.y]}function scaleTo(s){view.k=Math.max(scaleExtent[0],Math.min(scaleExtent[1],s))}function translateTo(p,l){l=point(l),view.x+=p[0]-l[0],view.y+=p[1]-l[1]}function zoomTo(that,p,l,k){that.__chart__={x:view.x,y:view.y,k:view.k},scaleTo(Math.pow(2,k)),translateTo(center0=p,l),that=d3.select(that),duration>0&&(that=that.transition().duration(duration)),that.call(zoom.event)}function rescale(){x1&&x1.domain(x0.range().map(function(x){return(x-view.x)/view.k}).map(x0.invert)),y1&&y1.domain(y0.range().map(function(y){return(y-view.y)/view.k}).map(y0.invert))}function zoomstarted(dispatch){zooming++||dispatch({type:"zoomstart"})}function zoomed(dispatch){rescale(),dispatch({type:"zoom",scale:view.k,translate:[view.x,view.y]})}function zoomended(dispatch){--zooming||(dispatch({type:"zoomend"}),center0=null)}function mousedowned(){function moved(){dragged=1,translateTo(d3.mouse(that),location0),zoomed(dispatch)}function ended(){subject.on(mousemove,null).on(mouseup,null),dragRestore(dragged&&d3.event.target===target),zoomended(dispatch)}var that=this,target=d3.event.target,dispatch=event.of(that,arguments),dragged=0,subject=d3.select(d3_window(that)).on(mousemove,moved).on(mouseup,ended),location0=location(d3.mouse(that)),dragRestore=d3_event_dragSuppress(that);d3_selection_interrupt.call(that),zoomstarted(dispatch)}function touchstarted(){function relocate(){var touches=d3.touches(that);return scale0=view.k,touches.forEach(function(t){t.identifier in locations0&&(locations0[t.identifier]=location(t))}),touches}function started(){var target=d3.event.target;d3.select(target).on(touchmove,moved).on(touchend,ended),targets.push(target);for(var changed=d3.event.changedTouches,i=0,n=changed.length;n>i;++i)locations0[changed[i].identifier]=null;var touches=relocate(),now=Date.now();if(1===touches.length){if(500>now-touchtime){var p=touches[0];zoomTo(that,p,locations0[p.identifier],Math.floor(Math.log(view.k)/Math.LN2)+1),d3_eventPreventDefault()}touchtime=now}else if(touches.length>1){var p=touches[0],q=touches[1],dx=p[0]-q[0],dy=p[1]-q[1];distance0=dx*dx+dy*dy}}function moved(){var p0,l0,p1,l1,touches=d3.touches(that);d3_selection_interrupt.call(that);for(var i=0,n=touches.length;n>i;++i,l1=null)if(p1=touches[i],l1=locations0[p1.identifier]){if(l0)break;p0=p1,l0=l1}if(l1){var distance1=(distance1=p1[0]-p0[0])*distance1+(distance1=p1[1]-p0[1])*distance1,scale1=distance0&&Math.sqrt(distance1/distance0);p0=[(p0[0]+p1[0])/2,(p0[1]+p1[1])/2],l0=[(l0[0]+l1[0])/2,(l0[1]+l1[1])/2],scaleTo(scale1*scale0)}touchtime=null,translateTo(p0,l0),zoomed(dispatch)}function ended(){if(d3.event.touches.length){for(var changed=d3.event.changedTouches,i=0,n=changed.length;n>i;++i)delete locations0[changed[i].identifier];for(var identifier in locations0)return void relocate()}d3.selectAll(targets).on(zoomName,null),subject.on(mousedown,mousedowned).on(touchstart,touchstarted),dragRestore(),zoomended(dispatch)}var scale0,that=this,dispatch=event.of(that,arguments),locations0={},distance0=0,zoomName=".zoom-"+d3.event.changedTouches[0].identifier,touchmove="touchmove"+zoomName,touchend="touchend"+zoomName,targets=[],subject=d3.select(that),dragRestore=d3_event_dragSuppress(that);started(),zoomstarted(dispatch),subject.on(mousedown,null).on(touchstart,started)}function mousewheeled(){var dispatch=event.of(this,arguments);mousewheelTimer?clearTimeout(mousewheelTimer):(d3_selection_interrupt.call(this),translate0=location(center0=center||d3.mouse(this)),zoomstarted(dispatch)),mousewheelTimer=setTimeout(function(){mousewheelTimer=null,zoomended(dispatch)},50),d3_eventPreventDefault(),scaleTo(Math.pow(2,.002*d3_behavior_zoomDelta())*view.k),translateTo(center0,translate0),zoomed(dispatch)}function dblclicked(){var p=d3.mouse(this),k=Math.log(view.k)/Math.LN2;zoomTo(this,p,location(p),d3.event.shiftKey?Math.ceil(k)-1:Math.floor(k)+1)}var translate0,center0,center,mousewheelTimer,touchtime,x0,x1,y0,y1,view={x:0,y:0,k:1},size=[960,500],scaleExtent=d3_behavior_zoomInfinity,duration=250,zooming=0,mousedown="mousedown.zoom",mousemove="mousemove.zoom",mouseup="mouseup.zoom",touchstart="touchstart.zoom",event=d3_eventDispatch(zoom,"zoomstart","zoom","zoomend");return d3_behavior_zoomWheel||(d3_behavior_zoomWheel="onwheel"in d3_document?(d3_behavior_zoomDelta=function(){return-d3.event.deltaY*(d3.event.deltaMode?120:1)},"wheel"):"onmousewheel"in d3_document?(d3_behavior_zoomDelta=function(){return d3.event.wheelDelta},"mousewheel"):(d3_behavior_zoomDelta=function(){return-d3.event.detail},"MozMousePixelScroll")),zoom.event=function(g){g.each(function(){var dispatch=event.of(this,arguments),view1=view;d3_transitionInheritId?d3.select(this).transition().each("start.zoom",function(){view=this.__chart__||{x:0,y:0,k:1},zoomstarted(dispatch)}).tween("zoom:zoom",function(){var dx=size[0],dy=size[1],cx=center0?center0[0]:dx/2,cy=center0?center0[1]:dy/2,i=d3.interpolateZoom([(cx-view.x)/view.k,(cy-view.y)/view.k,dx/view.k],[(cx-view1.x)/view1.k,(cy-view1.y)/view1.k,dx/view1.k]);return function(t){var l=i(t),k=dx/l[2];this.__chart__=view={x:cx-l[0]*k,y:cy-l[1]*k,k:k},zoomed(dispatch)}}).each("interrupt.zoom",function(){zoomended(dispatch)}).each("end.zoom",function(){zoomended(dispatch)}):(this.__chart__=view,zoomstarted(dispatch),zoomed(dispatch),zoomended(dispatch))})},zoom.translate=function(_){return arguments.length?(view={x:+_[0],y:+_[1],k:view.k},rescale(),zoom):[view.x,view.y]},zoom.scale=function(_){return arguments.length?(view={x:view.x,y:view.y,k:null},scaleTo(+_),rescale(),zoom):view.k},zoom.scaleExtent=function(_){return arguments.length?(scaleExtent=null==_?d3_behavior_zoomInfinity:[+_[0],+_[1]],zoom):scaleExtent},zoom.center=function(_){return arguments.length?(center=_&&[+_[0],+_[1]],zoom):center},zoom.size=function(_){return arguments.length?(size=_&&[+_[0],+_[1]],zoom):size},zoom.duration=function(_){return arguments.length?(duration=+_,zoom):duration},zoom.x=function(z){return arguments.length?(x1=z,x0=z.copy(),view={x:0,y:0,k:1},zoom):x1},zoom.y=function(z){return arguments.length?(y1=z,y0=z.copy(),view={x:0,y:0,k:1},zoom):y1},d3.rebind(zoom,event,"on")};var d3_behavior_zoomDelta,d3_behavior_zoomWheel,d3_behavior_zoomInfinity=[0,1/0];d3.color=d3_color,d3_color.prototype.toString=function(){return this.rgb()+""},d3.hsl=d3_hsl;var d3_hslPrototype=d3_hsl.prototype=new d3_color;d3_hslPrototype.brighter=function(k){return k=Math.pow(.7,arguments.length?k:1),new d3_hsl(this.h,this.s,this.l/k)},d3_hslPrototype.darker=function(k){return k=Math.pow(.7,arguments.length?k:1),new d3_hsl(this.h,this.s,k*this.l)},d3_hslPrototype.rgb=function(){return d3_hsl_rgb(this.h,this.s,this.l)},d3.hcl=d3_hcl;var d3_hclPrototype=d3_hcl.prototype=new d3_color;d3_hclPrototype.brighter=function(k){return new d3_hcl(this.h,this.c,Math.min(100,this.l+d3_lab_K*(arguments.length?k:1)))},d3_hclPrototype.darker=function(k){return new d3_hcl(this.h,this.c,Math.max(0,this.l-d3_lab_K*(arguments.length?k:1)))},d3_hclPrototype.rgb=function(){return d3_hcl_lab(this.h,this.c,this.l).rgb()},d3.lab=d3_lab;var d3_lab_K=18,d3_lab_X=.95047,d3_lab_Y=1,d3_lab_Z=1.08883,d3_labPrototype=d3_lab.prototype=new d3_color;d3_labPrototype.brighter=function(k){return new d3_lab(Math.min(100,this.l+d3_lab_K*(arguments.length?k:1)),this.a,this.b)},d3_labPrototype.darker=function(k){return new d3_lab(Math.max(0,this.l-d3_lab_K*(arguments.length?k:1)),this.a,this.b)},d3_labPrototype.rgb=function(){return d3_lab_rgb(this.l,this.a,this.b)},d3.rgb=d3_rgb;var d3_rgbPrototype=d3_rgb.prototype=new d3_color;d3_rgbPrototype.brighter=function(k){k=Math.pow(.7,arguments.length?k:1);var r=this.r,g=this.g,b=this.b,i=30;return r||g||b?(r&&i>r&&(r=i),g&&i>g&&(g=i),b&&i>b&&(b=i),new d3_rgb(Math.min(255,r/k),Math.min(255,g/k),Math.min(255,b/k))):new d3_rgb(i,i,i)},d3_rgbPrototype.darker=function(k){return k=Math.pow(.7,arguments.length?k:1),new d3_rgb(k*this.r,k*this.g,k*this.b)},d3_rgbPrototype.hsl=function(){return d3_rgb_hsl(this.r,this.g,this.b)},d3_rgbPrototype.toString=function(){return"#"+d3_rgb_hex(this.r)+d3_rgb_hex(this.g)+d3_rgb_hex(this.b)};var d3_rgb_names=d3.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});d3_rgb_names.forEach(function(key,value){d3_rgb_names.set(key,d3_rgbNumber(value))}),d3.functor=d3_functor,d3.xhr=d3_xhrType(d3_identity),d3.dsv=function(delimiter,mimeType){function dsv(url,row,callback){arguments.length<3&&(callback=row,row=null);var xhr=d3_xhr(url,mimeType,null==row?response:typedResponse(row),callback);return xhr.row=function(_){return arguments.length?xhr.response(null==(row=_)?response:typedResponse(_)):row},xhr}function response(request){return dsv.parse(request.responseText)}function typedResponse(f){return function(request){return dsv.parse(request.responseText,f)}}function formatRow(row){return row.map(formatValue).join(delimiter)}function formatValue(text){return reFormat.test(text)?'"'+text.replace(/\"/g,'""')+'"':text}var reFormat=new RegExp('["'+delimiter+"\n]"),delimiterCode=delimiter.charCodeAt(0);return dsv.parse=function(text,f){var o;return dsv.parseRows(text,function(row,i){if(o)return o(row,i-1);var a=new Function("d","return {"+row.map(function(name,i){return JSON.stringify(name)+": d["+i+"]"}).join(",")+"}");o=f?function(row,i){return f(a(row),i)}:a})},dsv.parseRows=function(text,f){function token(){if(I>=N)return EOF;if(eol)return eol=!1,EOL;var j=I;if(34===text.charCodeAt(j)){for(var i=j;i++<N;)if(34===text.charCodeAt(i)){if(34!==text.charCodeAt(i+1))break;++i}I=i+2;var c=text.charCodeAt(i+1);return 13===c?(eol=!0,10===text.charCodeAt(i+2)&&++I):10===c&&(eol=!0),text.slice(j+1,i).replace(/""/g,'"')}for(;N>I;){var c=text.charCodeAt(I++),k=1;if(10===c)eol=!0;else if(13===c)eol=!0,10===text.charCodeAt(I)&&(++I,++k);else if(c!==delimiterCode)continue;return text.slice(j,I-k)}return text.slice(j)}for(var t,eol,EOL={},EOF={},rows=[],N=text.length,I=0,n=0;(t=token())!==EOF;){for(var a=[];t!==EOL&&t!==EOF;)a.push(t),t=token();f&&null==(a=f(a,n++))||rows.push(a)}return rows},dsv.format=function(rows){if(Array.isArray(rows[0]))return dsv.formatRows(rows);var fieldSet=new d3_Set,fields=[];return rows.forEach(function(row){for(var field in row)fieldSet.has(field)||fields.push(fieldSet.add(field))}),[fields.map(formatValue).join(delimiter)].concat(rows.map(function(row){return fields.map(function(field){return formatValue(row[field])}).join(delimiter)})).join("\n")},dsv.formatRows=function(rows){return rows.map(formatRow).join("\n")},dsv},d3.csv=d3.dsv(",","text/csv"),d3.tsv=d3.dsv("	","text/tab-separated-values");var d3_timer_queueHead,d3_timer_queueTail,d3_timer_interval,d3_timer_timeout,d3_timer_frame=this[d3_vendorSymbol(this,"requestAnimationFrame")]||function(callback){setTimeout(callback,17)};d3.timer=function(){d3_timer.apply(this,arguments)},d3.timer.flush=function(){d3_timer_mark(),d3_timer_sweep()},d3.round=function(x,n){return n?Math.round(x*(n=Math.pow(10,n)))/n:Math.round(x)};var d3_formatPrefixes=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(d3_formatPrefix);d3.formatPrefix=function(value,precision){var i=0;return(value=+value)&&(0>value&&(value*=-1),precision&&(value=d3.round(value,d3_format_precision(value,precision))),i=1+Math.floor(1e-12+Math.log(value)/Math.LN10),i=Math.max(-24,Math.min(24,3*Math.floor((i-1)/3)))),d3_formatPrefixes[8+i/3]};var d3_format_re=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,d3_format_types=d3.map({b:function(x){return x.toString(2)},c:function(x){return String.fromCharCode(x)},o:function(x){return x.toString(8)},x:function(x){return x.toString(16)},X:function(x){return x.toString(16).toUpperCase()},g:function(x,p){return x.toPrecision(p)},e:function(x,p){return x.toExponential(p)},f:function(x,p){return x.toFixed(p)},r:function(x,p){return(x=d3.round(x,d3_format_precision(x,p))).toFixed(Math.max(0,Math.min(20,d3_format_precision(x*(1+1e-15),p))))}}),d3_time=d3.time={},d3_date=Date;d3_date_utc.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){d3_time_prototype.setUTCDate.apply(this._,arguments)},setDay:function(){d3_time_prototype.setUTCDay.apply(this._,arguments)},setFullYear:function(){d3_time_prototype.setUTCFullYear.apply(this._,arguments)},setHours:function(){d3_time_prototype.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){d3_time_prototype.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){d3_time_prototype.setUTCMinutes.apply(this._,arguments)},setMonth:function(){d3_time_prototype.setUTCMonth.apply(this._,arguments)},setSeconds:function(){d3_time_prototype.setUTCSeconds.apply(this._,arguments)},setTime:function(){d3_time_prototype.setTime.apply(this._,arguments)}};var d3_time_prototype=Date.prototype;d3_time.year=d3_time_interval(function(date){return date=d3_time.day(date),date.setMonth(0,1),date},function(date,offset){date.setFullYear(date.getFullYear()+offset)},function(date){return date.getFullYear()}),d3_time.years=d3_time.year.range,d3_time.years.utc=d3_time.year.utc.range,d3_time.day=d3_time_interval(function(date){var day=new d3_date(2e3,0);return day.setFullYear(date.getFullYear(),date.getMonth(),date.getDate()),day},function(date,offset){date.setDate(date.getDate()+offset)},function(date){return date.getDate()-1}),d3_time.days=d3_time.day.range,d3_time.days.utc=d3_time.day.utc.range,d3_time.dayOfYear=function(date){var year=d3_time.year(date);return Math.floor((date-year-6e4*(date.getTimezoneOffset()-year.getTimezoneOffset()))/864e5)
},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(day,i){i=7-i;var interval=d3_time[day]=d3_time_interval(function(date){return(date=d3_time.day(date)).setDate(date.getDate()-(date.getDay()+i)%7),date},function(date,offset){date.setDate(date.getDate()+7*Math.floor(offset))},function(date){var day=d3_time.year(date).getDay();return Math.floor((d3_time.dayOfYear(date)+(day+i)%7)/7)-(day!==i)});d3_time[day+"s"]=interval.range,d3_time[day+"s"].utc=interval.utc.range,d3_time[day+"OfYear"]=function(date){var day=d3_time.year(date).getDay();return Math.floor((d3_time.dayOfYear(date)+(day+i)%7)/7)}}),d3_time.week=d3_time.sunday,d3_time.weeks=d3_time.sunday.range,d3_time.weeks.utc=d3_time.sunday.utc.range,d3_time.weekOfYear=d3_time.sundayOfYear;var d3_time_formatPads={"-":"",_:" ",0:"0"},d3_time_numberRe=/^\s*\d+/,d3_time_percentRe=/^%/;d3.locale=function(locale){return{numberFormat:d3_locale_numberFormat(locale),timeFormat:d3_locale_timeFormat(locale)}};var d3_locale_enUS=d3.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});d3.format=d3_locale_enUS.numberFormat,d3.geo={},d3_adder.prototype={s:0,t:0,add:function(y){d3_adderSum(y,this.t,d3_adderTemp),d3_adderSum(d3_adderTemp.s,this.s,this),this.s?this.t+=d3_adderTemp.t:this.s=d3_adderTemp.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var d3_adderTemp=new d3_adder;d3.geo.stream=function(object,listener){object&&d3_geo_streamObjectType.hasOwnProperty(object.type)?d3_geo_streamObjectType[object.type](object,listener):d3_geo_streamGeometry(object,listener)};var d3_geo_streamObjectType={Feature:function(feature,listener){d3_geo_streamGeometry(feature.geometry,listener)},FeatureCollection:function(object,listener){for(var features=object.features,i=-1,n=features.length;++i<n;)d3_geo_streamGeometry(features[i].geometry,listener)}},d3_geo_streamGeometryType={Sphere:function(object,listener){listener.sphere()},Point:function(object,listener){object=object.coordinates,listener.point(object[0],object[1],object[2])},MultiPoint:function(object,listener){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)object=coordinates[i],listener.point(object[0],object[1],object[2])},LineString:function(object,listener){d3_geo_streamLine(object.coordinates,listener,0)},MultiLineString:function(object,listener){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)d3_geo_streamLine(coordinates[i],listener,0)},Polygon:function(object,listener){d3_geo_streamPolygon(object.coordinates,listener)},MultiPolygon:function(object,listener){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)d3_geo_streamPolygon(coordinates[i],listener)},GeometryCollection:function(object,listener){for(var geometries=object.geometries,i=-1,n=geometries.length;++i<n;)d3_geo_streamGeometry(geometries[i],listener)}};d3.geo.area=function(object){return d3_geo_areaSum=0,d3.geo.stream(object,d3_geo_area),d3_geo_areaSum};var d3_geo_areaSum,d3_geo_areaRingSum=new d3_adder,d3_geo_area={sphere:function(){d3_geo_areaSum+=4*π},point:d3_noop,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){d3_geo_areaRingSum.reset(),d3_geo_area.lineStart=d3_geo_areaRingStart},polygonEnd:function(){var area=2*d3_geo_areaRingSum;d3_geo_areaSum+=0>area?4*π+area:area,d3_geo_area.lineStart=d3_geo_area.lineEnd=d3_geo_area.point=d3_noop}};d3.geo.bounds=function(){function point(λ,φ){ranges.push(range=[λ0=λ,λ1=λ]),φ0>φ&&(φ0=φ),φ>φ1&&(φ1=φ)}function linePoint(λ,φ){var p=d3_geo_cartesian([λ*d3_radians,φ*d3_radians]);if(p0){var normal=d3_geo_cartesianCross(p0,p),equatorial=[normal[1],-normal[0],0],inflection=d3_geo_cartesianCross(equatorial,normal);d3_geo_cartesianNormalize(inflection),inflection=d3_geo_spherical(inflection);var dλ=λ-λ_,s=dλ>0?1:-1,λi=inflection[0]*d3_degrees*s,antimeridian=abs(dλ)>180;if(antimeridian^(λi>s*λ_&&s*λ>λi)){var φi=inflection[1]*d3_degrees;φi>φ1&&(φ1=φi)}else if(λi=(λi+360)%360-180,antimeridian^(λi>s*λ_&&s*λ>λi)){var φi=-inflection[1]*d3_degrees;φ0>φi&&(φ0=φi)}else φ0>φ&&(φ0=φ),φ>φ1&&(φ1=φ);antimeridian?λ_>λ?angle(λ0,λ)>angle(λ0,λ1)&&(λ1=λ):angle(λ,λ1)>angle(λ0,λ1)&&(λ0=λ):λ1>=λ0?(λ0>λ&&(λ0=λ),λ>λ1&&(λ1=λ)):λ>λ_?angle(λ0,λ)>angle(λ0,λ1)&&(λ1=λ):angle(λ,λ1)>angle(λ0,λ1)&&(λ0=λ)}else point(λ,φ);p0=p,λ_=λ}function lineStart(){bound.point=linePoint}function lineEnd(){range[0]=λ0,range[1]=λ1,bound.point=point,p0=null}function ringPoint(λ,φ){if(p0){var dλ=λ-λ_;dλSum+=abs(dλ)>180?dλ+(dλ>0?360:-360):dλ}else λ__=λ,φ__=φ;d3_geo_area.point(λ,φ),linePoint(λ,φ)}function ringStart(){d3_geo_area.lineStart()}function ringEnd(){ringPoint(λ__,φ__),d3_geo_area.lineEnd(),abs(dλSum)>ε&&(λ0=-(λ1=180)),range[0]=λ0,range[1]=λ1,p0=null}function angle(λ0,λ1){return(λ1-=λ0)<0?λ1+360:λ1}function compareRanges(a,b){return a[0]-b[0]}function withinRange(x,range){return range[0]<=range[1]?range[0]<=x&&x<=range[1]:x<range[0]||range[1]<x}var λ0,φ0,λ1,φ1,λ_,λ__,φ__,p0,dλSum,ranges,range,bound={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){bound.point=ringPoint,bound.lineStart=ringStart,bound.lineEnd=ringEnd,dλSum=0,d3_geo_area.polygonStart()},polygonEnd:function(){d3_geo_area.polygonEnd(),bound.point=point,bound.lineStart=lineStart,bound.lineEnd=lineEnd,0>d3_geo_areaRingSum?(λ0=-(λ1=180),φ0=-(φ1=90)):dλSum>ε?φ1=90:-ε>dλSum&&(φ0=-90),range[0]=λ0,range[1]=λ1}};return function(feature){φ1=λ1=-(λ0=φ0=1/0),ranges=[],d3.geo.stream(feature,bound);var n=ranges.length;if(n){ranges.sort(compareRanges);for(var b,i=1,a=ranges[0],merged=[a];n>i;++i)b=ranges[i],withinRange(b[0],a)||withinRange(b[1],a)?(angle(a[0],b[1])>angle(a[0],a[1])&&(a[1]=b[1]),angle(b[0],a[1])>angle(a[0],a[1])&&(a[0]=b[0])):merged.push(a=b);for(var dλ,b,best=-1/0,n=merged.length-1,i=0,a=merged[n];n>=i;a=b,++i)b=merged[i],(dλ=angle(a[1],b[0]))>best&&(best=dλ,λ0=b[0],λ1=a[1])}return ranges=range=null,1/0===λ0||1/0===φ0?[[0/0,0/0],[0/0,0/0]]:[[λ0,φ0],[λ1,φ1]]}}(),d3.geo.centroid=function(object){d3_geo_centroidW0=d3_geo_centroidW1=d3_geo_centroidX0=d3_geo_centroidY0=d3_geo_centroidZ0=d3_geo_centroidX1=d3_geo_centroidY1=d3_geo_centroidZ1=d3_geo_centroidX2=d3_geo_centroidY2=d3_geo_centroidZ2=0,d3.geo.stream(object,d3_geo_centroid);var x=d3_geo_centroidX2,y=d3_geo_centroidY2,z=d3_geo_centroidZ2,m=x*x+y*y+z*z;return ε2>m&&(x=d3_geo_centroidX1,y=d3_geo_centroidY1,z=d3_geo_centroidZ1,ε>d3_geo_centroidW1&&(x=d3_geo_centroidX0,y=d3_geo_centroidY0,z=d3_geo_centroidZ0),m=x*x+y*y+z*z,ε2>m)?[0/0,0/0]:[Math.atan2(y,x)*d3_degrees,d3_asin(z/Math.sqrt(m))*d3_degrees]};var d3_geo_centroidW0,d3_geo_centroidW1,d3_geo_centroidX0,d3_geo_centroidY0,d3_geo_centroidZ0,d3_geo_centroidX1,d3_geo_centroidY1,d3_geo_centroidZ1,d3_geo_centroidX2,d3_geo_centroidY2,d3_geo_centroidZ2,d3_geo_centroid={sphere:d3_noop,point:d3_geo_centroidPoint,lineStart:d3_geo_centroidLineStart,lineEnd:d3_geo_centroidLineEnd,polygonStart:function(){d3_geo_centroid.lineStart=d3_geo_centroidRingStart},polygonEnd:function(){d3_geo_centroid.lineStart=d3_geo_centroidLineStart}},d3_geo_clipAntimeridian=d3_geo_clip(d3_true,d3_geo_clipAntimeridianLine,d3_geo_clipAntimeridianInterpolate,[-π,-π/2]),d3_geo_clipExtentMAX=1e9;d3.geo.clipExtent=function(){var x0,y0,x1,y1,stream,clip,clipExtent={stream:function(output){return stream&&(stream.valid=!1),stream=clip(output),stream.valid=!0,stream},extent:function(_){return arguments.length?(clip=d3_geo_clipExtent(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1]),stream&&(stream.valid=!1,stream=null),clipExtent):[[x0,y0],[x1,y1]]}};return clipExtent.extent([[0,0],[960,500]])},(d3.geo.conicEqualArea=function(){return d3_geo_conic(d3_geo_conicEqualArea)}).raw=d3_geo_conicEqualArea,d3.geo.albers=function(){return d3.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},d3.geo.albersUsa=function(){function albersUsa(coordinates){var x=coordinates[0],y=coordinates[1];return point=null,lower48Point(x,y),point||(alaskaPoint(x,y),point)||hawaiiPoint(x,y),point}var point,lower48Point,alaskaPoint,hawaiiPoint,lower48=d3.geo.albers(),alaska=d3.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),hawaii=d3.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),pointStream={point:function(x,y){point=[x,y]}};return albersUsa.invert=function(coordinates){var k=lower48.scale(),t=lower48.translate(),x=(coordinates[0]-t[0])/k,y=(coordinates[1]-t[1])/k;return(y>=.12&&.234>y&&x>=-.425&&-.214>x?alaska:y>=.166&&.234>y&&x>=-.214&&-.115>x?hawaii:lower48).invert(coordinates)},albersUsa.stream=function(stream){var lower48Stream=lower48.stream(stream),alaskaStream=alaska.stream(stream),hawaiiStream=hawaii.stream(stream);return{point:function(x,y){lower48Stream.point(x,y),alaskaStream.point(x,y),hawaiiStream.point(x,y)},sphere:function(){lower48Stream.sphere(),alaskaStream.sphere(),hawaiiStream.sphere()},lineStart:function(){lower48Stream.lineStart(),alaskaStream.lineStart(),hawaiiStream.lineStart()},lineEnd:function(){lower48Stream.lineEnd(),alaskaStream.lineEnd(),hawaiiStream.lineEnd()},polygonStart:function(){lower48Stream.polygonStart(),alaskaStream.polygonStart(),hawaiiStream.polygonStart()},polygonEnd:function(){lower48Stream.polygonEnd(),alaskaStream.polygonEnd(),hawaiiStream.polygonEnd()}}},albersUsa.precision=function(_){return arguments.length?(lower48.precision(_),alaska.precision(_),hawaii.precision(_),albersUsa):lower48.precision()},albersUsa.scale=function(_){return arguments.length?(lower48.scale(_),alaska.scale(.35*_),hawaii.scale(_),albersUsa.translate(lower48.translate())):lower48.scale()},albersUsa.translate=function(_){if(!arguments.length)return lower48.translate();var k=lower48.scale(),x=+_[0],y=+_[1];return lower48Point=lower48.translate(_).clipExtent([[x-.455*k,y-.238*k],[x+.455*k,y+.238*k]]).stream(pointStream).point,alaskaPoint=alaska.translate([x-.307*k,y+.201*k]).clipExtent([[x-.425*k+ε,y+.12*k+ε],[x-.214*k-ε,y+.234*k-ε]]).stream(pointStream).point,hawaiiPoint=hawaii.translate([x-.205*k,y+.212*k]).clipExtent([[x-.214*k+ε,y+.166*k+ε],[x-.115*k-ε,y+.234*k-ε]]).stream(pointStream).point,albersUsa},albersUsa.scale(1070)};var d3_geo_pathAreaSum,d3_geo_pathAreaPolygon,d3_geo_pathBoundsX0,d3_geo_pathBoundsY0,d3_geo_pathBoundsX1,d3_geo_pathBoundsY1,d3_geo_pathArea={point:d3_noop,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){d3_geo_pathAreaPolygon=0,d3_geo_pathArea.lineStart=d3_geo_pathAreaRingStart},polygonEnd:function(){d3_geo_pathArea.lineStart=d3_geo_pathArea.lineEnd=d3_geo_pathArea.point=d3_noop,d3_geo_pathAreaSum+=abs(d3_geo_pathAreaPolygon/2)}},d3_geo_pathBounds={point:d3_geo_pathBoundsPoint,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:d3_noop,polygonEnd:d3_noop},d3_geo_pathCentroid={point:d3_geo_pathCentroidPoint,lineStart:d3_geo_pathCentroidLineStart,lineEnd:d3_geo_pathCentroidLineEnd,polygonStart:function(){d3_geo_pathCentroid.lineStart=d3_geo_pathCentroidRingStart},polygonEnd:function(){d3_geo_pathCentroid.point=d3_geo_pathCentroidPoint,d3_geo_pathCentroid.lineStart=d3_geo_pathCentroidLineStart,d3_geo_pathCentroid.lineEnd=d3_geo_pathCentroidLineEnd}};d3.geo.path=function(){function path(object){return object&&("function"==typeof pointRadius&&contextStream.pointRadius(+pointRadius.apply(this,arguments)),cacheStream&&cacheStream.valid||(cacheStream=projectStream(contextStream)),d3.geo.stream(object,cacheStream)),contextStream.result()}function reset(){return cacheStream=null,path}var projection,context,projectStream,contextStream,cacheStream,pointRadius=4.5;return path.area=function(object){return d3_geo_pathAreaSum=0,d3.geo.stream(object,projectStream(d3_geo_pathArea)),d3_geo_pathAreaSum},path.centroid=function(object){return d3_geo_centroidX0=d3_geo_centroidY0=d3_geo_centroidZ0=d3_geo_centroidX1=d3_geo_centroidY1=d3_geo_centroidZ1=d3_geo_centroidX2=d3_geo_centroidY2=d3_geo_centroidZ2=0,d3.geo.stream(object,projectStream(d3_geo_pathCentroid)),d3_geo_centroidZ2?[d3_geo_centroidX2/d3_geo_centroidZ2,d3_geo_centroidY2/d3_geo_centroidZ2]:d3_geo_centroidZ1?[d3_geo_centroidX1/d3_geo_centroidZ1,d3_geo_centroidY1/d3_geo_centroidZ1]:d3_geo_centroidZ0?[d3_geo_centroidX0/d3_geo_centroidZ0,d3_geo_centroidY0/d3_geo_centroidZ0]:[0/0,0/0]},path.bounds=function(object){return d3_geo_pathBoundsX1=d3_geo_pathBoundsY1=-(d3_geo_pathBoundsX0=d3_geo_pathBoundsY0=1/0),d3.geo.stream(object,projectStream(d3_geo_pathBounds)),[[d3_geo_pathBoundsX0,d3_geo_pathBoundsY0],[d3_geo_pathBoundsX1,d3_geo_pathBoundsY1]]},path.projection=function(_){return arguments.length?(projectStream=(projection=_)?_.stream||d3_geo_pathProjectStream(_):d3_identity,reset()):projection},path.context=function(_){return arguments.length?(contextStream=null==(context=_)?new d3_geo_pathBuffer:new d3_geo_pathContext(_),"function"!=typeof pointRadius&&contextStream.pointRadius(pointRadius),reset()):context},path.pointRadius=function(_){return arguments.length?(pointRadius="function"==typeof _?_:(contextStream.pointRadius(+_),+_),path):pointRadius},path.projection(d3.geo.albersUsa()).context(null)},d3.geo.transform=function(methods){return{stream:function(stream){var transform=new d3_geo_transform(stream);for(var k in methods)transform[k]=methods[k];return transform}}},d3_geo_transform.prototype={point:function(x,y){this.stream.point(x,y)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},d3.geo.projection=d3_geo_projection,d3.geo.projectionMutator=d3_geo_projectionMutator,(d3.geo.equirectangular=function(){return d3_geo_projection(d3_geo_equirectangular)}).raw=d3_geo_equirectangular.invert=d3_geo_equirectangular,d3.geo.rotation=function(rotate){function forward(coordinates){return coordinates=rotate(coordinates[0]*d3_radians,coordinates[1]*d3_radians),coordinates[0]*=d3_degrees,coordinates[1]*=d3_degrees,coordinates}return rotate=d3_geo_rotation(rotate[0]%360*d3_radians,rotate[1]*d3_radians,rotate.length>2?rotate[2]*d3_radians:0),forward.invert=function(coordinates){return coordinates=rotate.invert(coordinates[0]*d3_radians,coordinates[1]*d3_radians),coordinates[0]*=d3_degrees,coordinates[1]*=d3_degrees,coordinates},forward},d3_geo_identityRotation.invert=d3_geo_equirectangular,d3.geo.circle=function(){function circle(){var center="function"==typeof origin?origin.apply(this,arguments):origin,rotate=d3_geo_rotation(-center[0]*d3_radians,-center[1]*d3_radians,0).invert,ring=[];return interpolate(null,null,1,{point:function(x,y){ring.push(x=rotate(x,y)),x[0]*=d3_degrees,x[1]*=d3_degrees}}),{type:"Polygon",coordinates:[ring]}}var angle,interpolate,origin=[0,0],precision=6;return circle.origin=function(x){return arguments.length?(origin=x,circle):origin},circle.angle=function(x){return arguments.length?(interpolate=d3_geo_circleInterpolate((angle=+x)*d3_radians,precision*d3_radians),circle):angle},circle.precision=function(_){return arguments.length?(interpolate=d3_geo_circleInterpolate(angle*d3_radians,(precision=+_)*d3_radians),circle):precision},circle.angle(90)},d3.geo.distance=function(a,b){var t,Δλ=(b[0]-a[0])*d3_radians,φ0=a[1]*d3_radians,φ1=b[1]*d3_radians,sinΔλ=Math.sin(Δλ),cosΔλ=Math.cos(Δλ),sinφ0=Math.sin(φ0),cosφ0=Math.cos(φ0),sinφ1=Math.sin(φ1),cosφ1=Math.cos(φ1);return Math.atan2(Math.sqrt((t=cosφ1*sinΔλ)*t+(t=cosφ0*sinφ1-sinφ0*cosφ1*cosΔλ)*t),sinφ0*sinφ1+cosφ0*cosφ1*cosΔλ)},d3.geo.graticule=function(){function graticule(){return{type:"MultiLineString",coordinates:lines()}}function lines(){return d3.range(Math.ceil(X0/DX)*DX,X1,DX).map(X).concat(d3.range(Math.ceil(Y0/DY)*DY,Y1,DY).map(Y)).concat(d3.range(Math.ceil(x0/dx)*dx,x1,dx).filter(function(x){return abs(x%DX)>ε}).map(x)).concat(d3.range(Math.ceil(y0/dy)*dy,y1,dy).filter(function(y){return abs(y%DY)>ε}).map(y))}var x1,x0,X1,X0,y1,y0,Y1,Y0,x,y,X,Y,dx=10,dy=dx,DX=90,DY=360,precision=2.5;return graticule.lines=function(){return lines().map(function(coordinates){return{type:"LineString",coordinates:coordinates}})},graticule.outline=function(){return{type:"Polygon",coordinates:[X(X0).concat(Y(Y1).slice(1),X(X1).reverse().slice(1),Y(Y0).reverse().slice(1))]}},graticule.extent=function(_){return arguments.length?graticule.majorExtent(_).minorExtent(_):graticule.minorExtent()},graticule.majorExtent=function(_){return arguments.length?(X0=+_[0][0],X1=+_[1][0],Y0=+_[0][1],Y1=+_[1][1],X0>X1&&(_=X0,X0=X1,X1=_),Y0>Y1&&(_=Y0,Y0=Y1,Y1=_),graticule.precision(precision)):[[X0,Y0],[X1,Y1]]},graticule.minorExtent=function(_){return arguments.length?(x0=+_[0][0],x1=+_[1][0],y0=+_[0][1],y1=+_[1][1],x0>x1&&(_=x0,x0=x1,x1=_),y0>y1&&(_=y0,y0=y1,y1=_),graticule.precision(precision)):[[x0,y0],[x1,y1]]},graticule.step=function(_){return arguments.length?graticule.majorStep(_).minorStep(_):graticule.minorStep()},graticule.majorStep=function(_){return arguments.length?(DX=+_[0],DY=+_[1],graticule):[DX,DY]},graticule.minorStep=function(_){return arguments.length?(dx=+_[0],dy=+_[1],graticule):[dx,dy]},graticule.precision=function(_){return arguments.length?(precision=+_,x=d3_geo_graticuleX(y0,y1,90),y=d3_geo_graticuleY(x0,x1,precision),X=d3_geo_graticuleX(Y0,Y1,90),Y=d3_geo_graticuleY(X0,X1,precision),graticule):precision},graticule.majorExtent([[-180,-90+ε],[180,90-ε]]).minorExtent([[-180,-80-ε],[180,80+ε]])},d3.geo.greatArc=function(){function greatArc(){return{type:"LineString",coordinates:[source_||source.apply(this,arguments),target_||target.apply(this,arguments)]}}var source_,target_,source=d3_source,target=d3_target;return greatArc.distance=function(){return d3.geo.distance(source_||source.apply(this,arguments),target_||target.apply(this,arguments))},greatArc.source=function(_){return arguments.length?(source=_,source_="function"==typeof _?null:_,greatArc):source},greatArc.target=function(_){return arguments.length?(target=_,target_="function"==typeof _?null:_,greatArc):target},greatArc.precision=function(){return arguments.length?greatArc:0},greatArc},d3.geo.interpolate=function(source,target){return d3_geo_interpolate(source[0]*d3_radians,source[1]*d3_radians,target[0]*d3_radians,target[1]*d3_radians)},d3.geo.length=function(object){return d3_geo_lengthSum=0,d3.geo.stream(object,d3_geo_length),d3_geo_lengthSum};var d3_geo_lengthSum,d3_geo_length={sphere:d3_noop,point:d3_noop,lineStart:d3_geo_lengthLineStart,lineEnd:d3_noop,polygonStart:d3_noop,polygonEnd:d3_noop},d3_geo_azimuthalEqualArea=d3_geo_azimuthal(function(cosλcosφ){return Math.sqrt(2/(1+cosλcosφ))},function(ρ){return 2*Math.asin(ρ/2)});(d3.geo.azimuthalEqualArea=function(){return d3_geo_projection(d3_geo_azimuthalEqualArea)}).raw=d3_geo_azimuthalEqualArea;var d3_geo_azimuthalEquidistant=d3_geo_azimuthal(function(cosλcosφ){var c=Math.acos(cosλcosφ);return c&&c/Math.sin(c)},d3_identity);(d3.geo.azimuthalEquidistant=function(){return d3_geo_projection(d3_geo_azimuthalEquidistant)}).raw=d3_geo_azimuthalEquidistant,(d3.geo.conicConformal=function(){return d3_geo_conic(d3_geo_conicConformal)}).raw=d3_geo_conicConformal,(d3.geo.conicEquidistant=function(){return d3_geo_conic(d3_geo_conicEquidistant)}).raw=d3_geo_conicEquidistant;var d3_geo_gnomonic=d3_geo_azimuthal(function(cosλcosφ){return 1/cosλcosφ},Math.atan);(d3.geo.gnomonic=function(){return d3_geo_projection(d3_geo_gnomonic)}).raw=d3_geo_gnomonic,d3_geo_mercator.invert=function(x,y){return[x,2*Math.atan(Math.exp(y))-halfπ]},(d3.geo.mercator=function(){return d3_geo_mercatorProjection(d3_geo_mercator)}).raw=d3_geo_mercator;var d3_geo_orthographic=d3_geo_azimuthal(function(){return 1},Math.asin);(d3.geo.orthographic=function(){return d3_geo_projection(d3_geo_orthographic)}).raw=d3_geo_orthographic;var d3_geo_stereographic=d3_geo_azimuthal(function(cosλcosφ){return 1/(1+cosλcosφ)},function(ρ){return 2*Math.atan(ρ)});(d3.geo.stereographic=function(){return d3_geo_projection(d3_geo_stereographic)}).raw=d3_geo_stereographic,d3_geo_transverseMercator.invert=function(x,y){return[-y,2*Math.atan(Math.exp(x))-halfπ]},(d3.geo.transverseMercator=function(){var projection=d3_geo_mercatorProjection(d3_geo_transverseMercator),center=projection.center,rotate=projection.rotate;return projection.center=function(_){return _?center([-_[1],_[0]]):(_=center(),[_[1],-_[0]])},projection.rotate=function(_){return _?rotate([_[0],_[1],_.length>2?_[2]+90:90]):(_=rotate(),[_[0],_[1],_[2]-90])},rotate([0,0,90])}).raw=d3_geo_transverseMercator,d3.geom={},d3.geom.hull=function(vertices){function hull(data){if(data.length<3)return[];var i,fx=d3_functor(x),fy=d3_functor(y),n=data.length,points=[],flippedPoints=[];for(i=0;n>i;i++)points.push([+fx.call(this,data[i],i),+fy.call(this,data[i],i),i]);for(points.sort(d3_geom_hullOrder),i=0;n>i;i++)flippedPoints.push([points[i][0],-points[i][1]]);var upper=d3_geom_hullUpper(points),lower=d3_geom_hullUpper(flippedPoints),skipLeft=lower[0]===upper[0],skipRight=lower[lower.length-1]===upper[upper.length-1],polygon=[];for(i=upper.length-1;i>=0;--i)polygon.push(data[points[upper[i]][2]]);for(i=+skipLeft;i<lower.length-skipRight;++i)polygon.push(data[points[lower[i]][2]]);return polygon}var x=d3_geom_pointX,y=d3_geom_pointY;return arguments.length?hull(vertices):(hull.x=function(_){return arguments.length?(x=_,hull):x},hull.y=function(_){return arguments.length?(y=_,hull):y},hull)},d3.geom.polygon=function(coordinates){return d3_subclass(coordinates,d3_geom_polygonPrototype),coordinates};var d3_geom_polygonPrototype=d3.geom.polygon.prototype=[];d3_geom_polygonPrototype.area=function(){for(var a,i=-1,n=this.length,b=this[n-1],area=0;++i<n;)a=b,b=this[i],area+=a[1]*b[0]-a[0]*b[1];return.5*area},d3_geom_polygonPrototype.centroid=function(k){var a,c,i=-1,n=this.length,x=0,y=0,b=this[n-1];for(arguments.length||(k=-1/(6*this.area()));++i<n;)a=b,b=this[i],c=a[0]*b[1]-b[0]*a[1],x+=(a[0]+b[0])*c,y+=(a[1]+b[1])*c;return[x*k,y*k]},d3_geom_polygonPrototype.clip=function(subject){for(var input,j,m,b,c,d,closed=d3_geom_polygonClosed(subject),i=-1,n=this.length-d3_geom_polygonClosed(this),a=this[n-1];++i<n;){for(input=subject.slice(),subject.length=0,b=this[i],c=input[(m=input.length-closed)-1],j=-1;++j<m;)d=input[j],d3_geom_polygonInside(d,a,b)?(d3_geom_polygonInside(c,a,b)||subject.push(d3_geom_polygonIntersect(c,d,a,b)),subject.push(d)):d3_geom_polygonInside(c,a,b)&&subject.push(d3_geom_polygonIntersect(c,d,a,b)),c=d;closed&&subject.push(subject[0]),a=b}return subject};var d3_geom_voronoiEdges,d3_geom_voronoiCells,d3_geom_voronoiBeaches,d3_geom_voronoiFirstCircle,d3_geom_voronoiCircles,d3_geom_voronoiBeachPool=[],d3_geom_voronoiCirclePool=[];d3_geom_voronoiCell.prototype.prepare=function(){for(var edge,halfEdges=this.edges,iHalfEdge=halfEdges.length;iHalfEdge--;)edge=halfEdges[iHalfEdge].edge,edge.b&&edge.a||halfEdges.splice(iHalfEdge,1);return halfEdges.sort(d3_geom_voronoiHalfEdgeOrder),halfEdges.length},d3_geom_voronoiHalfEdge.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},d3_geom_voronoiRedBlackTree.prototype={insert:function(after,node){var parent,grandpa,uncle;if(after){if(node.P=after,node.N=after.N,after.N&&(after.N.P=node),after.N=node,after.R){for(after=after.R;after.L;)after=after.L;after.L=node}else after.R=node;parent=after}else this._?(after=d3_geom_voronoiRedBlackFirst(this._),node.P=null,node.N=after,after.P=after.L=node,parent=after):(node.P=node.N=null,this._=node,parent=null);for(node.L=node.R=null,node.U=parent,node.C=!0,after=node;parent&&parent.C;)grandpa=parent.U,parent===grandpa.L?(uncle=grandpa.R,uncle&&uncle.C?(parent.C=uncle.C=!1,grandpa.C=!0,after=grandpa):(after===parent.R&&(d3_geom_voronoiRedBlackRotateLeft(this,parent),after=parent,parent=after.U),parent.C=!1,grandpa.C=!0,d3_geom_voronoiRedBlackRotateRight(this,grandpa))):(uncle=grandpa.L,uncle&&uncle.C?(parent.C=uncle.C=!1,grandpa.C=!0,after=grandpa):(after===parent.L&&(d3_geom_voronoiRedBlackRotateRight(this,parent),after=parent,parent=after.U),parent.C=!1,grandpa.C=!0,d3_geom_voronoiRedBlackRotateLeft(this,grandpa))),parent=after.U;this._.C=!1},remove:function(node){node.N&&(node.N.P=node.P),node.P&&(node.P.N=node.N),node.N=node.P=null;var sibling,next,red,parent=node.U,left=node.L,right=node.R;if(next=left?right?d3_geom_voronoiRedBlackFirst(right):left:right,parent?parent.L===node?parent.L=next:parent.R=next:this._=next,left&&right?(red=next.C,next.C=node.C,next.L=left,left.U=next,next!==right?(parent=next.U,next.U=node.U,node=next.R,parent.L=node,next.R=right,right.U=next):(next.U=parent,parent=next,node=next.R)):(red=node.C,node=next),node&&(node.U=parent),!red){if(node&&node.C)return void(node.C=!1);do{if(node===this._)break;if(node===parent.L){if(sibling=parent.R,sibling.C&&(sibling.C=!1,parent.C=!0,d3_geom_voronoiRedBlackRotateLeft(this,parent),sibling=parent.R),sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){sibling.R&&sibling.R.C||(sibling.L.C=!1,sibling.C=!0,d3_geom_voronoiRedBlackRotateRight(this,sibling),sibling=parent.R),sibling.C=parent.C,parent.C=sibling.R.C=!1,d3_geom_voronoiRedBlackRotateLeft(this,parent),node=this._;break}}else if(sibling=parent.L,sibling.C&&(sibling.C=!1,parent.C=!0,d3_geom_voronoiRedBlackRotateRight(this,parent),sibling=parent.L),sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){sibling.L&&sibling.L.C||(sibling.R.C=!1,sibling.C=!0,d3_geom_voronoiRedBlackRotateLeft(this,sibling),sibling=parent.L),sibling.C=parent.C,parent.C=sibling.L.C=!1,d3_geom_voronoiRedBlackRotateRight(this,parent),node=this._;break}sibling.C=!0,node=parent,parent=parent.U}while(!node.C);node&&(node.C=!1)}}},d3.geom.voronoi=function(points){function voronoi(data){var polygons=new Array(data.length),x0=clipExtent[0][0],y0=clipExtent[0][1],x1=clipExtent[1][0],y1=clipExtent[1][1];return d3_geom_voronoi(sites(data),clipExtent).cells.forEach(function(cell,i){var edges=cell.edges,site=cell.site,polygon=polygons[i]=edges.length?edges.map(function(e){var s=e.start();return[s.x,s.y]}):site.x>=x0&&site.x<=x1&&site.y>=y0&&site.y<=y1?[[x0,y1],[x1,y1],[x1,y0],[x0,y0]]:[];polygon.point=data[i]}),polygons}function sites(data){return data.map(function(d,i){return{x:Math.round(fx(d,i)/ε)*ε,y:Math.round(fy(d,i)/ε)*ε,i:i}})}var x=d3_geom_pointX,y=d3_geom_pointY,fx=x,fy=y,clipExtent=d3_geom_voronoiClipExtent;return points?voronoi(points):(voronoi.links=function(data){return d3_geom_voronoi(sites(data)).edges.filter(function(edge){return edge.l&&edge.r}).map(function(edge){return{source:data[edge.l.i],target:data[edge.r.i]}})},voronoi.triangles=function(data){var triangles=[];return d3_geom_voronoi(sites(data)).cells.forEach(function(cell,i){for(var e0,s0,site=cell.site,edges=cell.edges.sort(d3_geom_voronoiHalfEdgeOrder),j=-1,m=edges.length,e1=edges[m-1].edge,s1=e1.l===site?e1.r:e1.l;++j<m;)e0=e1,s0=s1,e1=edges[j].edge,s1=e1.l===site?e1.r:e1.l,i<s0.i&&i<s1.i&&d3_geom_voronoiTriangleArea(site,s0,s1)<0&&triangles.push([data[i],data[s0.i],data[s1.i]])}),triangles},voronoi.x=function(_){return arguments.length?(fx=d3_functor(x=_),voronoi):x},voronoi.y=function(_){return arguments.length?(fy=d3_functor(y=_),voronoi):y},voronoi.clipExtent=function(_){return arguments.length?(clipExtent=null==_?d3_geom_voronoiClipExtent:_,voronoi):clipExtent===d3_geom_voronoiClipExtent?null:clipExtent},voronoi.size=function(_){return arguments.length?voronoi.clipExtent(_&&[[0,0],_]):clipExtent===d3_geom_voronoiClipExtent?null:clipExtent&&clipExtent[1]},voronoi)};var d3_geom_voronoiClipExtent=[[-1e6,-1e6],[1e6,1e6]];d3.geom.delaunay=function(vertices){return d3.geom.voronoi().triangles(vertices)},d3.geom.quadtree=function(points,x1,y1,x2,y2){function quadtree(data){function insert(n,d,x,y,x1,y1,x2,y2){if(!isNaN(x)&&!isNaN(y))if(n.leaf){var nx=n.x,ny=n.y;if(null!=nx)if(abs(nx-x)+abs(ny-y)<.01)insertChild(n,d,x,y,x1,y1,x2,y2);else{var nPoint=n.point;n.x=n.y=n.point=null,insertChild(n,nPoint,nx,ny,x1,y1,x2,y2),insertChild(n,d,x,y,x1,y1,x2,y2)}else n.x=x,n.y=y,n.point=d}else insertChild(n,d,x,y,x1,y1,x2,y2)}function insertChild(n,d,x,y,x1,y1,x2,y2){var xm=.5*(x1+x2),ym=.5*(y1+y2),right=x>=xm,below=y>=ym,i=below<<1|right;n.leaf=!1,n=n.nodes[i]||(n.nodes[i]=d3_geom_quadtreeNode()),right?x1=xm:x2=xm,below?y1=ym:y2=ym,insert(n,d,x,y,x1,y1,x2,y2)}var d,xs,ys,i,n,x1_,y1_,x2_,y2_,fx=d3_functor(x),fy=d3_functor(y);if(null!=x1)x1_=x1,y1_=y1,x2_=x2,y2_=y2;else if(x2_=y2_=-(x1_=y1_=1/0),xs=[],ys=[],n=data.length,compat)for(i=0;n>i;++i)d=data[i],d.x<x1_&&(x1_=d.x),d.y<y1_&&(y1_=d.y),d.x>x2_&&(x2_=d.x),d.y>y2_&&(y2_=d.y),xs.push(d.x),ys.push(d.y);else for(i=0;n>i;++i){var x_=+fx(d=data[i],i),y_=+fy(d,i);x1_>x_&&(x1_=x_),y1_>y_&&(y1_=y_),x_>x2_&&(x2_=x_),y_>y2_&&(y2_=y_),xs.push(x_),ys.push(y_)}var dx=x2_-x1_,dy=y2_-y1_;dx>dy?y2_=y1_+dx:x2_=x1_+dy;var root=d3_geom_quadtreeNode();if(root.add=function(d){insert(root,d,+fx(d,++i),+fy(d,i),x1_,y1_,x2_,y2_)},root.visit=function(f){d3_geom_quadtreeVisit(f,root,x1_,y1_,x2_,y2_)},root.find=function(point){return d3_geom_quadtreeFind(root,point[0],point[1],x1_,y1_,x2_,y2_)},i=-1,null==x1){for(;++i<n;)insert(root,data[i],xs[i],ys[i],x1_,y1_,x2_,y2_);--i}else data.forEach(root.add);return xs=ys=data=d=null,root}var compat,x=d3_geom_pointX,y=d3_geom_pointY;return(compat=arguments.length)?(x=d3_geom_quadtreeCompatX,y=d3_geom_quadtreeCompatY,3===compat&&(y2=y1,x2=x1,y1=x1=0),quadtree(points)):(quadtree.x=function(_){return arguments.length?(x=_,quadtree):x},quadtree.y=function(_){return arguments.length?(y=_,quadtree):y},quadtree.extent=function(_){return arguments.length?(null==_?x1=y1=x2=y2=null:(x1=+_[0][0],y1=+_[0][1],x2=+_[1][0],y2=+_[1][1]),quadtree):null==x1?null:[[x1,y1],[x2,y2]]},quadtree.size=function(_){return arguments.length?(null==_?x1=y1=x2=y2=null:(x1=y1=0,x2=+_[0],y2=+_[1]),quadtree):null==x1?null:[x2-x1,y2-y1]},quadtree)},d3.interpolateRgb=d3_interpolateRgb,d3.interpolateObject=d3_interpolateObject,d3.interpolateNumber=d3_interpolateNumber,d3.interpolateString=d3_interpolateString;var d3_interpolate_numberA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,d3_interpolate_numberB=new RegExp(d3_interpolate_numberA.source,"g");d3.interpolate=d3_interpolate,d3.interpolators=[function(a,b){var t=typeof b;return("string"===t?d3_rgb_names.has(b.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(b)?d3_interpolateRgb:d3_interpolateString:b instanceof d3_color?d3_interpolateRgb:Array.isArray(b)?d3_interpolateArray:"object"===t&&isNaN(b)?d3_interpolateObject:d3_interpolateNumber)(a,b)}],d3.interpolateArray=d3_interpolateArray;var d3_ease_default=function(){return d3_identity},d3_ease=d3.map({linear:d3_ease_default,poly:d3_ease_poly,quad:function(){return d3_ease_quad},cubic:function(){return d3_ease_cubic},sin:function(){return d3_ease_sin},exp:function(){return d3_ease_exp},circle:function(){return d3_ease_circle},elastic:d3_ease_elastic,back:d3_ease_back,bounce:function(){return d3_ease_bounce}}),d3_ease_mode=d3.map({"in":d3_identity,out:d3_ease_reverse,"in-out":d3_ease_reflect,"out-in":function(f){return d3_ease_reflect(d3_ease_reverse(f))}});d3.ease=function(name){var i=name.indexOf("-"),t=i>=0?name.slice(0,i):name,m=i>=0?name.slice(i+1):"in";return t=d3_ease.get(t)||d3_ease_default,m=d3_ease_mode.get(m)||d3_identity,d3_ease_clamp(m(t.apply(null,d3_arraySlice.call(arguments,1))))},d3.interpolateHcl=d3_interpolateHcl,d3.interpolateHsl=d3_interpolateHsl,d3.interpolateLab=d3_interpolateLab,d3.interpolateRound=d3_interpolateRound,d3.transform=function(string){var g=d3_document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(string){if(null!=string){g.setAttribute("transform",string);var t=g.transform.baseVal.consolidate()
}return new d3_transform(t?t.matrix:d3_transformIdentity)})(string)},d3_transform.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var d3_transformIdentity={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolateTransform=d3_interpolateTransform,d3.layout={},d3.layout.bundle=function(){return function(links){for(var paths=[],i=-1,n=links.length;++i<n;)paths.push(d3_layout_bundlePath(links[i]));return paths}},d3.layout.chord=function(){function relayout(){var k,x,x0,i,j,subgroups={},groupSums=[],groupIndex=d3.range(n),subgroupIndex=[];for(chords=[],groups=[],k=0,i=-1;++i<n;){for(x=0,j=-1;++j<n;)x+=matrix[i][j];groupSums.push(x),subgroupIndex.push(d3.range(n)),k+=x}for(sortGroups&&groupIndex.sort(function(a,b){return sortGroups(groupSums[a],groupSums[b])}),sortSubgroups&&subgroupIndex.forEach(function(d,i){d.sort(function(a,b){return sortSubgroups(matrix[i][a],matrix[i][b])})}),k=(τ-padding*n)/k,x=0,i=-1;++i<n;){for(x0=x,j=-1;++j<n;){var di=groupIndex[i],dj=subgroupIndex[di][j],v=matrix[di][dj],a0=x,a1=x+=v*k;subgroups[di+"-"+dj]={index:di,subindex:dj,startAngle:a0,endAngle:a1,value:v}}groups[di]={index:di,startAngle:x0,endAngle:x,value:(x-x0)/k},x+=padding}for(i=-1;++i<n;)for(j=i-1;++j<n;){var source=subgroups[i+"-"+j],target=subgroups[j+"-"+i];(source.value||target.value)&&chords.push(source.value<target.value?{source:target,target:source}:{source:source,target:target})}sortChords&&resort()}function resort(){chords.sort(function(a,b){return sortChords((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var chords,groups,matrix,n,sortGroups,sortSubgroups,sortChords,chord={},padding=0;return chord.matrix=function(x){return arguments.length?(n=(matrix=x)&&matrix.length,chords=groups=null,chord):matrix},chord.padding=function(x){return arguments.length?(padding=x,chords=groups=null,chord):padding},chord.sortGroups=function(x){return arguments.length?(sortGroups=x,chords=groups=null,chord):sortGroups},chord.sortSubgroups=function(x){return arguments.length?(sortSubgroups=x,chords=null,chord):sortSubgroups},chord.sortChords=function(x){return arguments.length?(sortChords=x,chords&&resort(),chord):sortChords},chord.chords=function(){return chords||relayout(),chords},chord.groups=function(){return groups||relayout(),groups},chord},d3.layout.force=function(){function repulse(node){return function(quad,x1,_,x2){if(quad.point!==node){var dx=quad.cx-node.x,dy=quad.cy-node.y,dw=x2-x1,dn=dx*dx+dy*dy;if(dn>dw*dw/theta2){if(chargeDistance2>dn){var k=quad.charge/dn;node.px-=dx*k,node.py-=dy*k}return!0}if(quad.point&&dn&&chargeDistance2>dn){var k=quad.pointCharge/dn;node.px-=dx*k,node.py-=dy*k}}return!quad.charge}}function dragmove(d){d.px=d3.event.x,d.py=d3.event.y,force.resume()}var timer,drag,alpha,distances,strengths,charges,force={},event=d3.dispatch("start","tick","end"),size=[1,1],friction=.9,linkDistance=d3_layout_forceLinkDistance,linkStrength=d3_layout_forceLinkStrength,charge=-30,chargeDistance2=d3_layout_forceChargeDistance2,gravity=.1,theta2=.64,nodes=[],links=[];return force.tick=function(){if((alpha*=.99)<.005)return timer=null,event.end({type:"end",alpha:alpha=0}),!0;var q,i,o,s,t,l,k,x,y,n=nodes.length,m=links.length;for(i=0;m>i;++i)o=links[i],s=o.source,t=o.target,x=t.x-s.x,y=t.y-s.y,(l=x*x+y*y)&&(l=alpha*strengths[i]*((l=Math.sqrt(l))-distances[i])/l,x*=l,y*=l,t.x-=x*(k=s.weight+t.weight?s.weight/(s.weight+t.weight):.5),t.y-=y*k,s.x+=x*(k=1-k),s.y+=y*k);if((k=alpha*gravity)&&(x=size[0]/2,y=size[1]/2,i=-1,k))for(;++i<n;)o=nodes[i],o.x+=(x-o.x)*k,o.y+=(y-o.y)*k;if(charge)for(d3_layout_forceAccumulate(q=d3.geom.quadtree(nodes),alpha,charges),i=-1;++i<n;)(o=nodes[i]).fixed||q.visit(repulse(o));for(i=-1;++i<n;)o=nodes[i],o.fixed?(o.x=o.px,o.y=o.py):(o.x-=(o.px-(o.px=o.x))*friction,o.y-=(o.py-(o.py=o.y))*friction);event.tick({type:"tick",alpha:alpha})},force.nodes=function(x){return arguments.length?(nodes=x,force):nodes},force.links=function(x){return arguments.length?(links=x,force):links},force.size=function(x){return arguments.length?(size=x,force):size},force.linkDistance=function(x){return arguments.length?(linkDistance="function"==typeof x?x:+x,force):linkDistance},force.distance=force.linkDistance,force.linkStrength=function(x){return arguments.length?(linkStrength="function"==typeof x?x:+x,force):linkStrength},force.friction=function(x){return arguments.length?(friction=+x,force):friction},force.charge=function(x){return arguments.length?(charge="function"==typeof x?x:+x,force):charge},force.chargeDistance=function(x){return arguments.length?(chargeDistance2=x*x,force):Math.sqrt(chargeDistance2)},force.gravity=function(x){return arguments.length?(gravity=+x,force):gravity},force.theta=function(x){return arguments.length?(theta2=x*x,force):Math.sqrt(theta2)},force.alpha=function(x){return arguments.length?(x=+x,alpha?x>0?alpha=x:(timer.c=null,timer.t=0/0,timer=null,event.start({type:"end",alpha:alpha=0})):x>0&&(event.start({type:"start",alpha:alpha=x}),timer=d3_timer(force.tick)),force):alpha},force.start=function(){function position(dimension,size){if(!neighbors){for(neighbors=new Array(n),j=0;n>j;++j)neighbors[j]=[];for(j=0;m>j;++j){var o=links[j];neighbors[o.source.index].push(o.target),neighbors[o.target.index].push(o.source)}}for(var x,candidates=neighbors[i],j=-1,l=candidates.length;++j<l;)if(!isNaN(x=candidates[j][dimension]))return x;return Math.random()*size}var i,neighbors,o,n=nodes.length,m=links.length,w=size[0],h=size[1];for(i=0;n>i;++i)(o=nodes[i]).index=i,o.weight=0;for(i=0;m>i;++i)o=links[i],"number"==typeof o.source&&(o.source=nodes[o.source]),"number"==typeof o.target&&(o.target=nodes[o.target]),++o.source.weight,++o.target.weight;for(i=0;n>i;++i)o=nodes[i],isNaN(o.x)&&(o.x=position("x",w)),isNaN(o.y)&&(o.y=position("y",h)),isNaN(o.px)&&(o.px=o.x),isNaN(o.py)&&(o.py=o.y);if(distances=[],"function"==typeof linkDistance)for(i=0;m>i;++i)distances[i]=+linkDistance.call(this,links[i],i);else for(i=0;m>i;++i)distances[i]=linkDistance;if(strengths=[],"function"==typeof linkStrength)for(i=0;m>i;++i)strengths[i]=+linkStrength.call(this,links[i],i);else for(i=0;m>i;++i)strengths[i]=linkStrength;if(charges=[],"function"==typeof charge)for(i=0;n>i;++i)charges[i]=+charge.call(this,nodes[i],i);else for(i=0;n>i;++i)charges[i]=charge;return force.resume()},force.resume=function(){return force.alpha(.1)},force.stop=function(){return force.alpha(0)},force.drag=function(){return drag||(drag=d3.behavior.drag().origin(d3_identity).on("dragstart.force",d3_layout_forceDragstart).on("drag.force",dragmove).on("dragend.force",d3_layout_forceDragend)),arguments.length?void this.on("mouseover.force",d3_layout_forceMouseover).on("mouseout.force",d3_layout_forceMouseout).call(drag):drag},d3.rebind(force,event,"on")};var d3_layout_forceLinkDistance=20,d3_layout_forceLinkStrength=1,d3_layout_forceChargeDistance2=1/0;d3.layout.hierarchy=function(){function hierarchy(root){var node,stack=[root],nodes=[];for(root.depth=0;null!=(node=stack.pop());)if(nodes.push(node),(childs=children.call(hierarchy,node,node.depth))&&(n=childs.length)){for(var n,childs,child;--n>=0;)stack.push(child=childs[n]),child.parent=node,child.depth=node.depth+1;value&&(node.value=0),node.children=childs}else value&&(node.value=+value.call(hierarchy,node,node.depth)||0),delete node.children;return d3_layout_hierarchyVisitAfter(root,function(node){var childs,parent;sort&&(childs=node.children)&&childs.sort(sort),value&&(parent=node.parent)&&(parent.value+=node.value)}),nodes}var sort=d3_layout_hierarchySort,children=d3_layout_hierarchyChildren,value=d3_layout_hierarchyValue;return hierarchy.sort=function(x){return arguments.length?(sort=x,hierarchy):sort},hierarchy.children=function(x){return arguments.length?(children=x,hierarchy):children},hierarchy.value=function(x){return arguments.length?(value=x,hierarchy):value},hierarchy.revalue=function(root){return value&&(d3_layout_hierarchyVisitBefore(root,function(node){node.children&&(node.value=0)}),d3_layout_hierarchyVisitAfter(root,function(node){var parent;node.children||(node.value=+value.call(hierarchy,node,node.depth)||0),(parent=node.parent)&&(parent.value+=node.value)})),root},hierarchy},d3.layout.partition=function(){function position(node,x,dx,dy){var children=node.children;if(node.x=x,node.y=node.depth*dy,node.dx=dx,node.dy=dy,children&&(n=children.length)){var n,c,d,i=-1;for(dx=node.value?dx/node.value:0;++i<n;)position(c=children[i],x,d=c.value*dx,dy),x+=d}}function depth(node){var children=node.children,d=0;if(children&&(n=children.length))for(var n,i=-1;++i<n;)d=Math.max(d,depth(children[i]));return 1+d}function partition(d,i){var nodes=hierarchy.call(this,d,i);return position(nodes[0],0,size[0],size[1]/depth(nodes[0])),nodes}var hierarchy=d3.layout.hierarchy(),size=[1,1];return partition.size=function(x){return arguments.length?(size=x,partition):size},d3_layout_hierarchyRebind(partition,hierarchy)},d3.layout.pie=function(){function pie(data){var v,n=data.length,values=data.map(function(d,i){return+value.call(pie,d,i)}),a=+("function"==typeof startAngle?startAngle.apply(this,arguments):startAngle),da=("function"==typeof endAngle?endAngle.apply(this,arguments):endAngle)-a,p=Math.min(Math.abs(da)/n,+("function"==typeof padAngle?padAngle.apply(this,arguments):padAngle)),pa=p*(0>da?-1:1),sum=d3.sum(values),k=sum?(da-n*pa)/sum:0,index=d3.range(n),arcs=[];return null!=sort&&index.sort(sort===d3_layout_pieSortByValue?function(i,j){return values[j]-values[i]}:function(i,j){return sort(data[i],data[j])}),index.forEach(function(i){arcs[i]={data:data[i],value:v=values[i],startAngle:a,endAngle:a+=v*k+pa,padAngle:p}}),arcs}var value=Number,sort=d3_layout_pieSortByValue,startAngle=0,endAngle=τ,padAngle=0;return pie.value=function(_){return arguments.length?(value=_,pie):value},pie.sort=function(_){return arguments.length?(sort=_,pie):sort},pie.startAngle=function(_){return arguments.length?(startAngle=_,pie):startAngle},pie.endAngle=function(_){return arguments.length?(endAngle=_,pie):endAngle},pie.padAngle=function(_){return arguments.length?(padAngle=_,pie):padAngle},pie};var d3_layout_pieSortByValue={};d3.layout.stack=function(){function stack(data,index){if(!(n=data.length))return data;var series=data.map(function(d,i){return values.call(stack,d,i)}),points=series.map(function(d){return d.map(function(v,i){return[x.call(stack,v,i),y.call(stack,v,i)]})}),orders=order.call(stack,points,index);series=d3.permute(series,orders),points=d3.permute(points,orders);var n,i,j,o,offsets=offset.call(stack,points,index),m=series[0].length;for(j=0;m>j;++j)for(out.call(stack,series[0][j],o=offsets[j],points[0][j][1]),i=1;n>i;++i)out.call(stack,series[i][j],o+=points[i-1][j][1],points[i][j][1]);return data}var values=d3_identity,order=d3_layout_stackOrderDefault,offset=d3_layout_stackOffsetZero,out=d3_layout_stackOut,x=d3_layout_stackX,y=d3_layout_stackY;return stack.values=function(x){return arguments.length?(values=x,stack):values},stack.order=function(x){return arguments.length?(order="function"==typeof x?x:d3_layout_stackOrders.get(x)||d3_layout_stackOrderDefault,stack):order},stack.offset=function(x){return arguments.length?(offset="function"==typeof x?x:d3_layout_stackOffsets.get(x)||d3_layout_stackOffsetZero,stack):offset},stack.x=function(z){return arguments.length?(x=z,stack):x},stack.y=function(z){return arguments.length?(y=z,stack):y},stack.out=function(z){return arguments.length?(out=z,stack):out},stack};var d3_layout_stackOrders=d3.map({"inside-out":function(data){var i,j,n=data.length,max=data.map(d3_layout_stackMaxIndex),sums=data.map(d3_layout_stackReduceSum),index=d3.range(n).sort(function(a,b){return max[a]-max[b]}),top=0,bottom=0,tops=[],bottoms=[];for(i=0;n>i;++i)j=index[i],bottom>top?(top+=sums[j],tops.push(j)):(bottom+=sums[j],bottoms.push(j));return bottoms.reverse().concat(tops)},reverse:function(data){return d3.range(data.length).reverse()},"default":d3_layout_stackOrderDefault}),d3_layout_stackOffsets=d3.map({silhouette:function(data){var i,j,o,n=data.length,m=data[0].length,sums=[],max=0,y0=[];for(j=0;m>j;++j){for(i=0,o=0;n>i;i++)o+=data[i][j][1];o>max&&(max=o),sums.push(o)}for(j=0;m>j;++j)y0[j]=(max-sums[j])/2;return y0},wiggle:function(data){var i,j,k,s1,s2,s3,dx,o,o0,n=data.length,x=data[0],m=x.length,y0=[];for(y0[0]=o=o0=0,j=1;m>j;++j){for(i=0,s1=0;n>i;++i)s1+=data[i][j][1];for(i=0,s2=0,dx=x[j][0]-x[j-1][0];n>i;++i){for(k=0,s3=(data[i][j][1]-data[i][j-1][1])/(2*dx);i>k;++k)s3+=(data[k][j][1]-data[k][j-1][1])/dx;s2+=s3*data[i][j][1]}y0[j]=o-=s1?s2/s1*dx:0,o0>o&&(o0=o)}for(j=0;m>j;++j)y0[j]-=o0;return y0},expand:function(data){var i,j,o,n=data.length,m=data[0].length,k=1/n,y0=[];for(j=0;m>j;++j){for(i=0,o=0;n>i;i++)o+=data[i][j][1];if(o)for(i=0;n>i;i++)data[i][j][1]/=o;else for(i=0;n>i;i++)data[i][j][1]=k}for(j=0;m>j;++j)y0[j]=0;return y0},zero:d3_layout_stackOffsetZero});d3.layout.histogram=function(){function histogram(data,i){for(var bin,x,bins=[],values=data.map(valuer,this),range=ranger.call(this,values,i),thresholds=binner.call(this,range,values,i),i=-1,n=values.length,m=thresholds.length-1,k=frequency?1:1/n;++i<m;)bin=bins[i]=[],bin.dx=thresholds[i+1]-(bin.x=thresholds[i]),bin.y=0;if(m>0)for(i=-1;++i<n;)x=values[i],x>=range[0]&&x<=range[1]&&(bin=bins[d3.bisect(thresholds,x,1,m)-1],bin.y+=k,bin.push(data[i]));return bins}var frequency=!0,valuer=Number,ranger=d3_layout_histogramRange,binner=d3_layout_histogramBinSturges;return histogram.value=function(x){return arguments.length?(valuer=x,histogram):valuer},histogram.range=function(x){return arguments.length?(ranger=d3_functor(x),histogram):ranger},histogram.bins=function(x){return arguments.length?(binner="number"==typeof x?function(range){return d3_layout_histogramBinFixed(range,x)}:d3_functor(x),histogram):binner},histogram.frequency=function(x){return arguments.length?(frequency=!!x,histogram):frequency},histogram},d3.layout.pack=function(){function pack(d,i){var nodes=hierarchy.call(this,d,i),root=nodes[0],w=size[0],h=size[1],r=null==radius?Math.sqrt:"function"==typeof radius?radius:function(){return radius};if(root.x=root.y=0,d3_layout_hierarchyVisitAfter(root,function(d){d.r=+r(d.value)}),d3_layout_hierarchyVisitAfter(root,d3_layout_packSiblings),padding){var dr=padding*(radius?1:Math.max(2*root.r/w,2*root.r/h))/2;d3_layout_hierarchyVisitAfter(root,function(d){d.r+=dr}),d3_layout_hierarchyVisitAfter(root,d3_layout_packSiblings),d3_layout_hierarchyVisitAfter(root,function(d){d.r-=dr})}return d3_layout_packTransform(root,w/2,h/2,radius?1:1/Math.max(2*root.r/w,2*root.r/h)),nodes}var radius,hierarchy=d3.layout.hierarchy().sort(d3_layout_packSort),padding=0,size=[1,1];return pack.size=function(_){return arguments.length?(size=_,pack):size},pack.radius=function(_){return arguments.length?(radius=null==_||"function"==typeof _?_:+_,pack):radius},pack.padding=function(_){return arguments.length?(padding=+_,pack):padding},d3_layout_hierarchyRebind(pack,hierarchy)},d3.layout.tree=function(){function tree(d,i){var nodes=hierarchy.call(this,d,i),root0=nodes[0],root1=wrapTree(root0);if(d3_layout_hierarchyVisitAfter(root1,firstWalk),root1.parent.m=-root1.z,d3_layout_hierarchyVisitBefore(root1,secondWalk),nodeSize)d3_layout_hierarchyVisitBefore(root0,sizeNode);else{var left=root0,right=root0,bottom=root0;d3_layout_hierarchyVisitBefore(root0,function(node){node.x<left.x&&(left=node),node.x>right.x&&(right=node),node.depth>bottom.depth&&(bottom=node)});var tx=separation(left,right)/2-left.x,kx=size[0]/(right.x+separation(right,left)/2+tx),ky=size[1]/(bottom.depth||1);d3_layout_hierarchyVisitBefore(root0,function(node){node.x=(node.x+tx)*kx,node.y=node.depth*ky})}return nodes}function wrapTree(root0){for(var node1,root1={A:null,children:[root0]},queue=[root1];null!=(node1=queue.pop());)for(var child,children=node1.children,i=0,n=children.length;n>i;++i)queue.push((children[i]=child={_:children[i],parent:node1,children:(child=children[i].children)&&child.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:i}).a=child);return root1.children[0]}function firstWalk(v){var children=v.children,siblings=v.parent.children,w=v.i?siblings[v.i-1]:null;if(children.length){d3_layout_treeShift(v);var midpoint=(children[0].z+children[children.length-1].z)/2;w?(v.z=w.z+separation(v._,w._),v.m=v.z-midpoint):v.z=midpoint}else w&&(v.z=w.z+separation(v._,w._));v.parent.A=apportion(v,w,v.parent.A||siblings[0])}function secondWalk(v){v._.x=v.z+v.parent.m,v.m+=v.parent.m}function apportion(v,w,ancestor){if(w){for(var shift,vip=v,vop=v,vim=w,vom=vip.parent.children[0],sip=vip.m,sop=vop.m,sim=vim.m,som=vom.m;vim=d3_layout_treeRight(vim),vip=d3_layout_treeLeft(vip),vim&&vip;)vom=d3_layout_treeLeft(vom),vop=d3_layout_treeRight(vop),vop.a=v,shift=vim.z+sim-vip.z-sip+separation(vim._,vip._),shift>0&&(d3_layout_treeMove(d3_layout_treeAncestor(vim,v,ancestor),v,shift),sip+=shift,sop+=shift),sim+=vim.m,sip+=vip.m,som+=vom.m,sop+=vop.m;vim&&!d3_layout_treeRight(vop)&&(vop.t=vim,vop.m+=sim-sop),vip&&!d3_layout_treeLeft(vom)&&(vom.t=vip,vom.m+=sip-som,ancestor=v)}return ancestor}function sizeNode(node){node.x*=size[0],node.y=node.depth*size[1]}var hierarchy=d3.layout.hierarchy().sort(null).value(null),separation=d3_layout_treeSeparation,size=[1,1],nodeSize=null;return tree.separation=function(x){return arguments.length?(separation=x,tree):separation},tree.size=function(x){return arguments.length?(nodeSize=null==(size=x)?sizeNode:null,tree):nodeSize?null:size},tree.nodeSize=function(x){return arguments.length?(nodeSize=null==(size=x)?null:sizeNode,tree):nodeSize?size:null},d3_layout_hierarchyRebind(tree,hierarchy)},d3.layout.cluster=function(){function cluster(d,i){var previousNode,nodes=hierarchy.call(this,d,i),root=nodes[0],x=0;d3_layout_hierarchyVisitAfter(root,function(node){var children=node.children;children&&children.length?(node.x=d3_layout_clusterX(children),node.y=d3_layout_clusterY(children)):(node.x=previousNode?x+=separation(node,previousNode):0,node.y=0,previousNode=node)});var left=d3_layout_clusterLeft(root),right=d3_layout_clusterRight(root),x0=left.x-separation(left,right)/2,x1=right.x+separation(right,left)/2;return d3_layout_hierarchyVisitAfter(root,nodeSize?function(node){node.x=(node.x-root.x)*size[0],node.y=(root.y-node.y)*size[1]}:function(node){node.x=(node.x-x0)/(x1-x0)*size[0],node.y=(1-(root.y?node.y/root.y:1))*size[1]}),nodes}var hierarchy=d3.layout.hierarchy().sort(null).value(null),separation=d3_layout_treeSeparation,size=[1,1],nodeSize=!1;return cluster.separation=function(x){return arguments.length?(separation=x,cluster):separation},cluster.size=function(x){return arguments.length?(nodeSize=null==(size=x),cluster):nodeSize?null:size},cluster.nodeSize=function(x){return arguments.length?(nodeSize=null!=(size=x),cluster):nodeSize?size:null},d3_layout_hierarchyRebind(cluster,hierarchy)},d3.layout.treemap=function(){function scale(children,k){for(var child,area,i=-1,n=children.length;++i<n;)area=(child=children[i]).value*(0>k?0:k),child.area=isNaN(area)||0>=area?0:area}function squarify(node){var children=node.children;if(children&&children.length){var child,score,n,rect=pad(node),row=[],remaining=children.slice(),best=1/0,u="slice"===mode?rect.dx:"dice"===mode?rect.dy:"slice-dice"===mode?1&node.depth?rect.dy:rect.dx:Math.min(rect.dx,rect.dy);for(scale(remaining,rect.dx*rect.dy/node.value),row.area=0;(n=remaining.length)>0;)row.push(child=remaining[n-1]),row.area+=child.area,"squarify"!==mode||(score=worst(row,u))<=best?(remaining.pop(),best=score):(row.area-=row.pop().area,position(row,u,rect,!1),u=Math.min(rect.dx,rect.dy),row.length=row.area=0,best=1/0);row.length&&(position(row,u,rect,!0),row.length=row.area=0),children.forEach(squarify)}}function stickify(node){var children=node.children;if(children&&children.length){var child,rect=pad(node),remaining=children.slice(),row=[];for(scale(remaining,rect.dx*rect.dy/node.value),row.area=0;child=remaining.pop();)row.push(child),row.area+=child.area,null!=child.z&&(position(row,child.z?rect.dx:rect.dy,rect,!remaining.length),row.length=row.area=0);children.forEach(stickify)}}function worst(row,u){for(var r,s=row.area,rmax=0,rmin=1/0,i=-1,n=row.length;++i<n;)(r=row[i].area)&&(rmin>r&&(rmin=r),r>rmax&&(rmax=r));return s*=s,u*=u,s?Math.max(u*rmax*ratio/s,s/(u*rmin*ratio)):1/0}function position(row,u,rect,flush){var o,i=-1,n=row.length,x=rect.x,y=rect.y,v=u?round(row.area/u):0;if(u==rect.dx){for((flush||v>rect.dy)&&(v=rect.dy);++i<n;)o=row[i],o.x=x,o.y=y,o.dy=v,x+=o.dx=Math.min(rect.x+rect.dx-x,v?round(o.area/v):0);o.z=!0,o.dx+=rect.x+rect.dx-x,rect.y+=v,rect.dy-=v}else{for((flush||v>rect.dx)&&(v=rect.dx);++i<n;)o=row[i],o.x=x,o.y=y,o.dx=v,y+=o.dy=Math.min(rect.y+rect.dy-y,v?round(o.area/v):0);o.z=!1,o.dy+=rect.y+rect.dy-y,rect.x+=v,rect.dx-=v}}function treemap(d){var nodes=stickies||hierarchy(d),root=nodes[0];return root.x=root.y=0,root.value?(root.dx=size[0],root.dy=size[1]):root.dx=root.dy=0,stickies&&hierarchy.revalue(root),scale([root],root.dx*root.dy/root.value),(stickies?stickify:squarify)(root),sticky&&(stickies=nodes),nodes}var stickies,hierarchy=d3.layout.hierarchy(),round=Math.round,size=[1,1],padding=null,pad=d3_layout_treemapPadNull,sticky=!1,mode="squarify",ratio=.5*(1+Math.sqrt(5));return treemap.size=function(x){return arguments.length?(size=x,treemap):size},treemap.padding=function(x){function padFunction(node){var p=x.call(treemap,node,node.depth);return null==p?d3_layout_treemapPadNull(node):d3_layout_treemapPad(node,"number"==typeof p?[p,p,p,p]:p)}function padConstant(node){return d3_layout_treemapPad(node,x)}if(!arguments.length)return padding;var type;return pad=null==(padding=x)?d3_layout_treemapPadNull:"function"==(type=typeof x)?padFunction:"number"===type?(x=[x,x,x,x],padConstant):padConstant,treemap},treemap.round=function(x){return arguments.length?(round=x?Math.round:Number,treemap):round!=Number},treemap.sticky=function(x){return arguments.length?(sticky=x,stickies=null,treemap):sticky},treemap.ratio=function(x){return arguments.length?(ratio=x,treemap):ratio},treemap.mode=function(x){return arguments.length?(mode=x+"",treemap):mode},d3_layout_hierarchyRebind(treemap,hierarchy)},d3.random={normal:function(µ,σ){var n=arguments.length;return 2>n&&(σ=1),1>n&&(µ=0),function(){var x,y,r;do x=2*Math.random()-1,y=2*Math.random()-1,r=x*x+y*y;while(!r||r>1);return µ+σ*x*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var random=d3.random.normal.apply(d3,arguments);return function(){return Math.exp(random())}},bates:function(m){var random=d3.random.irwinHall(m);return function(){return random()/m}},irwinHall:function(m){return function(){for(var s=0,j=0;m>j;j++)s+=Math.random();return s}}},d3.scale={};var d3_scale_niceIdentity={floor:d3_identity,ceil:d3_identity};d3.scale.linear=function(){return d3_scale_linear([0,1],[0,1],d3_interpolate,!1)};var d3_scale_linearFormatSignificant={s:1,g:1,p:1,r:1,e:1};d3.scale.log=function(){return d3_scale_log(d3.scale.linear().domain([0,1]),10,!0,[1,10])};var d3_scale_logFormat=d3.format(".0e"),d3_scale_logNiceNegative={floor:function(x){return-Math.ceil(-x)},ceil:function(x){return-Math.floor(-x)}};d3.scale.pow=function(){return d3_scale_pow(d3.scale.linear(),1,[0,1])},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return d3_scale_ordinal([],{t:"range",a:[[]]})},d3.scale.category10=function(){return d3.scale.ordinal().range(d3_category10)},d3.scale.category20=function(){return d3.scale.ordinal().range(d3_category20)},d3.scale.category20b=function(){return d3.scale.ordinal().range(d3_category20b)},d3.scale.category20c=function(){return d3.scale.ordinal().range(d3_category20c)};var d3_category10=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(d3_rgbString),d3_category20=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(d3_rgbString),d3_category20b=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(d3_rgbString),d3_category20c=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(d3_rgbString);d3.scale.quantile=function(){return d3_scale_quantile([],[])},d3.scale.quantize=function(){return d3_scale_quantize(0,1,[0,1])},d3.scale.threshold=function(){return d3_scale_threshold([.5],[0,1])},d3.scale.identity=function(){return d3_scale_identity([0,1])},d3.svg={},d3.svg.arc=function(){function arc(){var r0=Math.max(0,+innerRadius.apply(this,arguments)),r1=Math.max(0,+outerRadius.apply(this,arguments)),a0=startAngle.apply(this,arguments)-halfπ,a1=endAngle.apply(this,arguments)-halfπ,da=Math.abs(a1-a0),cw=a0>a1?0:1;if(r0>r1&&(rc=r1,r1=r0,r0=rc),da>=τε)return circleSegment(r1,cw)+(r0?circleSegment(r0,1-cw):"")+"Z";var rc,cr,rp,ap,x0,y0,x1,y1,x2,y2,x3,y3,p0=0,p1=0,path=[];if((ap=(+padAngle.apply(this,arguments)||0)/2)&&(rp=padRadius===d3_svg_arcAuto?Math.sqrt(r0*r0+r1*r1):+padRadius.apply(this,arguments),cw||(p1*=-1),r1&&(p1=d3_asin(rp/r1*Math.sin(ap))),r0&&(p0=d3_asin(rp/r0*Math.sin(ap)))),r1){x0=r1*Math.cos(a0+p1),y0=r1*Math.sin(a0+p1),x1=r1*Math.cos(a1-p1),y1=r1*Math.sin(a1-p1);var l1=Math.abs(a1-a0-2*p1)<=π?0:1;if(p1&&d3_svg_arcSweep(x0,y0,x1,y1)===cw^l1){var h1=(a0+a1)/2;x0=r1*Math.cos(h1),y0=r1*Math.sin(h1),x1=y1=null}}else x0=y0=0;if(r0){x2=r0*Math.cos(a1-p0),y2=r0*Math.sin(a1-p0),x3=r0*Math.cos(a0+p0),y3=r0*Math.sin(a0+p0);var l0=Math.abs(a0-a1+2*p0)<=π?0:1;if(p0&&d3_svg_arcSweep(x2,y2,x3,y3)===1-cw^l0){var h0=(a0+a1)/2;x2=r0*Math.cos(h0),y2=r0*Math.sin(h0),x3=y3=null}}else x2=y2=0;if(da>ε&&(rc=Math.min(Math.abs(r1-r0)/2,+cornerRadius.apply(this,arguments)))>.001){cr=r1>r0^cw?0:1;var rc1=rc,rc0=rc;if(π>da){var oc=null==x3?[x2,y2]:null==x1?[x0,y0]:d3_geom_polygonIntersect([x0,y0],[x3,y3],[x1,y1],[x2,y2]),ax=x0-oc[0],ay=y0-oc[1],bx=x1-oc[0],by=y1-oc[1],kc=1/Math.sin(Math.acos((ax*bx+ay*by)/(Math.sqrt(ax*ax+ay*ay)*Math.sqrt(bx*bx+by*by)))/2),lc=Math.sqrt(oc[0]*oc[0]+oc[1]*oc[1]);rc0=Math.min(rc,(r0-lc)/(kc-1)),rc1=Math.min(rc,(r1-lc)/(kc+1))}if(null!=x1){var t30=d3_svg_arcCornerTangents(null==x3?[x2,y2]:[x3,y3],[x0,y0],r1,rc1,cw),t12=d3_svg_arcCornerTangents([x1,y1],[x2,y2],r1,rc1,cw);rc===rc1?path.push("M",t30[0],"A",rc1,",",rc1," 0 0,",cr," ",t30[1],"A",r1,",",r1," 0 ",1-cw^d3_svg_arcSweep(t30[1][0],t30[1][1],t12[1][0],t12[1][1]),",",cw," ",t12[1],"A",rc1,",",rc1," 0 0,",cr," ",t12[0]):path.push("M",t30[0],"A",rc1,",",rc1," 0 1,",cr," ",t12[0])}else path.push("M",x0,",",y0);if(null!=x3){var t03=d3_svg_arcCornerTangents([x0,y0],[x3,y3],r0,-rc0,cw),t21=d3_svg_arcCornerTangents([x2,y2],null==x1?[x0,y0]:[x1,y1],r0,-rc0,cw);rc===rc0?path.push("L",t21[0],"A",rc0,",",rc0," 0 0,",cr," ",t21[1],"A",r0,",",r0," 0 ",cw^d3_svg_arcSweep(t21[1][0],t21[1][1],t03[1][0],t03[1][1]),",",1-cw," ",t03[1],"A",rc0,",",rc0," 0 0,",cr," ",t03[0]):path.push("L",t21[0],"A",rc0,",",rc0," 0 0,",cr," ",t03[0])}else path.push("L",x2,",",y2)}else path.push("M",x0,",",y0),null!=x1&&path.push("A",r1,",",r1," 0 ",l1,",",cw," ",x1,",",y1),path.push("L",x2,",",y2),null!=x3&&path.push("A",r0,",",r0," 0 ",l0,",",1-cw," ",x3,",",y3);return path.push("Z"),path.join("")}function circleSegment(r1,cw){return"M0,"+r1+"A"+r1+","+r1+" 0 1,"+cw+" 0,"+-r1+"A"+r1+","+r1+" 0 1,"+cw+" 0,"+r1}var innerRadius=d3_svg_arcInnerRadius,outerRadius=d3_svg_arcOuterRadius,cornerRadius=d3_zero,padRadius=d3_svg_arcAuto,startAngle=d3_svg_arcStartAngle,endAngle=d3_svg_arcEndAngle,padAngle=d3_svg_arcPadAngle;return arc.innerRadius=function(v){return arguments.length?(innerRadius=d3_functor(v),arc):innerRadius},arc.outerRadius=function(v){return arguments.length?(outerRadius=d3_functor(v),arc):outerRadius},arc.cornerRadius=function(v){return arguments.length?(cornerRadius=d3_functor(v),arc):cornerRadius},arc.padRadius=function(v){return arguments.length?(padRadius=v==d3_svg_arcAuto?d3_svg_arcAuto:d3_functor(v),arc):padRadius},arc.startAngle=function(v){return arguments.length?(startAngle=d3_functor(v),arc):startAngle},arc.endAngle=function(v){return arguments.length?(endAngle=d3_functor(v),arc):endAngle},arc.padAngle=function(v){return arguments.length?(padAngle=d3_functor(v),arc):padAngle},arc.centroid=function(){var r=(+innerRadius.apply(this,arguments)+ +outerRadius.apply(this,arguments))/2,a=(+startAngle.apply(this,arguments)+ +endAngle.apply(this,arguments))/2-halfπ;return[Math.cos(a)*r,Math.sin(a)*r]},arc};var d3_svg_arcAuto="auto";d3.svg.line=function(){return d3_svg_line(d3_identity)};var d3_svg_lineInterpolators=d3.map({linear:d3_svg_lineLinear,"linear-closed":d3_svg_lineLinearClosed,step:d3_svg_lineStep,"step-before":d3_svg_lineStepBefore,"step-after":d3_svg_lineStepAfter,basis:d3_svg_lineBasis,"basis-open":d3_svg_lineBasisOpen,"basis-closed":d3_svg_lineBasisClosed,bundle:d3_svg_lineBundle,cardinal:d3_svg_lineCardinal,"cardinal-open":d3_svg_lineCardinalOpen,"cardinal-closed":d3_svg_lineCardinalClosed,monotone:d3_svg_lineMonotone});d3_svg_lineInterpolators.forEach(function(key,value){value.key=key,value.closed=/-closed$/.test(key)});var d3_svg_lineBasisBezier1=[0,2/3,1/3,0],d3_svg_lineBasisBezier2=[0,1/3,2/3,0],d3_svg_lineBasisBezier3=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var line=d3_svg_line(d3_svg_lineRadial);return line.radius=line.x,delete line.x,line.angle=line.y,delete line.y,line},d3_svg_lineStepBefore.reverse=d3_svg_lineStepAfter,d3_svg_lineStepAfter.reverse=d3_svg_lineStepBefore,d3.svg.area=function(){return d3_svg_area(d3_identity)},d3.svg.area.radial=function(){var area=d3_svg_area(d3_svg_lineRadial);return area.radius=area.x,delete area.x,area.innerRadius=area.x0,delete area.x0,area.outerRadius=area.x1,delete area.x1,area.angle=area.y,delete area.y,area.startAngle=area.y0,delete area.y0,area.endAngle=area.y1,delete area.y1,area},d3.svg.chord=function(){function chord(d,i){var s=subgroup(this,source,d,i),t=subgroup(this,target,d,i);return"M"+s.p0+arc(s.r,s.p1,s.a1-s.a0)+(equals(s,t)?curve(s.r,s.p1,s.r,s.p0):curve(s.r,s.p1,t.r,t.p0)+arc(t.r,t.p1,t.a1-t.a0)+curve(t.r,t.p1,s.r,s.p0))+"Z"}function subgroup(self,f,d,i){var subgroup=f.call(self,d,i),r=radius.call(self,subgroup,i),a0=startAngle.call(self,subgroup,i)-halfπ,a1=endAngle.call(self,subgroup,i)-halfπ;return{r:r,a0:a0,a1:a1,p0:[r*Math.cos(a0),r*Math.sin(a0)],p1:[r*Math.cos(a1),r*Math.sin(a1)]}}function equals(a,b){return a.a0==b.a0&&a.a1==b.a1}function arc(r,p,a){return"A"+r+","+r+" 0 "+ +(a>π)+",1 "+p}function curve(r0,p0,r1,p1){return"Q 0,0 "+p1}var source=d3_source,target=d3_target,radius=d3_svg_chordRadius,startAngle=d3_svg_arcStartAngle,endAngle=d3_svg_arcEndAngle;return chord.radius=function(v){return arguments.length?(radius=d3_functor(v),chord):radius},chord.source=function(v){return arguments.length?(source=d3_functor(v),chord):source},chord.target=function(v){return arguments.length?(target=d3_functor(v),chord):target},chord.startAngle=function(v){return arguments.length?(startAngle=d3_functor(v),chord):startAngle},chord.endAngle=function(v){return arguments.length?(endAngle=d3_functor(v),chord):endAngle},chord},d3.svg.diagonal=function(){function diagonal(d,i){var p0=source.call(this,d,i),p3=target.call(this,d,i),m=(p0.y+p3.y)/2,p=[p0,{x:p0.x,y:m},{x:p3.x,y:m},p3];return p=p.map(projection),"M"+p[0]+"C"+p[1]+" "+p[2]+" "+p[3]}var source=d3_source,target=d3_target,projection=d3_svg_diagonalProjection;return diagonal.source=function(x){return arguments.length?(source=d3_functor(x),diagonal):source},diagonal.target=function(x){return arguments.length?(target=d3_functor(x),diagonal):target},diagonal.projection=function(x){return arguments.length?(projection=x,diagonal):projection},diagonal},d3.svg.diagonal.radial=function(){var diagonal=d3.svg.diagonal(),projection=d3_svg_diagonalProjection,projection_=diagonal.projection;
return diagonal.projection=function(x){return arguments.length?projection_(d3_svg_diagonalRadialProjection(projection=x)):projection},diagonal},d3.svg.symbol=function(){function symbol(d,i){return(d3_svg_symbols.get(type.call(this,d,i))||d3_svg_symbolCircle)(size.call(this,d,i))}var type=d3_svg_symbolType,size=d3_svg_symbolSize;return symbol.type=function(x){return arguments.length?(type=d3_functor(x),symbol):type},symbol.size=function(x){return arguments.length?(size=d3_functor(x),symbol):size},symbol};var d3_svg_symbols=d3.map({circle:d3_svg_symbolCircle,cross:function(size){var r=Math.sqrt(size/5)/2;return"M"+-3*r+","+-r+"H"+-r+"V"+-3*r+"H"+r+"V"+-r+"H"+3*r+"V"+r+"H"+r+"V"+3*r+"H"+-r+"V"+r+"H"+-3*r+"Z"},diamond:function(size){var ry=Math.sqrt(size/(2*d3_svg_symbolTan30)),rx=ry*d3_svg_symbolTan30;return"M0,"+-ry+"L"+rx+",0 0,"+ry+" "+-rx+",0Z"},square:function(size){var r=Math.sqrt(size)/2;return"M"+-r+","+-r+"L"+r+","+-r+" "+r+","+r+" "+-r+","+r+"Z"},"triangle-down":function(size){var rx=Math.sqrt(size/d3_svg_symbolSqrt3),ry=rx*d3_svg_symbolSqrt3/2;return"M0,"+ry+"L"+rx+","+-ry+" "+-rx+","+-ry+"Z"},"triangle-up":function(size){var rx=Math.sqrt(size/d3_svg_symbolSqrt3),ry=rx*d3_svg_symbolSqrt3/2;return"M0,"+-ry+"L"+rx+","+ry+" "+-rx+","+ry+"Z"}});d3.svg.symbolTypes=d3_svg_symbols.keys();var d3_svg_symbolSqrt3=Math.sqrt(3),d3_svg_symbolTan30=Math.tan(30*d3_radians);d3_selectionPrototype.transition=function(name){for(var subgroup,node,id=d3_transitionInheritId||++d3_transitionId,ns=d3_transitionNamespace(name),subgroups=[],transition=d3_transitionInherit||{time:Date.now(),ease:d3_ease_cubicInOut,delay:0,duration:250},j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);for(var group=this[j],i=-1,n=group.length;++i<n;)(node=group[i])&&d3_transitionNode(node,i,ns,id,transition),subgroup.push(node)}return d3_transition(subgroups,ns,id)},d3_selectionPrototype.interrupt=function(name){return this.each(null==name?d3_selection_interrupt:d3_selection_interruptNS(d3_transitionNamespace(name)))};var d3_transitionInheritId,d3_transitionInherit,d3_selection_interrupt=d3_selection_interruptNS(d3_transitionNamespace()),d3_transitionPrototype=[],d3_transitionId=0;d3_transitionPrototype.call=d3_selectionPrototype.call,d3_transitionPrototype.empty=d3_selectionPrototype.empty,d3_transitionPrototype.node=d3_selectionPrototype.node,d3_transitionPrototype.size=d3_selectionPrototype.size,d3.transition=function(selection,name){return selection&&selection.transition?d3_transitionInheritId?selection.transition(name):selection:d3.selection().transition(selection)},d3.transition.prototype=d3_transitionPrototype,d3_transitionPrototype.select=function(selector){var subgroup,subnode,node,id=this.id,ns=this.namespace,subgroups=[];selector=d3_selection_selector(selector);for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);for(var group=this[j],i=-1,n=group.length;++i<n;)(node=group[i])&&(subnode=selector.call(node,node.__data__,i,j))?("__data__"in node&&(subnode.__data__=node.__data__),d3_transitionNode(subnode,i,ns,id,node[ns][id]),subgroup.push(subnode)):subgroup.push(null)}return d3_transition(subgroups,ns,id)},d3_transitionPrototype.selectAll=function(selector){var subgroup,subnodes,node,subnode,transition,id=this.id,ns=this.namespace,subgroups=[];selector=d3_selection_selectorAll(selector);for(var j=-1,m=this.length;++j<m;)for(var group=this[j],i=-1,n=group.length;++i<n;)if(node=group[i]){transition=node[ns][id],subnodes=selector.call(node,node.__data__,i,j),subgroups.push(subgroup=[]);for(var k=-1,o=subnodes.length;++k<o;)(subnode=subnodes[k])&&d3_transitionNode(subnode,k,ns,id,transition),subgroup.push(subnode)}return d3_transition(subgroups,ns,id)},d3_transitionPrototype.filter=function(filter){var subgroup,group,node,subgroups=[];"function"!=typeof filter&&(filter=d3_selection_filter(filter));for(var j=0,m=this.length;m>j;j++){subgroups.push(subgroup=[]);for(var group=this[j],i=0,n=group.length;n>i;i++)(node=group[i])&&filter.call(node,node.__data__,i,j)&&subgroup.push(node)}return d3_transition(subgroups,this.namespace,this.id)},d3_transitionPrototype.tween=function(name,tween){var id=this.id,ns=this.namespace;return arguments.length<2?this.node()[ns][id].tween.get(name):d3_selection_each(this,null==tween?function(node){node[ns][id].tween.remove(name)}:function(node){node[ns][id].tween.set(name,tween)})},d3_transitionPrototype.attr=function(nameNS,value){function attrNull(){this.removeAttribute(name)}function attrNullNS(){this.removeAttributeNS(name.space,name.local)}function attrTween(b){return null==b?attrNull:(b+="",function(){var i,a=this.getAttribute(name);return a!==b&&(i=interpolate(a,b),function(t){this.setAttribute(name,i(t))})})}function attrTweenNS(b){return null==b?attrNullNS:(b+="",function(){var i,a=this.getAttributeNS(name.space,name.local);return a!==b&&(i=interpolate(a,b),function(t){this.setAttributeNS(name.space,name.local,i(t))})})}if(arguments.length<2){for(value in nameNS)this.attr(value,nameNS[value]);return this}var interpolate="transform"==nameNS?d3_interpolateTransform:d3_interpolate,name=d3.ns.qualify(nameNS);return d3_transition_tween(this,"attr."+nameNS,value,name.local?attrTweenNS:attrTween)},d3_transitionPrototype.attrTween=function(nameNS,tween){function attrTween(d,i){var f=tween.call(this,d,i,this.getAttribute(name));return f&&function(t){this.setAttribute(name,f(t))}}function attrTweenNS(d,i){var f=tween.call(this,d,i,this.getAttributeNS(name.space,name.local));return f&&function(t){this.setAttributeNS(name.space,name.local,f(t))}}var name=d3.ns.qualify(nameNS);return this.tween("attr."+nameNS,name.local?attrTweenNS:attrTween)},d3_transitionPrototype.style=function(name,value,priority){function styleNull(){this.style.removeProperty(name)}function styleString(b){return null==b?styleNull:(b+="",function(){var i,a=d3_window(this).getComputedStyle(this,null).getPropertyValue(name);return a!==b&&(i=d3_interpolate(a,b),function(t){this.style.setProperty(name,i(t),priority)})})}var n=arguments.length;if(3>n){if("string"!=typeof name){2>n&&(value="");for(priority in name)this.style(priority,name[priority],value);return this}priority=""}return d3_transition_tween(this,"style."+name,value,styleString)},d3_transitionPrototype.styleTween=function(name,tween,priority){function styleTween(d,i){var f=tween.call(this,d,i,d3_window(this).getComputedStyle(this,null).getPropertyValue(name));return f&&function(t){this.style.setProperty(name,f(t),priority)}}return arguments.length<3&&(priority=""),this.tween("style."+name,styleTween)},d3_transitionPrototype.text=function(value){return d3_transition_tween(this,"text",value,d3_transition_text)},d3_transitionPrototype.remove=function(){var ns=this.namespace;return this.each("end.transition",function(){var p;this[ns].count<2&&(p=this.parentNode)&&p.removeChild(this)})},d3_transitionPrototype.ease=function(value){var id=this.id,ns=this.namespace;return arguments.length<1?this.node()[ns][id].ease:("function"!=typeof value&&(value=d3.ease.apply(d3,arguments)),d3_selection_each(this,function(node){node[ns][id].ease=value}))},d3_transitionPrototype.delay=function(value){var id=this.id,ns=this.namespace;return arguments.length<1?this.node()[ns][id].delay:d3_selection_each(this,"function"==typeof value?function(node,i,j){node[ns][id].delay=+value.call(node,node.__data__,i,j)}:(value=+value,function(node){node[ns][id].delay=value}))},d3_transitionPrototype.duration=function(value){var id=this.id,ns=this.namespace;return arguments.length<1?this.node()[ns][id].duration:d3_selection_each(this,"function"==typeof value?function(node,i,j){node[ns][id].duration=Math.max(1,value.call(node,node.__data__,i,j))}:(value=Math.max(1,value),function(node){node[ns][id].duration=value}))},d3_transitionPrototype.each=function(type,listener){var id=this.id,ns=this.namespace;if(arguments.length<2){var inherit=d3_transitionInherit,inheritId=d3_transitionInheritId;try{d3_transitionInheritId=id,d3_selection_each(this,function(node,i,j){d3_transitionInherit=node[ns][id],type.call(node,node.__data__,i,j)})}finally{d3_transitionInherit=inherit,d3_transitionInheritId=inheritId}}else d3_selection_each(this,function(node){var transition=node[ns][id];(transition.event||(transition.event=d3.dispatch("start","end","interrupt"))).on(type,listener)});return this},d3_transitionPrototype.transition=function(){for(var subgroup,group,node,transition,id0=this.id,id1=++d3_transitionId,ns=this.namespace,subgroups=[],j=0,m=this.length;m>j;j++){subgroups.push(subgroup=[]);for(var group=this[j],i=0,n=group.length;n>i;i++)(node=group[i])&&(transition=node[ns][id0],d3_transitionNode(node,i,ns,id1,{time:transition.time,ease:transition.ease,delay:transition.delay+transition.duration,duration:transition.duration})),subgroup.push(node)}return d3_transition(subgroups,ns,id1)},d3.svg.axis=function(){function axis(g){g.each(function(){var tickTransform,g=d3.select(this),scale0=this.__chart__||scale,scale1=this.__chart__=scale.copy(),ticks=null==tickValues?scale1.ticks?scale1.ticks.apply(scale1,tickArguments_):scale1.domain():tickValues,tickFormat=null==tickFormat_?scale1.tickFormat?scale1.tickFormat.apply(scale1,tickArguments_):d3_identity:tickFormat_,tick=g.selectAll(".tick").data(ticks,scale1),tickEnter=tick.enter().insert("g",".domain").attr("class","tick").style("opacity",ε),tickExit=d3.transition(tick.exit()).style("opacity",ε).remove(),tickUpdate=d3.transition(tick.order()).style("opacity",1),tickSpacing=Math.max(innerTickSize,0)+tickPadding,range=d3_scaleRange(scale1),path=g.selectAll(".domain").data([0]),pathUpdate=(path.enter().append("path").attr("class","domain"),d3.transition(path));tickEnter.append("line"),tickEnter.append("text");var x1,x2,y1,y2,lineEnter=tickEnter.select("line"),lineUpdate=tickUpdate.select("line"),text=tick.select("text").text(tickFormat),textEnter=tickEnter.select("text"),textUpdate=tickUpdate.select("text"),sign="top"===orient||"left"===orient?-1:1;if("bottom"===orient||"top"===orient?(tickTransform=d3_svg_axisX,x1="x",y1="y",x2="x2",y2="y2",text.attr("dy",0>sign?"0em":".71em").style("text-anchor","middle"),pathUpdate.attr("d","M"+range[0]+","+sign*outerTickSize+"V0H"+range[1]+"V"+sign*outerTickSize)):(tickTransform=d3_svg_axisY,x1="y",y1="x",x2="y2",y2="x2",text.attr("dy",".32em").style("text-anchor",0>sign?"end":"start"),pathUpdate.attr("d","M"+sign*outerTickSize+","+range[0]+"H0V"+range[1]+"H"+sign*outerTickSize)),lineEnter.attr(y2,sign*innerTickSize),textEnter.attr(y1,sign*tickSpacing),lineUpdate.attr(x2,0).attr(y2,sign*innerTickSize),textUpdate.attr(x1,0).attr(y1,sign*tickSpacing),scale1.rangeBand){var x=scale1,dx=x.rangeBand()/2;scale0=scale1=function(d){return x(d)+dx}}else scale0.rangeBand?scale0=scale1:tickExit.call(tickTransform,scale1,scale0);tickEnter.call(tickTransform,scale0,scale1),tickUpdate.call(tickTransform,scale1,scale1)})}var tickFormat_,scale=d3.scale.linear(),orient=d3_svg_axisDefaultOrient,innerTickSize=6,outerTickSize=6,tickPadding=3,tickArguments_=[10],tickValues=null;return axis.scale=function(x){return arguments.length?(scale=x,axis):scale},axis.orient=function(x){return arguments.length?(orient=x in d3_svg_axisOrients?x+"":d3_svg_axisDefaultOrient,axis):orient},axis.ticks=function(){return arguments.length?(tickArguments_=d3_array(arguments),axis):tickArguments_},axis.tickValues=function(x){return arguments.length?(tickValues=x,axis):tickValues},axis.tickFormat=function(x){return arguments.length?(tickFormat_=x,axis):tickFormat_},axis.tickSize=function(x){var n=arguments.length;return n?(innerTickSize=+x,outerTickSize=+arguments[n-1],axis):innerTickSize},axis.innerTickSize=function(x){return arguments.length?(innerTickSize=+x,axis):innerTickSize},axis.outerTickSize=function(x){return arguments.length?(outerTickSize=+x,axis):outerTickSize},axis.tickPadding=function(x){return arguments.length?(tickPadding=+x,axis):tickPadding},axis.tickSubdivide=function(){return arguments.length&&axis},axis};var d3_svg_axisDefaultOrient="bottom",d3_svg_axisOrients={top:1,right:1,bottom:1,left:1};d3.svg.brush=function(){function brush(g){g.each(function(){var g=d3.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",brushstart).on("touchstart.brush",brushstart),background=g.selectAll(".background").data([0]);background.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),g.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var resize=g.selectAll(".resize").data(resizes,d3_identity);resize.exit().remove(),resize.enter().append("g").attr("class",function(d){return"resize "+d}).style("cursor",function(d){return d3_svg_brushCursor[d]}).append("rect").attr("x",function(d){return/[ew]$/.test(d)?-3:null}).attr("y",function(d){return/^[ns]/.test(d)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),resize.style("display",brush.empty()?"none":null);var range,gUpdate=d3.transition(g),backgroundUpdate=d3.transition(background);x&&(range=d3_scaleRange(x),backgroundUpdate.attr("x",range[0]).attr("width",range[1]-range[0]),redrawX(gUpdate)),y&&(range=d3_scaleRange(y),backgroundUpdate.attr("y",range[0]).attr("height",range[1]-range[0]),redrawY(gUpdate)),redraw(gUpdate)})}function redraw(g){g.selectAll(".resize").attr("transform",function(d){return"translate("+xExtent[+/e$/.test(d)]+","+yExtent[+/^s/.test(d)]+")"})}function redrawX(g){g.select(".extent").attr("x",xExtent[0]),g.selectAll(".extent,.n>rect,.s>rect").attr("width",xExtent[1]-xExtent[0])}function redrawY(g){g.select(".extent").attr("y",yExtent[0]),g.selectAll(".extent,.e>rect,.w>rect").attr("height",yExtent[1]-yExtent[0])}function brushstart(){function keydown(){32==d3.event.keyCode&&(dragging||(center=null,origin[0]-=xExtent[1],origin[1]-=yExtent[1],dragging=2),d3_eventPreventDefault())}function keyup(){32==d3.event.keyCode&&2==dragging&&(origin[0]+=xExtent[1],origin[1]+=yExtent[1],dragging=0,d3_eventPreventDefault())}function brushmove(){var point=d3.mouse(target),moved=!1;offset&&(point[0]+=offset[0],point[1]+=offset[1]),dragging||(d3.event.altKey?(center||(center=[(xExtent[0]+xExtent[1])/2,(yExtent[0]+yExtent[1])/2]),origin[0]=xExtent[+(point[0]<center[0])],origin[1]=yExtent[+(point[1]<center[1])]):center=null),resizingX&&move1(point,x,0)&&(redrawX(g),moved=!0),resizingY&&move1(point,y,1)&&(redrawY(g),moved=!0),moved&&(redraw(g),event_({type:"brush",mode:dragging?"move":"resize"}))}function move1(point,scale,i){var min,max,range=d3_scaleRange(scale),r0=range[0],r1=range[1],position=origin[i],extent=i?yExtent:xExtent,size=extent[1]-extent[0];return dragging&&(r0-=position,r1-=size+position),min=(i?yClamp:xClamp)?Math.max(r0,Math.min(r1,point[i])):point[i],dragging?max=(min+=position)+size:(center&&(position=Math.max(r0,Math.min(r1,2*center[i]-min))),min>position?(max=min,min=position):max=position),extent[0]!=min||extent[1]!=max?(i?yExtentDomain=null:xExtentDomain=null,extent[0]=min,extent[1]=max,!0):void 0}function brushend(){brushmove(),g.style("pointer-events","all").selectAll(".resize").style("display",brush.empty()?"none":null),d3.select("body").style("cursor",null),w.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),dragRestore(),event_({type:"brushend"})}var center,offset,target=this,eventTarget=d3.select(d3.event.target),event_=event.of(target,arguments),g=d3.select(target),resizing=eventTarget.datum(),resizingX=!/^(n|s)$/.test(resizing)&&x,resizingY=!/^(e|w)$/.test(resizing)&&y,dragging=eventTarget.classed("extent"),dragRestore=d3_event_dragSuppress(target),origin=d3.mouse(target),w=d3.select(d3_window(target)).on("keydown.brush",keydown).on("keyup.brush",keyup);if(d3.event.changedTouches?w.on("touchmove.brush",brushmove).on("touchend.brush",brushend):w.on("mousemove.brush",brushmove).on("mouseup.brush",brushend),g.interrupt().selectAll("*").interrupt(),dragging)origin[0]=xExtent[0]-origin[0],origin[1]=yExtent[0]-origin[1];else if(resizing){var ex=+/w$/.test(resizing),ey=+/^n/.test(resizing);offset=[xExtent[1-ex]-origin[0],yExtent[1-ey]-origin[1]],origin[0]=xExtent[ex],origin[1]=yExtent[ey]}else d3.event.altKey&&(center=origin.slice());g.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",eventTarget.style("cursor")),event_({type:"brushstart"}),brushmove()}var xExtentDomain,yExtentDomain,event=d3_eventDispatch(brush,"brushstart","brush","brushend"),x=null,y=null,xExtent=[0,0],yExtent=[0,0],xClamp=!0,yClamp=!0,resizes=d3_svg_brushResizes[0];return brush.event=function(g){g.each(function(){var event_=event.of(this,arguments),extent1={x:xExtent,y:yExtent,i:xExtentDomain,j:yExtentDomain},extent0=this.__chart__||extent1;this.__chart__=extent1,d3_transitionInheritId?d3.select(this).transition().each("start.brush",function(){xExtentDomain=extent0.i,yExtentDomain=extent0.j,xExtent=extent0.x,yExtent=extent0.y,event_({type:"brushstart"})}).tween("brush:brush",function(){var xi=d3_interpolateArray(xExtent,extent1.x),yi=d3_interpolateArray(yExtent,extent1.y);return xExtentDomain=yExtentDomain=null,function(t){xExtent=extent1.x=xi(t),yExtent=extent1.y=yi(t),event_({type:"brush",mode:"resize"})}}).each("end.brush",function(){xExtentDomain=extent1.i,yExtentDomain=extent1.j,event_({type:"brush",mode:"resize"}),event_({type:"brushend"})}):(event_({type:"brushstart"}),event_({type:"brush",mode:"resize"}),event_({type:"brushend"}))})},brush.x=function(z){return arguments.length?(x=z,resizes=d3_svg_brushResizes[!x<<1|!y],brush):x},brush.y=function(z){return arguments.length?(y=z,resizes=d3_svg_brushResizes[!x<<1|!y],brush):y},brush.clamp=function(z){return arguments.length?(x&&y?(xClamp=!!z[0],yClamp=!!z[1]):x?xClamp=!!z:y&&(yClamp=!!z),brush):x&&y?[xClamp,yClamp]:x?xClamp:y?yClamp:null},brush.extent=function(z){var x0,x1,y0,y1,t;return arguments.length?(x&&(x0=z[0],x1=z[1],y&&(x0=x0[0],x1=x1[0]),xExtentDomain=[x0,x1],x.invert&&(x0=x(x0),x1=x(x1)),x0>x1&&(t=x0,x0=x1,x1=t),(x0!=xExtent[0]||x1!=xExtent[1])&&(xExtent=[x0,x1])),y&&(y0=z[0],y1=z[1],x&&(y0=y0[1],y1=y1[1]),yExtentDomain=[y0,y1],y.invert&&(y0=y(y0),y1=y(y1)),y0>y1&&(t=y0,y0=y1,y1=t),(y0!=yExtent[0]||y1!=yExtent[1])&&(yExtent=[y0,y1])),brush):(x&&(xExtentDomain?(x0=xExtentDomain[0],x1=xExtentDomain[1]):(x0=xExtent[0],x1=xExtent[1],x.invert&&(x0=x.invert(x0),x1=x.invert(x1)),x0>x1&&(t=x0,x0=x1,x1=t))),y&&(yExtentDomain?(y0=yExtentDomain[0],y1=yExtentDomain[1]):(y0=yExtent[0],y1=yExtent[1],y.invert&&(y0=y.invert(y0),y1=y.invert(y1)),y0>y1&&(t=y0,y0=y1,y1=t))),x&&y?[[x0,y0],[x1,y1]]:x?[x0,x1]:y&&[y0,y1])},brush.clear=function(){return brush.empty()||(xExtent=[0,0],yExtent=[0,0],xExtentDomain=yExtentDomain=null),brush},brush.empty=function(){return!!x&&xExtent[0]==xExtent[1]||!!y&&yExtent[0]==yExtent[1]},d3.rebind(brush,event,"on")};var d3_svg_brushCursor={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},d3_svg_brushResizes=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],d3_time_format=d3_time.format=d3_locale_enUS.timeFormat,d3_time_formatUtc=d3_time_format.utc,d3_time_formatIso=d3_time_formatUtc("%Y-%m-%dT%H:%M:%S.%LZ");d3_time_format.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?d3_time_formatIsoNative:d3_time_formatIso,d3_time_formatIsoNative.parse=function(string){var date=new Date(string);return isNaN(date)?null:date},d3_time_formatIsoNative.toString=d3_time_formatIso.toString,d3_time.second=d3_time_interval(function(date){return new d3_date(1e3*Math.floor(date/1e3))},function(date,offset){date.setTime(date.getTime()+1e3*Math.floor(offset))},function(date){return date.getSeconds()}),d3_time.seconds=d3_time.second.range,d3_time.seconds.utc=d3_time.second.utc.range,d3_time.minute=d3_time_interval(function(date){return new d3_date(6e4*Math.floor(date/6e4))},function(date,offset){date.setTime(date.getTime()+6e4*Math.floor(offset))},function(date){return date.getMinutes()}),d3_time.minutes=d3_time.minute.range,d3_time.minutes.utc=d3_time.minute.utc.range,d3_time.hour=d3_time_interval(function(date){var timezone=date.getTimezoneOffset()/60;return new d3_date(36e5*(Math.floor(date/36e5-timezone)+timezone))},function(date,offset){date.setTime(date.getTime()+36e5*Math.floor(offset))},function(date){return date.getHours()}),d3_time.hours=d3_time.hour.range,d3_time.hours.utc=d3_time.hour.utc.range,d3_time.month=d3_time_interval(function(date){return date=d3_time.day(date),date.setDate(1),date},function(date,offset){date.setMonth(date.getMonth()+offset)},function(date){return date.getMonth()}),d3_time.months=d3_time.month.range,d3_time.months.utc=d3_time.month.utc.range;var d3_time_scaleSteps=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],d3_time_scaleLocalMethods=[[d3_time.second,1],[d3_time.second,5],[d3_time.second,15],[d3_time.second,30],[d3_time.minute,1],[d3_time.minute,5],[d3_time.minute,15],[d3_time.minute,30],[d3_time.hour,1],[d3_time.hour,3],[d3_time.hour,6],[d3_time.hour,12],[d3_time.day,1],[d3_time.day,2],[d3_time.week,1],[d3_time.month,1],[d3_time.month,3],[d3_time.year,1]],d3_time_scaleLocalFormat=d3_time_format.multi([[".%L",function(d){return d.getMilliseconds()}],[":%S",function(d){return d.getSeconds()}],["%I:%M",function(d){return d.getMinutes()}],["%I %p",function(d){return d.getHours()}],["%a %d",function(d){return d.getDay()&&1!=d.getDate()}],["%b %d",function(d){return 1!=d.getDate()}],["%B",function(d){return d.getMonth()}],["%Y",d3_true]]),d3_time_scaleMilliseconds={range:function(start,stop,step){return d3.range(Math.ceil(start/step)*step,+stop,step).map(d3_time_scaleDate)},floor:d3_identity,ceil:d3_identity};d3_time_scaleLocalMethods.year=d3_time.year,d3_time.scale=function(){return d3_time_scale(d3.scale.linear(),d3_time_scaleLocalMethods,d3_time_scaleLocalFormat)};var d3_time_scaleUtcMethods=d3_time_scaleLocalMethods.map(function(m){return[m[0].utc,m[1]]}),d3_time_scaleUtcFormat=d3_time_formatUtc.multi([[".%L",function(d){return d.getUTCMilliseconds()}],[":%S",function(d){return d.getUTCSeconds()}],["%I:%M",function(d){return d.getUTCMinutes()}],["%I %p",function(d){return d.getUTCHours()}],["%a %d",function(d){return d.getUTCDay()&&1!=d.getUTCDate()}],["%b %d",function(d){return 1!=d.getUTCDate()}],["%B",function(d){return d.getUTCMonth()}],["%Y",d3_true]]);d3_time_scaleUtcMethods.year=d3_time.year.utc,d3_time.scale.utc=function(){return d3_time_scale(d3.scale.linear(),d3_time_scaleUtcMethods,d3_time_scaleUtcFormat)},d3.text=d3_xhrType(function(request){return request.responseText}),d3.json=function(url,callback){return d3_xhr(url,"application/json",d3_json,callback)},d3.html=function(url,callback){return d3_xhr(url,"text/html",d3_html,callback)},d3.xml=d3_xhrType(function(request){return request.responseXML}),"function"==typeof define&&define.amd?define(this.d3=d3):"object"==typeof module&&module.exports?module.exports=d3:this.d3=d3}(),function(){function addMapEntry(map,pair){return map.set(pair[0],pair[1]),map}function addSetEntry(set,value){return set.add(value),set}function apply(func,thisArg,args){var length=args.length;switch(length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}function arrayAggregator(array,setter,iteratee,accumulator){for(var index=-1,length=array.length;++index<length;){var value=array[index];setter(accumulator,value,iteratee(value),array)}return accumulator}function arrayConcat(array,other){for(var index=-1,length=array.length,othIndex=-1,othLength=other.length,result=Array(length+othLength);++index<length;)result[index]=array[index];for(;++othIndex<othLength;)result[index++]=other[othIndex];return result}function arrayEach(array,iteratee){for(var index=-1,length=array.length;++index<length&&iteratee(array[index],index,array)!==!1;);return array}function arrayEachRight(array,iteratee){for(var length=array.length;length--&&iteratee(array[length],length,array)!==!1;);return array}function arrayEvery(array,predicate){for(var index=-1,length=array.length;++index<length;)if(!predicate(array[index],index,array))return!1;return!0}function arrayFilter(array,predicate){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[++resIndex]=value)}return result}function arrayIncludes(array,value){return!!array.length&&baseIndexOf(array,value,0)>-1}function arrayIncludesWith(array,value,comparator){for(var index=-1,length=array.length;++index<length;)if(comparator(value,array[index]))return!0;return!1}function arrayMap(array,iteratee){for(var index=-1,length=array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}function arrayReduce(array,iteratee,accumulator,initAccum){var index=-1,length=array.length;for(initAccum&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}function arrayReduceRight(array,iteratee,accumulator,initAccum){var length=array.length;for(initAccum&&length&&(accumulator=array[--length]);length--;)accumulator=iteratee(accumulator,array[length],length,array);return accumulator}function arraySome(array,predicate){for(var index=-1,length=array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}function baseExtremum(array,iteratee,comparator){for(var index=-1,length=array.length;++index<length;){var value=array[index],current=iteratee(value);if(null!=current&&(computed===undefined?current===current:comparator(current,computed)))var computed=current,result=value}return result}function baseFind(collection,predicate,eachFunc,retKey){var result;return eachFunc(collection,function(value,key,collection){return predicate(value,key,collection)?(result=retKey?key:value,!1):void 0}),result}function baseFindIndex(array,predicate,fromRight){for(var length=array.length,index=fromRight?length:-1;fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}function baseIndexOf(array,value,fromIndex){if(value!==value)return indexOfNaN(array,fromIndex);for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}function baseReduce(collection,iteratee,accumulator,initAccum,eachFunc){return eachFunc(collection,function(value,index,collection){accumulator=initAccum?(initAccum=!1,value):iteratee(accumulator,value,index,collection)}),accumulator}function baseSortBy(array,comparer){var length=array.length;for(array.sort(comparer);length--;)array[length]=array[length].value;return array}function baseSum(array,iteratee){for(var result,index=-1,length=array.length;++index<length;){var current=iteratee(array[index]);current!==undefined&&(result=result===undefined?current:result+current)}return result}function baseTimes(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}function baseToPairs(object,props){return arrayMap(props,function(key){return[key,object[key]]})}function baseUnary(func){return function(value){return func(value)}}function baseValues(object,props){return arrayMap(props,function(key){return object[key]})}function charsStartIndex(strSymbols,chrSymbols){for(var index=-1,length=strSymbols.length;++index<length&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1;);return index}function charsEndIndex(strSymbols,chrSymbols){for(var index=strSymbols.length;index--&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1;);return index}function checkGlobal(value){return value&&value.Object===Object?value:null}function compareAscending(value,other){if(value!==other){var valIsNull=null===value,valIsUndef=value===undefined,valIsReflexive=value===value,othIsNull=null===other,othIsUndef=other===undefined,othIsReflexive=other===other;if(value>other&&!othIsNull||!valIsReflexive||valIsNull&&!othIsUndef&&othIsReflexive||valIsUndef&&othIsReflexive)return 1;if(other>value&&!valIsNull||!othIsReflexive||othIsNull&&!valIsUndef&&valIsReflexive||othIsUndef&&valIsReflexive)return-1}return 0}function compareMultiple(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=compareAscending(objCriteria[index],othCriteria[index]);if(result){if(index>=ordersLength)return result;var order=orders[index];return result*("desc"==order?-1:1)}}return object.index-other.index}function deburrLetter(letter){return deburredLetters[letter]}function escapeHtmlChar(chr){return htmlEscapes[chr]}function escapeStringChar(chr){return"\\"+stringEscapes[chr]}function indexOfNaN(array,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?0:-1);fromRight?index--:++index<length;){var other=array[index];if(other!==other)return index}return-1}function isHostObject(value){var result=!1;if(null!=value&&"function"!=typeof value.toString)try{result=!!(value+"")}catch(e){}return result}function isIndex(value,length){return value="number"==typeof value||reIsUint.test(value)?+value:-1,length=null==length?MAX_SAFE_INTEGER:length,value>-1&&value%1==0&&length>value}function iteratorToArray(iterator){for(var data,result=[];!(data=iterator.next()).done;)result.push(data.value);return result}function mapToArray(map){var index=-1,result=Array(map.size);return map.forEach(function(value,key){result[++index]=[key,value]}),result}function replaceHolders(array,placeholder){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;)array[index]===placeholder&&(array[index]=PLACEHOLDER,result[++resIndex]=index);return result}function setToArray(set){var index=-1,result=Array(set.size);return set.forEach(function(value){result[++index]=value}),result}function stringSize(string){if(!string||!reHasComplexSymbol.test(string))return string.length;for(var result=reComplexSymbol.lastIndex=0;reComplexSymbol.test(string);)result++;return result}function stringToArray(string){return string.match(reComplexSymbol)}function unescapeHtmlChar(chr){return htmlUnescapes[chr]}function runInContext(context){function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper)return value;if(hasOwnProperty.call(value,"__wrapped__"))return wrapperClone(value)}return new LodashWrapper(value)}function baseLodash(){}function LodashWrapper(value,chainAll){this.__wrapped__=value,this.__actions__=[],this.__chain__=!!chainAll,this.__index__=0,this.__values__=undefined}function LazyWrapper(value){this.__wrapped__=value,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=MAX_ARRAY_LENGTH,this.__views__=[]}function lazyClone(){var result=new LazyWrapper(this.__wrapped__);return result.__actions__=copyArray(this.__actions__),result.__dir__=this.__dir__,result.__filtered__=this.__filtered__,result.__iteratees__=copyArray(this.__iteratees__),result.__takeCount__=this.__takeCount__,result.__views__=copyArray(this.__views__),result}function lazyReverse(){if(this.__filtered__){var result=new LazyWrapper(this);result.__dir__=-1,result.__filtered__=!0}else result=this.clone(),result.__dir__*=-1;return result}function lazyValue(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=0>dir,arrLength=isArr?array.length:0,view=getView(0,arrLength,this.__views__),start=view.start,end=view.end,length=end-start,index=isRight?end:start-1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin(length,this.__takeCount__);
if(!isArr||LARGE_ARRAY_SIZE>arrLength||arrLength==length&&takeCount==length)return baseWrapperValue(array,this.__actions__);var result=[];outer:for(;length--&&takeCount>resIndex;){index+=dir;for(var iterIndex=-1,value=array[index];++iterIndex<iterLength;){var data=iteratees[iterIndex],iteratee=data.iteratee,type=data.type,computed=iteratee(value);if(type==LAZY_MAP_FLAG)value=computed;else if(!computed){if(type==LAZY_FILTER_FLAG)continue outer;break outer}}result[resIndex++]=value}return result}function Hash(){}function hashDelete(hash,key){return hashHas(hash,key)&&delete hash[key]}function hashGet(hash,key){if(nativeCreate){var result=hash[key];return result===HASH_UNDEFINED?undefined:result}return hasOwnProperty.call(hash,key)?hash[key]:undefined}function hashHas(hash,key){return nativeCreate?hash[key]!==undefined:hasOwnProperty.call(hash,key)}function hashSet(hash,key,value){hash[key]=nativeCreate&&value===undefined?HASH_UNDEFINED:value}function MapCache(values){var index=-1,length=values?values.length:0;for(this.clear();++index<length;){var entry=values[index];this.set(entry[0],entry[1])}}function mapClear(){this.__data__={hash:new Hash,map:Map?new Map:[],string:new Hash}}function mapDelete(key){var data=this.__data__;return isKeyable(key)?hashDelete("string"==typeof key?data.string:data.hash,key):Map?data.map["delete"](key):assocDelete(data.map,key)}function mapGet(key){var data=this.__data__;return isKeyable(key)?hashGet("string"==typeof key?data.string:data.hash,key):Map?data.map.get(key):assocGet(data.map,key)}function mapHas(key){var data=this.__data__;return isKeyable(key)?hashHas("string"==typeof key?data.string:data.hash,key):Map?data.map.has(key):assocHas(data.map,key)}function mapSet(key,value){var data=this.__data__;return isKeyable(key)?hashSet("string"==typeof key?data.string:data.hash,key,value):Map?data.map.set(key,value):assocSet(data.map,key,value),this}function SetCache(values){var index=-1,length=values?values.length:0;for(this.__data__=new MapCache;++index<length;)this.push(values[index])}function cacheHas(cache,value){var map=cache.__data__;if(isKeyable(value)){var data=map.__data__,hash="string"==typeof value?data.string:data.hash;return hash[value]===HASH_UNDEFINED}return map.has(value)}function cachePush(value){var map=this.__data__;if(isKeyable(value)){var data=map.__data__,hash="string"==typeof value?data.string:data.hash;hash[value]=HASH_UNDEFINED}else map.set(value,HASH_UNDEFINED)}function Stack(values){var index=-1,length=values?values.length:0;for(this.clear();++index<length;){var entry=values[index];this.set(entry[0],entry[1])}}function stackClear(){this.__data__={array:[],map:null}}function stackDelete(key){var data=this.__data__,array=data.array;return array?assocDelete(array,key):data.map["delete"](key)}function stackGet(key){var data=this.__data__,array=data.array;return array?assocGet(array,key):data.map.get(key)}function stackHas(key){var data=this.__data__,array=data.array;return array?assocHas(array,key):data.map.has(key)}function stackSet(key,value){var data=this.__data__,array=data.array;array&&(array.length<LARGE_ARRAY_SIZE-1?assocSet(array,key,value):(data.array=null,data.map=new MapCache(array)));var map=data.map;return map&&map.set(key,value),this}function assocDelete(array,key){var index=assocIndexOf(array,key);if(0>index)return!1;var lastIndex=array.length-1;return index==lastIndex?array.pop():splice.call(array,index,1),!0}function assocGet(array,key){var index=assocIndexOf(array,key);return 0>index?undefined:array[index][1]}function assocHas(array,key){return assocIndexOf(array,key)>-1}function assocIndexOf(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}function assocSet(array,key,value){var index=assocIndexOf(array,key);0>index?array.push([key,value]):array[index][1]=value}function assignInDefaults(objValue,srcValue,key,object){return objValue===undefined||eq(objValue,objectProto[key])&&!hasOwnProperty.call(object,key)?srcValue:objValue}function assignMergeValue(object,key,value){(value!==undefined&&!eq(object[key],value)||"number"==typeof key&&value===undefined&&!(key in object))&&(object[key]=value)}function assignValue(object,key,value){var objValue=object[key];(!eq(objValue,value)||eq(objValue,objectProto[key])&&!hasOwnProperty.call(object,key)||value===undefined&&!(key in object))&&(object[key]=value)}function baseAggregator(collection,setter,iteratee,accumulator){return baseEach(collection,function(value,key,collection){setter(accumulator,value,iteratee(value),collection)}),accumulator}function baseAssign(object,source){return object&&copyObject(source,keys(source),object)}function baseAt(object,paths){for(var index=-1,isNil=null==object,length=paths.length,result=Array(length);++index<length;)result[index]=isNil?undefined:get(object,paths[index]);return result}function baseClamp(number,lower,upper){return number===number&&(upper!==undefined&&(number=upper>=number?number:upper),lower!==undefined&&(number=number>=lower?number:lower)),number}function baseClone(value,isDeep,customizer,key,object,stack){var result;if(customizer&&(result=object?customizer(value,key,object,stack):customizer(value)),result!==undefined)return result;if(!isObject(value))return value;var isArr=isArray(value);if(isArr){if(result=initCloneArray(value),!isDeep)return copyArray(value,result)}else{var tag=getTag(value),isFunc=tag==funcTag||tag==genTag;if(tag!=objectTag&&tag!=argsTag&&(!isFunc||object))return cloneableTags[tag]?initCloneByTag(value,tag,isDeep):object?value:{};if(isHostObject(value))return object?value:{};if(result=initCloneObject(isFunc?{}:value),!isDeep)return copySymbols(value,baseAssign(result,value))}stack||(stack=new Stack);var stacked=stack.get(value);return stacked?stacked:(stack.set(value,result),(isArr?arrayEach:baseForOwn)(value,function(subValue,key){assignValue(result,key,baseClone(subValue,isDeep,customizer,key,value,stack))}),isArr?result:copySymbols(value,result))}function baseConforms(source){var props=keys(source),length=props.length;return function(object){if(null==object)return!length;for(var index=length;index--;){var key=props[index],predicate=source[key],value=object[key];if(value===undefined&&!(key in Object(object))||!predicate(value))return!1}return!0}}function baseDelay(func,wait,args){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return setTimeout(function(){func.apply(undefined,args)},wait)}function baseDifference(array,values,iteratee,comparator){var index=-1,includes=arrayIncludes,isCommon=!0,length=array.length,result=[],valuesLength=values.length;if(!length)return result;iteratee&&(values=arrayMap(values,baseUnary(iteratee))),comparator?(includes=arrayIncludesWith,isCommon=!1):values.length>=LARGE_ARRAY_SIZE&&(includes=cacheHas,isCommon=!1,values=new SetCache(values));outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value):value;if(isCommon&&computed===computed){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===computed)continue outer;result.push(value)}else includes(values,computed,comparator)||result.push(value)}return result}function baseEvery(collection,predicate){var result=!0;return baseEach(collection,function(value,index,collection){return result=!!predicate(value,index,collection)}),result}function baseFill(array,value,start,end){var length=array.length;for(start=toInteger(start),0>start&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:toInteger(end),0>end&&(end+=length),end=start>end?0:toLength(end);end>start;)array[start++]=value;return array}function baseFilter(collection,predicate){var result=[];return baseEach(collection,function(value,index,collection){predicate(value,index,collection)&&result.push(value)}),result}function baseFlatten(array,isDeep,isStrict,result){result||(result=[]);for(var index=-1,length=array.length;++index<length;){var value=array[index];isArrayLikeObject(value)&&(isStrict||isArray(value)||isArguments(value))?isDeep?baseFlatten(value,isDeep,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}function baseForIn(object,iteratee){return null==object?object:baseFor(object,iteratee,keysIn)}function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys)}function baseForOwnRight(object,iteratee){return object&&baseForRight(object,iteratee,keys)}function baseFunctions(object,props){return arrayFilter(props,function(key){return isFunction(object[key])})}function baseGet(object,path){path=isKey(path,object)?[path+""]:baseToPath(path);for(var index=0,length=path.length;null!=object&&length>index;)object=object[path[index++]];return index&&index==length?object:undefined}function baseHas(object,key){return hasOwnProperty.call(object,key)||"object"==typeof object&&key in object&&null===getPrototypeOf(object)}function baseHasIn(object,key){return key in Object(object)}function baseInRange(number,start,end){return number>=nativeMin(start,end)&&number<nativeMax(start,end)}function baseIntersection(arrays,iteratee,comparator){for(var includes=comparator?arrayIncludesWith:arrayIncludes,othLength=arrays.length,othIndex=othLength,caches=Array(othLength),result=[];othIndex--;){var array=arrays[othIndex];othIndex&&iteratee&&(array=arrayMap(array,baseUnary(iteratee))),caches[othIndex]=!comparator&&(iteratee||array.length>=120)?new SetCache(othIndex&&array):undefined}array=arrays[0];var index=-1,length=array.length,seen=caches[0];outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value):value;if(!(seen?cacheHas(seen,computed):includes(result,computed,comparator))){for(var othIndex=othLength;--othIndex;){var cache=caches[othIndex];if(!(cache?cacheHas(cache,computed):includes(arrays[othIndex],computed,comparator)))continue outer}seen&&seen.push(computed),result.push(value)}}return result}function baseInverter(object,setter,iteratee,accumulator){return baseForOwn(object,function(value,key,object){setter(accumulator,iteratee(value),key,object)}),accumulator}function baseInvoke(object,path,args){isKey(path,object)||(path=baseToPath(path),object=parent(object,path),path=last(path));var func=null==object?object:object[path];return null==func?undefined:apply(func,object,args)}function baseIsEqual(value,other,customizer,bitmask,stack){return value===other?!0:null==value||null==other||!isObject(value)&&!isObjectLike(other)?value!==value&&other!==other:baseIsEqualDeep(value,other,baseIsEqual,customizer,bitmask,stack)}function baseIsEqualDeep(object,other,equalFunc,customizer,bitmask,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=arrayTag,othTag=arrayTag;objIsArr||(objTag=getTag(object),objTag==argsTag?objTag=objectTag:objTag!=objectTag&&(objIsArr=isTypedArray(object))),othIsArr||(othTag=getTag(other),othTag==argsTag?othTag=objectTag:othTag!=objectTag&&(othIsArr=isTypedArray(other)));var objIsObj=objTag==objectTag&&!isHostObject(object),othIsObj=othTag==objectTag&&!isHostObject(other),isSameTag=objTag==othTag;if(isSameTag&&!objIsArr&&!objIsObj)return equalByTag(object,other,objTag,equalFunc,customizer,bitmask);var isPartial=bitmask&PARTIAL_COMPARE_FLAG;if(!isPartial){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped)return equalFunc(objIsWrapped?object.value():object,othIsWrapped?other.value():other,customizer,bitmask,stack)}return isSameTag?(stack||(stack=new Stack),(objIsArr?equalArrays:equalObjects)(object,other,equalFunc,customizer,bitmask,stack)):!1}function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object))return!1}else{var stack=new Stack,result=customizer?customizer(objValue,srcValue,key,object,source,stack):undefined;if(!(result===undefined?baseIsEqual(srcValue,objValue,customizer,UNORDERED_COMPARE_FLAG|PARTIAL_COMPARE_FLAG,stack):result))return!1}}return!0}function baseIteratee(value){var type=typeof value;return"function"==type?value:null==value?identity:"object"==type?isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value):property(value)}function baseKeys(object){return nativeKeys(Object(object))}function baseKeysIn(object){object=null==object?object:Object(object);var result=[];for(var key in object)result.push(key);return result}function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)}),result}function baseMatches(source){var matchData=getMatchData(source);if(1==matchData.length&&matchData[0][2]){var key=matchData[0][0],value=matchData[0][1];return function(object){return null==object?!1:object[key]===value&&(value!==undefined||key in Object(object))}}return function(object){return object===source||baseIsMatch(object,source,matchData)}}function baseMatchesProperty(path,srcValue){return function(object){var objValue=get(object,path);return objValue===undefined&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,undefined,UNORDERED_COMPARE_FLAG|PARTIAL_COMPARE_FLAG)}}function baseMerge(object,source,srcIndex,customizer,stack){if(object!==source){var props=isArray(source)||isTypedArray(source)?undefined:keysIn(source);arrayEach(props||source,function(srcValue,key){if(props&&(key=srcValue,srcValue=source[key]),isObject(srcValue))stack||(stack=new Stack),baseMergeDeep(object,source,key,srcIndex,baseMerge,customizer,stack);else{var newValue=customizer?customizer(object[key],srcValue,key+"",object,source,stack):undefined;newValue===undefined&&(newValue=srcValue),assignMergeValue(object,key,newValue)}})}}function baseMergeDeep(object,source,key,srcIndex,mergeFunc,customizer,stack){var objValue=object[key],srcValue=source[key],stacked=stack.get(srcValue);if(stacked)return void assignMergeValue(object,key,stacked);var newValue=customizer?customizer(objValue,srcValue,key+"",object,source,stack):undefined,isCommon=newValue===undefined;isCommon&&(newValue=srcValue,isArray(srcValue)||isTypedArray(srcValue)?isArray(objValue)?newValue=srcIndex?copyArray(objValue):objValue:isArrayLikeObject(objValue)?newValue=copyArray(objValue):(isCommon=!1,newValue=baseClone(srcValue)):isPlainObject(srcValue)||isArguments(srcValue)?isArguments(objValue)?newValue=toPlainObject(objValue):!isObject(objValue)||srcIndex&&isFunction(objValue)?(isCommon=!1,newValue=baseClone(srcValue)):newValue=srcIndex?baseClone(objValue):objValue:isCommon=!1),stack.set(srcValue,newValue),isCommon&&mergeFunc(newValue,srcValue,srcIndex,customizer,stack),assignMergeValue(object,key,newValue)}function baseOrderBy(collection,iteratees,orders){var index=-1,toIteratee=getIteratee();iteratees=arrayMap(iteratees.length?iteratees:Array(1),function(iteratee){return toIteratee(iteratee)});var result=baseMap(collection,function(value){var criteria=arrayMap(iteratees,function(iteratee){return iteratee(value)});return{criteria:criteria,index:++index,value:value}});return baseSortBy(result,function(object,other){return compareMultiple(object,other,orders)})}function basePick(object,props){return object=Object(object),arrayReduce(props,function(result,key){return key in object&&(result[key]=object[key]),result},{})}function basePickBy(object,predicate){var result={};return baseForIn(object,function(value,key){predicate(value,key)&&(result[key]=value)}),result}function baseProperty(key){return function(object){return null==object?undefined:object[key]}}function basePropertyDeep(path){return function(object){return baseGet(object,path)}}function basePullAll(array,values){return basePullAllBy(array,values)}function basePullAllBy(array,values,iteratee){var index=-1,length=values.length,seen=array;for(iteratee&&(seen=arrayMap(array,function(value){return iteratee(value)}));++index<length;)for(var fromIndex=0,value=values[index],computed=iteratee?iteratee(value):value;(fromIndex=baseIndexOf(seen,computed,fromIndex))>-1;)seen!==array&&splice.call(seen,fromIndex,1),splice.call(array,fromIndex,1);return array}function basePullAt(array,indexes){for(var length=array?indexes.length:0,lastIndex=length-1;length--;){var index=indexes[length];if(lastIndex==length||index!=previous){var previous=index;if(isIndex(index))splice.call(array,index,1);else if(isKey(index,array))delete array[index];else{var path=baseToPath(index),object=parent(array,path);null!=object&&delete object[last(path)]}}}return array}function baseRandom(lower,upper){return lower+nativeFloor(nativeRandom()*(upper-lower+1))}function baseRange(start,end,step,fromRight){for(var index=-1,length=nativeMax(nativeCeil((end-start)/(step||1)),0),result=Array(length);length--;)result[fromRight?length:++index]=start,start+=step;return result}function baseSet(object,path,value,customizer){path=isKey(path,object)?[path+""]:baseToPath(path);for(var index=-1,length=path.length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=path[index];if(isObject(nested)){var newValue=value;if(index!=lastIndex){var objValue=nested[key];newValue=customizer?customizer(objValue,key,nested):undefined,newValue===undefined&&(newValue=null==objValue?isIndex(path[index+1])?[]:{}:objValue)}assignValue(nested,key,newValue)}nested=nested[key]}return object}function baseSlice(array,start,end){var index=-1,length=array.length;0>start&&(start=-start>length?0:length+start),end=end>length?length:end,0>end&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}function baseSome(collection,predicate){var result;return baseEach(collection,function(value,index,collection){return result=predicate(value,index,collection),!result}),!!result}function baseSortedIndex(array,value,retHighest){var low=0,high=array?array.length:low;if("number"==typeof value&&value===value&&HALF_MAX_ARRAY_LENGTH>=high){for(;high>low;){var mid=low+high>>>1,computed=array[mid];(retHighest?value>=computed:value>computed)&&null!==computed?low=mid+1:high=mid}return high}return baseSortedIndexBy(array,value,identity,retHighest)}function baseSortedIndexBy(array,value,iteratee,retHighest){value=iteratee(value);for(var low=0,high=array?array.length:0,valIsNaN=value!==value,valIsNull=null===value,valIsUndef=value===undefined;high>low;){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),isDef=computed!==undefined,isReflexive=computed===computed;if(valIsNaN)var setLow=isReflexive||retHighest;else setLow=valIsNull?isReflexive&&isDef&&(retHighest||null!=computed):valIsUndef?isReflexive&&(retHighest||isDef):null==computed?!1:retHighest?value>=computed:value>computed;setLow?low=mid+1:high=mid}return nativeMin(high,MAX_ARRAY_INDEX)}function baseSortedUniq(array){return baseSortedUniqBy(array)}function baseSortedUniqBy(array,iteratee){for(var index=0,length=array.length,value=array[0],computed=iteratee?iteratee(value):value,seen=computed,resIndex=0,result=[value];++index<length;)value=array[index],computed=iteratee?iteratee(value):value,eq(computed,seen)||(seen=computed,result[++resIndex]=value);return result}function baseToPath(value){return isArray(value)?value:stringToPath(value)}function baseUniq(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=!0,result=[],seen=result;if(comparator)isCommon=!1,includes=arrayIncludesWith;else if(length>=LARGE_ARRAY_SIZE){var set=iteratee?null:createSet(array);if(set)return setToArray(set);isCommon=!1,includes=cacheHas,seen=new SetCache}else seen=iteratee?[]:result;outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value):value;if(isCommon&&computed===computed){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else includes(seen,computed,comparator)||(seen!==result&&seen.push(computed),result.push(value))}return result}function baseUnset(object,path){path=isKey(path,object)?[path+""]:baseToPath(path),object=parent(object,path);var key=last(path);return null!=object&&has(object,key)?delete object[key]:!0}function baseWhile(array,predicate,isDrop,fromRight){for(var length=array.length,index=fromRight?length:-1;(fromRight?index--:++index<length)&&predicate(array[index],index,array););return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index)}function baseWrapperValue(value,actions){var result=value;return result instanceof LazyWrapper&&(result=result.value()),arrayReduce(actions,function(result,action){return action.func.apply(action.thisArg,arrayPush([result],action.args))},result)}function baseXor(arrays,iteratee,comparator){for(var index=-1,length=arrays.length;++index<length;)var result=result?arrayPush(baseDifference(result,arrays[index],iteratee,comparator),baseDifference(arrays[index],result,iteratee,comparator)):arrays[index];return result&&result.length?baseUniq(result,iteratee,comparator):[]}function baseZipObject(props,values,assignFunc){for(var index=-1,length=props.length,valsLength=values.length,result={};++index<length;)assignFunc(result,props[index],valsLength>index?values[index]:undefined);return result}function cloneBuffer(buffer){var Ctor=buffer.constructor,result=new Ctor(buffer.byteLength),view=new Uint8Array(result);return view.set(new Uint8Array(buffer)),result}function cloneMap(map){var Ctor=map.constructor;return arrayReduce(mapToArray(map),addMapEntry,new Ctor)}function cloneRegExp(regexp){var Ctor=regexp.constructor,result=new Ctor(regexp.source,reFlags.exec(regexp));return result.lastIndex=regexp.lastIndex,result}function cloneSet(set){var Ctor=set.constructor;return arrayReduce(setToArray(set),addSetEntry,new Ctor)}function cloneSymbol(symbol){return Symbol?Object(symbolValueOf.call(symbol)):{}}function cloneTypedArray(typedArray,isDeep){var buffer=typedArray.buffer,Ctor=typedArray.constructor;return new Ctor(isDeep?cloneBuffer(buffer):buffer,typedArray.byteOffset,typedArray.length)}function composeArgs(args,partials,holders){for(var holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),leftIndex=-1,leftLength=partials.length,result=Array(leftLength+argsLength);++leftIndex<leftLength;)result[leftIndex]=partials[leftIndex];for(;++argsIndex<holdersLength;)result[holders[argsIndex]]=args[argsIndex];for(;argsLength--;)result[leftIndex++]=args[argsIndex++];return result}function composeArgsRight(args,partials,holders){for(var holdersIndex=-1,holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),rightIndex=-1,rightLength=partials.length,result=Array(argsLength+rightLength);++argsIndex<argsLength;)result[argsIndex]=args[argsIndex];for(var offset=argsIndex;++rightIndex<rightLength;)result[offset+rightIndex]=partials[rightIndex];for(;++holdersIndex<holdersLength;)result[offset+holders[holdersIndex]]=args[argsIndex++];return result}function copyArray(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array}function copyObject(source,props,object){return copyObjectWith(source,props,object)}function copyObjectWith(source,props,object,customizer){object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):source[key];assignValue(object,key,newValue)}return object}function copySymbols(source,object){return copyObject(source,getSymbols(source),object)}function createAggregator(setter,initializer){return function(collection,iteratee){var func=isArray(collection)?arrayAggregator:baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,getIteratee(iteratee),accumulator)}}function createAssigner(assigner){return rest(function(object,sources){var index=-1,length=sources.length,customizer=length>1?sources[length-1]:undefined,guard=length>2?sources[2]:undefined;for(customizer="function"==typeof customizer?(length--,customizer):undefined,guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=3>length?undefined:customizer,length=1),object=Object(object);++index<length;){var source=sources[index];source&&assigner(object,source,index,customizer)}return object})}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!isArrayLike(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&iteratee(iterable[index],index,iterable)!==!1;);return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(iteratee(iterable[key],key,iterable)===!1)break}return object}}function createBaseWrapper(func,bitmask,thisArg){function wrapper(){var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(isBind?thisArg:this,arguments)}var isBind=bitmask&BIND_FLAG,Ctor=createCtorWrapper(func);return wrapper}function createCaseFirst(methodName){return function(string){string=toString(string);var strSymbols=reHasComplexSymbol.test(string)?stringToArray(string):undefined,chr=strSymbols?strSymbols[0]:string.charAt(0),trailing=strSymbols?strSymbols.slice(1).join(""):string.slice(1);return chr[methodName]()+trailing}}function createCompounder(callback){return function(string){return arrayReduce(words(deburr(string)),callback,"")}}function createCtorWrapper(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}function createCurryWrapper(func,bitmask,arity){function wrapper(){for(var length=arguments.length,index=length,args=Array(length),fn=this&&this!==root&&this instanceof wrapper?Ctor:func,placeholder=wrapper.placeholder;index--;)args[index]=arguments[index];var holders=3>length&&args[0]!==placeholder&&args[length-1]!==placeholder?[]:replaceHolders(args,placeholder);return length-=holders.length,arity>length?createRecurryWrapper(func,bitmask,createHybridWrapper,placeholder,undefined,args,holders,undefined,undefined,arity-length):apply(fn,this,args)}var Ctor=createCtorWrapper(func);return wrapper}function createFlow(fromRight){return rest(function(funcs){funcs=baseFlatten(funcs);var length=funcs.length,index=length,prereq=LodashWrapper.prototype.thru;for(fromRight&&funcs.reverse();index--;){var func=funcs[index];if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);if(prereq&&!wrapper&&"wrapper"==getFuncName(func))var wrapper=new LodashWrapper([],!0)}for(index=wrapper?index:length;++index<length;){func=funcs[index];var funcName=getFuncName(func),data="wrapper"==funcName?getData(func):undefined;wrapper=data&&isLaziable(data[0])&&data[1]==(ARY_FLAG|CURRY_FLAG|PARTIAL_FLAG|REARG_FLAG)&&!data[4].length&&1==data[9]?wrapper[getFuncName(data[0])].apply(wrapper,data[3]):1==func.length&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func)}return function(){var args=arguments,value=args[0];if(wrapper&&1==args.length&&isArray(value)&&value.length>=LARGE_ARRAY_SIZE)return wrapper.plant(value).value();for(var index=0,result=length?funcs[index].apply(this,args):value;++index<length;)result=funcs[index].call(this,result);return result}})}function createHybridWrapper(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){function wrapper(){for(var length=arguments.length,index=length,args=Array(length);index--;)args[index]=arguments[index];if(partials&&(args=composeArgs(args,partials,holders)),partialsRight&&(args=composeArgsRight(args,partialsRight,holdersRight)),isCurry||isCurryRight){var placeholder=wrapper.placeholder,argsHolders=replaceHolders(args,placeholder);if(length-=argsHolders.length,arity>length)return createRecurryWrapper(func,bitmask,createHybridWrapper,placeholder,thisArg,args,argsHolders,argPos,ary,arity-length)}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;return argPos?args=reorder(args,argPos):isFlip&&args.length>1&&args.reverse(),isAry&&ary<args.length&&(args.length=ary),this&&this!==root&&this instanceof wrapper&&(fn=Ctor||createCtorWrapper(fn)),fn.apply(thisBinding,args)}var isAry=bitmask&ARY_FLAG,isBind=bitmask&BIND_FLAG,isBindKey=bitmask&BIND_KEY_FLAG,isCurry=bitmask&CURRY_FLAG,isCurryRight=bitmask&CURRY_RIGHT_FLAG,isFlip=bitmask&FLIP_FLAG,Ctor=isBindKey?undefined:createCtorWrapper(func);return wrapper}function createInverter(setter,toIteratee){return function(object,iteratee){return baseInverter(object,setter,toIteratee(iteratee),{})}}function createOver(arrayFunc){return rest(function(iteratees){return iteratees=arrayMap(baseFlatten(iteratees),getIteratee()),rest(function(args){var thisArg=this;return arrayFunc(iteratees,function(iteratee){return apply(iteratee,thisArg,args)})})})}function createPadding(string,length,chars){length=toInteger(length);var strLength=stringSize(string);if(!length||strLength>=length)return"";var padLength=length-strLength;chars=chars===undefined?" ":chars+"";var result=repeat(chars,nativeCeil(padLength/stringSize(chars)));return reHasComplexSymbol.test(chars)?stringToArray(result).slice(0,padLength).join(""):result.slice(0,padLength)}function createPartialWrapper(func,bitmask,thisArg,partials){function wrapper(){for(var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength),fn=this&&this!==root&&this instanceof wrapper?Ctor:func;++leftIndex<leftLength;)args[leftIndex]=partials[leftIndex];for(;argsLength--;)args[leftIndex++]=arguments[++argsIndex];return apply(fn,isBind?thisArg:this,args)}var isBind=bitmask&BIND_FLAG,Ctor=createCtorWrapper(func);return wrapper}function createRange(fromRight){return function(start,end,step){return step&&"number"!=typeof step&&isIterateeCall(start,end,step)&&(end=step=undefined),start=toNumber(start),start=start===start?start:0,end===undefined?(end=start,start=0):end=toNumber(end)||0,step=step===undefined?end>start?1:-1:toNumber(step)||0,baseRange(start,end,step,fromRight)}}function createRecurryWrapper(func,bitmask,wrapFunc,placeholder,thisArg,partials,holders,argPos,ary,arity){var isCurry=bitmask&CURRY_FLAG,newArgPos=argPos?copyArray(argPos):undefined,newsHolders=isCurry?holders:undefined,newHoldersRight=isCurry?undefined:holders,newPartials=isCurry?partials:undefined,newPartialsRight=isCurry?undefined:partials;bitmask|=isCurry?PARTIAL_FLAG:PARTIAL_RIGHT_FLAG,bitmask&=~(isCurry?PARTIAL_RIGHT_FLAG:PARTIAL_FLAG),bitmask&CURRY_BOUND_FLAG||(bitmask&=~(BIND_FLAG|BIND_KEY_FLAG));var newData=[func,bitmask,thisArg,newPartials,newsHolders,newPartialsRight,newHoldersRight,newArgPos,ary,arity],result=wrapFunc.apply(undefined,newData);return isLaziable(func)&&setData(result,newData),result.placeholder=placeholder,result}function createRound(methodName){var func=Math[methodName];return function(number,precision){if(number=toNumber(number),precision=toInteger(precision)){var pair=(toString(number)+"e").split("e"),value=func(pair[0]+"e"+(+pair[1]+precision));
return pair=(toString(value)+"e").split("e"),+(pair[0]+"e"+(+pair[1]-precision))}return func(number)}}function createWrapper(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=bitmask&BIND_KEY_FLAG;if(!isBindKey&&"function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);var length=partials?partials.length:0;if(length||(bitmask&=~(PARTIAL_FLAG|PARTIAL_RIGHT_FLAG),partials=holders=undefined),ary=ary===undefined?ary:nativeMax(toInteger(ary),0),arity=arity===undefined?arity:toInteger(arity),length-=holders?holders.length:0,bitmask&PARTIAL_RIGHT_FLAG){var partialsRight=partials,holdersRight=holders;partials=holders=undefined}var data=isBindKey?undefined:getData(func),newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data&&mergeData(newData,data),func=newData[0],bitmask=newData[1],thisArg=newData[2],partials=newData[3],holders=newData[4],arity=newData[9]=null==newData[9]?isBindKey?0:func.length:nativeMax(newData[9]-length,0),!arity&&bitmask&(CURRY_FLAG|CURRY_RIGHT_FLAG)&&(bitmask&=~(CURRY_FLAG|CURRY_RIGHT_FLAG)),bitmask&&bitmask!=BIND_FLAG)result=bitmask==CURRY_FLAG||bitmask==CURRY_RIGHT_FLAG?createCurryWrapper(func,bitmask,arity):bitmask!=PARTIAL_FLAG&&bitmask!=(BIND_FLAG|PARTIAL_FLAG)||holders.length?createHybridWrapper.apply(undefined,newData):createPartialWrapper(func,bitmask,thisArg,partials);else var result=createBaseWrapper(func,bitmask,thisArg);var setter=data?baseSetData:setData;return setter(result,newData)}function equalArrays(array,other,equalFunc,customizer,bitmask,stack){var index=-1,isPartial=bitmask&PARTIAL_COMPARE_FLAG,isUnordered=bitmask&UNORDERED_COMPARE_FLAG,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var stacked=stack.get(array);if(stacked)return stacked==other;var result=!0;for(stack.set(array,other);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(compared!==undefined){if(compared)continue;result=!1;break}if(isUnordered){if(!arraySome(other,function(othValue){return arrValue===othValue||equalFunc(arrValue,othValue,customizer,bitmask,stack)})){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,customizer,bitmask,stack)){result=!1;break}}return stack["delete"](array),result}function equalByTag(object,other,tag,equalFunc,customizer,bitmask){switch(tag){case arrayBufferTag:return object.byteLength==other.byteLength&&equalFunc(new Uint8Array(object),new Uint8Array(other))?!0:!1;case boolTag:case dateTag:return+object==+other;case errorTag:return object.name==other.name&&object.message==other.message;case numberTag:return object!=+object?other!=+other:object==+other;case regexpTag:case stringTag:return object==other+"";case mapTag:var convert=mapToArray;case setTag:var isPartial=bitmask&PARTIAL_COMPARE_FLAG;return convert||(convert=setToArray),(isPartial||object.size==other.size)&&equalFunc(convert(object),convert(other),customizer,bitmask|UNORDERED_COMPARE_FLAG);case symbolTag:return!!Symbol&&symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}function equalObjects(object,other,equalFunc,customizer,bitmask,stack){var isPartial=bitmask&PARTIAL_COMPARE_FLAG,objProps=keys(object),objLength=objProps.length,othProps=keys(other),othLength=othProps.length;if(objLength!=othLength&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:baseHas(other,key)))return!1}var stacked=stack.get(object);if(stacked)return stacked==other;var result=!0;stack.set(object,other);for(var skipCtor=isPartial;++index<objLength;){key=objProps[index];var objValue=object[key],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(compared===undefined?objValue===othValue||equalFunc(objValue,othValue,customizer,bitmask,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor!=othCtor&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor)&&(result=!1)}return stack["delete"](object),result}function getFuncName(func){for(var result=func.name+"",array=realNames[result],length=hasOwnProperty.call(realNames,result)?array.length:0;length--;){var data=array[length],otherFunc=data.func;if(null==otherFunc||otherFunc==func)return data.name}return result}function getIteratee(){var result=lodash.iteratee||iteratee;return result=result===iteratee?baseIteratee:result,arguments.length?result(arguments[0],arguments[1]):result}function getMatchData(object){for(var result=toPairs(object),length=result.length;length--;)result[length][2]=isStrictComparable(result[length][1]);return result}function getNative(object,key){var value=null==object?undefined:object[key];return isNative(value)?value:undefined}function getTag(value){return objectToString.call(value)}function getView(start,end,transforms){for(var index=-1,length=transforms.length;++index<length;){var data=transforms[index],size=data.size;switch(data.type){case"drop":start+=size;break;case"dropRight":end-=size;break;case"take":end=nativeMin(end,start+size);break;case"takeRight":start=nativeMax(start,end-size)}}return{start:start,end:end}}function hasPath(object,path,hasFunc){if(null==object)return!1;var result=hasFunc(object,path);result||isKey(path)||(path=baseToPath(path),object=parent(object,path),null!=object&&(path=last(path),result=hasFunc(object,path)));var length=object?object.length:undefined;return result||!!length&&isLength(length)&&isIndex(path,length)&&(isArray(object)||isString(object)||isArguments(object))}function initCloneArray(array){var length=array.length,result=array.constructor(length);return length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input),result}function initCloneObject(object){if(isPrototype(object))return{};var Ctor=object.constructor;return baseCreate(isFunction(Ctor)?Ctor.prototype:undefined)}function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return cloneBuffer(object);case boolTag:case dateTag:return new Ctor(+object);case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case uint8ClampedTag:case uint16Tag:case uint32Tag:return cloneTypedArray(object,isDeep);case mapTag:return cloneMap(object);case numberTag:case stringTag:return new Ctor(object);case regexpTag:return cloneRegExp(object);case setTag:return cloneSet(object);case symbolTag:return cloneSymbol(object)}}function indexKeys(object){var length=object?object.length:undefined;return isLength(length)&&(isArray(object)||isString(object)||isArguments(object))?baseTimes(length,String):null}function isIterateeCall(value,index,object){if(!isObject(object))return!1;var type=typeof index;return("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object)?eq(object[index],value):!1}function isKey(value,object){return"number"==typeof value?!0:!isArray(value)&&(reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object))}function isKeyable(value){var type=typeof value;return"number"==type||"boolean"==type||"string"==type&&"__proto__"!==value||null==value}function isLaziable(func){var funcName=getFuncName(func),other=lodash[funcName];if("function"!=typeof other||!(funcName in LazyWrapper.prototype))return!1;if(func===other)return!0;var data=getData(other);return!!data&&func===data[0]}function isPrototype(value){var Ctor=value&&value.constructor,proto="function"==typeof Ctor&&Ctor.prototype||objectProto;return value===proto}function isStrictComparable(value){return value===value&&!isObject(value)}function mergeData(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=(BIND_FLAG|BIND_KEY_FLAG|ARY_FLAG)>newBitmask,isCombo=srcBitmask==ARY_FLAG&&bitmask==CURRY_FLAG||srcBitmask==ARY_FLAG&&bitmask==REARG_FLAG&&data[7].length<=source[8]||srcBitmask==(ARY_FLAG|REARG_FLAG)&&source[7].length<=source[8]&&bitmask==CURRY_FLAG;if(!isCommon&&!isCombo)return data;srcBitmask&BIND_FLAG&&(data[2]=source[2],newBitmask|=bitmask&BIND_FLAG?0:CURRY_BOUND_FLAG);var value=source[3];if(value){var partials=data[3];data[3]=partials?composeArgs(partials,value,source[4]):copyArray(value),data[4]=partials?replaceHolders(data[3],PLACEHOLDER):copyArray(source[4])}return value=source[5],value&&(partials=data[5],data[5]=partials?composeArgsRight(partials,value,source[6]):copyArray(value),data[6]=partials?replaceHolders(data[5],PLACEHOLDER):copyArray(source[6])),value=source[7],value&&(data[7]=copyArray(value)),srcBitmask&ARY_FLAG&&(data[8]=null==data[8]?source[8]:nativeMin(data[8],source[8])),null==data[9]&&(data[9]=source[9]),data[0]=source[0],data[1]=newBitmask,data}function mergeDefaults(objValue,srcValue,key,object,source,stack){return isObject(objValue)&&isObject(srcValue)&&(stack.set(srcValue,objValue),baseMerge(objValue,srcValue,undefined,mergeDefaults,stack)),objValue}function parent(object,path){return 1==path.length?object:get(object,baseSlice(path,0,-1))}function reorder(array,indexes){for(var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=copyArray(array);length--;){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:undefined}return array}function stringToPath(string){var result=[];return toString(string).replace(rePropName,function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,"$1"):number||match)}),result}function toArrayLikeObject(value){return isArrayLikeObject(value)?value:[]}function toFunction(value){return"function"==typeof value?value:identity}function wrapperClone(wrapper){if(wrapper instanceof LazyWrapper)return wrapper.clone();var result=new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__);return result.__actions__=copyArray(wrapper.__actions__),result.__index__=wrapper.__index__,result.__values__=wrapper.__values__,result}function chunk(array,size){size=nativeMax(toInteger(size),0);var length=array?array.length:0;if(!length||1>size)return[];for(var index=0,resIndex=-1,result=Array(nativeCeil(length/size));length>index;)result[++resIndex]=baseSlice(array,index,index+=size);return result}function compact(array){for(var index=-1,length=array?array.length:0,resIndex=-1,result=[];++index<length;){var value=array[index];value&&(result[++resIndex]=value)}return result}function drop(array,n,guard){var length=array?array.length:0;return length?(n=guard||n===undefined?1:toInteger(n),baseSlice(array,0>n?0:n,length)):[]}function dropRight(array,n,guard){var length=array?array.length:0;return length?(n=guard||n===undefined?1:toInteger(n),n=length-n,baseSlice(array,0,0>n?0:n)):[]}function dropRightWhile(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),!0,!0):[]}function dropWhile(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),!0):[]}function fill(array,value,start,end){var length=array?array.length:0;return length?(start&&"number"!=typeof start&&isIterateeCall(array,value,start)&&(start=0,end=length),baseFill(array,value,start,end)):[]}function findIndex(array,predicate){return array&&array.length?baseFindIndex(array,getIteratee(predicate,3)):-1}function findLastIndex(array,predicate){return array&&array.length?baseFindIndex(array,getIteratee(predicate,3),!0):-1}function flatten(array){var length=array?array.length:0;return length?baseFlatten(array):[]}function flattenDeep(array){var length=array?array.length:0;return length?baseFlatten(array,!0):[]}function fromPairs(pairs){for(var index=-1,length=pairs?pairs.length:0,result={};++index<length;){var pair=pairs[index];result[pair[0]]=pair[1]}return result}function head(array){return array?array[0]:undefined}function indexOf(array,value,fromIndex){var length=array?array.length:0;return length?(fromIndex=toInteger(fromIndex),0>fromIndex&&(fromIndex=nativeMax(length+fromIndex,0)),baseIndexOf(array,value,fromIndex)):-1}function initial(array){return dropRight(array,1)}function join(array,separator){return array?nativeJoin.call(array,separator):""}function last(array){var length=array?array.length:0;return length?array[length-1]:undefined}function lastIndexOf(array,value,fromIndex){var length=array?array.length:0;if(!length)return-1;var index=length;if(fromIndex!==undefined&&(index=toInteger(fromIndex),index=(0>index?nativeMax(length+index,0):nativeMin(index,length-1))+1),value!==value)return indexOfNaN(array,index,!0);for(;index--;)if(array[index]===value)return index;return-1}function pullAll(array,values){return array&&array.length&&values&&values.length?basePullAll(array,values):array}function pullAllBy(array,values,iteratee){return array&&array.length&&values&&values.length?basePullAllBy(array,values,getIteratee(iteratee)):array}function remove(array,predicate){var result=[];if(!array||!array.length)return result;var index=-1,indexes=[],length=array.length;for(predicate=getIteratee(predicate,3);++index<length;){var value=array[index];predicate(value,index,array)&&(result.push(value),indexes.push(index))}return basePullAt(array,indexes),result}function reverse(array){return array?nativeReverse.call(array):array}function slice(array,start,end){var length=array?array.length:0;return length?(end&&"number"!=typeof end&&isIterateeCall(array,start,end)?(start=0,end=length):(start=null==start?0:toInteger(start),end=end===undefined?length:toInteger(end)),baseSlice(array,start,end)):[]}function sortedIndex(array,value){return baseSortedIndex(array,value)}function sortedIndexBy(array,value,iteratee){return baseSortedIndexBy(array,value,getIteratee(iteratee))}function sortedIndexOf(array,value){var length=array?array.length:0;if(length){var index=baseSortedIndex(array,value);if(length>index&&eq(array[index],value))return index}return-1}function sortedLastIndex(array,value){return baseSortedIndex(array,value,!0)}function sortedLastIndexBy(array,value,iteratee){return baseSortedIndexBy(array,value,getIteratee(iteratee),!0)}function sortedLastIndexOf(array,value){var length=array?array.length:0;if(length){var index=baseSortedIndex(array,value,!0)-1;if(eq(array[index],value))return index}return-1}function sortedUniq(array){return array&&array.length?baseSortedUniq(array):[]}function sortedUniqBy(array,iteratee){return array&&array.length?baseSortedUniqBy(array,getIteratee(iteratee)):[]}function tail(array){return drop(array,1)}function take(array,n,guard){return array&&array.length?(n=guard||n===undefined?1:toInteger(n),baseSlice(array,0,0>n?0:n)):[]}function takeRight(array,n,guard){var length=array?array.length:0;return length?(n=guard||n===undefined?1:toInteger(n),n=length-n,baseSlice(array,0>n?0:n,length)):[]}function takeRightWhile(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),!1,!0):[]}function takeWhile(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3)):[]}function uniq(array){return array&&array.length?baseUniq(array):[]}function uniqBy(array,iteratee){return array&&array.length?baseUniq(array,getIteratee(iteratee)):[]}function uniqWith(array,comparator){return array&&array.length?baseUniq(array,undefined,comparator):[]}function unzip(array){if(!array||!array.length)return[];var length=0;return array=arrayFilter(array,function(group){return isArrayLikeObject(group)?(length=nativeMax(group.length,length),!0):void 0}),baseTimes(length,function(index){return arrayMap(array,baseProperty(index))})}function unzipWith(array,iteratee){if(!array||!array.length)return[];var result=unzip(array);return null==iteratee?result:arrayMap(result,function(group){return apply(iteratee,undefined,group)})}function zipObject(props,values){return baseZipObject(props||[],values||[],assignValue)}function zipObjectDeep(props,values){return baseZipObject(props||[],values||[],baseSet)}function chain(value){var result=lodash(value);return result.__chain__=!0,result}function tap(value,interceptor){return interceptor(value),value}function thru(value,interceptor){return interceptor(value)}function wrapperChain(){return chain(this)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}function wrapperFlatMap(iteratee){return this.map(iteratee).flatten()}function wrapperNext(){this.__values__===undefined&&(this.__values__=toArray(this.value()));var done=this.__index__>=this.__values__.length,value=done?undefined:this.__values__[this.__index__++];return{done:done,value:value}}function wrapperToIterator(){return this}function wrapperPlant(value){for(var result,parent=this;parent instanceof baseLodash;){var clone=wrapperClone(parent);clone.__index__=0,clone.__values__=undefined,result?previous.__wrapped__=clone:result=clone;var previous=clone;parent=parent.__wrapped__}return previous.__wrapped__=value,result}function wrapperReverse(){var value=this.__wrapped__;if(value instanceof LazyWrapper){var wrapped=value;return this.__actions__.length&&(wrapped=new LazyWrapper(this)),wrapped=wrapped.reverse(),wrapped.__actions__.push({func:thru,args:[reverse],thisArg:undefined}),new LodashWrapper(wrapped,this.__chain__)}return this.thru(reverse)}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}function every(collection,predicate,guard){var func=isArray(collection)?arrayEvery:baseEvery;return guard&&isIterateeCall(collection,predicate,guard)&&(predicate=undefined),func(collection,getIteratee(predicate,3))}function filter(collection,predicate){var func=isArray(collection)?arrayFilter:baseFilter;return func(collection,getIteratee(predicate,3))}function find(collection,predicate){if(predicate=getIteratee(predicate,3),isArray(collection)){var index=baseFindIndex(collection,predicate);return index>-1?collection[index]:undefined}return baseFind(collection,predicate,baseEach)}function findLast(collection,predicate){if(predicate=getIteratee(predicate,3),isArray(collection)){var index=baseFindIndex(collection,predicate,!0);return index>-1?collection[index]:undefined}return baseFind(collection,predicate,baseEachRight)}function flatMap(collection,iteratee){return baseFlatten(map(collection,iteratee))}function forEach(collection,iteratee){return"function"==typeof iteratee&&isArray(collection)?arrayEach(collection,iteratee):baseEach(collection,toFunction(iteratee))}function forEachRight(collection,iteratee){return"function"==typeof iteratee&&isArray(collection)?arrayEachRight(collection,iteratee):baseEachRight(collection,toFunction(iteratee))}function includes(collection,value,fromIndex,guard){collection=isArrayLike(collection)?collection:values(collection),fromIndex=fromIndex&&!guard?toInteger(fromIndex):0;var length=collection.length;return 0>fromIndex&&(fromIndex=nativeMax(length+fromIndex,0)),isString(collection)?length>=fromIndex&&collection.indexOf(value,fromIndex)>-1:!!length&&baseIndexOf(collection,value,fromIndex)>-1}function map(collection,iteratee){var func=isArray(collection)?arrayMap:baseMap;return func(collection,getIteratee(iteratee,3))}function orderBy(collection,iteratees,orders,guard){return null==collection?[]:(isArray(iteratees)||(iteratees=null==iteratees?[]:[iteratees]),orders=guard?undefined:orders,isArray(orders)||(orders=null==orders?[]:[orders]),baseOrderBy(collection,iteratees,orders))}function reduce(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduce:baseReduce,initAccum=arguments.length<3;return func(collection,getIteratee(iteratee,4),accumulator,initAccum,baseEach)}function reduceRight(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduceRight:baseReduce,initAccum=arguments.length<3;return func(collection,getIteratee(iteratee,4),accumulator,initAccum,baseEachRight)}function reject(collection,predicate){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=getIteratee(predicate,3),func(collection,function(value,index,collection){return!predicate(value,index,collection)})}function sample(collection){var array=isArrayLike(collection)?collection:values(collection),length=array.length;return length>0?array[baseRandom(0,length-1)]:undefined}function sampleSize(collection,n){var index=-1,result=toArray(collection),length=result.length,lastIndex=length-1;for(n=baseClamp(toInteger(n),0,length);++index<n;){var rand=baseRandom(index,lastIndex),value=result[rand];result[rand]=result[index],result[index]=value}return result.length=n,result}function shuffle(collection){return sampleSize(collection,MAX_ARRAY_LENGTH)}function size(collection){if(null==collection)return 0;if(isArrayLike(collection)){var result=collection.length;return result&&isString(collection)?stringSize(collection):result}return keys(collection).length}function some(collection,predicate,guard){var func=isArray(collection)?arraySome:baseSome;return guard&&isIterateeCall(collection,predicate,guard)&&(predicate=undefined),func(collection,getIteratee(predicate,3))}function after(n,func){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return n=toInteger(n),function(){return--n<1?func.apply(this,arguments):void 0}}function ary(func,n,guard){return n=guard?undefined:n,n=func&&null==n?func.length:n,createWrapper(func,ARY_FLAG,undefined,undefined,undefined,undefined,n)}function before(n,func){var result;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return n=toInteger(n),function(){return--n>0&&(result=func.apply(this,arguments)),1>=n&&(func=undefined),result}}function curry(func,arity,guard){arity=guard?undefined:arity;var result=createWrapper(func,CURRY_FLAG,undefined,undefined,undefined,undefined,undefined,arity);return result.placeholder=curry.placeholder,result}function curryRight(func,arity,guard){arity=guard?undefined:arity;var result=createWrapper(func,CURRY_RIGHT_FLAG,undefined,undefined,undefined,undefined,undefined,arity);return result.placeholder=curryRight.placeholder,result}function debounce(func,wait,options){function cancel(){timeoutId&&clearTimeout(timeoutId),maxTimeoutId&&clearTimeout(maxTimeoutId),lastCalled=0,args=maxTimeoutId=thisArg=timeoutId=trailingCall=undefined}function complete(isCalled,id){id&&clearTimeout(id),maxTimeoutId=timeoutId=trailingCall=undefined,isCalled&&(lastCalled=now(),result=func.apply(thisArg,args),timeoutId||maxTimeoutId||(args=thisArg=undefined))}function delayed(){var remaining=wait-(now()-stamp);0>=remaining||remaining>wait?complete(trailingCall,maxTimeoutId):timeoutId=setTimeout(delayed,remaining)}function flush(){return(timeoutId&&trailingCall||maxTimeoutId&&trailing)&&(result=func.apply(thisArg,args)),cancel(),result}function maxDelayed(){complete(trailing,timeoutId)}function debounced(){if(args=arguments,stamp=now(),thisArg=this,trailingCall=trailing&&(timeoutId||!leading),maxWait===!1)var leadingCall=leading&&!timeoutId;else{maxTimeoutId||leading||(lastCalled=stamp);var remaining=maxWait-(stamp-lastCalled),isCalled=0>=remaining||remaining>maxWait;isCalled?(maxTimeoutId&&(maxTimeoutId=clearTimeout(maxTimeoutId)),lastCalled=stamp,result=func.apply(thisArg,args)):maxTimeoutId||(maxTimeoutId=setTimeout(maxDelayed,remaining))}return isCalled&&timeoutId?timeoutId=clearTimeout(timeoutId):timeoutId||wait===maxWait||(timeoutId=setTimeout(delayed,wait)),leadingCall&&(isCalled=!0,result=func.apply(thisArg,args)),!isCalled||timeoutId||maxTimeoutId||(args=thisArg=undefined),result}var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,leading=!1,maxWait=!1,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return wait=toNumber(wait)||0,isObject(options)&&(leading=!!options.leading,maxWait="maxWait"in options&&nativeMax(toNumber(options.maxWait)||0,wait),trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=cancel,debounced.flush=flush,debounced}function flip(func){return createWrapper(func,FLIP_FLAG)}function memoize(func,resolver){if("function"!=typeof func||resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result),result};return memoized.cache=new memoize.Cache,memoized}function negate(predicate){if("function"!=typeof predicate)throw new TypeError(FUNC_ERROR_TEXT);return function(){return!predicate.apply(this,arguments)}}function once(func){return before(2,func)}function rest(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return start=nativeMax(start===undefined?func.length-1:toInteger(start),0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];switch(start){case 0:return func.call(this,array);case 1:return func.call(this,args[0],array);case 2:return func.call(this,args[0],args[1],array)}var otherArgs=Array(start+1);for(index=-1;++index<start;)otherArgs[index]=args[index];return otherArgs[start]=array,apply(func,this,otherArgs)}}function spread(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return start=start===undefined?0:nativeMax(toInteger(start),0),rest(function(args){var array=args[start],otherArgs=args.slice(0,start);return array&&arrayPush(otherArgs,array),apply(func,this,otherArgs)})}function throttle(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),debounce(func,wait,{leading:leading,maxWait:wait,trailing:trailing})}function unary(func){return ary(func,1)}function wrap(value,wrapper){return wrapper=null==wrapper?identity:wrapper,partial(wrapper,value)}function clone(value){return baseClone(value)}function cloneWith(value,customizer){return baseClone(value,!1,customizer)}function cloneDeep(value){return baseClone(value,!0)}function cloneDeepWith(value,customizer){return baseClone(value,!0,customizer)}function eq(value,other){return value===other||value!==value&&other!==other}function gt(value,other){return value>other}function gte(value,other){return value>=other}function isArguments(value){return isArrayLikeObject(value)&&hasOwnProperty.call(value,"callee")&&(!propertyIsEnumerable.call(value,"callee")||objectToString.call(value)==argsTag)}function isArrayLike(value){return null!=value&&!("function"==typeof value&&isFunction(value))&&isLength(getLength(value))}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}function isBoolean(value){return value===!0||value===!1||isObjectLike(value)&&objectToString.call(value)==boolTag}function isDate(value){return isObjectLike(value)&&objectToString.call(value)==dateTag}function isElement(value){return!!value&&1===value.nodeType&&isObjectLike(value)&&!isPlainObject(value)}function isEmpty(value){if(isArrayLike(value)&&(isArray(value)||isString(value)||isFunction(value.splice)||isArguments(value)))return!value.length;for(var key in value)if(hasOwnProperty.call(value,key))return!1;return!0}function isEqual(value,other){return baseIsEqual(value,other)}function isEqualWith(value,other,customizer){customizer="function"==typeof customizer?customizer:undefined;var result=customizer?customizer(value,other):undefined;return result===undefined?baseIsEqual(value,other,customizer):!!result}function isError(value){return isObjectLike(value)&&"string"==typeof value.message&&objectToString.call(value)==errorTag}function isFinite(value){return"number"==typeof value&&nativeIsFinite(value)}function isFunction(value){var tag=isObject(value)?objectToString.call(value):"";return tag==funcTag||tag==genTag}function isInteger(value){return"number"==typeof value&&value==toInteger(value)}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&MAX_SAFE_INTEGER>=value}function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function isObjectLike(value){return!!value&&"object"==typeof value}function isMatch(object,source){return object===source||baseIsMatch(object,source,getMatchData(source))}function isMatchWith(object,source,customizer){return customizer="function"==typeof customizer?customizer:undefined,baseIsMatch(object,source,getMatchData(source),customizer)}function isNaN(value){return isNumber(value)&&value!=+value}function isNative(value){return null==value?!1:isFunction(value)?reIsNative.test(funcToString.call(value)):isObjectLike(value)&&(isHostObject(value)?reIsNative:reIsHostCtor).test(value)}function isNull(value){return null===value}function isNil(value){return null==value}function isNumber(value){return"number"==typeof value||isObjectLike(value)&&objectToString.call(value)==numberTag}function isPlainObject(value){if(!isObjectLike(value)||objectToString.call(value)!=objectTag||isHostObject(value))return!1;var proto=objectProto;if("function"==typeof value.constructor&&(proto=getPrototypeOf(value)),null===proto)return!0;var Ctor=proto.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor&&funcToString.call(Ctor)==objectCtorString}function isRegExp(value){return isObject(value)&&objectToString.call(value)==regexpTag}function isSafeInteger(value){return isInteger(value)&&value>=-MAX_SAFE_INTEGER&&MAX_SAFE_INTEGER>=value}function isString(value){return"string"==typeof value||!isArray(value)&&isObjectLike(value)&&objectToString.call(value)==stringTag}function isSymbol(value){return"symbol"==typeof value||isObjectLike(value)&&objectToString.call(value)==symbolTag}function isTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objectToString.call(value)]}function isUndefined(value){return value===undefined}function lt(value,other){return other>value}function lte(value,other){return other>=value}function toArray(value){if(!value)return[];if(isArrayLike(value))return isString(value)?stringToArray(value):copyArray(value);if(iteratorSymbol&&value[iteratorSymbol])return iteratorToArray(value[iteratorSymbol]());var tag=getTag(value),func=tag==mapTag?mapToArray:tag==setTag?setToArray:values;return func(value)}function toInteger(value){if(!value)return 0===value?value:0;if(value=toNumber(value),value===INFINITY||value===-INFINITY){var sign=0>value?-1:1;return sign*MAX_INTEGER}var remainder=value%1;return value===value?remainder?value-remainder:value:0}function toLength(value){return value?baseClamp(toInteger(value),0,MAX_ARRAY_LENGTH):0}function toNumber(value){if(isObject(value)){var other=isFunction(value.valueOf)?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=value.replace(reTrim,"");var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NAN:+value}function toPlainObject(value){return copyObject(value,keysIn(value))}function toSafeInteger(value){return baseClamp(toInteger(value),-MAX_SAFE_INTEGER,MAX_SAFE_INTEGER)}function toString(value){if("string"==typeof value)return value;if(null==value)return"";if(isSymbol(value))return Symbol?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-INFINITY?"-0":result}function create(prototype,properties){var result=baseCreate(prototype);return properties?baseAssign(result,properties):result}function findKey(object,predicate){return baseFind(object,getIteratee(predicate,3),baseForOwn,!0)}function findLastKey(object,predicate){return baseFind(object,getIteratee(predicate,3),baseForOwnRight,!0)
}function forIn(object,iteratee){return null==object?object:baseFor(object,toFunction(iteratee),keysIn)}function forInRight(object,iteratee){return null==object?object:baseForRight(object,toFunction(iteratee),keysIn)}function forOwn(object,iteratee){return object&&baseForOwn(object,toFunction(iteratee))}function forOwnRight(object,iteratee){return object&&baseForOwnRight(object,toFunction(iteratee))}function functions(object){return null==object?[]:baseFunctions(object,keys(object))}function functionsIn(object){return null==object?[]:baseFunctions(object,keysIn(object))}function get(object,path,defaultValue){var result=null==object?undefined:baseGet(object,path);return result===undefined?defaultValue:result}function has(object,path){return hasPath(object,path,baseHas)}function hasIn(object,path){return hasPath(object,path,baseHasIn)}function keys(object){var isProto=isPrototype(object);if(!isProto&&!isArrayLike(object))return baseKeys(object);var indexes=indexKeys(object),skipIndexes=!!indexes,result=indexes||[],length=result.length;for(var key in object)!baseHas(object,key)||skipIndexes&&("length"==key||isIndex(key,length))||isProto&&"constructor"==key||result.push(key);return result}function keysIn(object){for(var index=-1,isProto=isPrototype(object),props=baseKeysIn(object),propsLength=props.length,indexes=indexKeys(object),skipIndexes=!!indexes,result=indexes||[],length=result.length;++index<propsLength;){var key=props[index];skipIndexes&&("length"==key||isIndex(key,length))||"constructor"==key&&(isProto||!hasOwnProperty.call(object,key))||result.push(key)}return result}function mapKeys(object,iteratee){var result={};return iteratee=getIteratee(iteratee,3),baseForOwn(object,function(value,key,object){result[iteratee(value,key,object)]=value}),result}function mapValues(object,iteratee){var result={};return iteratee=getIteratee(iteratee,3),baseForOwn(object,function(value,key,object){result[key]=iteratee(value,key,object)}),result}function omitBy(object,predicate){return predicate=getIteratee(predicate,2),basePickBy(object,function(value,key){return!predicate(value,key)})}function pickBy(object,predicate){return null==object?{}:basePickBy(object,getIteratee(predicate,2))}function result(object,path,defaultValue){if(isKey(path,object))result=null==object?undefined:object[path];else{path=baseToPath(path);var result=get(object,path);object=parent(object,path)}return result===undefined&&(result=defaultValue),isFunction(result)?result.call(object):result}function set(object,path,value){return null==object?object:baseSet(object,path,value)}function setWith(object,path,value,customizer){return customizer="function"==typeof customizer?customizer:undefined,null==object?object:baseSet(object,path,value,customizer)}function toPairs(object){return baseToPairs(object,keys(object))}function toPairsIn(object){return baseToPairs(object,keysIn(object))}function transform(object,iteratee,accumulator){var isArr=isArray(object)||isTypedArray(object);if(iteratee=getIteratee(iteratee,4),null==accumulator)if(isArr||isObject(object)){var Ctor=object.constructor;accumulator=isArr?isArray(object)?new Ctor:[]:baseCreate(isFunction(Ctor)?Ctor.prototype:undefined)}else accumulator={};return(isArr?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object)}),accumulator}function unset(object,path){return null==object?!0:baseUnset(object,path)}function values(object){return object?baseValues(object,keys(object)):[]}function valuesIn(object){return null==object?baseValues(object,keysIn(object)):[]}function clamp(number,lower,upper){return upper===undefined&&(upper=lower,lower=undefined),upper!==undefined&&(upper=toNumber(upper),upper=upper===upper?upper:0),lower!==undefined&&(lower=toNumber(lower),lower=lower===lower?lower:0),baseClamp(toNumber(number),lower,upper)}function inRange(number,start,end){return start=toNumber(start)||0,end===undefined?(end=start,start=0):end=toNumber(end)||0,number=toNumber(number),baseInRange(number,start,end)}function random(lower,upper,floating){if(floating&&"boolean"!=typeof floating&&isIterateeCall(lower,upper,floating)&&(upper=floating=undefined),floating===undefined&&("boolean"==typeof upper?(floating=upper,upper=undefined):"boolean"==typeof lower&&(floating=lower,lower=undefined)),lower===undefined&&upper===undefined?(lower=0,upper=1):(lower=toNumber(lower)||0,upper===undefined?(upper=lower,lower=0):upper=toNumber(upper)||0),lower>upper){var temp=lower;lower=upper,upper=temp}if(floating||lower%1||upper%1){var rand=nativeRandom();return nativeMin(lower+rand*(upper-lower+freeParseFloat("1e-"+((rand+"").length-1))),upper)}return baseRandom(lower,upper)}function capitalize(string){return upperFirst(toString(string).toLowerCase())}function deburr(string){return string=toString(string),string&&string.replace(reLatin1,deburrLetter).replace(reComboMark,"")}function endsWith(string,target,position){string=toString(string),target="string"==typeof target?target:target+"";var length=string.length;return position=position===undefined?length:baseClamp(toInteger(position),0,length),position-=target.length,position>=0&&string.indexOf(target,position)==position}function escape(string){return string=toString(string),string&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string}function escapeRegExp(string){return string=toString(string),string&&reHasRegExpChar.test(string)?string.replace(reRegExpChar,"\\$&"):string}function pad(string,length,chars){string=toString(string),length=toInteger(length);var strLength=stringSize(string);if(!length||strLength>=length)return string;var mid=(length-strLength)/2,leftLength=nativeFloor(mid),rightLength=nativeCeil(mid);return createPadding("",leftLength,chars)+string+createPadding("",rightLength,chars)}function padEnd(string,length,chars){return string=toString(string),string+createPadding(string,length,chars)}function padStart(string,length,chars){return string=toString(string),createPadding(string,length,chars)+string}function parseInt(string,radix,guard){return guard||null==radix?radix=0:radix&&(radix=+radix),string=toString(string).replace(reTrim,""),nativeParseInt(string,radix||(reHasHexPrefix.test(string)?16:10))}function repeat(string,n){string=toString(string),n=toInteger(n);var result="";if(!string||1>n||n>MAX_SAFE_INTEGER)return result;do n%2&&(result+=string),n=nativeFloor(n/2),string+=string;while(n);return result}function replace(){var args=arguments,string=toString(args[0]);return args.length<3?string:string.replace(args[1],args[2])}function split(string,separator,limit){return toString(string).split(separator,limit)}function startsWith(string,target,position){return string=toString(string),position=baseClamp(toInteger(position),0,string.length),string.lastIndexOf(target,position)==position}function template(string,options,guard){var settings=lodash.templateSettings;guard&&isIterateeCall(string,options,guard)&&(options=undefined),string=toString(string),options=assignInWith({},options,settings,assignInDefaults);var isEscaping,isEvaluating,imports=assignInWith({},options.imports,settings.imports,assignInDefaults),importsKeys=keys(imports),importsValues=baseValues(imports,importsKeys),index=0,interpolate=options.interpolate||reNoMatch,source="__p += '",reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g"),sourceURL="//# sourceURL="+("sourceURL"in options?options.sourceURL:"lodash.templateSources["+ ++templateCounter+"]")+"\n";string.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue||(interpolateValue=esTemplateValue),source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(isEscaping=!0,source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n";var variable=options.variable;variable||(source="with (obj) {\n"+source+"\n}\n"),source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+(variable||"obj")+") {\n"+(variable?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var result=attempt(function(){return Function(importsKeys,sourceURL+"return "+source).apply(undefined,importsValues)});if(result.source=source,isError(result))throw result;return result}function toLower(value){return toString(value).toLowerCase()}function toUpper(value){return toString(value).toUpperCase()}function trim(string,chars,guard){if(string=toString(string),!string)return string;if(guard||chars===undefined)return string.replace(reTrim,"");if(chars+="",!chars)return string;var strSymbols=stringToArray(string),chrSymbols=stringToArray(chars);return strSymbols.slice(charsStartIndex(strSymbols,chrSymbols),charsEndIndex(strSymbols,chrSymbols)+1).join("")}function trimEnd(string,chars,guard){if(string=toString(string),!string)return string;if(guard||chars===undefined)return string.replace(reTrimEnd,"");if(chars+="",!chars)return string;var strSymbols=stringToArray(string);return strSymbols.slice(0,charsEndIndex(strSymbols,stringToArray(chars))+1).join("")}function trimStart(string,chars,guard){if(string=toString(string),!string)return string;if(guard||chars===undefined)return string.replace(reTrimStart,"");if(chars+="",!chars)return string;var strSymbols=stringToArray(string);return strSymbols.slice(charsStartIndex(strSymbols,stringToArray(chars))).join("")}function truncate(string,options){var length=DEFAULT_TRUNC_LENGTH,omission=DEFAULT_TRUNC_OMISSION;if(isObject(options)){var separator="separator"in options?options.separator:separator;length="length"in options?toInteger(options.length):length,omission="omission"in options?toString(options.omission):omission}string=toString(string);var strLength=string.length;if(reHasComplexSymbol.test(string)){var strSymbols=stringToArray(string);strLength=strSymbols.length}if(length>=strLength)return string;var end=length-stringSize(omission);if(1>end)return omission;var result=strSymbols?strSymbols.slice(0,end).join(""):string.slice(0,end);if(separator===undefined)return result+omission;if(strSymbols&&(end+=result.length-end),isRegExp(separator)){if(string.slice(end).search(separator)){var match,substring=result;for(separator.global||(separator=RegExp(separator.source,toString(reFlags.exec(separator))+"g")),separator.lastIndex=0;match=separator.exec(substring);)var newEnd=match.index;result=result.slice(0,newEnd===undefined?end:newEnd)}}else if(string.indexOf(separator,end)!=end){var index=result.lastIndexOf(separator);index>-1&&(result=result.slice(0,index))}return result+omission}function unescape(string){return string=toString(string),string&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string}function words(string,pattern,guard){return string=toString(string),pattern=guard?undefined:pattern,pattern===undefined&&(pattern=reHasComplexWord.test(string)?reComplexWord:reBasicWord),string.match(pattern)||[]}function cond(pairs){var length=pairs?pairs.length:0,toIteratee=getIteratee();return pairs=length?arrayMap(pairs,function(pair){if("function"!=typeof pair[1])throw new TypeError(FUNC_ERROR_TEXT);return[toIteratee(pair[0]),pair[1]]}):[],rest(function(args){for(var index=-1;++index<length;){var pair=pairs[index];if(apply(pair[0],this,args))return apply(pair[1],this,args)}})}function conforms(source){return baseConforms(baseClone(source,!0))}function constant(value){return function(){return value}}function identity(value){return value}function iteratee(func){return baseIteratee("function"==typeof func?func:baseClone(func,!0))}function matches(source){return baseMatches(baseClone(source,!0))}function matchesProperty(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,!0))}function mixin(object,source,options){var props=keys(source),methodNames=baseFunctions(source,props);null!=options||isObject(source)&&(methodNames.length||!props.length)||(options=source,source=object,object=this,methodNames=baseFunctions(source,keys(source)));var chain=isObject(options)&&"chain"in options?options.chain:!0,isFunc=isFunction(object);return arrayEach(methodNames,function(methodName){var func=source[methodName];object[methodName]=func,isFunc&&(object.prototype[methodName]=function(){var chainAll=this.__chain__;if(chain||chainAll){var result=object(this.__wrapped__),actions=result.__actions__=copyArray(this.__actions__);return actions.push({func:func,args:arguments,thisArg:object}),result.__chain__=chainAll,result}return func.apply(object,arrayPush([this.value()],arguments))})}),object}function noConflict(){return root._===this&&(root._=oldDash),this}function noop(){}function nthArg(n){return n=toInteger(n),function(){return arguments[n]}}function property(path){return isKey(path)?baseProperty(path):basePropertyDeep(path)}function propertyOf(object){return function(path){return null==object?undefined:baseGet(object,path)}}function times(n,iteratee){if(n=toInteger(n),1>n||n>MAX_SAFE_INTEGER)return[];var index=MAX_ARRAY_LENGTH,length=nativeMin(n,MAX_ARRAY_LENGTH);iteratee=toFunction(iteratee),n-=MAX_ARRAY_LENGTH;for(var result=baseTimes(length,iteratee);++index<n;)iteratee(index);return result}function toPath(value){return isArray(value)?arrayMap(value,String):stringToPath(value)}function uniqueId(prefix){var id=++idCounter;return toString(prefix)+id}function add(augend,addend){var result;return augend!==undefined&&(result=augend),addend!==undefined&&(result=result===undefined?addend:result+addend),result}function max(array){return array&&array.length?baseExtremum(array,identity,gt):undefined}function maxBy(array,iteratee){return array&&array.length?baseExtremum(array,getIteratee(iteratee),gt):undefined}function mean(array){return sum(array)/(array?array.length:0)}function min(array){return array&&array.length?baseExtremum(array,identity,lt):undefined}function minBy(array,iteratee){return array&&array.length?baseExtremum(array,getIteratee(iteratee),lt):undefined}function subtract(minuend,subtrahend){var result;return minuend!==undefined&&(result=minuend),subtrahend!==undefined&&(result=result===undefined?subtrahend:result-subtrahend),result}function sum(array){return array&&array.length?baseSum(array,identity):0}function sumBy(array,iteratee){return array&&array.length?baseSum(array,getIteratee(iteratee)):0}context=context?_.defaults({},context,_.pick(root,contextProps)):root;var Date=context.Date,Error=context.Error,Math=context.Math,RegExp=context.RegExp,TypeError=context.TypeError,arrayProto=context.Array.prototype,objectProto=context.Object.prototype,funcToString=context.Function.prototype.toString,hasOwnProperty=objectProto.hasOwnProperty,idCounter=0,objectCtorString=funcToString.call(Object),objectToString=objectProto.toString,oldDash=root._,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Reflect=context.Reflect,Symbol=context.Symbol,Uint8Array=context.Uint8Array,clearTimeout=context.clearTimeout,enumerate=Reflect?Reflect.enumerate:undefined,getPrototypeOf=Object.getPrototypeOf,getOwnPropertySymbols=Object.getOwnPropertySymbols,iteratorSymbol="symbol"==typeof(iteratorSymbol=Symbol&&Symbol.iterator)?iteratorSymbol:undefined,propertyIsEnumerable=objectProto.propertyIsEnumerable,setTimeout=context.setTimeout,splice=arrayProto.splice,nativeCeil=Math.ceil,nativeFloor=Math.floor,nativeIsFinite=context.isFinite,nativeJoin=arrayProto.join,nativeKeys=Object.keys,nativeMax=Math.max,nativeMin=Math.min,nativeParseInt=context.parseInt,nativeRandom=Math.random,nativeReverse=arrayProto.reverse,Map=getNative(context,"Map"),Set=getNative(context,"Set"),WeakMap=getNative(context,"WeakMap"),nativeCreate=getNative(Object,"create"),metaMap=WeakMap&&new WeakMap,mapCtorString=Map?funcToString.call(Map):"",setCtorString=Set?funcToString.call(Set):"",symbolProto=Symbol?Symbol.prototype:undefined,symbolValueOf=Symbol?symbolProto.valueOf:undefined,symbolToString=Symbol?symbolProto.toString:undefined,realNames={};lodash.templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:lodash}};var baseCreate=function(){function object(){}return function(prototype){if(isObject(prototype)){object.prototype=prototype;var result=new object;object.prototype=undefined}return result||{}}}(),baseEach=createBaseEach(baseForOwn),baseEachRight=createBaseEach(baseForOwnRight,!0),baseFor=createBaseFor(),baseForRight=createBaseFor(!0);enumerate&&!propertyIsEnumerable.call({valueOf:1},"valueOf")&&(baseKeysIn=function(object){return iteratorToArray(enumerate(object))});var baseSetData=metaMap?function(func,data){return metaMap.set(func,data),func}:identity,createSet=Set&&2===new Set([1,2]).size?function(values){return new Set(values)}:noop,getData=metaMap?function(func){return metaMap.get(func)}:noop,getLength=baseProperty("length"),getSymbols=getOwnPropertySymbols||function(){return[]};(Map&&getTag(new Map)!=mapTag||Set&&getTag(new Set)!=setTag)&&(getTag=function(value){var result=objectToString.call(value),Ctor=result==objectTag?value.constructor:null,ctorString="function"==typeof Ctor?funcToString.call(Ctor):"";if(ctorString){if(ctorString==mapCtorString)return mapTag;if(ctorString==setCtorString)return setTag}return result});var setData=function(){var count=0,lastCalled=0;return function(key,value){var stamp=now(),remaining=HOT_SPAN-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=HOT_COUNT)return key}else count=0;return baseSetData(key,value)}}(),concat=rest(function(array,values){return isArray(array)||(array=null==array?[]:[Object(array)]),values=baseFlatten(values),arrayConcat(array,values)}),difference=rest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,!1,!0)):[]}),differenceBy=rest(function(array,values){var iteratee=last(values);return isArrayLikeObject(iteratee)&&(iteratee=undefined),isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,!1,!0),getIteratee(iteratee)):[]}),differenceWith=rest(function(array,values){var comparator=last(values);return isArrayLikeObject(comparator)&&(comparator=undefined),isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,!1,!0),undefined,comparator):[]}),intersection=rest(function(arrays){var mapped=arrayMap(arrays,toArrayLikeObject);return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped):[]}),intersectionBy=rest(function(arrays){var iteratee=last(arrays),mapped=arrayMap(arrays,toArrayLikeObject);return iteratee===last(mapped)?iteratee=undefined:mapped.pop(),mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,getIteratee(iteratee)):[]}),intersectionWith=rest(function(arrays){var comparator=last(arrays),mapped=arrayMap(arrays,toArrayLikeObject);return comparator===last(mapped)?comparator=undefined:mapped.pop(),mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,undefined,comparator):[]}),pull=rest(pullAll),pullAt=rest(function(array,indexes){indexes=arrayMap(baseFlatten(indexes),String);var result=baseAt(array,indexes);return basePullAt(array,indexes.sort(compareAscending)),result}),union=rest(function(arrays){return baseUniq(baseFlatten(arrays,!1,!0))}),unionBy=rest(function(arrays){var iteratee=last(arrays);return isArrayLikeObject(iteratee)&&(iteratee=undefined),baseUniq(baseFlatten(arrays,!1,!0),getIteratee(iteratee))}),unionWith=rest(function(arrays){var comparator=last(arrays);return isArrayLikeObject(comparator)&&(comparator=undefined),baseUniq(baseFlatten(arrays,!1,!0),undefined,comparator)}),without=rest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,values):[]}),xor=rest(function(arrays){return baseXor(arrayFilter(arrays,isArrayLikeObject))}),xorBy=rest(function(arrays){var iteratee=last(arrays);return isArrayLikeObject(iteratee)&&(iteratee=undefined),baseXor(arrayFilter(arrays,isArrayLikeObject),getIteratee(iteratee))}),xorWith=rest(function(arrays){var comparator=last(arrays);return isArrayLikeObject(comparator)&&(comparator=undefined),baseXor(arrayFilter(arrays,isArrayLikeObject),undefined,comparator)}),zip=rest(unzip),zipWith=rest(function(arrays){var length=arrays.length,iteratee=length>1?arrays[length-1]:undefined;return iteratee="function"==typeof iteratee?(arrays.pop(),iteratee):undefined,unzipWith(arrays,iteratee)}),wrapperAt=rest(function(paths){paths=baseFlatten(paths);var length=paths.length,start=length?paths[0]:0,value=this.__wrapped__,interceptor=function(object){return baseAt(object,paths)};return!(length>1||this.__actions__.length)&&value instanceof LazyWrapper&&isIndex(start)?(value=value.slice(start,+start+(length?1:0)),value.__actions__.push({func:thru,args:[interceptor],thisArg:undefined}),new LodashWrapper(value,this.__chain__).thru(function(array){return length&&!array.length&&array.push(undefined),array})):this.thru(interceptor)}),countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?++result[key]:result[key]=1}),groupBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):result[key]=[value]}),invokeMap=rest(function(collection,path,args){var index=-1,isFunc="function"==typeof path,isProp=isKey(path),result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value){var func=isFunc?path:isProp&&null!=value?value[path]:undefined;result[++index]=func?apply(func,value,args):baseInvoke(value,path,args)}),result}),keyBy=createAggregator(function(result,value,key){result[key]=value}),partition=createAggregator(function(result,value,key){result[key?0:1].push(value)},function(){return[[],[]]}),sortBy=rest(function(collection,iteratees){if(null==collection)return[];var length=iteratees.length;return length>1&&isIterateeCall(collection,iteratees[0],iteratees[1])?iteratees=[]:length>2&&isIterateeCall(iteratees[0],iteratees[1],iteratees[2])&&(iteratees.length=1),baseOrderBy(collection,baseFlatten(iteratees),[])}),now=Date.now,bind=rest(function(func,thisArg,partials){var bitmask=BIND_FLAG;if(partials.length){var holders=replaceHolders(partials,bind.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(func,bitmask,thisArg,partials,holders)}),bindKey=rest(function(object,key,partials){var bitmask=BIND_FLAG|BIND_KEY_FLAG;if(partials.length){var holders=replaceHolders(partials,bindKey.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(key,bitmask,object,partials,holders)}),defer=rest(function(func,args){return baseDelay(func,1,args)}),delay=rest(function(func,wait,args){return baseDelay(func,toNumber(wait)||0,args)}),overArgs=rest(function(func,transforms){transforms=arrayMap(baseFlatten(transforms),getIteratee());var funcsLength=transforms.length;return rest(function(args){for(var index=-1,length=nativeMin(args.length,funcsLength);++index<length;)args[index]=transforms[index].call(this,args[index]);return apply(func,this,args)})}),partial=rest(function(func,partials){var holders=replaceHolders(partials,partial.placeholder);return createWrapper(func,PARTIAL_FLAG,undefined,partials,holders)}),partialRight=rest(function(func,partials){var holders=replaceHolders(partials,partialRight.placeholder);return createWrapper(func,PARTIAL_RIGHT_FLAG,undefined,partials,holders)}),rearg=rest(function(func,indexes){return createWrapper(func,REARG_FLAG,undefined,undefined,undefined,baseFlatten(indexes))}),isArray=Array.isArray,assign=createAssigner(function(object,source){copyObject(source,keys(source),object)}),assignIn=createAssigner(function(object,source){copyObject(source,keysIn(source),object)}),assignInWith=createAssigner(function(object,source,srcIndex,customizer){copyObjectWith(source,keysIn(source),object,customizer)}),assignWith=createAssigner(function(object,source,srcIndex,customizer){copyObjectWith(source,keys(source),object,customizer)}),at=rest(function(object,paths){return baseAt(object,baseFlatten(paths))}),defaults=rest(function(args){return args.push(undefined,assignInDefaults),apply(assignInWith,undefined,args)}),defaultsDeep=rest(function(args){return args.push(undefined,mergeDefaults),apply(mergeWith,undefined,args)}),invert=createInverter(function(result,value,key){result[value]=key},constant(identity)),invertBy=createInverter(function(result,value,key){hasOwnProperty.call(result,value)?result[value].push(key):result[value]=[key]},getIteratee),invoke=rest(baseInvoke),merge=createAssigner(function(object,source,srcIndex){baseMerge(object,source,srcIndex)}),mergeWith=createAssigner(function(object,source,srcIndex,customizer){baseMerge(object,source,srcIndex,customizer)}),omit=rest(function(object,props){return null==object?{}:(props=arrayMap(baseFlatten(props),String),basePick(object,baseDifference(keysIn(object),props)))}),pick=rest(function(object,props){return null==object?{}:basePick(object,baseFlatten(props))}),camelCase=createCompounder(function(result,word,index){return word=word.toLowerCase(),result+(index?capitalize(word):word)}),kebabCase=createCompounder(function(result,word,index){return result+(index?"-":"")+word.toLowerCase()}),lowerCase=createCompounder(function(result,word,index){return result+(index?" ":"")+word.toLowerCase()}),lowerFirst=createCaseFirst("toLowerCase"),upperFirst=createCaseFirst("toUpperCase"),snakeCase=createCompounder(function(result,word,index){return result+(index?"_":"")+word.toLowerCase()}),startCase=createCompounder(function(result,word,index){return result+(index?" ":"")+capitalize(word)}),upperCase=createCompounder(function(result,word,index){return result+(index?" ":"")+word.toUpperCase()}),attempt=rest(function(func,args){try{return apply(func,undefined,args)}catch(e){return isObject(e)?e:new Error(e)}}),bindAll=rest(function(object,methodNames){return arrayEach(baseFlatten(methodNames),function(key){object[key]=bind(object[key],object)}),object}),flow=createFlow(),flowRight=createFlow(!0),method=rest(function(path,args){return function(object){return baseInvoke(object,path,args)}}),methodOf=rest(function(object,args){return function(path){return baseInvoke(object,path,args)}}),over=createOver(arrayMap),overEvery=createOver(arrayEvery),overSome=createOver(arraySome),range=createRange(),rangeRight=createRange(!0),ceil=createRound("ceil"),floor=createRound("floor"),round=createRound("round");return lodash.prototype=baseLodash.prototype,LodashWrapper.prototype=baseCreate(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper,LazyWrapper.prototype=baseCreate(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper,Hash.prototype=nativeCreate?nativeCreate(null):objectProto,MapCache.prototype.clear=mapClear,MapCache.prototype["delete"]=mapDelete,MapCache.prototype.get=mapGet,MapCache.prototype.has=mapHas,MapCache.prototype.set=mapSet,SetCache.prototype.push=cachePush,Stack.prototype.clear=stackClear,Stack.prototype["delete"]=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet,memoize.Cache=MapCache,lodash.after=after,lodash.ary=ary,lodash.assign=assign,lodash.assignIn=assignIn,lodash.assignInWith=assignInWith,lodash.assignWith=assignWith,lodash.at=at,lodash.before=before,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.chain=chain,lodash.chunk=chunk,lodash.compact=compact,lodash.concat=concat,lodash.cond=cond,lodash.conforms=conforms,lodash.constant=constant,lodash.countBy=countBy,lodash.create=create,lodash.curry=curry,lodash.curryRight=curryRight,lodash.debounce=debounce,lodash.defaults=defaults,lodash.defaultsDeep=defaultsDeep,lodash.defer=defer,lodash.delay=delay,lodash.difference=difference,lodash.differenceBy=differenceBy,lodash.differenceWith=differenceWith,lodash.drop=drop,lodash.dropRight=dropRight,lodash.dropRightWhile=dropRightWhile,lodash.dropWhile=dropWhile,lodash.fill=fill,lodash.filter=filter,lodash.flatMap=flatMap,lodash.flatten=flatten,lodash.flattenDeep=flattenDeep,lodash.flip=flip,lodash.flow=flow,lodash.flowRight=flowRight,lodash.fromPairs=fromPairs,lodash.functions=functions,lodash.functionsIn=functionsIn,lodash.groupBy=groupBy,lodash.initial=initial,lodash.intersection=intersection,lodash.intersectionBy=intersectionBy,lodash.intersectionWith=intersectionWith,lodash.invert=invert,lodash.invertBy=invertBy,lodash.invokeMap=invokeMap,lodash.iteratee=iteratee,lodash.keyBy=keyBy,lodash.keys=keys,lodash.keysIn=keysIn,lodash.map=map,lodash.mapKeys=mapKeys,lodash.mapValues=mapValues,lodash.matches=matches,lodash.matchesProperty=matchesProperty,lodash.memoize=memoize,lodash.merge=merge,lodash.mergeWith=mergeWith,lodash.method=method,lodash.methodOf=methodOf,lodash.mixin=mixin,lodash.negate=negate,lodash.nthArg=nthArg,lodash.omit=omit,lodash.omitBy=omitBy,lodash.once=once,lodash.orderBy=orderBy,lodash.over=over,lodash.overArgs=overArgs,lodash.overEvery=overEvery,lodash.overSome=overSome,lodash.partial=partial,lodash.partialRight=partialRight,lodash.partition=partition,lodash.pick=pick,lodash.pickBy=pickBy,lodash.property=property,lodash.propertyOf=propertyOf,lodash.pull=pull,lodash.pullAll=pullAll,lodash.pullAllBy=pullAllBy,lodash.pullAt=pullAt,lodash.range=range,lodash.rangeRight=rangeRight,lodash.rearg=rearg,lodash.reject=reject,lodash.remove=remove,lodash.rest=rest,lodash.reverse=reverse,lodash.sampleSize=sampleSize,lodash.set=set,lodash.setWith=setWith,lodash.shuffle=shuffle,lodash.slice=slice,lodash.sortBy=sortBy,lodash.sortedUniq=sortedUniq,lodash.sortedUniqBy=sortedUniqBy,lodash.split=split,lodash.spread=spread,lodash.tail=tail,lodash.take=take,lodash.takeRight=takeRight,lodash.takeRightWhile=takeRightWhile,lodash.takeWhile=takeWhile,lodash.tap=tap,lodash.throttle=throttle,lodash.thru=thru,lodash.toArray=toArray,lodash.toPairs=toPairs,lodash.toPairsIn=toPairsIn,lodash.toPath=toPath,lodash.toPlainObject=toPlainObject,lodash.transform=transform,lodash.unary=unary,lodash.union=union,lodash.unionBy=unionBy,lodash.unionWith=unionWith,lodash.uniq=uniq,lodash.uniqBy=uniqBy,lodash.uniqWith=uniqWith,lodash.unset=unset,lodash.unzip=unzip,lodash.unzipWith=unzipWith,lodash.values=values,lodash.valuesIn=valuesIn,lodash.without=without,lodash.words=words,lodash.wrap=wrap,lodash.xor=xor,lodash.xorBy=xorBy,lodash.xorWith=xorWith,lodash.zip=zip,lodash.zipObject=zipObject,lodash.zipObjectDeep=zipObjectDeep,lodash.zipWith=zipWith,lodash.extend=assignIn,lodash.extendWith=assignInWith,mixin(lodash,lodash),lodash.add=add,lodash.attempt=attempt,lodash.camelCase=camelCase,lodash.capitalize=capitalize,lodash.ceil=ceil,lodash.clamp=clamp,lodash.clone=clone,lodash.cloneDeep=cloneDeep,lodash.cloneDeepWith=cloneDeepWith,lodash.cloneWith=cloneWith,lodash.deburr=deburr,lodash.endsWith=endsWith,lodash.eq=eq,lodash.escape=escape,lodash.escapeRegExp=escapeRegExp,lodash.every=every,lodash.find=find,lodash.findIndex=findIndex,lodash.findKey=findKey,lodash.findLast=findLast,lodash.findLastIndex=findLastIndex,lodash.findLastKey=findLastKey,lodash.floor=floor,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=forIn,lodash.forInRight=forInRight,lodash.forOwn=forOwn,lodash.forOwnRight=forOwnRight,lodash.get=get,lodash.gt=gt,lodash.gte=gte,lodash.has=has,lodash.hasIn=hasIn,lodash.head=head,lodash.identity=identity,lodash.includes=includes,lodash.indexOf=indexOf,lodash.inRange=inRange,lodash.invoke=invoke,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isArrayLike=isArrayLike,lodash.isArrayLikeObject=isArrayLikeObject,lodash.isBoolean=isBoolean,lodash.isDate=isDate,lodash.isElement=isElement,lodash.isEmpty=isEmpty,lodash.isEqual=isEqual,lodash.isEqualWith=isEqualWith,lodash.isError=isError,lodash.isFinite=isFinite,lodash.isFunction=isFunction,lodash.isInteger=isInteger,lodash.isLength=isLength,lodash.isMatch=isMatch,lodash.isMatchWith=isMatchWith,lodash.isNaN=isNaN,lodash.isNative=isNative,lodash.isNil=isNil,lodash.isNull=isNull,lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isObjectLike=isObjectLike,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isSafeInteger=isSafeInteger,lodash.isString=isString,lodash.isSymbol=isSymbol,lodash.isTypedArray=isTypedArray,lodash.isUndefined=isUndefined,lodash.join=join,lodash.kebabCase=kebabCase,lodash.last=last,lodash.lastIndexOf=lastIndexOf,lodash.lowerCase=lowerCase,lodash.lowerFirst=lowerFirst,lodash.lt=lt,lodash.lte=lte,lodash.max=max,lodash.maxBy=maxBy,lodash.mean=mean,lodash.min=min,lodash.minBy=minBy,lodash.noConflict=noConflict,lodash.noop=noop,lodash.now=now,lodash.pad=pad,lodash.padEnd=padEnd,lodash.padStart=padStart,lodash.parseInt=parseInt,lodash.random=random,lodash.reduce=reduce,lodash.reduceRight=reduceRight,lodash.repeat=repeat,lodash.replace=replace,lodash.result=result,lodash.round=round,lodash.runInContext=runInContext,lodash.sample=sample,lodash.size=size,lodash.snakeCase=snakeCase,lodash.some=some,lodash.sortedIndex=sortedIndex,lodash.sortedIndexBy=sortedIndexBy,lodash.sortedIndexOf=sortedIndexOf,lodash.sortedLastIndex=sortedLastIndex,lodash.sortedLastIndexBy=sortedLastIndexBy,lodash.sortedLastIndexOf=sortedLastIndexOf,lodash.startCase=startCase,lodash.startsWith=startsWith,lodash.subtract=subtract,lodash.sum=sum,lodash.sumBy=sumBy,lodash.template=template,lodash.times=times,lodash.toInteger=toInteger,lodash.toLength=toLength,lodash.toLower=toLower,lodash.toNumber=toNumber,lodash.toSafeInteger=toSafeInteger,lodash.toString=toString,lodash.toUpper=toUpper,lodash.trim=trim,lodash.trimEnd=trimEnd,lodash.trimStart=trimStart,lodash.truncate=truncate,lodash.unescape=unescape,lodash.uniqueId=uniqueId,lodash.upperCase=upperCase,lodash.upperFirst=upperFirst,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.first=head,mixin(lodash,function(){var source={};
return baseForOwn(lodash,function(func,methodName){hasOwnProperty.call(lodash.prototype,methodName)||(source[methodName]=func)}),source}(),{chain:!1}),lodash.VERSION=VERSION,arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(methodName){lodash[methodName].placeholder=lodash}),arrayEach(["drop","take"],function(methodName,index){LazyWrapper.prototype[methodName]=function(n){var filtered=this.__filtered__;if(filtered&&!index)return new LazyWrapper(this);n=n===undefined?1:nativeMax(toInteger(n),0);var result=this.clone();return filtered?result.__takeCount__=nativeMin(n,result.__takeCount__):result.__views__.push({size:nativeMin(n,MAX_ARRAY_LENGTH),type:methodName+(result.__dir__<0?"Right":"")}),result},LazyWrapper.prototype[methodName+"Right"]=function(n){return this.reverse()[methodName](n).reverse()}}),arrayEach(["filter","map","takeWhile"],function(methodName,index){var type=index+1,isFilter=type==LAZY_FILTER_FLAG||type==LAZY_WHILE_FLAG;LazyWrapper.prototype[methodName]=function(iteratee){var result=this.clone();return result.__iteratees__.push({iteratee:getIteratee(iteratee,3),type:type}),result.__filtered__=result.__filtered__||isFilter,result}}),arrayEach(["head","last"],function(methodName,index){var takeName="take"+(index?"Right":"");LazyWrapper.prototype[methodName]=function(){return this[takeName](1).value()[0]}}),arrayEach(["initial","tail"],function(methodName,index){var dropName="drop"+(index?"":"Right");LazyWrapper.prototype[methodName]=function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1)}}),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.find=function(predicate){return this.filter(predicate).head()},LazyWrapper.prototype.findLast=function(predicate){return this.reverse().find(predicate)},LazyWrapper.prototype.invokeMap=rest(function(path,args){return"function"==typeof path?new LazyWrapper(this):this.map(function(value){return baseInvoke(value,path,args)})}),LazyWrapper.prototype.reject=function(predicate){return predicate=getIteratee(predicate,3),this.filter(function(value){return!predicate(value)})},LazyWrapper.prototype.slice=function(start,end){start=toInteger(start);var result=this;return result.__filtered__&&(start>0||0>end)?new LazyWrapper(result):(0>start?result=result.takeRight(-start):start&&(result=result.drop(start)),end!==undefined&&(end=toInteger(end),result=0>end?result.dropRight(-end):result.take(end-start)),result)},LazyWrapper.prototype.takeRightWhile=function(predicate){return this.reverse().takeWhile(predicate).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(MAX_ARRAY_LENGTH)},baseForOwn(LazyWrapper.prototype,function(func,methodName){var checkIteratee=/^(?:filter|find|map|reject)|While$/.test(methodName),isTaker=/^(?:head|last)$/.test(methodName),lodashFunc=lodash[isTaker?"take"+("last"==methodName?"Right":""):methodName],retUnwrapped=isTaker||/^find/.test(methodName);lodashFunc&&(lodash.prototype[methodName]=function(){var value=this.__wrapped__,args=isTaker?[1]:arguments,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy||isArray(value),interceptor=function(value){var result=lodashFunc.apply(lodash,arrayPush([value],args));return isTaker&&chainAll?result[0]:result};useLazy&&checkIteratee&&"function"==typeof iteratee&&1!=iteratee.length&&(isLazy=useLazy=!1);var chainAll=this.__chain__,isHybrid=!!this.__actions__.length,isUnwrapped=retUnwrapped&&!chainAll,onlyLazy=isLazy&&!isHybrid;if(!retUnwrapped&&useLazy){value=onlyLazy?value:new LazyWrapper(this);var result=func.apply(value,args);return result.__actions__.push({func:thru,args:[interceptor],thisArg:undefined}),new LodashWrapper(result,chainAll)}return isUnwrapped&&onlyLazy?func.apply(this,args):(result=this.thru(interceptor),isUnwrapped?isTaker?result.value()[0]:result.value():result)})}),arrayEach(["pop","push","shift","sort","splice","unshift"],function(methodName){var func=arrayProto[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?"tap":"thru",retUnwrapped=/^(?:pop|shift)$/.test(methodName);lodash.prototype[methodName]=function(){var args=arguments;return retUnwrapped&&!this.__chain__?func.apply(this.value(),args):this[chainName](function(value){return func.apply(value,args)})}}),baseForOwn(LazyWrapper.prototype,function(func,methodName){var lodashFunc=lodash[methodName];if(lodashFunc){var key=lodashFunc.name+"",names=realNames[key]||(realNames[key]=[]);names.push({name:methodName,func:lodashFunc})}}),realNames[createHybridWrapper(undefined,BIND_KEY_FLAG).name]=[{name:"wrapper",func:undefined}],LazyWrapper.prototype.clone=lazyClone,LazyWrapper.prototype.reverse=lazyReverse,LazyWrapper.prototype.value=lazyValue,lodash.prototype.at=wrapperAt,lodash.prototype.chain=wrapperChain,lodash.prototype.commit=wrapperCommit,lodash.prototype.flatMap=wrapperFlatMap,lodash.prototype.next=wrapperNext,lodash.prototype.plant=wrapperPlant,lodash.prototype.reverse=wrapperReverse,lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=wrapperValue,iteratorSymbol&&(lodash.prototype[iteratorSymbol]=wrapperToIterator),lodash}var undefined,VERSION="4.2.0",BIND_FLAG=1,BIND_KEY_FLAG=2,CURRY_BOUND_FLAG=4,CURRY_FLAG=8,CURRY_RIGHT_FLAG=16,PARTIAL_FLAG=32,PARTIAL_RIGHT_FLAG=64,ARY_FLAG=128,REARG_FLAG=256,FLIP_FLAG=512,UNORDERED_COMPARE_FLAG=1,PARTIAL_COMPARE_FLAG=2,DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION="...",HOT_COUNT=150,HOT_SPAN=16,LARGE_ARRAY_SIZE=200,LAZY_FILTER_FLAG=1,LAZY_MAP_FLAG=2,LAZY_WHILE_FLAG=3,FUNC_ERROR_TEXT="Expected a function",HASH_UNDEFINED="__lodash_hash_undefined__",INFINITY=1/0,MAX_SAFE_INTEGER=9007199254740991,MAX_INTEGER=1.7976931348623157e308,NAN=0/0,MAX_ARRAY_LENGTH=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH-1,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH>>>1,PLACEHOLDER="__lodash_placeholder__",argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEscapedHtml=/&(?:amp|lt|gt|quot|#39|#96);/g,reUnescapedHtml=/[&<>"'`]/g,reHasEscapedHtml=RegExp(reEscapedHtml.source),reHasUnescapedHtml=RegExp(reUnescapedHtml.source),reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,reInterpolate=/<%=([\s\S]+?)%>/g,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reHasRegExpChar=RegExp(reRegExpChar.source),reTrim=/^\s+|\s+$/g,reTrimStart=/^\s+/,reTrimEnd=/\s+$/,reEscapeChar=/\\(\\)?/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reFlags=/\w*$/,reHasHexPrefix=/^0x/i,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsOctal=/^0o[0-7]+$/i,reIsUint=/^(?:0|[1-9]\d*)$/,reLatin1=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g,rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f\\ufe20-\\ufe23",rsComboSymbolsRange="\\u20d0-\\u20f0",rsDingbatRange="\\u2700-\\u27bf",rsLowerRange="a-z\\xdf-\\xf6\\xf8-\\xff",rsMathOpRange="\\xac\\xb1\\xd7\\xf7",rsNonCharRange="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",rsQuoteRange="\\u2018\\u2019\\u201c\\u201d",rsSpaceRange=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsUpperRange="A-Z\\xc0-\\xd6\\xd8-\\xde",rsVarRange="\\ufe0e\\ufe0f",rsBreakRange=rsMathOpRange+rsNonCharRange+rsQuoteRange+rsSpaceRange,rsAstral="["+rsAstralRange+"]",rsBreak="["+rsBreakRange+"]",rsCombo="["+rsComboMarksRange+rsComboSymbolsRange+"]",rsDigits="\\d+",rsDingbat="["+rsDingbatRange+"]",rsLower="["+rsLowerRange+"]",rsMisc="[^"+rsAstralRange+rsBreakRange+rsDigits+rsDingbatRange+rsLowerRange+rsUpperRange+"]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:"+rsCombo+"|"+rsFitz+")",rsNonAstral="[^"+rsAstralRange+"]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper="["+rsUpperRange+"]",rsZWJ="\\u200d",rsLowerMisc="(?:"+rsLower+"|"+rsMisc+")",rsUpperMisc="(?:"+rsUpper+"|"+rsMisc+")",reOptMod=rsModifier+"?",rsOptVar="["+rsVarRange+"]?",rsOptJoin="(?:"+rsZWJ+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsEmoji="(?:"+[rsDingbat,rsRegional,rsSurrPair].join("|")+")"+rsSeq,rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reComboMark=RegExp(rsCombo,"g"),reComplexSymbol=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g"),reHasComplexSymbol=RegExp("["+rsZWJ+rsAstralRange+rsComboMarksRange+rsComboSymbolsRange+rsVarRange+"]"),reBasicWord=/[a-zA-Z0-9]+/g,reComplexWord=RegExp([rsUpper+"?"+rsLower+"+(?="+[rsBreak,rsUpper,"$"].join("|")+")",rsUpperMisc+"+(?="+[rsBreak,rsUpper+rsLowerMisc,"$"].join("|")+")",rsUpper+"?"+rsLowerMisc+"+",rsUpper+"+",rsDigits,rsEmoji].join("|"),"g"),reHasComplexWord=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,contextProps=["Array","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Reflect","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],templateCounter=-1,typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;var deburredLetters={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss"},htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},htmlUnescapes={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},objectTypes={"function":!0,object:!0},stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},freeParseFloat=parseFloat,freeParseInt=parseInt,freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType?exports:null,freeModule=objectTypes[typeof module]&&module&&!module.nodeType?module:null,freeGlobal=checkGlobal(freeExports&&freeModule&&"object"==typeof global&&global),freeSelf=checkGlobal(objectTypes[typeof self]&&self),freeWindow=checkGlobal(objectTypes[typeof window]&&window),moduleExports=freeModule&&freeModule.exports===freeExports?freeExports:null,thisGlobal=checkGlobal(objectTypes[typeof this]&&this),root=freeGlobal||freeWindow!==(thisGlobal&&thisGlobal.window)&&freeWindow||freeSelf||thisGlobal||Function("return this")(),_=runInContext();(freeWindow||freeSelf||{})._=_,"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return _}):freeExports&&freeModule?(moduleExports&&((freeModule.exports=_)._=_),freeExports._=_):root._=_}.call(this),!function(e,n){"use strict";function r(e,n){var r,t,u=e.toLowerCase();for(n=[].concat(n),r=0;n.length>r;r+=1)if(t=n[r]){if(t.test&&t.test(e))return!0;if(t.toLowerCase()===u)return!0}}var t=n.prototype.trim,u=n.prototype.trimRight,i=n.prototype.trimLeft,l=function(e){return 1*e||0},o=function(e,n){if(1>n)return"";for(var r="";n>0;)1&n&&(r+=e),n>>=1,e+=e;return r},a=[].slice,c=function(e){return null==e?"\\s":e.source?e.source:"["+g.escapeRegExp(e)+"]"},s={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},f={};for(var p in s)f[s[p]]=p;f["'"]="#39";var h=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}var r=o,t=function(){return t.cache.hasOwnProperty(arguments[0])||(t.cache[arguments[0]]=t.parse(arguments[0])),t.format.call(null,t.cache[arguments[0]],arguments)};return t.format=function(t,u){var i,l,o,a,c,s,f,p=1,g=t.length,d="",m=[];for(l=0;g>l;l++)if(d=e(t[l]),"string"===d)m.push(t[l]);else if("array"===d){if(a=t[l],a[2])for(i=u[p],o=0;a[2].length>o;o++){if(!i.hasOwnProperty(a[2][o]))throw new Error(h('[_.sprintf] property "%s" does not exist',a[2][o]));i=i[a[2][o]]}else i=a[1]?u[a[1]]:u[p++];if(/[^s]/.test(a[8])&&"number"!=e(i))throw new Error(h("[_.sprintf] expecting number but found %s",e(i)));switch(a[8]){case"b":i=i.toString(2);break;case"c":i=n.fromCharCode(i);break;case"d":i=parseInt(i,10);break;case"e":i=a[7]?i.toExponential(a[7]):i.toExponential();break;case"f":i=a[7]?parseFloat(i).toFixed(a[7]):parseFloat(i);break;case"o":i=i.toString(8);break;case"s":i=(i=n(i))&&a[7]?i.substring(0,a[7]):i;break;case"u":i=Math.abs(i);break;case"x":i=i.toString(16);break;case"X":i=i.toString(16).toUpperCase()}i=/[def]/.test(a[8])&&a[3]&&i>=0?"+"+i:i,s=a[4]?"0"==a[4]?"0":a[4].charAt(1):" ",f=a[6]-n(i).length,c=a[6]?r(s,f):"",m.push(a[5]?i+c:c+i)}return m.join("")},t.cache={},t.parse=function(e){for(var n=e,r=[],t=[],u=0;n;){if(null!==(r=/^[^\x25]+/.exec(n)))t.push(r[0]);else if(null!==(r=/^\x25{2}/.exec(n)))t.push("%");else{if(null===(r=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(n)))throw new Error("[_.sprintf] huh?");if(r[2]){u|=1;var i=[],l=r[2],o=[];if(null===(o=/^([a-z_][a-z_\d]*)/i.exec(l)))throw new Error("[_.sprintf] huh?");for(i.push(o[1]);""!==(l=l.substring(o[0].length));)if(null!==(o=/^\.([a-z_][a-z_\d]*)/i.exec(l)))i.push(o[1]);else{if(null===(o=/^\[(\d+)\]/.exec(l)))throw new Error("[_.sprintf] huh?");i.push(o[1])}r[2]=i}else u|=2;if(3===u)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");t.push(r)}n=n.substring(r[0].length)}return t},t}(),g={VERSION:"2.3.0",isBlank:function(e){return null==e&&(e=""),/^\s*$/.test(e)},stripTags:function(e){return null==e?"":n(e).replace(/<\/?[^>]+>/g,"")},capitalize:function(e){return e=null==e?"":n(e),e.charAt(0).toUpperCase()+e.slice(1)},chop:function(e,r){return null==e?[]:(e=n(e),r=~~r,r>0?e.match(new RegExp(".{1,"+r+"}","g")):[e])},clean:function(e){return g.strip(e).replace(/\s+/g," ")},count:function(e,r){if(null==e||null==r)return 0;e=n(e),r=n(r);for(var t=0,u=0,i=r.length;u=e.indexOf(r,u),-1!==u;)t++,u+=i;return t},chars:function(e){return null==e?[]:n(e).split("")},swapCase:function(e){return null==e?"":n(e).replace(/\S/g,function(e){return e===e.toUpperCase()?e.toLowerCase():e.toUpperCase()})},escapeHTML:function(e){return null==e?"":n(e).replace(/[&<>"']/g,function(e){return"&"+f[e]+";"})},unescapeHTML:function(e){return null==e?"":n(e).replace(/\&([^;]+);/g,function(e,r){var t;return r in s?s[r]:(t=r.match(/^#x([\da-fA-F]+)$/))?n.fromCharCode(parseInt(t[1],16)):(t=r.match(/^#(\d+)$/))?n.fromCharCode(~~t[1]):e})},escapeRegExp:function(e){return null==e?"":n(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(e,n,r,t){var u=g.chars(e);return u.splice(~~n,~~r,t),u.join("")},insert:function(e,n,r){return g.splice(e,n,0,r)},include:function(e,r){return""===r?!0:null==e?!1:-1!==n(e).indexOf(r)},join:function(){var e=a.call(arguments),n=e.shift();return null==n&&(n=""),e.join(n)},lines:function(e){return null==e?[]:n(e).split("\n")},reverse:function(e){return g.chars(e).reverse().join("")},startsWith:function(e,r){return""===r?!0:null==e||null==r?!1:(e=n(e),r=n(r),e.length>=r.length&&e.slice(0,r.length)===r)},endsWith:function(e,r){return""===r?!0:null==e||null==r?!1:(e=n(e),r=n(r),e.length>=r.length&&e.slice(e.length-r.length)===r)},succ:function(e){return null==e?"":(e=n(e),e.slice(0,-1)+n.fromCharCode(e.charCodeAt(e.length-1)+1))},titleize:function(e){return null==e?"":(e=n(e).toLowerCase(),e.replace(/(?:^|\s|-)\S/g,function(e){return e.toUpperCase()}))},camelize:function(e){return g.trim(e).replace(/[-_\s]+(.)?/g,function(e,n){return n?n.toUpperCase():""})},underscored:function(e){return g.trim(e).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(e){return g.trim(e).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(e){return g.titleize(n(e).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(e){return g.capitalize(g.underscored(e).replace(/_id$/,"").replace(/_/g," "))},trim:function(e,r){return null==e?"":!r&&t?t.call(e):(r=c(r),n(e).replace(new RegExp("^"+r+"+|"+r+"+$","g"),""))},ltrim:function(e,r){return null==e?"":!r&&i?i.call(e):(r=c(r),n(e).replace(new RegExp("^"+r+"+"),""))},rtrim:function(e,r){return null==e?"":!r&&u?u.call(e):(r=c(r),n(e).replace(new RegExp(r+"+$"),""))},truncate:function(e,r,t){return null==e?"":(e=n(e),t=t||"...",r=~~r,e.length>r?e.slice(0,r)+t:e)},prune:function(e,r,t){if(null==e)return"";if(e=n(e),r=~~r,t=null!=t?n(t):"...",r>=e.length)return e;var u=function(e){return e.toUpperCase()!==e.toLowerCase()?"A":" "},i=e.slice(0,r+1).replace(/.(?=\W*\w*$)/g,u);return i=i.slice(i.length-2).match(/\w\w/)?i.replace(/\s*\S+$/,""):g.rtrim(i.slice(0,i.length-1)),(i+t).length>e.length?e:e.slice(0,i.length)+t},words:function(e,n){return g.isBlank(e)?[]:g.trim(e,n).split(n||/\s+/)},pad:function(e,r,t,u){e=null==e?"":n(e),r=~~r;var i=0;switch(t?t.length>1&&(t=t.charAt(0)):t=" ",u){case"right":return i=r-e.length,e+o(t,i);case"both":return i=r-e.length,o(t,Math.ceil(i/2))+e+o(t,Math.floor(i/2));default:return i=r-e.length,o(t,i)+e}},lpad:function(e,n,r){return g.pad(e,n,r)},rpad:function(e,n,r){return g.pad(e,n,r,"right")},lrpad:function(e,n,r){return g.pad(e,n,r,"both")},sprintf:h,vsprintf:function(e,n){return n.unshift(e),h.apply(null,n)},toNumber:function(e,n){return e?(e=g.trim(e),e.match(/^-?\d+(?:\.\d+)?$/)?l(l(e).toFixed(~~n)):0/0):0},numberFormat:function(e,n,r,t){if(isNaN(e)||null==e)return"";e=e.toFixed(~~n),t="string"==typeof t?t:",";var u=e.split("."),i=u[0],l=u[1]?(r||".")+u[1]:"";return i.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+t)+l},strRight:function(e,r){if(null==e)return"";e=n(e),r=null!=r?n(r):r;var t=r?e.indexOf(r):-1;return~t?e.slice(t+r.length,e.length):e},strRightBack:function(e,r){if(null==e)return"";e=n(e),r=null!=r?n(r):r;var t=r?e.lastIndexOf(r):-1;return~t?e.slice(t+r.length,e.length):e},strLeft:function(e,r){if(null==e)return"";e=n(e),r=null!=r?n(r):r;var t=r?e.indexOf(r):-1;return~t?e.slice(0,t):e},strLeftBack:function(e,n){if(null==e)return"";e+="",n=null!=n?""+n:n;var r=e.lastIndexOf(n);return~r?e.slice(0,r):e},toSentence:function(e,n,r,t){n=n||", ",r=r||" and ";var u=e.slice(),i=u.pop();return e.length>2&&t&&(r=g.rtrim(n)+r),u.length?u.join(n)+r+i:i},toSentenceSerial:function(){var e=a.call(arguments);return e[3]=!0,g.toSentence.apply(g,e)},slugify:function(e){if(null==e)return"";var r="ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź",t="aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz",u=new RegExp(c(r),"g");return e=n(e).toLowerCase().replace(u,function(e){var n=r.indexOf(e);return t.charAt(n)||"-"}),g.dasherize(e.replace(/[^\w\s-]/g,""))},surround:function(e,n){return[n,e,n].join("")},quote:function(e,n){return g.surround(e,n||'"')},unquote:function(e,n){return n=n||'"',e[0]===n&&e[e.length-1]===n?e.slice(1,e.length-1):e},exports:function(){var e={};for(var n in this)this.hasOwnProperty(n)&&!n.match(/^(?:include|contains|reverse)$/)&&(e[n]=this[n]);return e},repeat:function(e,r,t){if(null==e)return"";if(r=~~r,null==t)return o(n(e),r);for(var u=[];r>0;u[--r]=e);return u.join(t)},naturalCmp:function(e,r){if(e==r)return 0;if(!e)return-1;if(!r)return 1;for(var t=/(\.\d+)|(\d+)|(\D+)/g,u=n(e).toLowerCase().match(t),i=n(r).toLowerCase().match(t),l=Math.min(u.length,i.length),o=0;l>o;o++){var a=u[o],c=i[o];if(a!==c){var s=parseInt(a,10);if(!isNaN(s)){var f=parseInt(c,10);if(!isNaN(f)&&s-f)return s-f}return c>a?-1:1}}return u.length===i.length?u.length-i.length:r>e?-1:1},levenshtein:function(e,r){if(null==e&&null==r)return 0;if(null==e)return n(r).length;if(null==r)return n(e).length;e=n(e),r=n(r);for(var t,u,i=[],l=0;r.length>=l;l++)for(var o=0;e.length>=o;o++)u=l&&o?e.charAt(o-1)===r.charAt(l-1)?t:Math.min(i[o],i[o-1],t)+1:l+o,t=i[o],i[o]=u;return i.pop()},toBoolean:function(e,n,t){return"number"==typeof e&&(e=""+e),"string"!=typeof e?!!e:(e=g.trim(e),r(e,n||["true","1"])?!0:r(e,t||["false","0"])?!1:void 0)}};g.strip=g.trim,g.lstrip=g.ltrim,g.rstrip=g.rtrim,g.center=g.lrpad,g.rjust=g.lpad,g.ljust=g.rpad,g.contains=g.include,g.q=g.quote,g.toBool=g.toBoolean,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(module.exports=g),exports._s=g),"function"==typeof define&&define.amd&&define("underscore.string",[],function(){return g}),e._=e._||{},e._.string=e._.str=g}(this,String),function(undefined){function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.lang().ordinal(func.call(this,a),period)}}function Language(){}function Moment(config){extend(this,config)}function Duration(duration){var years=duration.years||duration.year||duration.y||0,months=duration.months||duration.month||duration.M||0,weeks=duration.weeks||duration.week||duration.w||0,days=duration.days||duration.day||duration.d||0,hours=duration.hours||duration.hour||duration.h||0,minutes=duration.minutes||duration.minute||duration.m||0,seconds=duration.seconds||duration.second||duration.s||0,milliseconds=duration.milliseconds||duration.millisecond||duration.ms||0;this._input=duration,this._milliseconds=milliseconds+1e3*seconds+6e4*minutes+36e5*hours,this._days=days+7*weeks,this._months=months+12*years,this._data={},this._bubble()}function extend(a,b){for(var i in b)b.hasOwnProperty(i)&&(a[i]=b[i]);return a}function absRound(number){return 0>number?Math.ceil(number):Math.floor(number)}function leftZeroFill(number,targetLength){for(var output=number+"";output.length<targetLength;)output="0"+output;return output}function addOrSubtractDurationFromMoment(mom,duration,isAdding,ignoreUpdateOffset){var minutes,hours,milliseconds=duration._milliseconds,days=duration._days,months=duration._months;milliseconds&&mom._d.setTime(+mom._d+milliseconds*isAdding),(days||months)&&(minutes=mom.minute(),hours=mom.hour()),days&&mom.date(mom.date()+days*isAdding),months&&mom.month(mom.month()+months*isAdding),milliseconds&&!ignoreUpdateOffset&&moment.updateOffset(mom),(days||months)&&(mom.minute(minutes),mom.hour(hours))}function isArray(input){return"[object Array]"===Object.prototype.toString.call(input)}function compareArrays(array1,array2){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;len>i;i++)~~array1[i]!==~~array2[i]&&diffs++;return diffs+lengthDiff}function normalizeUnits(units){return units?unitAliases[units]||units.toLowerCase().replace(/(.)s$/,"$1"):units}function loadLang(key,values){return values.abbr=key,languages[key]||(languages[key]=new Language),languages[key].set(values),languages[key]}function getLangDefinition(key){if(!key)return moment.fn._lang;if(!languages[key]&&hasModule)try{require("./lang/"+key)}catch(e){return moment.fn._lang}return languages[key]}function removeFormattingTokens(input){return input.match(/\[.*\]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var i,length,array=format.match(formattingTokens);for(i=0,length=array.length;length>i;i++)array[i]=formatTokenFunctions[array[i]]?formatTokenFunctions[array[i]]:removeFormattingTokens(array[i]);return function(mom){var output="";for(i=0;length>i;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){function replaceLongDateFormatTokens(input){return m.lang().longDateFormat(input)||input}for(var i=5;i--&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);return formatFunctions[format]||(formatFunctions[format]=makeFormatFunction(format)),formatFunctions[format](m)}function getParseRegexForToken(token,config){switch(token){case"DDDD":return parseTokenThreeDigits;case"YYYY":return parseTokenFourDigits;case"YYYYY":return parseTokenSixDigits;case"S":case"SS":case"SSS":case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return getLangDefinition(config._l)._meridiemParse;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return parseTokenOneOrTwoDigits;default:return new RegExp(token.replace("\\",""))}}function timezoneMinutesFromString(string){var tzchunk=(parseTokenTimezone.exec(string)||[])[0],parts=(tzchunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(60*parts[1])+~~parts[2];return"+"===parts[0]?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"M":case"MM":datePartArray[1]=null==input?0:~~input-1;break;case"MMM":case"MMMM":a=getLangDefinition(config._l).monthsParse(input),null!=a?datePartArray[1]=a:config._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=input&&(datePartArray[2]=~~input);break;case"YY":datePartArray[0]=~~input+(~~input>68?1900:2e3);break;case"YYYY":case"YYYYY":datePartArray[0]=~~input;break;case"a":case"A":config._isPm=getLangDefinition(config._l).isPM(input);break;case"H":case"HH":case"h":case"hh":datePartArray[3]=~~input;break;case"m":case"mm":datePartArray[4]=~~input;break;case"s":case"ss":datePartArray[5]=~~input;break;case"S":case"SS":case"SSS":datePartArray[6]=~~(1e3*("0."+input));break;case"X":config._d=new Date(1e3*parseFloat(input));break;case"Z":case"ZZ":config._useUTC=!0,config._tzm=timezoneMinutesFromString(input)}null==input&&(config._isValid=!1)}function dateFromArray(config){var i,date,input=[];if(!config._d){for(i=0;7>i;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];input[3]+=~~((config._tzm||0)/60),input[4]+=~~((config._tzm||0)%60),date=new Date(0),config._useUTC?(date.setUTCFullYear(input[0],input[1],input[2]),date.setUTCHours(input[3],input[4],input[5],input[6])):(date.setFullYear(input[0],input[1],input[2]),date.setHours(input[3],input[4],input[5],input[6])),config._d=date}}function makeDateFromStringAndFormat(config){var i,parsedInput,tokens=config._f.match(formattingTokens),string=config._i;for(config._a=[],i=0;i<tokens.length;i++)parsedInput=(getParseRegexForToken(tokens[i],config).exec(string)||[])[0],parsedInput&&(string=string.slice(string.indexOf(parsedInput)+parsedInput.length)),formatTokenFunctions[tokens[i]]&&addTimeToArrayFromToken(tokens[i],parsedInput,config);string&&(config._il=string),config._isPm&&config._a[3]<12&&(config._a[3]+=12),config._isPm===!1&&12===config._a[3]&&(config._a[3]=0),dateFromArray(config)}function makeDateFromStringAndArray(config){var tempConfig,tempMoment,bestMoment,i,currentScore,scoreToBeat=99;for(i=0;i<config._f.length;i++)tempConfig=extend({},config),tempConfig._f=config._f[i],makeDateFromStringAndFormat(tempConfig),tempMoment=new Moment(tempConfig),currentScore=compareArrays(tempConfig._a,tempMoment.toArray()),tempMoment._il&&(currentScore+=tempMoment._il.length),scoreToBeat>currentScore&&(scoreToBeat=currentScore,bestMoment=tempMoment);extend(config,bestMoment)}function makeDateFromString(config){var i,string=config._i,match=isoRegex.exec(string);if(match){for(config._f="YYYY-MM-DD"+(match[2]||" "),i=0;4>i;i++)if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}parseTokenTimezone.exec(string)&&(config._f+=" Z"),makeDateFromStringAndFormat(config)}else config._d=new Date(string)}function makeDateFromInput(config){var input=config._i,matched=aspNetJsonRegex.exec(input);input===undefined?config._d=new Date:matched?config._d=new Date(+matched[1]):"string"==typeof input?makeDateFromString(config):isArray(input)?(config._a=input.slice(0),dateFromArray(config)):config._d=new Date(input instanceof Date?+input:input)}function substituteTimeAgo(string,number,withoutSuffix,isFuture,lang){return lang.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(milliseconds,withoutSuffix,lang){var seconds=round(Math.abs(milliseconds)/1e3),minutes=round(seconds/60),hours=round(minutes/60),days=round(hours/24),years=round(days/365),args=45>seconds&&["s",seconds]||1===minutes&&["m"]||45>minutes&&["mm",minutes]||1===hours&&["h"]||22>hours&&["hh",hours]||1===days&&["d"]||25>=days&&["dd",days]||45>=days&&["M"]||345>days&&["MM",round(days/30)]||1===years&&["y"]||["yy",years];return args[2]=withoutSuffix,args[3]=milliseconds>0,args[4]=lang,substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var adjustedMoment,end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day();return daysToDayOfWeek>end&&(daysToDayOfWeek-=7),end-7>daysToDayOfWeek&&(daysToDayOfWeek+=7),adjustedMoment=moment(mom).add("d",daysToDayOfWeek),{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function makeMoment(config){var input=config._i,format=config._f;return null===input||""===input?null:("string"==typeof input&&(config._i=input=getLangDefinition().preparse(input)),moment.isMoment(input)?(config=extend({},input),config._d=new Date(+input._d)):format?isArray(format)?makeDateFromStringAndArray(config):makeDateFromStringAndFormat(config):makeDateFromInput(config),new Moment(config))}function makeGetterAndSetter(name,key){moment.fn[name]=moment.fn[name+"s"]=function(input){var utc=this._isUTC?"UTC":"";return null!=input?(this._d["set"+utc+key](input),moment.updateOffset(this),this):this._d["get"+utc+key]()}}function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeDurationAsGetter(name,factor){moment.duration.fn["as"+name]=function(){return+this/factor}}for(var moment,i,VERSION="2.1.0",round=Math.round,languages={},hasModule="undefined"!=typeof module&&module.exports,aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{1,4}/,parseTokenSixDigits=/[+\-]?\d{1,6}/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/i,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,isoRegex=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoTimes=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,proxyGettersAndSetters="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),unitMillisecondFactors={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",y:"year"},formatFunctions={},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1
},MMM:function(format){return this.lang().monthsShort(this,format)},MMMM:function(format){return this.lang().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.lang().weekdaysMin(this,format)},ddd:function(format){return this.lang().weekdaysShort(this,format)},dddd:function(format){return this.lang().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return leftZeroFill(~~(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(~~(a/60),2)+":"+leftZeroFill(~~a%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(~~(10*a/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};ordinalizeTokens.length;)i=ordinalizeTokens.pop(),formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i);for(;paddedTokens.length;)i=paddedTokens.pop(),formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);for(formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3),Language.prototype={set:function(config){var prop,i;for(i in config)prop=config[i],"function"==typeof prop?this[i]=prop:this["_"+i]=prop},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName){var i,mom,regex;for(this._monthsParse||(this._monthsParse=[]),i=0;12>i;i++)if(this._monthsParse[i]||(mom=moment([2e3,i]),regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),this._monthsParse[i].test(monthName))return i},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;7>i;i++)if(this._weekdaysParse[i]||(mom=moment([2e3,1]).day(i),regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),this._weekdaysParse[i].test(weekdayName))return i},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];return!output&&this._longDateFormat[key.toUpperCase()]&&(output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key]=output),output},isPM:function(input){return"p"===(input+"").toLowerCase()[0]},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom){var output=this._calendar[key];return"function"==typeof output?output.apply(mom):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return"function"==typeof output?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return"function"==typeof format?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}},moment=function(input,format,lang){return makeMoment({_i:input,_f:format,_l:lang,_isUTC:!1})},moment.utc=function(input,format,lang){return makeMoment({_useUTC:!0,_isUTC:!0,_l:lang,_i:input,_f:format})},moment.unix=function(input){return moment(1e3*input)},moment.duration=function(input,key){var sign,ret,isDuration=moment.isDuration(input),isNumber="number"==typeof input,duration=isDuration?input._input:isNumber?{}:input,matched=aspNetTimeSpanJsonRegex.exec(input);return isNumber?key?duration[key]=input:duration.milliseconds=input:matched&&(sign="-"===matched[1]?-1:1,duration={y:0,d:~~matched[2]*sign,h:~~matched[3]*sign,m:~~matched[4]*sign,s:~~matched[5]*sign,ms:~~matched[6]*sign}),ret=new Duration(duration),isDuration&&input.hasOwnProperty("_lang")&&(ret._lang=input._lang),ret},moment.version=VERSION,moment.defaultFormat=isoFormat,moment.updateOffset=function(){},moment.lang=function(key,values){return key?(values?loadLang(key,values):languages[key]||getLangDefinition(key),void(moment.duration.fn._lang=moment.fn._lang=getLangDefinition(key))):moment.fn._lang._abbr},moment.langData=function(key){return key&&key._lang&&key._lang._abbr&&(key=key._lang._abbr),getLangDefinition(key)},moment.isMoment=function(obj){return obj instanceof Moment},moment.isDuration=function(obj){return obj instanceof Duration},moment.fn=Moment.prototype={clone:function(){return moment(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return formatMoment(moment(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return null==this._isValid&&(this._isValid=this._a?!compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray()):!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.lang().postformat(output)},add:function(input,val){var dur;return dur="string"==typeof input?moment.duration(+val,input):moment.duration(input,val),addOrSubtractDurationFromMoment(this,dur,1),this},subtract:function(input,val){var dur;return dur="string"==typeof input?moment.duration(+val,input):moment.duration(input,val),addOrSubtractDurationFromMoment(this,dur,-1),this},diff:function(input,units,asFloat){var diff,output,that=this._isUTC?moment(input).zone(this._offset||0):moment(input).local(),zoneDiff=6e4*(this.zone()-that.zone());return units=normalizeUnits(units),"year"===units||"month"===units?(diff=432e5*(this.daysInMonth()+that.daysInMonth()),output=12*(this.year()-that.year())+(this.month()-that.month()),output+=(this-moment(this).startOf("month")-(that-moment(that).startOf("month")))/diff,output-=6e4*(this.zone()-moment(this).startOf("month").zone()-(that.zone()-moment(that).startOf("month").zone()))/diff,"year"===units&&(output/=12)):(diff=this-that,output="second"===units?diff/1e3:"minute"===units?diff/6e4:"hour"===units?diff/36e5:"day"===units?(diff-zoneDiff)/864e5:"week"===units?(diff-zoneDiff)/6048e5:diff),asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(){var diff=this.diff(moment().startOf("day"),"days",!0),format=-6>diff?"sameElse":-1>diff?"lastWeek":0>diff?"lastDay":1>diff?"sameDay":2>diff?"nextDay":7>diff?"nextWeek":"sameElse";return this.format(this.lang().calendar(format,this))},isLeapYear:function(){var year=this.year();return year%4===0&&year%100!==0||year%400===0},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?"string"==typeof input&&(input=this.lang().weekdaysParse(input),"number"!=typeof input)?this:this.add({d:input-day}):day},month:function(input){var dayOfMonth,utc=this._isUTC?"UTC":"";return null!=input?"string"==typeof input&&(input=this.lang().monthsParse(input),"number"!=typeof input)?this:(dayOfMonth=this.date(),this.date(1),this._d["set"+utc+"Month"](input),this.date(Math.min(dayOfMonth,this.daysInMonth())),moment.updateOffset(this),this):this._d["get"+utc+"Month"]()},startOf:function(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units&&this.weekday(0),this},endOf:function(units){return this.startOf(units).add(units,1).subtract("ms",1)},isAfter:function(input,units){return units="undefined"!=typeof units?units:"millisecond",+this.clone().startOf(units)>+moment(input).startOf(units)},isBefore:function(input,units){return units="undefined"!=typeof units?units:"millisecond",+this.clone().startOf(units)<+moment(input).startOf(units)},isSame:function(input,units){return units="undefined"!=typeof units?units:"millisecond",+this.clone().startOf(units)===+moment(input).startOf(units)},min:function(other){return other=moment.apply(null,arguments),this>other?this:other},max:function(other){return other=moment.apply(null,arguments),other>this?this:other},zone:function(input){var offset=this._offset||0;return null==input?this._isUTC?offset:this._d.getTimezoneOffset():("string"==typeof input&&(input=timezoneMinutesFromString(input)),Math.abs(input)<16&&(input=60*input),this._offset=input,this._isUTC=!0,offset!==input&&addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},daysInMonth:function(){return moment.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add("d",input-dayOfYear)},weekYear:function(input){var year=weekOfYear(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==input?year:this.add("y",input-year)},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return null==input?year:this.add("y",input-year)},week:function(input){var week=this.lang().week(this);return null==input?week:this.add("d",7*(input-week))},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add("d",7*(input-week))},weekday:function(input){var weekday=(this._d.getDay()+7-this.lang()._week.dow)%7;return null==input?weekday:this.add("d",input-weekday)},isoWeekday:function(input){return null==input?this.day()||7:this.day(this.day()%7?input:input-7)},lang:function(key){return key===undefined?this._lang:(this._lang=getLangDefinition(key),this)}},i=0;i<proxyGettersAndSetters.length;i++)makeGetterAndSetter(proxyGettersAndSetters[i].toLowerCase().replace(/s$/,""),proxyGettersAndSetters[i]);makeGetterAndSetter("year","FullYear"),moment.fn.days=moment.fn.day,moment.fn.months=moment.fn.month,moment.fn.weeks=moment.fn.week,moment.fn.isoWeeks=moment.fn.isoWeek,moment.fn.toJSON=moment.fn.toISOString,moment.duration.fn=Duration.prototype={_bubble:function(){var seconds,minutes,hours,years,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data;data.milliseconds=milliseconds%1e3,seconds=absRound(milliseconds/1e3),data.seconds=seconds%60,minutes=absRound(seconds/60),data.minutes=minutes%60,hours=absRound(minutes/60),data.hours=hours%24,days+=absRound(hours/24),data.days=days%30,months+=absRound(days/30),data.months=months%12,years=absRound(months/12),data.years=years},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*~~(this._months/12)},humanize:function(withSuffix){var difference=+this,output=relativeTime(difference,!withSuffix,this.lang());return withSuffix&&(output=this.lang().pastFuture(difference,output)),this.lang().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);return this._milliseconds+=dur._milliseconds,this._days+=dur._days,this._months+=dur._months,this._bubble(),this},subtract:function(input,val){var dur=moment.duration(input,val);return this._milliseconds-=dur._milliseconds,this._days-=dur._days,this._months-=dur._months,this._bubble(),this},get:function(units){return units=normalizeUnits(units),this[units.toLowerCase()+"s"]()},as:function(units){return units=normalizeUnits(units),this["as"+units.charAt(0).toUpperCase()+units.slice(1)+"s"]()},lang:moment.fn.lang};for(i in unitMillisecondFactors)unitMillisecondFactors.hasOwnProperty(i)&&(makeDurationAsGetter(i,unitMillisecondFactors[i]),makeDurationGetter(i.toLowerCase()));makeDurationAsGetter("Weeks",6048e5),moment.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},moment.lang("en",{ordinal:function(number){var b=number%10,output=1===~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}}),hasModule&&(module.exports=moment),"undefined"==typeof ender&&(this.moment=moment),"function"==typeof define&&define.amd&&define("moment",[],function(){return moment})}.call(this),function(){var nv={};nv.dev=!1,nv.tooltip=nv.tooltip||{},nv.utils=nv.utils||{},nv.models=nv.models||{},nv.charts={},nv.logs={},nv.dom={},nv.dispatch=d3.dispatch("render_start","render_end"),Function.prototype.bind||(Function.prototype.bind=function(oThis){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){},fBound=function(){return fToBind.apply(this instanceof fNOP&&oThis?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)))};return fNOP.prototype=this.prototype,fBound.prototype=new fNOP,fBound}),nv.dev&&(nv.dispatch.on("render_start",function(){nv.logs.startTime=+new Date}),nv.dispatch.on("render_end",function(){nv.logs.endTime=+new Date,nv.logs.totalTime=nv.logs.endTime-nv.logs.startTime,nv.log("total",nv.logs.totalTime)})),nv.log=function(){if(nv.dev&&window.console&&console.log&&console.log.apply)console.log.apply(console,arguments);else if(nv.dev&&window.console&&"function"==typeof console.log&&Function.prototype.bind){var log=Function.prototype.bind.call(console.log,console);log.apply(console,arguments)}return arguments[arguments.length-1]},nv.deprecated=function(name,info){console&&console.warn&&console.warn("nvd3 warning: `"+name+"` has been deprecated. ",info||"")},nv.render=function(step){step=step||1,nv.render.active=!0,nv.dispatch.render_start();var renderLoop=function(){for(var chart,graph,i=0;step>i&&(graph=nv.render.queue[i]);i++)chart=graph.generate(),typeof graph.callback==typeof Function&&graph.callback(chart);nv.render.queue.splice(0,i),nv.render.queue.length?setTimeout(renderLoop):(nv.dispatch.render_end(),nv.render.active=!1)};setTimeout(renderLoop)},nv.render.active=!1,nv.render.queue=[],nv.addGraph=function(obj){typeof arguments[0]==typeof Function&&(obj={generate:arguments[0],callback:arguments[1]}),nv.render.queue.push(obj),nv.render.active||nv.render()},"undefined"!=typeof module&&"undefined"!=typeof exports&&(module.exports=nv),"undefined"!=typeof window&&(window.nv=nv),nv.dom.write=function(callback){return void 0!==window.fastdom?fastdom.write(callback):callback()},nv.dom.read=function(callback){return void 0!==window.fastdom?fastdom.read(callback):callback()},nv.interactiveGuideline=function(){"use strict";function layer(selection){selection.each(function(data){function mouseHandler(){var d3mouse=d3.mouse(this),mouseX=d3mouse[0],mouseY=d3mouse[1],subtractMargin=!0,mouseOutAnyReason=!1;if(isMSIE&&(mouseX=d3.event.offsetX,mouseY=d3.event.offsetY,"svg"!==d3.event.target.tagName&&(subtractMargin=!1),d3.event.target.className.baseVal.match("nv-legend")&&(mouseOutAnyReason=!0)),subtractMargin&&(mouseX-=margin.left,mouseY-=margin.top),0>mouseX||0>mouseY||mouseX>availableWidth||mouseY>availableHeight||d3.event.relatedTarget&&void 0===d3.event.relatedTarget.ownerSVGElement||mouseOutAnyReason){if(isMSIE&&d3.event.relatedTarget&&void 0===d3.event.relatedTarget.ownerSVGElement&&(void 0===d3.event.relatedTarget.className||d3.event.relatedTarget.className.match(tooltip.nvPointerEventsClass)))return;return dispatch.elementMouseout({mouseX:mouseX,mouseY:mouseY}),layer.renderGuideLine(null),void tooltip.hidden(!0)}tooltip.hidden(!1);var pointXValue=xScale.invert(mouseX);dispatch.elementMousemove({mouseX:mouseX,mouseY:mouseY,pointXValue:pointXValue}),"dblclick"===d3.event.type&&dispatch.elementDblclick({mouseX:mouseX,mouseY:mouseY,pointXValue:pointXValue}),"click"===d3.event.type&&dispatch.elementClick({mouseX:mouseX,mouseY:mouseY,pointXValue:pointXValue})}var container=d3.select(this),availableWidth=width||960,availableHeight=height||400,wrap=container.selectAll("g.nv-wrap.nv-interactiveLineLayer").data([data]),wrapEnter=wrap.enter().append("g").attr("class"," nv-wrap nv-interactiveLineLayer");wrapEnter.append("g").attr("class","nv-interactiveGuideLine"),svgContainer&&(svgContainer.on("touchmove",mouseHandler).on("mousemove",mouseHandler,!0).on("mouseout",mouseHandler,!0).on("dblclick",mouseHandler).on("click",mouseHandler),layer.guideLine=null,layer.renderGuideLine=function(x){showGuideLine&&(layer.guideLine&&layer.guideLine.attr("x1")===x||nv.dom.write(function(){var line=wrap.select(".nv-interactiveGuideLine").selectAll("line").data(null!=x?[nv.utils.NaNtoZero(x)]:[],String);line.enter().append("line").attr("class","nv-guideline").attr("x1",function(d){return d}).attr("x2",function(d){return d}).attr("y1",availableHeight).attr("y2",0),line.exit().remove()}))})})}var tooltip=nv.models.tooltip();tooltip.duration(0).hideDelay(0)._isInteractiveLayer(!0).hidden(!1);var width=null,height=null,margin={left:0,top:0},xScale=d3.scale.linear(),dispatch=d3.dispatch("elementMousemove","elementMouseout","elementClick","elementDblclick"),showGuideLine=!0,svgContainer=null,isMSIE="ActiveXObject"in window;return layer.dispatch=dispatch,layer.tooltip=tooltip,layer.margin=function(_){return arguments.length?(margin.top="undefined"!=typeof _.top?_.top:margin.top,margin.left="undefined"!=typeof _.left?_.left:margin.left,layer):margin},layer.width=function(_){return arguments.length?(width=_,layer):width},layer.height=function(_){return arguments.length?(height=_,layer):height},layer.xScale=function(_){return arguments.length?(xScale=_,layer):xScale},layer.showGuideLine=function(_){return arguments.length?(showGuideLine=_,layer):showGuideLine},layer.svgContainer=function(_){return arguments.length?(svgContainer=_,layer):svgContainer},layer},nv.interactiveBisect=function(values,searchVal,xAccessor){"use strict";if(!(values instanceof Array))return null;var _xAccessor;_xAccessor="function"!=typeof xAccessor?function(d){return d.x}:xAccessor;var _cmp=function(d,v){return _xAccessor(d)-v},bisect=d3.bisector(_cmp).left,index=d3.max([0,bisect(values,searchVal)-1]),currentValue=_xAccessor(values[index]);if("undefined"==typeof currentValue&&(currentValue=index),currentValue===searchVal)return index;var nextIndex=d3.min([index+1,values.length-1]),nextValue=_xAccessor(values[nextIndex]);return"undefined"==typeof nextValue&&(nextValue=nextIndex),Math.abs(nextValue-searchVal)>=Math.abs(currentValue-searchVal)?index:nextIndex},nv.nearestValueIndex=function(values,searchVal,threshold){"use strict";var yDistMax=1/0,indexToHighlight=null;return values.forEach(function(d,i){var delta=Math.abs(searchVal-d);null!=d&&yDistMax>=delta&&threshold>delta&&(yDistMax=delta,indexToHighlight=i)}),indexToHighlight},function(){"use strict";nv.models.tooltip=function(){function convertViewBoxRatio(){if(chartContainer){var svg=d3.select(chartContainer);"svg"!==svg.node().tagName&&(svg=svg.select("svg"));var viewBox=svg.node()?svg.attr("viewBox"):null;if(viewBox){viewBox=viewBox.split(" ");var ratio=parseInt(svg.style("width"),10)/viewBox[2];position.left=position.left*ratio,position.top=position.top*ratio}}}function initTooltip(){if(!tooltip){var body;body=chartContainer?chartContainer:document.body,tooltip=d3.select(body).append("div").attr("class","nvtooltip "+(classes?classes:"xy-tooltip")).attr("id",id),tooltip.style("top",0).style("left",0),tooltip.style("opacity",0),tooltip.selectAll("div, table, td, tr").classed(nvPointerEventsClass,!0),tooltip.classed(nvPointerEventsClass,!0),tooltipElem=tooltip.node()}}function nvtooltip(){if(enabled&&dataSeriesExists(data)){convertViewBoxRatio();var left=position.left,top=null!==fixedTop?fixedTop:position.top;return nv.dom.write(function(){initTooltip();var newContent=contentGenerator(data);newContent&&(tooltipElem.innerHTML=newContent),chartContainer&&isInteractiveLayer?nv.dom.read(function(){var svgComp=chartContainer.getElementsByTagName("svg")[0],svgOffset={left:0,top:0};if(svgComp){var svgBound=svgComp.getBoundingClientRect(),chartBound=chartContainer.getBoundingClientRect(),svgBoundTop=svgBound.top;if(0>svgBoundTop){var containerBound=chartContainer.getBoundingClientRect();svgBoundTop=Math.abs(svgBoundTop)>containerBound.height?0:svgBoundTop}svgOffset.top=Math.abs(svgBoundTop-chartBound.top),svgOffset.left=Math.abs(svgBound.left-chartBound.left)}left+=chartContainer.offsetLeft+svgOffset.left-2*chartContainer.scrollLeft,top+=chartContainer.offsetTop+svgOffset.top-2*chartContainer.scrollTop,snapDistance&&snapDistance>0&&(top=Math.floor(top/snapDistance)*snapDistance),calcTooltipPosition([left,top])}):calcTooltipPosition([left,top])}),nvtooltip}}var data=null,gravity="w",distance=25,snapDistance=0,fixedTop=null,classes=null,chartContainer=null,hidden=!0,hideDelay=400,tooltip=null,tooltipElem=null,position={left:null,top:null},offset={left:0,top:0},enabled=!0,duration=100,headerEnabled=!0,isInteractiveLayer=!1,id="nvtooltip-"+Math.floor(1e5*Math.random()),nvPointerEventsClass="nv-pointer-events-none",valueFormatter=function(d){return d},headerFormatter=function(d){return d},keyFormatter=function(d){return d},contentGenerator=function(d){if(null===d)return"";var table=d3.select(document.createElement("table"));if(headerEnabled){var theadEnter=table.selectAll("thead").data([d]).enter().append("thead");theadEnter.append("tr").append("td").attr("colspan",3).append("strong").classed("x-value",!0).html(headerFormatter(d.value))}var tbodyEnter=table.selectAll("tbody").data([d]).enter().append("tbody"),trowEnter=tbodyEnter.selectAll("tr").data(function(p){return p.series}).enter().append("tr").classed("highlight",function(p){return p.highlight});trowEnter.append("td").classed("legend-color-guide",!0).append("div").style("background-color",function(p){return p.color}),trowEnter.append("td").classed("key",!0).html(function(p,i){return keyFormatter(p.key,i)}),trowEnter.append("td").classed("value",!0).html(function(p,i){return valueFormatter(p.value,i)}),trowEnter.selectAll("td").each(function(p){if(p.highlight){var opacityScale=d3.scale.linear().domain([0,1]).range(["#fff",p.color]),opacity=.6;d3.select(this).style("border-bottom-color",opacityScale(opacity)).style("border-top-color",opacityScale(opacity))}});var html=table.node().outerHTML;return void 0!==d.footer&&(html+="<div class='footer'>"+d.footer+"</div>"),html},dataSeriesExists=function(d){if(d&&d.series){if(d.series instanceof Array)return!!d.series.length;if(d.series instanceof Object)return d.series=[d.series],!0}return!1},calcTooltipPosition=function(pos){tooltipElem&&nv.dom.read(function(){var left,top,height=parseInt(tooltipElem.offsetHeight,10),width=parseInt(tooltipElem.offsetWidth,10),windowWidth=nv.utils.windowSize().width,windowHeight=nv.utils.windowSize().height,scrollTop=window.pageYOffset,scrollLeft=window.pageXOffset;windowHeight=window.innerWidth>=document.body.scrollWidth?windowHeight:windowHeight-16,windowWidth=window.innerHeight>=document.body.scrollHeight?windowWidth:windowWidth-16;var tLeft,tTop,tooltipTop=function(Elem){var offsetTop=top;do isNaN(Elem.offsetTop)||(offsetTop+=Elem.offsetTop),Elem=Elem.offsetParent;while(Elem);return offsetTop},tooltipLeft=function(Elem){var offsetLeft=left;do isNaN(Elem.offsetLeft)||(offsetLeft+=Elem.offsetLeft),Elem=Elem.offsetParent;while(Elem);return offsetLeft};switch(gravity){case"e":left=pos[0]-width-distance,top=pos[1]-height/2,tLeft=tooltipLeft(tooltipElem),tTop=tooltipTop(tooltipElem),scrollLeft>tLeft&&(left=pos[0]+distance>scrollLeft?pos[0]+distance:scrollLeft-tLeft+left),scrollTop>tTop&&(top=scrollTop-tTop+top),tTop+height>scrollTop+windowHeight&&(top=scrollTop+windowHeight-tTop+top-height);break;case"w":left=pos[0]+distance,top=pos[1]-height/2,tLeft=tooltipLeft(tooltipElem),tTop=tooltipTop(tooltipElem),tLeft+width>windowWidth&&(left=pos[0]-width-distance),scrollTop>tTop&&(top=scrollTop+5),tTop+height>scrollTop+windowHeight&&(top=scrollTop+windowHeight-tTop+top-height);break;case"n":left=pos[0]-width/2-5,top=pos[1]+distance,tLeft=tooltipLeft(tooltipElem),tTop=tooltipTop(tooltipElem),scrollLeft>tLeft&&(left=scrollLeft+5),tLeft+width>windowWidth&&(left=left-width/2+5),tTop+height>scrollTop+windowHeight&&(top=scrollTop+windowHeight-tTop+top-height);break;case"s":left=pos[0]-width/2,top=pos[1]-height-distance,tLeft=tooltipLeft(tooltipElem),tTop=tooltipTop(tooltipElem),scrollLeft>tLeft&&(left=scrollLeft+5),tLeft+width>windowWidth&&(left=left-width/2+5),scrollTop>tTop&&(top=scrollTop);break;case"none":left=pos[0],top=pos[1]-distance,tLeft=tooltipLeft(tooltipElem),tTop=tooltipTop(tooltipElem)}left-=offset.left,top-=offset.top;var box=tooltipElem.getBoundingClientRect(),scrollTop=window.pageYOffset||document.documentElement.scrollTop,scrollLeft=window.pageXOffset||document.documentElement.scrollLeft,old_translate="translate("+(box.left+scrollLeft)+"px, "+(box.top+scrollTop)+"px)",new_translate="translate("+left+"px, "+top+"px)",translateInterpolator=d3.interpolateString(old_translate,new_translate),is_hidden=tooltip.style("opacity")<.1;hidden?tooltip.transition().delay(hideDelay).duration(0).style("opacity",0):tooltip.interrupt().transition().duration(is_hidden?0:duration).styleTween("transform",function(){return translateInterpolator},"important").style("-webkit-transform",new_translate).style("opacity",1)})};return nvtooltip.nvPointerEventsClass=nvPointerEventsClass,nvtooltip.options=nv.utils.optionsFunc.bind(nvtooltip),nvtooltip._options=Object.create({},{duration:{get:function(){return duration},set:function(_){duration=_}},gravity:{get:function(){return gravity},set:function(_){gravity=_}},distance:{get:function(){return distance},set:function(_){distance=_}},snapDistance:{get:function(){return snapDistance},set:function(_){snapDistance=_}},classes:{get:function(){return classes},set:function(_){classes=_}},chartContainer:{get:function(){return chartContainer},set:function(_){chartContainer=_}},fixedTop:{get:function(){return fixedTop},set:function(_){fixedTop=_}},enabled:{get:function(){return enabled},set:function(_){enabled=_}},hideDelay:{get:function(){return hideDelay},set:function(_){hideDelay=_}},contentGenerator:{get:function(){return contentGenerator},set:function(_){contentGenerator=_}},valueFormatter:{get:function(){return valueFormatter},set:function(_){valueFormatter=_}},headerFormatter:{get:function(){return headerFormatter},set:function(_){headerFormatter=_}},keyFormatter:{get:function(){return keyFormatter},set:function(_){keyFormatter=_}},headerEnabled:{get:function(){return headerEnabled},set:function(_){headerEnabled=_}},_isInteractiveLayer:{get:function(){return isInteractiveLayer},set:function(_){isInteractiveLayer=!!_}},position:{get:function(){return position},set:function(_){position.left=void 0!==_.left?_.left:position.left,position.top=void 0!==_.top?_.top:position.top}},offset:{get:function(){return offset},set:function(_){offset.left=void 0!==_.left?_.left:offset.left,offset.top=void 0!==_.top?_.top:offset.top}},hidden:{get:function(){return hidden},set:function(_){hidden!=_&&(hidden=!!_,nvtooltip())}},data:{get:function(){return data},set:function(_){_.point&&(_.value=_.point.x,_.series=_.series||{},_.series.value=_.point.y,_.series.color=_.point.color||_.series.color),data=_}},tooltipElem:{get:function(){return tooltipElem},set:function(){}},id:{get:function(){return id},set:function(){}}}),nv.utils.initOptions(nvtooltip),nvtooltip}}(),nv.utils.windowSize=function(){var size={width:640,height:480};return window.innerWidth&&window.innerHeight?(size.width=window.innerWidth,size.height=window.innerHeight,size):"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth?(size.width=document.documentElement.offsetWidth,size.height=document.documentElement.offsetHeight,size):document.body&&document.body.offsetWidth?(size.width=document.body.offsetWidth,size.height=document.body.offsetHeight,size):size},nv.utils.windowResize=function(handler){return window.addEventListener?window.addEventListener("resize",handler):nv.log("ERROR: Failed to bind to window.resize with: ",handler),{callback:handler,clear:function(){window.removeEventListener("resize",handler)}}},nv.utils.getColor=function(color){if(void 0===color)return nv.utils.defaultColor();if(Array.isArray(color)){var color_scale=d3.scale.ordinal().range(color);return function(d,i){var key=void 0===i?d:i;return d.color||color_scale(key)}}return color},nv.utils.defaultColor=function(){return nv.utils.getColor(d3.scale.category20().range())},nv.utils.customTheme=function(dictionary,getKey,defaultColors){getKey=getKey||function(series){return series.key},defaultColors=defaultColors||d3.scale.category20().range();var defIndex=defaultColors.length;return function(series){var key=getKey(series);return"function"==typeof dictionary[key]?dictionary[key]():void 0!==dictionary[key]?dictionary[key]:(defIndex||(defIndex=defaultColors.length),defIndex-=1,defaultColors[defIndex])}},nv.utils.pjax=function(links,content){var load=function(href){d3.html(href,function(fragment){var target=d3.select(content).node();target.parentNode.replaceChild(d3.select(fragment).select(content).node(),target),nv.utils.pjax(links,content)})};d3.selectAll(links).on("click",function(){history.pushState(this.href,this.textContent,this.href),load(this.href),d3.event.preventDefault()}),d3.select(window).on("popstate",function(){d3.event.state&&load(d3.event.state)
})},nv.utils.calcApproxTextWidth=function(svgTextElem){if("function"==typeof svgTextElem.style&&"function"==typeof svgTextElem.text){var fontSize=parseInt(svgTextElem.style("font-size").replace("px",""),10),textLength=svgTextElem.text().length;return textLength*fontSize*.5}return 0},nv.utils.NaNtoZero=function(n){return"number"!=typeof n||isNaN(n)||null===n||1/0===n||n===-1/0?0:n},d3.selection.prototype.watchTransition=function(renderWatch){var args=[this].concat([].slice.call(arguments,1));return renderWatch.transition.apply(renderWatch,args)},nv.utils.renderWatch=function(dispatch,duration){if(!(this instanceof nv.utils.renderWatch))return new nv.utils.renderWatch(dispatch,duration);var _duration=void 0!==duration?duration:250,renderStack=[],self=this;this.models=function(models){return models=[].slice.call(arguments,0),models.forEach(function(model){model.__rendered=!1,function(m){m.dispatch.on("renderEnd",function(){m.__rendered=!0,self.renderEnd("model")})}(model),renderStack.indexOf(model)<0&&renderStack.push(model)}),this},this.reset=function(duration){void 0!==duration&&(_duration=duration),renderStack=[]},this.transition=function(selection,args,duration){if(args=arguments.length>1?[].slice.call(arguments,1):[],duration=args.length>1?args.pop():void 0!==_duration?_duration:250,selection.__rendered=!1,renderStack.indexOf(selection)<0&&renderStack.push(selection),0===duration)return selection.__rendered=!0,selection.delay=function(){return this},selection.duration=function(){return this},selection;selection.__rendered=0===selection.length?!0:selection.every(function(d){return!d.length})?!0:!1;var n=0;return selection.transition().duration(duration).each(function(){++n}).each("end",function(){0===--n&&(selection.__rendered=!0,self.renderEnd.apply(this,args))})},this.renderEnd=function(){renderStack.every(function(d){return d.__rendered})&&(renderStack.forEach(function(d){d.__rendered=!1}),dispatch.renderEnd.apply(this,arguments))}},nv.utils.deepExtend=function(dst){var sources=arguments.length>1?[].slice.call(arguments,1):[];sources.forEach(function(source){for(var key in source){var isArray=dst[key]instanceof Array,isObject="object"==typeof dst[key],srcObj="object"==typeof source[key];isObject&&!isArray&&srcObj?nv.utils.deepExtend(dst[key],source[key]):dst[key]=source[key]}})},nv.utils.state=function(){if(!(this instanceof nv.utils.state))return new nv.utils.state;var state={},_setState=function(){},_getState=function(){return{}},init=null,changed=null;this.dispatch=d3.dispatch("change","set"),this.dispatch.on("set",function(state){_setState(state,!0)}),this.getter=function(fn){return _getState=fn,this},this.setter=function(fn,callback){return callback||(callback=function(){}),_setState=function(state,update){fn(state),update&&callback()},this},this.init=function(state){init=init||{},nv.utils.deepExtend(init,state)};var _set=function(){var settings=_getState();if(JSON.stringify(settings)===JSON.stringify(state))return!1;for(var key in settings)void 0===state[key]&&(state[key]={}),state[key]=settings[key],changed=!0;return!0};this.update=function(){init&&(_setState(init,!1),init=null),_set.call(this)&&this.dispatch.change(state)}},nv.utils.optionsFunc=function(args){return args&&d3.map(args).forEach(function(key,value){"function"==typeof this[key]&&this[key](value)}.bind(this)),this},nv.utils.calcTicksX=function(numTicks,data){var numValues=1,i=0;for(i;i<data.length;i+=1){var stream_len=data[i]&&data[i].values?data[i].values.length:0;numValues=stream_len>numValues?stream_len:numValues}return nv.log("Requested number of ticks: ",numTicks),nv.log("Calculated max values to be: ",numValues),numTicks=numTicks>numValues?numTicks=numValues-1:numTicks,numTicks=1>numTicks?1:numTicks,numTicks=Math.floor(numTicks),nv.log("Calculating tick count as: ",numTicks),numTicks},nv.utils.calcTicksY=function(numTicks,data){return nv.utils.calcTicksX(numTicks,data)},nv.utils.initOption=function(chart,name){chart._calls&&chart._calls[name]?chart[name]=chart._calls[name]:(chart[name]=function(_){return arguments.length?(chart._overrides[name]=!0,chart._options[name]=_,chart):chart._options[name]},chart["_"+name]=function(_){return arguments.length?(chart._overrides[name]||(chart._options[name]=_),chart):chart._options[name]})},nv.utils.initOptions=function(chart){chart._overrides=chart._overrides||{};var ops=Object.getOwnPropertyNames(chart._options||{}),calls=Object.getOwnPropertyNames(chart._calls||{});ops=ops.concat(calls);for(var i in ops)nv.utils.initOption(chart,ops[i])},nv.utils.inheritOptionsD3=function(target,d3_source,oplist){target._d3options=oplist.concat(target._d3options||[]),oplist.unshift(d3_source),oplist.unshift(target),d3.rebind.apply(this,oplist)},nv.utils.arrayUnique=function(a){return a.sort().filter(function(item,pos){return!pos||item!=a[pos-1]})},nv.utils.symbolMap=d3.map(),nv.utils.symbol=function(){function symbol(d,i){var t=type.call(this,d,i),s=size.call(this,d,i);return-1!==d3.svg.symbolTypes.indexOf(t)?d3.svg.symbol().type(t).size(s)():nv.utils.symbolMap.get(t)(s)}var type,size=64;return symbol.type=function(_){return arguments.length?(type=d3.functor(_),symbol):type},symbol.size=function(_){return arguments.length?(size=d3.functor(_),symbol):size},symbol},nv.utils.inheritOptions=function(target,source){var ops=Object.getOwnPropertyNames(source._options||{}),calls=Object.getOwnPropertyNames(source._calls||{}),inherited=source._inherited||[],d3ops=source._d3options||[],args=ops.concat(calls).concat(inherited).concat(d3ops);args.unshift(source),args.unshift(target),d3.rebind.apply(this,args),target._inherited=nv.utils.arrayUnique(ops.concat(calls).concat(inherited).concat(ops).concat(target._inherited||[])),target._d3options=nv.utils.arrayUnique(d3ops.concat(target._d3options||[]))},nv.utils.initSVG=function(svg){svg.classed({"nvd3-svg":!0})},nv.utils.sanitizeHeight=function(height,container){return height||parseInt(container.style("height"),10)||400},nv.utils.sanitizeWidth=function(width,container){return width||parseInt(container.style("width"),10)||960},nv.utils.availableHeight=function(height,container,margin){return nv.utils.sanitizeHeight(height,container)-margin.top-margin.bottom},nv.utils.availableWidth=function(width,container,margin){return nv.utils.sanitizeWidth(width,container)-margin.left-margin.right},nv.utils.noData=function(chart,container){var opt=chart.options(),margin=opt.margin(),noData=opt.noData(),data=null==noData?["No Data Available."]:[noData],height=nv.utils.availableHeight(opt.height(),container,margin),width=nv.utils.availableWidth(opt.width(),container,margin),x=margin.left+width/2,y=margin.top+height/2;container.selectAll("g").remove();var noDataText=container.selectAll(".nv-noData").data(data);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),noDataText.attr("x",x).attr("y",y).text(function(t){return t})},nv.models.axis=function(){"use strict";function chart(selection){return renderWatch.reset(),selection.each(function(data){var container=d3.select(this);nv.utils.initSVG(container);var wrap=container.selectAll("g.nv-wrap.nv-axis").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-axis"),g=(wrapEnter.append("g"),wrap.select("g"));null!==ticks?axis.ticks(ticks):("top"==axis.orient()||"bottom"==axis.orient())&&axis.ticks(Math.abs(scale.range()[1]-scale.range()[0])/100),g.watchTransition(renderWatch,"axis").call(axis),scale0=scale0||axis.scale();var fmt=axis.tickFormat();null==fmt&&(fmt=scale0.tickFormat());var axisLabel=g.selectAll("text.nv-axislabel").data([axisLabelText||null]);axisLabel.exit().remove();var xLabelMargin,axisMaxMin,w;switch(axis.orient()){case"top":axisLabel.enter().append("text").attr("class","nv-axislabel"),w=scale.range().length<2?0:2===scale.range().length?scale.range()[1]:scale.range()[scale.range().length-1]+(scale.range()[1]-scale.range()[0]),axisLabel.attr("text-anchor","middle").attr("y",0).attr("x",w/2),showMaxMin&&(axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data(scale.domain()),axisMaxMin.enter().append("g").attr("class",function(d,i){return["nv-axisMaxMin","nv-axisMaxMin-x",0==i?"nv-axisMin-x":"nv-axisMax-x"].join(" ")}).append("text"),axisMaxMin.exit().remove(),axisMaxMin.attr("transform",function(d){return"translate("+nv.utils.NaNtoZero(scale(d))+",0)"}).select("text").attr("dy","-0.5em").attr("y",-axis.tickPadding()).attr("text-anchor","middle").text(function(d){var v=fmt(d);return(""+v).match("NaN")?"":v}),axisMaxMin.watchTransition(renderWatch,"min-max top").attr("transform",function(d,i){return"translate("+nv.utils.NaNtoZero(scale.range()[i])+",0)"}));break;case"bottom":xLabelMargin=axisLabelDistance+36;var maxTextWidth=30,textHeight=0,xTicks=g.selectAll("g").select("text"),rotateLabelsRule="";if(rotateLabels%360){xTicks.each(function(){var box=this.getBoundingClientRect(),width=box.width;textHeight=box.height,width>maxTextWidth&&(maxTextWidth=width)}),rotateLabelsRule="rotate("+rotateLabels+" 0,"+(textHeight/2+axis.tickPadding())+")";var sin=Math.abs(Math.sin(rotateLabels*Math.PI/180));xLabelMargin=(sin?sin*maxTextWidth:maxTextWidth)+30,xTicks.attr("transform",rotateLabelsRule).style("text-anchor",rotateLabels%360>0?"start":"end")}axisLabel.enter().append("text").attr("class","nv-axislabel"),w=scale.range().length<2?0:2===scale.range().length?scale.range()[1]:scale.range()[scale.range().length-1]+(scale.range()[1]-scale.range()[0]),axisLabel.attr("text-anchor","middle").attr("y",xLabelMargin).attr("x",w/2),showMaxMin&&(axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data([scale.domain()[0],scale.domain()[scale.domain().length-1]]),axisMaxMin.enter().append("g").attr("class",function(d,i){return["nv-axisMaxMin","nv-axisMaxMin-x",0==i?"nv-axisMin-x":"nv-axisMax-x"].join(" ")}).append("text"),axisMaxMin.exit().remove(),axisMaxMin.attr("transform",function(d){return"translate("+nv.utils.NaNtoZero(scale(d)+(isOrdinal?scale.rangeBand()/2:0))+",0)"}).select("text").attr("dy",".71em").attr("y",axis.tickPadding()).attr("transform",rotateLabelsRule).style("text-anchor",rotateLabels?rotateLabels%360>0?"start":"end":"middle").text(function(d){var v=fmt(d);return(""+v).match("NaN")?"":v}),axisMaxMin.watchTransition(renderWatch,"min-max bottom").attr("transform",function(d){return"translate("+nv.utils.NaNtoZero(scale(d)+(isOrdinal?scale.rangeBand()/2:0))+",0)"})),staggerLabels&&xTicks.attr("transform",function(d,i){return"translate(0,"+(i%2==0?"0":"12")+")"});break;case"right":axisLabel.enter().append("text").attr("class","nv-axislabel"),axisLabel.style("text-anchor",rotateYLabel?"middle":"begin").attr("transform",rotateYLabel?"rotate(90)":"").attr("y",rotateYLabel?-Math.max(margin.right,width)+12:-10).attr("x",rotateYLabel?d3.max(scale.range())/2:axis.tickPadding()),showMaxMin&&(axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data(scale.domain()),axisMaxMin.enter().append("g").attr("class",function(d,i){return["nv-axisMaxMin","nv-axisMaxMin-y",0==i?"nv-axisMin-y":"nv-axisMax-y"].join(" ")}).append("text").style("opacity",0),axisMaxMin.exit().remove(),axisMaxMin.attr("transform",function(d){return"translate(0,"+nv.utils.NaNtoZero(scale(d))+")"}).select("text").attr("dy",".32em").attr("y",0).attr("x",axis.tickPadding()).style("text-anchor","start").text(function(d){var v=fmt(d);return(""+v).match("NaN")?"":v}),axisMaxMin.watchTransition(renderWatch,"min-max right").attr("transform",function(d,i){return"translate(0,"+nv.utils.NaNtoZero(scale.range()[i])+")"}).select("text").style("opacity",1));break;case"left":axisLabel.enter().append("text").attr("class","nv-axislabel"),axisLabel.style("text-anchor",rotateYLabel?"middle":"end").attr("transform",rotateYLabel?"rotate(-90)":"").attr("y",rotateYLabel?-Math.max(margin.left,width)+25-(axisLabelDistance||0):-10).attr("x",rotateYLabel?-d3.max(scale.range())/2:-axis.tickPadding()),showMaxMin&&(axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data(scale.domain()),axisMaxMin.enter().append("g").attr("class",function(d,i){return["nv-axisMaxMin","nv-axisMaxMin-y",0==i?"nv-axisMin-y":"nv-axisMax-y"].join(" ")}).append("text").style("opacity",0),axisMaxMin.exit().remove(),axisMaxMin.attr("transform",function(d){return"translate(0,"+nv.utils.NaNtoZero(scale0(d))+")"}).select("text").attr("dy",".32em").attr("y",0).attr("x",-axis.tickPadding()).attr("text-anchor","end").text(function(d){var v=fmt(d);return(""+v).match("NaN")?"":v}),axisMaxMin.watchTransition(renderWatch,"min-max right").attr("transform",function(d,i){return"translate(0,"+nv.utils.NaNtoZero(scale.range()[i])+")"}).select("text").style("opacity",1))}if(axisLabel.text(function(d){return d}),!showMaxMin||"left"!==axis.orient()&&"right"!==axis.orient()||(g.selectAll("g").each(function(d){d3.select(this).select("text").attr("opacity",1),(scale(d)<scale.range()[1]+10||scale(d)>scale.range()[0]-10)&&((d>1e-10||-1e-10>d)&&d3.select(this).attr("opacity",0),d3.select(this).select("text").attr("opacity",0))}),scale.domain()[0]==scale.domain()[1]&&0==scale.domain()[0]&&wrap.selectAll("g.nv-axisMaxMin").style("opacity",function(d,i){return i?0:1})),showMaxMin&&("top"===axis.orient()||"bottom"===axis.orient())){var maxMinRange=[];wrap.selectAll("g.nv-axisMaxMin").each(function(d,i){try{maxMinRange.push(i?scale(d)-this.getBoundingClientRect().width-4:scale(d)+this.getBoundingClientRect().width+4)}catch(err){maxMinRange.push(i?scale(d)-4:scale(d)+4)}}),g.selectAll("g").each(function(d){(scale(d)<maxMinRange[0]||scale(d)>maxMinRange[1])&&(d>1e-10||-1e-10>d?d3.select(this).remove():d3.select(this).select("text").remove())})}g.selectAll(".tick").filter(function(d){return!parseFloat(Math.round(1e5*d)/1e6)&&void 0!==d}).classed("zero",!0),scale0=scale.copy()}),renderWatch.renderEnd("axis immediate"),chart}var axis=d3.svg.axis(),scale=d3.scale.linear(),margin={top:0,right:0,bottom:0,left:0},width=75,height=60,axisLabelText=null,showMaxMin=!0,rotateLabels=0,rotateYLabel=!0,staggerLabels=!1,isOrdinal=!1,ticks=null,axisLabelDistance=0,duration=250,dispatch=d3.dispatch("renderEnd");axis.scale(scale).orient("bottom").tickFormat(function(d){return d});var scale0,renderWatch=nv.utils.renderWatch(dispatch,duration);return chart.axis=axis,chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{axisLabelDistance:{get:function(){return axisLabelDistance},set:function(_){axisLabelDistance=_}},staggerLabels:{get:function(){return staggerLabels},set:function(_){staggerLabels=_}},rotateLabels:{get:function(){return rotateLabels},set:function(_){rotateLabels=_}},rotateYLabel:{get:function(){return rotateYLabel},set:function(_){rotateYLabel=_}},showMaxMin:{get:function(){return showMaxMin},set:function(_){showMaxMin=_}},axisLabel:{get:function(){return axisLabelText},set:function(_){axisLabelText=_}},height:{get:function(){return height},set:function(_){height=_}},ticks:{get:function(){return ticks},set:function(_){ticks=_}},width:{get:function(){return width},set:function(_){width=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration)}},scale:{get:function(){return scale},set:function(_){scale=_,axis.scale(scale),isOrdinal="function"==typeof scale.rangeBands,nv.utils.inheritOptionsD3(chart,scale,["domain","range","rangeBand","rangeBands"])}}}),nv.utils.initOptions(chart),nv.utils.inheritOptionsD3(chart,axis,["orient","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat"]),nv.utils.inheritOptionsD3(chart,scale,["domain","range","rangeBand","rangeBands"]),chart},nv.models.boxPlot=function(){"use strict";function chart(selection){return renderWatch.reset(),selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom;container=d3.select(this),nv.utils.initSVG(container),x.domain(xDomain||data.map(function(d,i){return getX(d,i)})).rangeBands(xRange||[0,availableWidth],.1);var yData=[];if(!yDomain){var yMin=d3.min(data.map(function(d){var min_arr=[];return min_arr.push(d.values.Q1),d.values.hasOwnProperty("whisker_low")&&null!==d.values.whisker_low&&min_arr.push(d.values.whisker_low),d.values.hasOwnProperty("outliers")&&null!==d.values.outliers&&(min_arr=min_arr.concat(d.values.outliers)),d3.min(min_arr)})),yMax=d3.max(data.map(function(d){var max_arr=[];return max_arr.push(d.values.Q3),d.values.hasOwnProperty("whisker_high")&&null!==d.values.whisker_high&&max_arr.push(d.values.whisker_high),d.values.hasOwnProperty("outliers")&&null!==d.values.outliers&&(max_arr=max_arr.concat(d.values.outliers)),d3.max(max_arr)}));yData=[yMin,yMax]}y.domain(yDomain||yData),y.range(yRange||[availableHeight,0]),x0=x0||x,y0=y0||y.copy().range([y(0),y(0)]);{var wrap=container.selectAll("g.nv-wrap").data([data]);wrap.enter().append("g").attr("class","nvd3 nv-wrap")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");var boxplots=wrap.selectAll(".nv-boxplot").data(function(d){return d}),boxEnter=boxplots.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6);boxplots.attr("class","nv-boxplot").attr("transform",function(d,i){return"translate("+(x(getX(d,i))+.05*x.rangeBand())+", 0)"}).classed("hover",function(d){return d.hover}),boxplots.watchTransition(renderWatch,"nv-boxplot: boxplots").style("stroke-opacity",1).style("fill-opacity",.75).delay(function(d,i){return i*duration/data.length}).attr("transform",function(d,i){return"translate("+(x(getX(d,i))+.05*x.rangeBand())+", 0)"}),boxplots.exit().remove(),boxEnter.each(function(d,i){var box=d3.select(this);["low","high"].forEach(function(key){d.values.hasOwnProperty("whisker_"+key)&&null!==d.values["whisker_"+key]&&(box.append("line").style("stroke",d.color?d.color:color(d,i)).attr("class","nv-boxplot-whisker nv-boxplot-"+key),box.append("line").style("stroke",d.color?d.color:color(d,i)).attr("class","nv-boxplot-tick nv-boxplot-"+key))})});var outliers=boxplots.selectAll(".nv-boxplot-outlier").data(function(d){return d.values.hasOwnProperty("outliers")&&null!==d.values.outliers?d.values.outliers:[]});outliers.enter().append("circle").style("fill",function(d,i,j){return color(d,j)}).style("stroke",function(d,i,j){return color(d,j)}).on("mouseover",function(d,i,j){d3.select(this).classed("hover",!0),dispatch.elementMouseover({series:{key:d,color:color(d,j)},e:d3.event})}).on("mouseout",function(d,i,j){d3.select(this).classed("hover",!1),dispatch.elementMouseout({series:{key:d,color:color(d,j)},e:d3.event})}).on("mousemove",function(){dispatch.elementMousemove({e:d3.event})}),outliers.attr("class","nv-boxplot-outlier"),outliers.watchTransition(renderWatch,"nv-boxplot: nv-boxplot-outlier").attr("cx",.45*x.rangeBand()).attr("cy",function(d){return y(d)}).attr("r","3"),outliers.exit().remove();var box_width=function(){return null===maxBoxWidth?.9*x.rangeBand():Math.min(75,.9*x.rangeBand())},box_left=function(){return.45*x.rangeBand()-box_width()/2},box_right=function(){return.45*x.rangeBand()+box_width()/2};["low","high"].forEach(function(key){var endpoint="low"===key?"Q1":"Q3";boxplots.select("line.nv-boxplot-whisker.nv-boxplot-"+key).watchTransition(renderWatch,"nv-boxplot: boxplots").attr("x1",.45*x.rangeBand()).attr("y1",function(d){return y(d.values["whisker_"+key])}).attr("x2",.45*x.rangeBand()).attr("y2",function(d){return y(d.values[endpoint])}),boxplots.select("line.nv-boxplot-tick.nv-boxplot-"+key).watchTransition(renderWatch,"nv-boxplot: boxplots").attr("x1",box_left).attr("y1",function(d){return y(d.values["whisker_"+key])}).attr("x2",box_right).attr("y2",function(d){return y(d.values["whisker_"+key])})}),["low","high"].forEach(function(key){boxEnter.selectAll(".nv-boxplot-"+key).on("mouseover",function(d,i,j){d3.select(this).classed("hover",!0),dispatch.elementMouseover({series:{key:d.values["whisker_"+key],color:color(d,j)},e:d3.event})}).on("mouseout",function(d,i,j){d3.select(this).classed("hover",!1),dispatch.elementMouseout({series:{key:d.values["whisker_"+key],color:color(d,j)},e:d3.event})}).on("mousemove",function(){dispatch.elementMousemove({e:d3.event})})}),boxEnter.append("rect").attr("class","nv-boxplot-box").on("mouseover",function(d,i){d3.select(this).classed("hover",!0),dispatch.elementMouseover({key:d.label,value:d.label,series:[{key:"Q3",value:d.values.Q3,color:d.color||color(d,i)},{key:"Q2",value:d.values.Q2,color:d.color||color(d,i)},{key:"Q1",value:d.values.Q1,color:d.color||color(d,i)}],data:d,index:i,e:d3.event})}).on("mouseout",function(d,i){d3.select(this).classed("hover",!1),dispatch.elementMouseout({key:d.label,value:d.label,series:[{key:"Q3",value:d.values.Q3,color:d.color||color(d,i)},{key:"Q2",value:d.values.Q2,color:d.color||color(d,i)},{key:"Q1",value:d.values.Q1,color:d.color||color(d,i)}],data:d,index:i,e:d3.event})}).on("mousemove",function(){dispatch.elementMousemove({e:d3.event})}),boxplots.select("rect.nv-boxplot-box").watchTransition(renderWatch,"nv-boxplot: boxes").attr("y",function(d){return y(d.values.Q3)}).attr("width",box_width).attr("x",box_left).attr("height",function(d){return Math.abs(y(d.values.Q3)-y(d.values.Q1))||1}).style("fill",function(d,i){return d.color||color(d,i)}).style("stroke",function(d,i){return d.color||color(d,i)}),boxEnter.append("line").attr("class","nv-boxplot-median"),boxplots.select("line.nv-boxplot-median").watchTransition(renderWatch,"nv-boxplot: boxplots line").attr("x1",box_left).attr("y1",function(d){return y(d.values.Q2)}).attr("x2",box_right).attr("y2",function(d){return y(d.values.Q2)}),x0=x.copy(),y0=y.copy()}),renderWatch.renderEnd("nv-boxplot immediate"),chart}var xDomain,yDomain,xRange,yRange,x0,y0,margin={top:0,right:0,bottom:0,left:0},width=960,height=500,id=Math.floor(1e4*Math.random()),x=d3.scale.ordinal(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},color=nv.utils.defaultColor(),container=null,dispatch=d3.dispatch("elementMouseover","elementMouseout","elementMousemove","renderEnd"),duration=250,maxBoxWidth=null,renderWatch=nv.utils.renderWatch(dispatch,duration);return chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},maxBoxWidth:{get:function(){return maxBoxWidth},set:function(_){maxBoxWidth=_}},x:{get:function(){return getX},set:function(_){getX=_}},y:{get:function(){return getY},set:function(_){getY=_}},xScale:{get:function(){return x},set:function(_){x=_}},yScale:{get:function(){return y},set:function(_){y=_}},xDomain:{get:function(){return xDomain},set:function(_){xDomain=_}},yDomain:{get:function(){return yDomain},set:function(_){yDomain=_}},xRange:{get:function(){return xRange},set:function(_){xRange=_}},yRange:{get:function(){return yRange},set:function(_){yRange=_}},id:{get:function(){return id},set:function(_){id=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration)}}}),nv.utils.initOptions(chart),chart},nv.models.boxPlotChart=function(){"use strict";function chart(selection){return renderWatch.reset(),renderWatch.models(boxplot),showXAxis&&renderWatch.models(xAxis),showYAxis&&renderWatch.models(yAxis),selection.each(function(data){var container=d3.select(this);nv.utils.initSVG(container);var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;if(chart.update=function(){dispatch.beforeUpdate(),container.transition().duration(duration).call(chart)},chart.container=this,!(data&&data.length&&data.filter(function(d){return d.values.hasOwnProperty("Q1")&&d.values.hasOwnProperty("Q2")&&d.values.hasOwnProperty("Q3")}).length)){var noDataText=container.selectAll(".nv-noData").data([noData]);return noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d}),chart}container.selectAll(".nv-noData").remove(),x=boxplot.xScale(),y=boxplot.yScale().clamp(!0);var wrap=container.selectAll("g.nv-wrap.nv-boxPlotWithAxes").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-boxPlotWithAxes").append("g"),defsEnter=gEnter.append("defs"),g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis"),gEnter.append("g").attr("class","nv-y nv-axis").append("g").attr("class","nv-zeroLine").append("line"),gEnter.append("g").attr("class","nv-barsWrap"),g.attr("transform","translate("+margin.left+","+margin.top+")"),rightAlignYAxis&&g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)"),boxplot.width(availableWidth).height(availableHeight);var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return!d.disabled}));if(barsWrap.transition().call(boxplot),defsEnter.append("clipPath").attr("id","nv-x-label-clip-"+boxplot.id()).append("rect"),g.select("#nv-x-label-clip-"+boxplot.id()+" rect").attr("width",x.rangeBand()*(staggerLabels?2:1)).attr("height",16).attr("x",-x.rangeBand()/(staggerLabels?1:2)),showXAxis){xAxis.scale(x).ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight,0),g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")"),g.select(".nv-x.nv-axis").call(xAxis);var xTicks=g.select(".nv-x.nv-axis").selectAll("g");staggerLabels&&xTicks.selectAll("text").attr("transform",function(d,i,j){return"translate(0,"+(j%2==0?"5":"17")+")"})}showYAxis&&(yAxis.scale(y).ticks(Math.floor(availableHeight/36)).tickSize(-availableWidth,0),g.select(".nv-y.nv-axis").call(yAxis)),g.select(".nv-zeroLine line").attr("x1",0).attr("x2",availableWidth).attr("y1",y(0)).attr("y2",y(0))}),renderWatch.renderEnd("nv-boxplot chart immediate"),chart}var x,y,boxplot=nv.models.boxPlot(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),margin={top:15,right:10,bottom:50,left:60},width=null,height=null,color=nv.utils.getColor(),showXAxis=!0,showYAxis=!0,rightAlignYAxis=!1,staggerLabels=!1,tooltip=nv.models.tooltip(),noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","beforeUpdate","renderEnd"),duration=250;xAxis.orient("bottom").showMaxMin(!1).tickFormat(function(d){return d}),yAxis.orient(rightAlignYAxis?"right":"left").tickFormat(d3.format(",.1f")),tooltip.duration(0);var renderWatch=nv.utils.renderWatch(dispatch,duration);return boxplot.dispatch.on("elementMouseover.tooltip",function(evt){tooltip.data(evt).hidden(!1)}),boxplot.dispatch.on("elementMouseout.tooltip",function(evt){tooltip.data(evt).hidden(!0)}),boxplot.dispatch.on("elementMousemove.tooltip",function(){tooltip.position({top:d3.event.pageY,left:d3.event.pageX})()}),chart.dispatch=dispatch,chart.boxplot=boxplot,chart.xAxis=xAxis,chart.yAxis=yAxis,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},staggerLabels:{get:function(){return staggerLabels},set:function(_){staggerLabels=_}},showXAxis:{get:function(){return showXAxis},set:function(_){showXAxis=_}},showYAxis:{get:function(){return showYAxis},set:function(_){showYAxis=_}},tooltips:{get:function(){return tooltips},set:function(_){tooltips=_}},tooltipContent:{get:function(){return tooltip},set:function(_){tooltip=_}},noData:{get:function(){return noData},set:function(_){noData=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration),boxplot.duration(duration),xAxis.duration(duration),yAxis.duration(duration)}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),boxplot.color(color)}},rightAlignYAxis:{get:function(){return rightAlignYAxis},set:function(_){rightAlignYAxis=_,yAxis.orient(_?"right":"left")}}}),nv.utils.inheritOptions(chart,boxplot),nv.utils.initOptions(chart),chart},nv.models.bullet=function(){"use strict";function chart(selection){return selection.each(function(d,i){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom;container=d3.select(this),nv.utils.initSVG(container);{var rangez=ranges.call(this,d,i).slice().sort(d3.descending),markerz=markers.call(this,d,i).slice().sort(d3.descending),measurez=measures.call(this,d,i).slice().sort(d3.descending),rangeLabelz=rangeLabels.call(this,d,i).slice(),markerLabelz=markerLabels.call(this,d,i).slice(),measureLabelz=measureLabels.call(this,d,i).slice(),x1=d3.scale.linear().domain(d3.extent(d3.merge([forceX,rangez]))).range(reverse?[availableWidth,0]:[0,availableWidth]);this.__chart__||d3.scale.linear().domain([0,1/0]).range(x1.range())}this.__chart__=x1;var rangeMin=d3.min(rangez),rangeMax=d3.max(rangez),rangeAvg=rangez[1],wrap=container.selectAll("g.nv-wrap.nv-bullet").data([d]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-bullet"),gEnter=wrapEnter.append("g"),g=wrap.select("g");gEnter.append("rect").attr("class","nv-range nv-rangeMax"),gEnter.append("rect").attr("class","nv-range nv-rangeAvg"),gEnter.append("rect").attr("class","nv-range nv-rangeMin"),gEnter.append("rect").attr("class","nv-measure"),wrap.attr("transform","translate("+margin.left+","+margin.top+")");var w1=function(d){return Math.abs(x1(d)-x1(0))},xp1=function(d){return x1(0>d?d:0)};g.select("rect.nv-rangeMax").attr("height",availableHeight).attr("width",w1(rangeMax>0?rangeMax:rangeMin)).attr("x",xp1(rangeMax>0?rangeMax:rangeMin)).datum(rangeMax>0?rangeMax:rangeMin),g.select("rect.nv-rangeAvg").attr("height",availableHeight).attr("width",w1(rangeAvg)).attr("x",xp1(rangeAvg)).datum(rangeAvg),g.select("rect.nv-rangeMin").attr("height",availableHeight).attr("width",w1(rangeMax)).attr("x",xp1(rangeMax)).attr("width",w1(rangeMax>0?rangeMin:rangeMax)).attr("x",xp1(rangeMax>0?rangeMin:rangeMax)).datum(rangeMax>0?rangeMin:rangeMax),g.select("rect.nv-measure").style("fill",color).attr("height",availableHeight/3).attr("y",availableHeight/3).attr("width",0>measurez?x1(0)-x1(measurez[0]):x1(measurez[0])-x1(0)).attr("x",xp1(measurez)).on("mouseover",function(){dispatch.elementMouseover({value:measurez[0],label:measureLabelz[0]||"Current",color:d3.select(this).style("fill")})}).on("mousemove",function(){dispatch.elementMousemove({value:measurez[0],label:measureLabelz[0]||"Current",color:d3.select(this).style("fill")})}).on("mouseout",function(){dispatch.elementMouseout({value:measurez[0],label:measureLabelz[0]||"Current",color:d3.select(this).style("fill")})});var h3=availableHeight/6,markerData=markerz.map(function(marker,index){return{value:marker,label:markerLabelz[index]}});gEnter.selectAll("path.nv-markerTriangle").data(markerData).enter().append("path").attr("class","nv-markerTriangle").attr("transform",function(d){return"translate("+x1(d.value)+","+availableHeight/2+")"}).attr("d","M0,"+h3+"L"+h3+","+-h3+" "+-h3+","+-h3+"Z").on("mouseover",function(d){dispatch.elementMouseover({value:d.value,label:d.label||"Previous",color:d3.select(this).style("fill"),pos:[x1(d.value),availableHeight/2]})
}).on("mousemove",function(d){dispatch.elementMousemove({value:d.value,label:d.label||"Previous",color:d3.select(this).style("fill")})}).on("mouseout",function(d){dispatch.elementMouseout({value:d.value,label:d.label||"Previous",color:d3.select(this).style("fill")})}),wrap.selectAll(".nv-range").on("mouseover",function(d,i){var label=rangeLabelz[i]||(i?1==i?"Mean":"Minimum":"Maximum");dispatch.elementMouseover({value:d,label:label,color:d3.select(this).style("fill")})}).on("mousemove",function(){dispatch.elementMousemove({value:measurez[0],label:measureLabelz[0]||"Previous",color:d3.select(this).style("fill")})}).on("mouseout",function(d,i){var label=rangeLabelz[i]||(i?1==i?"Mean":"Minimum":"Maximum");dispatch.elementMouseout({value:d,label:label,color:d3.select(this).style("fill")})})}),chart}var margin={top:0,right:0,bottom:0,left:0},orient="left",reverse=!1,ranges=function(d){return d.ranges},markers=function(d){return d.markers?d.markers:[0]},measures=function(d){return d.measures},rangeLabels=function(d){return d.rangeLabels?d.rangeLabels:[]},markerLabels=function(d){return d.markerLabels?d.markerLabels:[]},measureLabels=function(d){return d.measureLabels?d.measureLabels:[]},forceX=[0],width=380,height=30,container=null,tickFormat=null,color=nv.utils.getColor(["#1f77b4"]),dispatch=d3.dispatch("elementMouseover","elementMouseout","elementMousemove");return chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{ranges:{get:function(){return ranges},set:function(_){ranges=_}},markers:{get:function(){return markers},set:function(_){markers=_}},measures:{get:function(){return measures},set:function(_){measures=_}},forceX:{get:function(){return forceX},set:function(_){forceX=_}},width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},tickFormat:{get:function(){return tickFormat},set:function(_){tickFormat=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},orient:{get:function(){return orient},set:function(_){orient=_,reverse="right"==orient||"bottom"==orient}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}}}),nv.utils.initOptions(chart),chart},nv.models.bulletChart=function(){"use strict";function chart(selection){return selection.each(function(d,i){var container=d3.select(this);nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=height-margin.top-margin.bottom;if(chart.update=function(){chart(selection)},chart.container=this,!d||!ranges.call(this,d,i))return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove();var rangez=ranges.call(this,d,i).slice().sort(d3.descending),markerz=markers.call(this,d,i).slice().sort(d3.descending),measurez=measures.call(this,d,i).slice().sort(d3.descending),wrap=container.selectAll("g.nv-wrap.nv-bulletChart").data([d]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-bulletChart"),gEnter=wrapEnter.append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-bulletWrap"),gEnter.append("g").attr("class","nv-titles"),wrap.attr("transform","translate("+margin.left+","+margin.top+")");var x1=d3.scale.linear().domain([0,Math.max(rangez[0],markerz[0],measurez[0])]).range(reverse?[availableWidth,0]:[0,availableWidth]),x0=this.__chart__||d3.scale.linear().domain([0,1/0]).range(x1.range());this.__chart__=x1;var title=gEnter.select(".nv-titles").append("g").attr("text-anchor","end").attr("transform","translate(-6,"+(height-margin.top-margin.bottom)/2+")");title.append("text").attr("class","nv-title").text(function(d){return d.title}),title.append("text").attr("class","nv-subtitle").attr("dy","1em").text(function(d){return d.subtitle}),bullet.width(availableWidth).height(availableHeight);var bulletWrap=g.select(".nv-bulletWrap");d3.transition(bulletWrap).call(bullet);var format=tickFormat||x1.tickFormat(availableWidth/100),tick=g.selectAll("g.nv-tick").data(x1.ticks(ticks?ticks:availableWidth/50),function(d){return this.textContent||format(d)}),tickEnter=tick.enter().append("g").attr("class","nv-tick").attr("transform",function(d){return"translate("+x0(d)+",0)"}).style("opacity",1e-6);tickEnter.append("line").attr("y1",availableHeight).attr("y2",7*availableHeight/6),tickEnter.append("text").attr("text-anchor","middle").attr("dy","1em").attr("y",7*availableHeight/6).text(format);var tickUpdate=d3.transition(tick).attr("transform",function(d){return"translate("+x1(d)+",0)"}).style("opacity",1);tickUpdate.select("line").attr("y1",availableHeight).attr("y2",7*availableHeight/6),tickUpdate.select("text").attr("y",7*availableHeight/6),d3.transition(tick.exit()).attr("transform",function(d){return"translate("+x1(d)+",0)"}).style("opacity",1e-6).remove()}),d3.timer.flush(),chart}var bullet=nv.models.bullet(),tooltip=nv.models.tooltip(),orient="left",reverse=!1,margin={top:5,right:40,bottom:20,left:120},ranges=function(d){return d.ranges},markers=function(d){return d.markers?d.markers:[0]},measures=function(d){return d.measures},width=null,height=55,tickFormat=null,ticks=null,noData=null,dispatch=d3.dispatch("tooltipShow","tooltipHide");return tooltip.duration(0).headerEnabled(!1),bullet.dispatch.on("elementMouseover.tooltip",function(evt){evt.series={key:evt.label,value:evt.value,color:evt.color},tooltip.data(evt).hidden(!1)}),bullet.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),bullet.dispatch.on("elementMousemove.tooltip",function(){tooltip.position({top:d3.event.pageY,left:d3.event.pageX})()}),chart.bullet=bullet,chart.dispatch=dispatch,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{ranges:{get:function(){return ranges},set:function(_){ranges=_}},markers:{get:function(){return markers},set:function(_){markers=_}},measures:{get:function(){return measures},set:function(_){measures=_}},width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},tickFormat:{get:function(){return tickFormat},set:function(_){tickFormat=_}},ticks:{get:function(){return ticks},set:function(_){ticks=_}},noData:{get:function(){return noData},set:function(_){noData=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},orient:{get:function(){return orient},set:function(_){orient=_,reverse="right"==orient||"bottom"==orient}}}),nv.utils.inheritOptions(chart,bullet),nv.utils.initOptions(chart),chart},nv.models.candlestickBar=function(){"use strict";function chart(selection){return selection.each(function(data){container=d3.select(this);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);nv.utils.initSVG(container);var barWidth=availableWidth/data[0].values.length*.45;x.domain(xDomain||d3.extent(data[0].values.map(getX).concat(forceX))),x.range(padData?xRange||[.5*availableWidth/data[0].values.length,availableWidth*(data[0].values.length-.5)/data[0].values.length]:xRange||[5+barWidth/2,availableWidth-barWidth/2-5]),y.domain(yDomain||[d3.min(data[0].values.map(getLow).concat(forceY)),d3.max(data[0].values.map(getHigh).concat(forceY))]).range(yRange||[availableHeight,0]),x.domain()[0]===x.domain()[1]&&x.domain(x.domain()[0]?[x.domain()[0]-.01*x.domain()[0],x.domain()[1]+.01*x.domain()[1]]:[-1,1]),y.domain()[0]===y.domain()[1]&&y.domain(y.domain()[0]?[y.domain()[0]+.01*y.domain()[0],y.domain()[1]-.01*y.domain()[1]]:[-1,1]);var wrap=d3.select(this).selectAll("g.nv-wrap.nv-candlestickBar").data([data[0].values]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-candlestickBar"),defsEnter=wrapEnter.append("defs"),gEnter=wrapEnter.append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-ticks"),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),container.on("click",function(d,i){dispatch.chartClick({data:d,index:i,pos:d3.event,id:id})}),defsEnter.append("clipPath").attr("id","nv-chart-clip-path-"+id).append("rect"),wrap.select("#nv-chart-clip-path-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight),g.attr("clip-path",clipEdge?"url(#nv-chart-clip-path-"+id+")":"");var ticks=wrap.select(".nv-ticks").selectAll(".nv-tick").data(function(d){return d});ticks.exit().remove();{var tickGroups=ticks.enter().append("g").attr("class",function(d,i,j){return(getOpen(d,i)>getClose(d,i)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+j+"-"+i});tickGroups.append("line").attr("class","nv-candlestick-lines").attr("transform",function(d,i){return"translate("+x(getX(d,i))+",0)"}).attr("x1",0).attr("y1",function(d,i){return y(getHigh(d,i))}).attr("x2",0).attr("y2",function(d,i){return y(getLow(d,i))}),tickGroups.append("rect").attr("class","nv-candlestick-rects nv-bars").attr("transform",function(d,i){return"translate("+(x(getX(d,i))-barWidth/2)+","+(y(getY(d,i))-(getOpen(d,i)>getClose(d,i)?y(getClose(d,i))-y(getOpen(d,i)):0))+")"}).attr("x",0).attr("y",0).attr("width",barWidth).attr("height",function(d,i){var open=getOpen(d,i),close=getClose(d,i);return open>close?y(close)-y(open):y(open)-y(close)})}container.selectAll(".nv-candlestick-lines").transition().attr("transform",function(d,i){return"translate("+x(getX(d,i))+",0)"}).attr("x1",0).attr("y1",function(d,i){return y(getHigh(d,i))}).attr("x2",0).attr("y2",function(d,i){return y(getLow(d,i))}),container.selectAll(".nv-candlestick-rects").transition().attr("transform",function(d,i){return"translate("+(x(getX(d,i))-barWidth/2)+","+(y(getY(d,i))-(getOpen(d,i)>getClose(d,i)?y(getClose(d,i))-y(getOpen(d,i)):0))+")"}).attr("x",0).attr("y",0).attr("width",barWidth).attr("height",function(d,i){var open=getOpen(d,i),close=getClose(d,i);return open>close?y(close)-y(open):y(open)-y(close)})}),chart}var container,xDomain,yDomain,xRange,yRange,margin={top:0,right:0,bottom:0,left:0},width=null,height=null,id=Math.floor(1e4*Math.random()),x=d3.scale.linear(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},getOpen=function(d){return d.open},getClose=function(d){return d.close},getHigh=function(d){return d.high},getLow=function(d){return d.low},forceX=[],forceY=[],padData=!1,clipEdge=!0,color=nv.utils.defaultColor(),interactive=!1,dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState","renderEnd","chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove");return chart.highlightPoint=function(pointIndex,isHoverOver){chart.clearHighlights(),container.select(".nv-candlestickBar .nv-tick-0-"+pointIndex).classed("hover",isHoverOver)},chart.clearHighlights=function(){container.select(".nv-candlestickBar .nv-tick.hover").classed("hover",!1)},chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},xScale:{get:function(){return x},set:function(_){x=_}},yScale:{get:function(){return y},set:function(_){y=_}},xDomain:{get:function(){return xDomain},set:function(_){xDomain=_}},yDomain:{get:function(){return yDomain},set:function(_){yDomain=_}},xRange:{get:function(){return xRange},set:function(_){xRange=_}},yRange:{get:function(){return yRange},set:function(_){yRange=_}},forceX:{get:function(){return forceX},set:function(_){forceX=_}},forceY:{get:function(){return forceY},set:function(_){forceY=_}},padData:{get:function(){return padData},set:function(_){padData=_}},clipEdge:{get:function(){return clipEdge},set:function(_){clipEdge=_}},id:{get:function(){return id},set:function(_){id=_}},interactive:{get:function(){return interactive},set:function(_){interactive=_}},x:{get:function(){return getX},set:function(_){getX=_}},y:{get:function(){return getY},set:function(_){getY=_}},open:{get:function(){return getOpen()},set:function(_){getOpen=_}},close:{get:function(){return getClose()},set:function(_){getClose=_}},high:{get:function(){return getHigh},set:function(_){getHigh=_}},low:{get:function(){return getLow},set:function(_){getLow=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!=_.top?_.top:margin.top,margin.right=void 0!=_.right?_.right:margin.right,margin.bottom=void 0!=_.bottom?_.bottom:margin.bottom,margin.left=void 0!=_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}}}),nv.utils.initOptions(chart),chart},nv.models.cumulativeLineChart=function(){"use strict";function chart(selection){return renderWatch.reset(),renderWatch.models(lines),showXAxis&&renderWatch.models(xAxis),showYAxis&&renderWatch.models(yAxis),selection.each(function(data){function dragStart(){d3.select(chart.container).style("cursor","ew-resize")}function dragMove(){index.x=d3.event.x,index.i=Math.round(dx.invert(index.x)),updateZero()}function dragEnd(){d3.select(chart.container).style("cursor","auto"),state.index=index.i,dispatch.stateChange(state)}function updateZero(){indexLine.data([index]);var oldDuration=chart.duration();chart.duration(0),chart.update(),chart.duration(oldDuration)}var container=d3.select(this);nv.utils.initSVG(container),container.classed("nv-chart-"+id,!0);var that=this,availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);if(chart.update=function(){0===duration?container.call(chart):container.transition().duration(duration).call(chart)},chart.container=this,state.setter(stateSetter(data),chart.update).getter(stateGetter(data)).update(),state.disabled=data.map(function(d){return!!d.disabled}),!defaultState){var key;defaultState={};for(key in state)defaultState[key]=state[key]instanceof Array?state[key].slice(0):state[key]}var indexDrag=d3.behavior.drag().on("dragstart",dragStart).on("drag",dragMove).on("dragend",dragEnd);if(!(data&&data.length&&data.filter(function(d){return d.values.length}).length))return nv.utils.noData(chart,container),chart;if(container.selectAll(".nv-noData").remove(),x=lines.xScale(),y=lines.yScale(),rescaleY)lines.yDomain(null);else{var seriesDomains=data.filter(function(series){return!series.disabled}).map(function(series){var initialDomain=d3.extent(series.values,lines.y());return initialDomain[0]<-.95&&(initialDomain[0]=-.95),[(initialDomain[0]-initialDomain[1])/(1+initialDomain[1]),(initialDomain[1]-initialDomain[0])/(1+initialDomain[0])]}),completeDomain=[d3.min(seriesDomains,function(d){return d[0]}),d3.max(seriesDomains,function(d){return d[1]})];lines.yDomain(completeDomain)}dx.domain([0,data[0].values.length-1]).range([0,availableWidth]).clamp(!0);var data=indexify(index.i,data),interactivePointerEvents=useInteractiveGuideline?"none":"all",wrap=container.selectAll("g.nv-wrap.nv-cumulativeLine").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-cumulativeLine").append("g"),g=wrap.select("g");if(gEnter.append("g").attr("class","nv-interactive"),gEnter.append("g").attr("class","nv-x nv-axis").style("pointer-events","none"),gEnter.append("g").attr("class","nv-y nv-axis"),gEnter.append("g").attr("class","nv-background"),gEnter.append("g").attr("class","nv-linesWrap").style("pointer-events",interactivePointerEvents),gEnter.append("g").attr("class","nv-avgLinesWrap").style("pointer-events","none"),gEnter.append("g").attr("class","nv-legendWrap"),gEnter.append("g").attr("class","nv-controlsWrap"),showLegend&&(legend.width(availableWidth),g.select(".nv-legendWrap").datum(data).call(legend),margin.top!=legend.height()&&(margin.top=legend.height(),availableHeight=nv.utils.availableHeight(height,container,margin)),g.select(".nv-legendWrap").attr("transform","translate(0,"+-margin.top+")")),showControls){var controlsData=[{key:"Re-scale y-axis",disabled:!rescaleY}];controls.width(140).color(["#444","#444","#444"]).rightAlign(!1).margin({top:5,right:0,bottom:5,left:20}),g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+-margin.top+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")"),rightAlignYAxis&&g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)");var tempDisabled=data.filter(function(d){return d.tempDisabled});wrap.select(".tempDisabled").remove(),tempDisabled.length&&wrap.append("text").attr("class","tempDisabled").attr("x",availableWidth/2).attr("y","-.71em").style("text-anchor","end").text(tempDisabled.map(function(d){return d.key}).join(", ")+" values cannot be calculated for this time period."),useInteractiveGuideline&&(interactiveLayer.width(availableWidth).height(availableHeight).margin({left:margin.left,top:margin.top}).svgContainer(container).xScale(x),wrap.select(".nv-interactive").call(interactiveLayer)),gEnter.select(".nv-background").append("rect"),g.select(".nv-background rect").attr("width",availableWidth).attr("height",availableHeight),lines.y(function(d){return d.display.y}).width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled&&!data[i].tempDisabled}));var linesWrap=g.select(".nv-linesWrap").datum(data.filter(function(d){return!d.disabled&&!d.tempDisabled}));linesWrap.call(lines),data.forEach(function(d,i){d.seriesIndex=i});var avgLineData=data.filter(function(d){return!d.disabled&&!!average(d)}),avgLines=g.select(".nv-avgLinesWrap").selectAll("line").data(avgLineData,function(d){return d.key}),getAvgLineY=function(d){var yVal=y(average(d));return 0>yVal?0:yVal>availableHeight?availableHeight:yVal};avgLines.enter().append("line").style("stroke-width",2).style("stroke-dasharray","10,10").style("stroke",function(d){return lines.color()(d,d.seriesIndex)}).attr("x1",0).attr("x2",availableWidth).attr("y1",getAvgLineY).attr("y2",getAvgLineY),avgLines.style("stroke-opacity",function(d){var yVal=y(average(d));return 0>yVal||yVal>availableHeight?0:1}).attr("x1",0).attr("x2",availableWidth).attr("y1",getAvgLineY).attr("y2",getAvgLineY),avgLines.exit().remove();var indexLine=linesWrap.selectAll(".nv-indexLine").data([index]);indexLine.enter().append("rect").attr("class","nv-indexLine").attr("width",3).attr("x",-2).attr("fill","red").attr("fill-opacity",.5).style("pointer-events","all").call(indexDrag),indexLine.attr("transform",function(d){return"translate("+dx(d.i)+",0)"}).attr("height",availableHeight),showXAxis&&(xAxis.scale(x)._ticks(nv.utils.calcTicksX(availableWidth/70,data)).tickSize(-availableHeight,0),g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")"),g.select(".nv-x.nv-axis").call(xAxis)),showYAxis&&(yAxis.scale(y)._ticks(nv.utils.calcTicksY(availableHeight/36,data)).tickSize(-availableWidth,0),g.select(".nv-y.nv-axis").call(yAxis)),g.select(".nv-background rect").on("click",function(){index.x=d3.mouse(this)[0],index.i=Math.round(dx.invert(index.x)),state.index=index.i,dispatch.stateChange(state),updateZero()}),lines.dispatch.on("elementClick",function(e){index.i=e.pointIndex,index.x=dx(index.i),state.index=index.i,dispatch.stateChange(state),updateZero()}),controls.dispatch.on("legendClick",function(d){d.disabled=!d.disabled,rescaleY=!d.disabled,state.rescaleY=rescaleY,dispatch.stateChange(state),chart.update()}),legend.dispatch.on("stateChange",function(newState){for(var key in newState)state[key]=newState[key];dispatch.stateChange(state),chart.update()}),interactiveLayer.dispatch.on("elementMousemove",function(e){lines.clearHighlights();var singlePoint,pointIndex,pointXLocation,allData=[];if(data.filter(function(series,i){return series.seriesIndex=i,!series.disabled}).forEach(function(series,i){pointIndex=nv.interactiveBisect(series.values,e.pointXValue,chart.x()),lines.highlightPoint(i,pointIndex,!0);var point=series.values[pointIndex];"undefined"!=typeof point&&("undefined"==typeof singlePoint&&(singlePoint=point),"undefined"==typeof pointXLocation&&(pointXLocation=chart.xScale()(chart.x()(point,pointIndex))),allData.push({key:series.key,value:chart.y()(point,pointIndex),color:color(series,series.seriesIndex)}))}),allData.length>2){var yValue=chart.yScale().invert(e.mouseY),domainExtent=Math.abs(chart.yScale().domain()[0]-chart.yScale().domain()[1]),threshold=.03*domainExtent,indexToHighlight=nv.nearestValueIndex(allData.map(function(d){return d.value}),yValue,threshold);null!==indexToHighlight&&(allData[indexToHighlight].highlight=!0)}var xValue=xAxis.tickFormat()(chart.x()(singlePoint,pointIndex),pointIndex);interactiveLayer.tooltip.position({left:pointXLocation+margin.left,top:e.mouseY+margin.top}).chartContainer(that.parentNode).valueFormatter(function(d){return yAxis.tickFormat()(d)}).data({value:xValue,series:allData})(),interactiveLayer.renderGuideLine(pointXLocation)}),interactiveLayer.dispatch.on("elementMouseout",function(){lines.clearHighlights()}),dispatch.on("changeState",function(e){"undefined"!=typeof e.disabled&&(data.forEach(function(series,i){series.disabled=e.disabled[i]}),state.disabled=e.disabled),"undefined"!=typeof e.index&&(index.i=e.index,index.x=dx(index.i),state.index=e.index,indexLine.data([index])),"undefined"!=typeof e.rescaleY&&(rescaleY=e.rescaleY),chart.update()})}),renderWatch.renderEnd("cumulativeLineChart immediate"),chart}function indexify(idx,data){return indexifyYGetter||(indexifyYGetter=lines.y()),data.map(function(line){if(!line.values)return line;var indexValue=line.values[idx];if(null==indexValue)return line;var v=indexifyYGetter(indexValue,idx);return-.95>v&&!noErrorCheck?(line.tempDisabled=!0,line):(line.tempDisabled=!1,line.values=line.values.map(function(point,pointIndex){return point.display={y:(indexifyYGetter(point,pointIndex)-v)/(1+v)},point}),line)})}var x,y,lines=nv.models.line(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend(),interactiveLayer=nv.interactiveGuideline(),tooltip=nv.models.tooltip(),margin={top:30,right:30,bottom:50,left:60},color=nv.utils.defaultColor(),width=null,height=null,showLegend=!0,showXAxis=!0,showYAxis=!0,rightAlignYAxis=!1,showControls=!0,useInteractiveGuideline=!1,rescaleY=!0,id=lines.id(),state=nv.utils.state(),defaultState=null,noData=null,average=function(d){return d.average},dispatch=d3.dispatch("stateChange","changeState","renderEnd"),duration=250,noErrorCheck=!1;state.index=0,state.rescaleY=rescaleY,xAxis.orient("bottom").tickPadding(7),yAxis.orient(rightAlignYAxis?"right":"left"),tooltip.valueFormatter(function(d,i){return yAxis.tickFormat()(d,i)}).headerFormatter(function(d,i){return xAxis.tickFormat()(d,i)}),controls.updateState(!1);var dx=d3.scale.linear(),index={i:0,x:0},renderWatch=nv.utils.renderWatch(dispatch,duration),stateGetter=function(data){return function(){return{active:data.map(function(d){return!d.disabled}),index:index.i,rescaleY:rescaleY}}},stateSetter=function(data){return function(state){void 0!==state.index&&(index.i=state.index),void 0!==state.rescaleY&&(rescaleY=state.rescaleY),void 0!==state.active&&data.forEach(function(series,i){series.disabled=!state.active[i]})}};lines.dispatch.on("elementMouseover.tooltip",function(evt){var point={x:chart.x()(evt.point),y:chart.y()(evt.point),color:evt.point.color};evt.point=point,tooltip.data(evt).position(evt.pos).hidden(!1)}),lines.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)});var indexifyYGetter=null;return chart.dispatch=dispatch,chart.lines=lines,chart.legend=legend,chart.controls=controls,chart.xAxis=xAxis,chart.yAxis=yAxis,chart.interactiveLayer=interactiveLayer,chart.state=state,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},rescaleY:{get:function(){return rescaleY},set:function(_){rescaleY=_}},showControls:{get:function(){return showControls},set:function(_){showControls=_}},showLegend:{get:function(){return showLegend},set:function(_){showLegend=_}},average:{get:function(){return average},set:function(_){average=_}},defaultState:{get:function(){return defaultState},set:function(_){defaultState=_}},noData:{get:function(){return noData},set:function(_){noData=_}},showXAxis:{get:function(){return showXAxis},set:function(_){showXAxis=_}},showYAxis:{get:function(){return showYAxis},set:function(_){showYAxis=_}},noErrorCheck:{get:function(){return noErrorCheck},set:function(_){noErrorCheck=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),legend.color(color)}},useInteractiveGuideline:{get:function(){return useInteractiveGuideline},set:function(_){useInteractiveGuideline=_,_===!0&&(chart.interactive(!1),chart.useVoronoi(!1))}},rightAlignYAxis:{get:function(){return rightAlignYAxis},set:function(_){rightAlignYAxis=_,yAxis.orient(_?"right":"left")}},duration:{get:function(){return duration},set:function(_){duration=_,lines.duration(duration),xAxis.duration(duration),yAxis.duration(duration),renderWatch.reset(duration)}}}),nv.utils.inheritOptions(chart,lines),nv.utils.initOptions(chart),chart},nv.models.discreteBar=function(){"use strict";function chart(selection){return renderWatch.reset(),selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom;container=d3.select(this),nv.utils.initSVG(container),data.forEach(function(series,i){series.values.forEach(function(point){point.series=i})});var seriesData=xDomain&&yDomain?[]:data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),y0:d.y0}})});x.domain(xDomain||d3.merge(seriesData).map(function(d){return d.x})).rangeBands(xRange||[0,availableWidth],.1),y.domain(yDomain||d3.extent(d3.merge(seriesData).map(function(d){return d.y}).concat(forceY))),y.range(showValues?yRange||[availableHeight-(y.domain()[0]<0?12:0),y.domain()[1]>0?12:0]:yRange||[availableHeight,0]),x0=x0||x,y0=y0||y.copy().range([y(0),y(0)]);{var wrap=container.selectAll("g.nv-wrap.nv-discretebar").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-discretebar"),gEnter=wrapEnter.append("g");wrap.select("g")}gEnter.append("g").attr("class","nv-groups"),wrap.attr("transform","translate("+margin.left+","+margin.top+")");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),groups.exit().watchTransition(renderWatch,"discreteBar: exit groups").style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}),groups.watchTransition(renderWatch,"discreteBar: groups").style("stroke-opacity",1).style("fill-opacity",.75);var bars=groups.selectAll("g.nv-bar").data(function(d){return d.values});bars.exit().remove();var barsEnter=bars.enter().append("g").attr("transform",function(d,i){return"translate("+(x(getX(d,i))+.05*x.rangeBand())+", "+y(0)+")"}).on("mouseover",function(d,i){d3.select(this).classed("hover",!0),dispatch.elementMouseover({data:d,index:i,color:d3.select(this).style("fill")})}).on("mouseout",function(d,i){d3.select(this).classed("hover",!1),dispatch.elementMouseout({data:d,index:i,color:d3.select(this).style("fill")})}).on("mousemove",function(d,i){dispatch.elementMousemove({data:d,index:i,color:d3.select(this).style("fill")})}).on("click",function(d,i){dispatch.elementClick({data:d,index:i,color:d3.select(this).style("fill")}),d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({data:d,index:i,color:d3.select(this).style("fill")}),d3.event.stopPropagation()});barsEnter.append("rect").attr("height",0).attr("width",.9*x.rangeBand()/data.length),showValues?(barsEnter.append("text").attr("text-anchor","middle"),bars.select("text").text(function(d,i){return valueFormat(getY(d,i))}).watchTransition(renderWatch,"discreteBar: bars text").attr("x",.9*x.rangeBand()/2).attr("y",function(d,i){return getY(d,i)<0?y(getY(d,i))-y(0)+12:-4})):bars.selectAll("text").remove(),bars.attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).style("fill",function(d,i){return d.color||color(d,i)}).style("stroke",function(d,i){return d.color||color(d,i)}).select("rect").attr("class",rectClass).watchTransition(renderWatch,"discreteBar: bars rect").attr("width",.9*x.rangeBand()/data.length),bars.watchTransition(renderWatch,"discreteBar: bars").attr("transform",function(d,i){var left=x(getX(d,i))+.05*x.rangeBand(),top=getY(d,i)<0?y(0):y(0)-y(getY(d,i))<1?y(0)-1:y(getY(d,i));return"translate("+left+", "+top+")"}).select("rect").attr("height",function(d,i){return Math.max(Math.abs(y(getY(d,i))-y(yDomain&&yDomain[0]||0))||1)}),x0=x.copy(),y0=y.copy()}),renderWatch.renderEnd("discreteBar immediate"),chart}var container,xDomain,yDomain,xRange,yRange,x0,y0,margin={top:0,right:0,bottom:0,left:0},width=960,height=500,id=Math.floor(1e4*Math.random()),x=d3.scale.ordinal(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},forceY=[0],color=nv.utils.defaultColor(),showValues=!1,valueFormat=d3.format(",.2f"),dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),rectClass="discreteBar",duration=250,renderWatch=nv.utils.renderWatch(dispatch,duration);return chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},forceY:{get:function(){return forceY},set:function(_){forceY=_}},showValues:{get:function(){return showValues},set:function(_){showValues=_}},x:{get:function(){return getX},set:function(_){getX=_}},y:{get:function(){return getY},set:function(_){getY=_}},xScale:{get:function(){return x},set:function(_){x=_}},yScale:{get:function(){return y},set:function(_){y=_}},xDomain:{get:function(){return xDomain},set:function(_){xDomain=_}},yDomain:{get:function(){return yDomain},set:function(_){yDomain=_}},xRange:{get:function(){return xRange},set:function(_){xRange=_}},yRange:{get:function(){return yRange},set:function(_){yRange=_}},valueFormat:{get:function(){return valueFormat},set:function(_){valueFormat=_}},id:{get:function(){return id},set:function(_){id=_}},rectClass:{get:function(){return rectClass},set:function(_){rectClass=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left
}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration)}}}),nv.utils.initOptions(chart),chart},nv.models.discreteBarChart=function(){"use strict";function chart(selection){return renderWatch.reset(),renderWatch.models(discretebar),showXAxis&&renderWatch.models(xAxis),showYAxis&&renderWatch.models(yAxis),selection.each(function(data){var container=d3.select(this);nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);if(chart.update=function(){dispatch.beforeUpdate(),container.transition().duration(duration).call(chart)},chart.container=this,!(data&&data.length&&data.filter(function(d){return d.values.length}).length))return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove(),x=discretebar.xScale(),y=discretebar.yScale().clamp(!0);var wrap=container.selectAll("g.nv-wrap.nv-discreteBarWithAxes").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-discreteBarWithAxes").append("g"),defsEnter=gEnter.append("defs"),g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis"),gEnter.append("g").attr("class","nv-y nv-axis").append("g").attr("class","nv-zeroLine").append("line"),gEnter.append("g").attr("class","nv-barsWrap"),g.attr("transform","translate("+margin.left+","+margin.top+")"),rightAlignYAxis&&g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)"),discretebar.width(availableWidth).height(availableHeight);var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return!d.disabled}));if(barsWrap.transition().call(discretebar),defsEnter.append("clipPath").attr("id","nv-x-label-clip-"+discretebar.id()).append("rect"),g.select("#nv-x-label-clip-"+discretebar.id()+" rect").attr("width",x.rangeBand()*(staggerLabels?2:1)).attr("height",16).attr("x",-x.rangeBand()/(staggerLabels?1:2)),showXAxis){xAxis.scale(x)._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight,0),g.select(".nv-x.nv-axis").attr("transform","translate(0,"+(y.range()[0]+(discretebar.showValues()&&y.domain()[0]<0?16:0))+")"),g.select(".nv-x.nv-axis").call(xAxis);var xTicks=g.select(".nv-x.nv-axis").selectAll("g");staggerLabels&&xTicks.selectAll("text").attr("transform",function(d,i,j){return"translate(0,"+(j%2==0?"5":"17")+")"})}showYAxis&&(yAxis.scale(y)._ticks(nv.utils.calcTicksY(availableHeight/36,data)).tickSize(-availableWidth,0),g.select(".nv-y.nv-axis").call(yAxis)),g.select(".nv-zeroLine line").attr("x1",0).attr("x2",availableWidth).attr("y1",y(0)).attr("y2",y(0))}),renderWatch.renderEnd("discreteBar chart immediate"),chart}var x,y,discretebar=nv.models.discreteBar(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),tooltip=nv.models.tooltip(),margin={top:15,right:10,bottom:50,left:60},width=null,height=null,color=nv.utils.getColor(),showXAxis=!0,showYAxis=!0,rightAlignYAxis=!1,staggerLabels=!1,noData=null,dispatch=d3.dispatch("beforeUpdate","renderEnd"),duration=250;xAxis.orient("bottom").showMaxMin(!1).tickFormat(function(d){return d}),yAxis.orient(rightAlignYAxis?"right":"left").tickFormat(d3.format(",.1f")),tooltip.duration(0).headerEnabled(!1).valueFormatter(function(d,i){return yAxis.tickFormat()(d,i)}).keyFormatter(function(d,i){return xAxis.tickFormat()(d,i)});var renderWatch=nv.utils.renderWatch(dispatch,duration);return discretebar.dispatch.on("elementMouseover.tooltip",function(evt){evt.series={key:chart.x()(evt.data),value:chart.y()(evt.data),color:evt.color},tooltip.data(evt).hidden(!1)}),discretebar.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),discretebar.dispatch.on("elementMousemove.tooltip",function(){tooltip.position({top:d3.event.pageY,left:d3.event.pageX})()}),chart.dispatch=dispatch,chart.discretebar=discretebar,chart.xAxis=xAxis,chart.yAxis=yAxis,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},staggerLabels:{get:function(){return staggerLabels},set:function(_){staggerLabels=_}},showXAxis:{get:function(){return showXAxis},set:function(_){showXAxis=_}},showYAxis:{get:function(){return showYAxis},set:function(_){showYAxis=_}},noData:{get:function(){return noData},set:function(_){noData=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration),discretebar.duration(duration),xAxis.duration(duration),yAxis.duration(duration)}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),discretebar.color(color)}},rightAlignYAxis:{get:function(){return rightAlignYAxis},set:function(_){rightAlignYAxis=_,yAxis.orient(_?"right":"left")}}}),nv.utils.inheritOptions(chart,discretebar),nv.utils.initOptions(chart),chart},nv.models.distribution=function(){"use strict";function chart(selection){return renderWatch.reset(),selection.each(function(data){var naxis=(width-("x"===axis?margin.left+margin.right:margin.top+margin.bottom),"x"==axis?"y":"x"),container=d3.select(this);nv.utils.initSVG(container),scale0=scale0||scale;var wrap=container.selectAll("g.nv-distribution").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-distribution"),g=(wrapEnter.append("g"),wrap.select("g"));wrap.attr("transform","translate("+margin.left+","+margin.top+")");var distWrap=g.selectAll("g.nv-dist").data(function(d){return d},function(d){return d.key});distWrap.enter().append("g"),distWrap.attr("class",function(d,i){return"nv-dist nv-series-"+i}).style("stroke",function(d,i){return color(d,i)});var dist=distWrap.selectAll("line.nv-dist"+axis).data(function(d){return d.values});dist.enter().append("line").attr(axis+"1",function(d,i){return scale0(getData(d,i))}).attr(axis+"2",function(d,i){return scale0(getData(d,i))}),renderWatch.transition(distWrap.exit().selectAll("line.nv-dist"+axis),"dist exit").attr(axis+"1",function(d,i){return scale(getData(d,i))}).attr(axis+"2",function(d,i){return scale(getData(d,i))}).style("stroke-opacity",0).remove(),dist.attr("class",function(d,i){return"nv-dist"+axis+" nv-dist"+axis+"-"+i}).attr(naxis+"1",0).attr(naxis+"2",size),renderWatch.transition(dist,"dist").attr(axis+"1",function(d,i){return scale(getData(d,i))}).attr(axis+"2",function(d,i){return scale(getData(d,i))}),scale0=scale.copy()}),renderWatch.renderEnd("distribution immediate"),chart}var scale0,margin={top:0,right:0,bottom:0,left:0},width=400,size=8,axis="x",getData=function(d){return d[axis]},color=nv.utils.defaultColor(),scale=d3.scale.linear(),duration=250,dispatch=d3.dispatch("renderEnd"),renderWatch=nv.utils.renderWatch(dispatch,duration);return chart.options=nv.utils.optionsFunc.bind(chart),chart.dispatch=dispatch,chart.margin=function(_){return arguments.length?(margin.top="undefined"!=typeof _.top?_.top:margin.top,margin.right="undefined"!=typeof _.right?_.right:margin.right,margin.bottom="undefined"!=typeof _.bottom?_.bottom:margin.bottom,margin.left="undefined"!=typeof _.left?_.left:margin.left,chart):margin},chart.width=function(_){return arguments.length?(width=_,chart):width},chart.axis=function(_){return arguments.length?(axis=_,chart):axis},chart.size=function(_){return arguments.length?(size=_,chart):size},chart.getData=function(_){return arguments.length?(getData=d3.functor(_),chart):getData},chart.scale=function(_){return arguments.length?(scale=_,chart):scale},chart.color=function(_){return arguments.length?(color=nv.utils.getColor(_),chart):color},chart.duration=function(_){return arguments.length?(duration=_,renderWatch.reset(duration),chart):duration},chart},nv.models.furiousLegend=function(){"use strict";function chart(selection){function setTextColor(d,i){return"furious"!=vers?"#000":expanded?d.disengaged?color(d,i):"#fff":expanded?void 0:d.disabled?color(d,i):"#fff"}function setBGColor(d,i){return expanded&&"furious"==vers?d.disengaged?"#fff":color(d,i):d.disabled?"#fff":color(d,i)}return selection.each(function(data){var availableWidth=width-margin.left-margin.right,container=d3.select(this);nv.utils.initSVG(container);var wrap=container.selectAll("g.nv-legend").data([data]),g=(wrap.enter().append("g").attr("class","nvd3 nv-legend").append("g"),wrap.select("g"));wrap.attr("transform","translate("+margin.left+","+margin.top+")");var seriesShape,series=g.selectAll(".nv-series").data(function(d){return"furious"!=vers?d:d.filter(function(n){return expanded?!0:!n.disengaged})}),seriesEnter=series.enter().append("g").attr("class","nv-series");if("classic"==vers)seriesEnter.append("circle").style("stroke-width",2).attr("class","nv-legend-symbol").attr("r",5),seriesShape=series.select("circle");else if("furious"==vers){seriesEnter.append("rect").style("stroke-width",2).attr("class","nv-legend-symbol").attr("rx",3).attr("ry",3),seriesShape=series.select("rect"),seriesEnter.append("g").attr("class","nv-check-box").property("innerHTML",'<path d="M0.5,5 L22.5,5 L22.5,26.5 L0.5,26.5 L0.5,5 Z" class="nv-box"></path><path d="M5.5,12.8618467 L11.9185089,19.2803556 L31,0.198864511" class="nv-check"></path>').attr("transform","translate(-10,-8)scale(0.5)");var seriesCheckbox=series.select(".nv-check-box");seriesCheckbox.each(function(d,i){d3.select(this).selectAll("path").attr("stroke",setTextColor(d,i))})}seriesEnter.append("text").attr("text-anchor","start").attr("class","nv-legend-text").attr("dy",".32em").attr("dx","8");var seriesText=series.select("text.nv-legend-text");series.on("mouseover",function(d,i){dispatch.legendMouseover(d,i)}).on("mouseout",function(d,i){dispatch.legendMouseout(d,i)}).on("click",function(d,i){dispatch.legendClick(d,i);var data=series.data();if(updateState){if("classic"==vers)radioButtonMode?(data.forEach(function(series){series.disabled=!0}),d.disabled=!1):(d.disabled=!d.disabled,data.every(function(series){return series.disabled})&&data.forEach(function(series){series.disabled=!1}));else if("furious"==vers)if(expanded)d.disengaged=!d.disengaged,d.userDisabled=void 0==d.userDisabled?!!d.disabled:d.userDisabled,d.disabled=d.disengaged||d.userDisabled;else if(!expanded){d.disabled=!d.disabled,d.userDisabled=d.disabled;var engaged=data.filter(function(d){return!d.disengaged});engaged.every(function(series){return series.userDisabled})&&data.forEach(function(series){series.disabled=series.userDisabled=!1})}dispatch.stateChange({disabled:data.map(function(d){return!!d.disabled}),disengaged:data.map(function(d){return!!d.disengaged})})}}).on("dblclick",function(d,i){if(("furious"!=vers||!expanded)&&(dispatch.legendDblclick(d,i),updateState)){var data=series.data();data.forEach(function(series){series.disabled=!0,"furious"==vers&&(series.userDisabled=series.disabled)}),d.disabled=!1,"furious"==vers&&(d.userDisabled=d.disabled),dispatch.stateChange({disabled:data.map(function(d){return!!d.disabled})})}}),series.classed("nv-disabled",function(d){return d.userDisabled}),series.exit().remove(),seriesText.attr("fill",setTextColor).text(getKey);var versPadding;switch(vers){case"furious":versPadding=23;break;case"classic":versPadding=20}if(align){var seriesWidths=[];series.each(function(){var nodeTextLength,legendText=d3.select(this).select("text");try{if(nodeTextLength=legendText.node().getComputedTextLength(),0>=nodeTextLength)throw Error()}catch(e){nodeTextLength=nv.utils.calcApproxTextWidth(legendText)}seriesWidths.push(nodeTextLength+padding)});for(var seriesPerRow=0,legendWidth=0,columnWidths=[];availableWidth>legendWidth&&seriesPerRow<seriesWidths.length;)columnWidths[seriesPerRow]=seriesWidths[seriesPerRow],legendWidth+=seriesWidths[seriesPerRow++];for(0===seriesPerRow&&(seriesPerRow=1);legendWidth>availableWidth&&seriesPerRow>1;){columnWidths=[],seriesPerRow--;for(var k=0;k<seriesWidths.length;k++)seriesWidths[k]>(columnWidths[k%seriesPerRow]||0)&&(columnWidths[k%seriesPerRow]=seriesWidths[k]);legendWidth=columnWidths.reduce(function(prev,cur){return prev+cur})}for(var xPositions=[],i=0,curX=0;seriesPerRow>i;i++)xPositions[i]=curX,curX+=columnWidths[i];series.attr("transform",function(d,i){return"translate("+xPositions[i%seriesPerRow]+","+(5+Math.floor(i/seriesPerRow)*versPadding)+")"}),rightAlign?g.attr("transform","translate("+(width-margin.right-legendWidth)+","+margin.top+")"):g.attr("transform","translate(0,"+margin.top+")"),height=margin.top+margin.bottom+Math.ceil(seriesWidths.length/seriesPerRow)*versPadding}else{var xpos,ypos=5,newxpos=5,maxwidth=0;series.attr("transform",function(){var length=d3.select(this).select("text").node().getComputedTextLength()+padding;return xpos=newxpos,width<margin.left+margin.right+xpos+length&&(newxpos=xpos=5,ypos+=versPadding),newxpos+=length,newxpos>maxwidth&&(maxwidth=newxpos),"translate("+xpos+","+ypos+")"}),g.attr("transform","translate("+(width-margin.right-maxwidth)+","+margin.top+")"),height=margin.top+margin.bottom+ypos+15}"furious"==vers&&seriesShape.attr("width",function(d,i){return seriesText[0][i].getComputedTextLength()+27}).attr("height",18).attr("y",-9).attr("x",-15),seriesShape.style("fill",setBGColor).style("stroke",function(d,i){return d.color||color(d,i)})}),chart}var margin={top:5,right:0,bottom:5,left:0},width=400,height=20,getKey=function(d){return d.key},color=nv.utils.getColor(),align=!0,padding=28,rightAlign=!0,updateState=!0,radioButtonMode=!1,expanded=!1,dispatch=d3.dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout","stateChange"),vers="classic";return chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},key:{get:function(){return getKey},set:function(_){getKey=_}},align:{get:function(){return align},set:function(_){align=_}},rightAlign:{get:function(){return rightAlign},set:function(_){rightAlign=_}},padding:{get:function(){return padding},set:function(_){padding=_}},updateState:{get:function(){return updateState},set:function(_){updateState=_}},radioButtonMode:{get:function(){return radioButtonMode},set:function(_){radioButtonMode=_}},expanded:{get:function(){return expanded},set:function(_){expanded=_}},vers:{get:function(){return vers},set:function(_){vers=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}}}),nv.utils.initOptions(chart),chart},nv.models.historicalBar=function(){"use strict";function chart(selection){return selection.each(function(data){renderWatch.reset(),container=d3.select(this);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);nv.utils.initSVG(container),x.domain(xDomain||d3.extent(data[0].values.map(getX).concat(forceX))),x.range(padData?xRange||[.5*availableWidth/data[0].values.length,availableWidth*(data[0].values.length-.5)/data[0].values.length]:xRange||[0,availableWidth]),y.domain(yDomain||d3.extent(data[0].values.map(getY).concat(forceY))).range(yRange||[availableHeight,0]),x.domain()[0]===x.domain()[1]&&x.domain(x.domain()[0]?[x.domain()[0]-.01*x.domain()[0],x.domain()[1]+.01*x.domain()[1]]:[-1,1]),y.domain()[0]===y.domain()[1]&&y.domain(y.domain()[0]?[y.domain()[0]+.01*y.domain()[0],y.domain()[1]-.01*y.domain()[1]]:[-1,1]);var wrap=container.selectAll("g.nv-wrap.nv-historicalBar-"+id).data([data[0].values]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-historicalBar-"+id),defsEnter=wrapEnter.append("defs"),gEnter=wrapEnter.append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-bars"),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),container.on("click",function(d,i){dispatch.chartClick({data:d,index:i,pos:d3.event,id:id})}),defsEnter.append("clipPath").attr("id","nv-chart-clip-path-"+id).append("rect"),wrap.select("#nv-chart-clip-path-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight),g.attr("clip-path",clipEdge?"url(#nv-chart-clip-path-"+id+")":"");var bars=wrap.select(".nv-bars").selectAll(".nv-bar").data(function(d){return d},function(d,i){return getX(d,i)});bars.exit().remove(),bars.enter().append("rect").attr("x",0).attr("y",function(d,i){return nv.utils.NaNtoZero(y(Math.max(0,getY(d,i))))}).attr("height",function(d,i){return nv.utils.NaNtoZero(Math.abs(y(getY(d,i))-y(0)))}).attr("transform",function(d,i){return"translate("+(x(getX(d,i))-availableWidth/data[0].values.length*.45)+",0)"}).on("mouseover",function(d,i){interactive&&(d3.select(this).classed("hover",!0),dispatch.elementMouseover({data:d,index:i,color:d3.select(this).style("fill")}))}).on("mouseout",function(d,i){interactive&&(d3.select(this).classed("hover",!1),dispatch.elementMouseout({data:d,index:i,color:d3.select(this).style("fill")}))}).on("mousemove",function(d,i){interactive&&dispatch.elementMousemove({data:d,index:i,color:d3.select(this).style("fill")})}).on("click",function(d,i){interactive&&(dispatch.elementClick({data:d,index:i,color:d3.select(this).style("fill")}),d3.event.stopPropagation())}).on("dblclick",function(d,i){interactive&&(dispatch.elementDblClick({data:d,index:i,color:d3.select(this).style("fill")}),d3.event.stopPropagation())}),bars.attr("fill",function(d,i){return color(d,i)}).attr("class",function(d,i,j){return(getY(d,i)<0?"nv-bar negative":"nv-bar positive")+" nv-bar-"+j+"-"+i}).watchTransition(renderWatch,"bars").attr("transform",function(d,i){return"translate("+(x(getX(d,i))-availableWidth/data[0].values.length*.45)+",0)"}).attr("width",availableWidth/data[0].values.length*.9),bars.watchTransition(renderWatch,"bars").attr("y",function(d,i){var rval=getY(d,i)<0?y(0):y(0)-y(getY(d,i))<1?y(0)-1:y(getY(d,i));return nv.utils.NaNtoZero(rval)}).attr("height",function(d,i){return nv.utils.NaNtoZero(Math.max(Math.abs(y(getY(d,i))-y(0)),1))})}),renderWatch.renderEnd("historicalBar immediate"),chart}var xDomain,yDomain,xRange,yRange,margin={top:0,right:0,bottom:0,left:0},width=null,height=null,id=Math.floor(1e4*Math.random()),container=null,x=d3.scale.linear(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},forceX=[],forceY=[0],padData=!1,clipEdge=!0,color=nv.utils.defaultColor(),dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),interactive=!0,renderWatch=nv.utils.renderWatch(dispatch,0);return chart.highlightPoint=function(pointIndex,isHoverOver){container.select(".nv-bars .nv-bar-0-"+pointIndex).classed("hover",isHoverOver)},chart.clearHighlights=function(){container.select(".nv-bars .nv-bar.hover").classed("hover",!1)},chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},forceX:{get:function(){return forceX},set:function(_){forceX=_}},forceY:{get:function(){return forceY},set:function(_){forceY=_}},padData:{get:function(){return padData},set:function(_){padData=_}},x:{get:function(){return getX},set:function(_){getX=_}},y:{get:function(){return getY},set:function(_){getY=_}},xScale:{get:function(){return x},set:function(_){x=_}},yScale:{get:function(){return y},set:function(_){y=_}},xDomain:{get:function(){return xDomain},set:function(_){xDomain=_}},yDomain:{get:function(){return yDomain},set:function(_){yDomain=_}},xRange:{get:function(){return xRange},set:function(_){xRange=_}},yRange:{get:function(){return yRange},set:function(_){yRange=_}},clipEdge:{get:function(){return clipEdge},set:function(_){clipEdge=_}},id:{get:function(){return id},set:function(_){id=_}},interactive:{get:function(){return interactive},set:function(_){interactive=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}}}),nv.utils.initOptions(chart),chart},nv.models.historicalBarChart=function(bar_model){"use strict";function chart(selection){return selection.each(function(data){renderWatch.reset(),renderWatch.models(bars),showXAxis&&renderWatch.models(xAxis),showYAxis&&renderWatch.models(yAxis);var container=d3.select(this),that=this;nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);if(chart.update=function(){container.transition().duration(transitionDuration).call(chart)},chart.container=this,state.disabled=data.map(function(d){return!!d.disabled}),!defaultState){var key;defaultState={};for(key in state)defaultState[key]=state[key]instanceof Array?state[key].slice(0):state[key]}if(!(data&&data.length&&data.filter(function(d){return d.values.length}).length))return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove(),x=bars.xScale(),y=bars.yScale();var wrap=container.selectAll("g.nv-wrap.nv-historicalBarChart").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-historicalBarChart").append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis"),gEnter.append("g").attr("class","nv-y nv-axis"),gEnter.append("g").attr("class","nv-barsWrap"),gEnter.append("g").attr("class","nv-legendWrap"),gEnter.append("g").attr("class","nv-interactive"),showLegend&&(legend.width(availableWidth),g.select(".nv-legendWrap").datum(data).call(legend),margin.top!=legend.height()&&(margin.top=legend.height(),availableHeight=nv.utils.availableHeight(height,container,margin)),wrap.select(".nv-legendWrap").attr("transform","translate(0,"+-margin.top+")")),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),rightAlignYAxis&&g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)"),useInteractiveGuideline&&(interactiveLayer.width(availableWidth).height(availableHeight).margin({left:margin.left,top:margin.top}).svgContainer(container).xScale(x),wrap.select(".nv-interactive").call(interactiveLayer)),bars.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled}));var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return!d.disabled}));barsWrap.transition().call(bars),showXAxis&&(xAxis.scale(x)._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight,0),g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")"),g.select(".nv-x.nv-axis").transition().call(xAxis)),showYAxis&&(yAxis.scale(y)._ticks(nv.utils.calcTicksY(availableHeight/36,data)).tickSize(-availableWidth,0),g.select(".nv-y.nv-axis").transition().call(yAxis)),interactiveLayer.dispatch.on("elementMousemove",function(e){bars.clearHighlights();var singlePoint,pointIndex,pointXLocation,allData=[];data.filter(function(series,i){return series.seriesIndex=i,!series.disabled}).forEach(function(series){pointIndex=nv.interactiveBisect(series.values,e.pointXValue,chart.x()),bars.highlightPoint(pointIndex,!0);var point=series.values[pointIndex];void 0!==point&&(void 0===singlePoint&&(singlePoint=point),void 0===pointXLocation&&(pointXLocation=chart.xScale()(chart.x()(point,pointIndex))),allData.push({key:series.key,value:chart.y()(point,pointIndex),color:color(series,series.seriesIndex),data:series.values[pointIndex]}))});var xValue=xAxis.tickFormat()(chart.x()(singlePoint,pointIndex));interactiveLayer.tooltip.position({left:pointXLocation+margin.left,top:e.mouseY+margin.top}).chartContainer(that.parentNode).valueFormatter(function(d){return yAxis.tickFormat()(d)}).data({value:xValue,index:pointIndex,series:allData})(),interactiveLayer.renderGuideLine(pointXLocation)}),interactiveLayer.dispatch.on("elementMouseout",function(){dispatch.tooltipHide(),bars.clearHighlights()}),legend.dispatch.on("legendClick",function(d){d.disabled=!d.disabled,data.filter(function(d){return!d.disabled}).length||data.map(function(d){return d.disabled=!1,wrap.selectAll(".nv-series").classed("disabled",!1),d}),state.disabled=data.map(function(d){return!!d.disabled}),dispatch.stateChange(state),selection.transition().call(chart)}),legend.dispatch.on("legendDblclick",function(d){data.forEach(function(d){d.disabled=!0}),d.disabled=!1,state.disabled=data.map(function(d){return!!d.disabled}),dispatch.stateChange(state),chart.update()}),dispatch.on("changeState",function(e){"undefined"!=typeof e.disabled&&(data.forEach(function(series,i){series.disabled=e.disabled[i]}),state.disabled=e.disabled),chart.update()})}),renderWatch.renderEnd("historicalBarChart immediate"),chart}var x,y,bars=bar_model||nv.models.historicalBar(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),interactiveLayer=nv.interactiveGuideline(),tooltip=nv.models.tooltip(),margin={top:30,right:90,bottom:50,left:90},color=nv.utils.defaultColor(),width=null,height=null,showLegend=!1,showXAxis=!0,showYAxis=!0,rightAlignYAxis=!1,useInteractiveGuideline=!1,state={},defaultState=null,noData=null,dispatch=d3.dispatch("tooltipHide","stateChange","changeState","renderEnd"),transitionDuration=250;xAxis.orient("bottom").tickPadding(7),yAxis.orient(rightAlignYAxis?"right":"left"),tooltip.duration(0).headerEnabled(!1).valueFormatter(function(d,i){return yAxis.tickFormat()(d,i)}).headerFormatter(function(d,i){return xAxis.tickFormat()(d,i)});var renderWatch=nv.utils.renderWatch(dispatch,0);return bars.dispatch.on("elementMouseover.tooltip",function(evt){evt.series={key:chart.x()(evt.data),value:chart.y()(evt.data),color:evt.color},tooltip.data(evt).hidden(!1)}),bars.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),bars.dispatch.on("elementMousemove.tooltip",function(){tooltip.position({top:d3.event.pageY,left:d3.event.pageX})()}),chart.dispatch=dispatch,chart.bars=bars,chart.legend=legend,chart.xAxis=xAxis,chart.yAxis=yAxis,chart.interactiveLayer=interactiveLayer,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},showLegend:{get:function(){return showLegend},set:function(_){showLegend=_}},showXAxis:{get:function(){return showXAxis},set:function(_){showXAxis=_}},showYAxis:{get:function(){return showYAxis},set:function(_){showYAxis=_}},defaultState:{get:function(){return defaultState},set:function(_){defaultState=_}},noData:{get:function(){return noData},set:function(_){noData=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),legend.color(color),bars.color(color)}},duration:{get:function(){return transitionDuration},set:function(_){transitionDuration=_,renderWatch.reset(transitionDuration),yAxis.duration(transitionDuration),xAxis.duration(transitionDuration)}},rightAlignYAxis:{get:function(){return rightAlignYAxis},set:function(_){rightAlignYAxis=_,yAxis.orient(_?"right":"left")}},useInteractiveGuideline:{get:function(){return useInteractiveGuideline},set:function(_){useInteractiveGuideline=_,_===!0&&chart.interactive(!1)}}}),nv.utils.inheritOptions(chart,bars),nv.utils.initOptions(chart),chart},nv.models.ohlcBarChart=function(){var chart=nv.models.historicalBarChart(nv.models.ohlcBar());return chart.useInteractiveGuideline(!0),chart.interactiveLayer.tooltip.contentGenerator(function(data){var d=data.series[0].data,color=d.open<d.close?"2ca02c":"d62728";return'<h3 style="color: #'+color+'">'+data.value+"</h3><table><tr><td>open:</td><td>"+chart.yAxis.tickFormat()(d.open)+"</td></tr><tr><td>close:</td><td>"+chart.yAxis.tickFormat()(d.close)+"</td></tr><tr><td>high</td><td>"+chart.yAxis.tickFormat()(d.high)+"</td></tr><tr><td>low:</td><td>"+chart.yAxis.tickFormat()(d.low)+"</td></tr></table>"}),chart},nv.models.candlestickBarChart=function(){var chart=nv.models.historicalBarChart(nv.models.candlestickBar());return chart.useInteractiveGuideline(!0),chart.interactiveLayer.tooltip.contentGenerator(function(data){var d=data.series[0].data,color=d.open<d.close?"2ca02c":"d62728";return'<h3 style="color: #'+color+'">'+data.value+"</h3><table><tr><td>open:</td><td>"+chart.yAxis.tickFormat()(d.open)+"</td></tr><tr><td>close:</td><td>"+chart.yAxis.tickFormat()(d.close)+"</td></tr><tr><td>high</td><td>"+chart.yAxis.tickFormat()(d.high)+"</td></tr><tr><td>low:</td><td>"+chart.yAxis.tickFormat()(d.low)+"</td></tr></table>"}),chart},nv.models.legend=function(){"use strict";function chart(selection){function setTextColor(d,i){return"furious"!=vers?"#000":expanded?d.disengaged?"#000":"#fff":expanded?void 0:(d.color||(d.color=color(d,i)),d.disabled?d.color:"#fff")}function setBGColor(d,i){return expanded&&"furious"==vers&&d.disengaged?"#eee":d.color||color(d,i)}function setBGOpacity(d){return expanded&&"furious"==vers?1:d.disabled?0:1}return selection.each(function(data){var availableWidth=width-margin.left-margin.right,container=d3.select(this);nv.utils.initSVG(container);var wrap=container.selectAll("g.nv-legend").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-legend").append("g"),g=wrap.select("g");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var seriesShape,versPadding,series=g.selectAll(".nv-series").data(function(d){return"furious"!=vers?d:d.filter(function(n){return expanded?!0:!n.disengaged})}),seriesEnter=series.enter().append("g").attr("class","nv-series");switch(vers){case"furious":versPadding=23;break;case"classic":versPadding=20}if("classic"==vers)seriesEnter.append("circle").style("stroke-width",2).attr("class","nv-legend-symbol").attr("r",5),seriesShape=series.select("circle");else if("furious"==vers){seriesEnter.append("rect").style("stroke-width",2).attr("class","nv-legend-symbol").attr("rx",3).attr("ry",3),seriesShape=series.select(".nv-legend-symbol"),seriesEnter.append("g").attr("class","nv-check-box").property("innerHTML",'<path d="M0.5,5 L22.5,5 L22.5,26.5 L0.5,26.5 L0.5,5 Z" class="nv-box"></path><path d="M5.5,12.8618467 L11.9185089,19.2803556 L31,0.198864511" class="nv-check"></path>').attr("transform","translate(-10,-8)scale(0.5)");var seriesCheckbox=series.select(".nv-check-box");seriesCheckbox.each(function(d,i){d3.select(this).selectAll("path").attr("stroke",setTextColor(d,i))
})}seriesEnter.append("text").attr("text-anchor","start").attr("class","nv-legend-text").attr("dy",".32em").attr("dx","8");var seriesText=series.select("text.nv-legend-text");series.on("mouseover",function(d,i){dispatch.legendMouseover(d,i)}).on("mouseout",function(d,i){dispatch.legendMouseout(d,i)}).on("click",function(d,i){dispatch.legendClick(d,i);var data=series.data();if(updateState){if("classic"==vers)radioButtonMode?(data.forEach(function(series){series.disabled=!0}),d.disabled=!1):(d.disabled=!d.disabled,data.every(function(series){return series.disabled})&&data.forEach(function(series){series.disabled=!1}));else if("furious"==vers)if(expanded)d.disengaged=!d.disengaged,d.userDisabled=void 0==d.userDisabled?!!d.disabled:d.userDisabled,d.disabled=d.disengaged||d.userDisabled;else if(!expanded){d.disabled=!d.disabled,d.userDisabled=d.disabled;var engaged=data.filter(function(d){return!d.disengaged});engaged.every(function(series){return series.userDisabled})&&data.forEach(function(series){series.disabled=series.userDisabled=!1})}dispatch.stateChange({disabled:data.map(function(d){return!!d.disabled}),disengaged:data.map(function(d){return!!d.disengaged})})}}).on("dblclick",function(d,i){if(("furious"!=vers||!expanded)&&(dispatch.legendDblclick(d,i),updateState)){var data=series.data();data.forEach(function(series){series.disabled=!0,"furious"==vers&&(series.userDisabled=series.disabled)}),d.disabled=!1,"furious"==vers&&(d.userDisabled=d.disabled),dispatch.stateChange({disabled:data.map(function(d){return!!d.disabled})})}}),series.classed("nv-disabled",function(d){return d.userDisabled}),series.exit().remove(),seriesText.attr("fill",setTextColor).text(getKey);var legendWidth=0;if(align){var seriesWidths=[];series.each(function(){var nodeTextLength,legendText=d3.select(this).select("text");try{if(nodeTextLength=legendText.node().getComputedTextLength(),0>=nodeTextLength)throw Error()}catch(e){nodeTextLength=nv.utils.calcApproxTextWidth(legendText)}seriesWidths.push(nodeTextLength+padding)});var seriesPerRow=0,columnWidths=[];for(legendWidth=0;availableWidth>legendWidth&&seriesPerRow<seriesWidths.length;)columnWidths[seriesPerRow]=seriesWidths[seriesPerRow],legendWidth+=seriesWidths[seriesPerRow++];for(0===seriesPerRow&&(seriesPerRow=1);legendWidth>availableWidth&&seriesPerRow>1;){columnWidths=[],seriesPerRow--;for(var k=0;k<seriesWidths.length;k++)seriesWidths[k]>(columnWidths[k%seriesPerRow]||0)&&(columnWidths[k%seriesPerRow]=seriesWidths[k]);legendWidth=columnWidths.reduce(function(prev,cur){return prev+cur})}for(var xPositions=[],i=0,curX=0;seriesPerRow>i;i++)xPositions[i]=curX,curX+=columnWidths[i];series.attr("transform",function(d,i){return"translate("+xPositions[i%seriesPerRow]+","+(5+Math.floor(i/seriesPerRow)*versPadding)+")"}),rightAlign?g.attr("transform","translate("+(width-margin.right-legendWidth)+","+margin.top+")"):g.attr("transform","translate(0,"+margin.top+")"),height=margin.top+margin.bottom+Math.ceil(seriesWidths.length/seriesPerRow)*versPadding}else{var xpos,ypos=5,newxpos=5,maxwidth=0;series.attr("transform",function(){var length=d3.select(this).select("text").node().getComputedTextLength()+padding;return xpos=newxpos,width<margin.left+margin.right+xpos+length&&(newxpos=xpos=5,ypos+=versPadding),newxpos+=length,newxpos>maxwidth&&(maxwidth=newxpos),xpos+maxwidth>legendWidth&&(legendWidth=xpos+maxwidth),"translate("+xpos+","+ypos+")"}),g.attr("transform","translate("+(width-margin.right-maxwidth)+","+margin.top+")"),height=margin.top+margin.bottom+ypos+15}if("furious"==vers){seriesShape.attr("width",function(d,i){return seriesText[0][i].getComputedTextLength()+27}).attr("height",18).attr("y",-9).attr("x",-15),gEnter.insert("rect",":first-child").attr("class","nv-legend-bg").attr("fill","#eee").attr("opacity",0);var seriesBG=g.select(".nv-legend-bg");seriesBG.transition().duration(300).attr("x",-versPadding).attr("width",legendWidth+versPadding-12).attr("height",height+10).attr("y",-margin.top-10).attr("opacity",expanded?1:0)}seriesShape.style("fill",setBGColor).style("fill-opacity",setBGOpacity).style("stroke",setBGColor)}),chart}var margin={top:5,right:0,bottom:5,left:0},width=400,height=20,getKey=function(d){return d.key},color=nv.utils.getColor(),align=!0,padding=32,rightAlign=!0,updateState=!0,radioButtonMode=!1,expanded=!1,dispatch=d3.dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout","stateChange"),vers="classic";return chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},key:{get:function(){return getKey},set:function(_){getKey=_}},align:{get:function(){return align},set:function(_){align=_}},rightAlign:{get:function(){return rightAlign},set:function(_){rightAlign=_}},padding:{get:function(){return padding},set:function(_){padding=_}},updateState:{get:function(){return updateState},set:function(_){updateState=_}},radioButtonMode:{get:function(){return radioButtonMode},set:function(_){radioButtonMode=_}},expanded:{get:function(){return expanded},set:function(_){expanded=_}},vers:{get:function(){return vers},set:function(_){vers=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}}}),nv.utils.initOptions(chart),chart},nv.models.line=function(){"use strict";function chart(selection){return renderWatch.reset(),renderWatch.models(scatter),selection.each(function(data){container=d3.select(this);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);nv.utils.initSVG(container),x=scatter.xScale(),y=scatter.yScale(),x0=x0||x,y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-line").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-line"),defsEnter=wrapEnter.append("defs"),gEnter=wrapEnter.append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-groups"),gEnter.append("g").attr("class","nv-scatterWrap"),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),scatter.width(availableWidth).height(availableHeight);var scatterWrap=wrap.select(".nv-scatterWrap");scatterWrap.call(scatter),defsEnter.append("clipPath").attr("id","nv-edge-clip-"+scatter.id()).append("rect"),wrap.select("#nv-edge-clip-"+scatter.id()+" rect").attr("width",availableWidth).attr("height",availableHeight>0?availableHeight:0),g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+scatter.id()+")":""),scatterWrap.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+scatter.id()+")":"");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",1e-6).style("stroke-width",function(d){return d.strokeWidth||strokeWidth}).style("fill-opacity",1e-6),groups.exit().remove(),groups.attr("class",function(d,i){return(d.classed||"")+" nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}).style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)}),groups.watchTransition(renderWatch,"line: groups").style("stroke-opacity",1).style("fill-opacity",function(d){return d.fillOpacity||.5});var areaPaths=groups.selectAll("path.nv-area").data(function(d){return isArea(d)?[d]:[]});areaPaths.enter().append("path").attr("class","nv-area").attr("d",function(d){return d3.svg.area().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x0(getX(d,i)))}).y0(function(d,i){return nv.utils.NaNtoZero(y0(getY(d,i)))}).y1(function(){return y0(y.domain()[0]<=0?y.domain()[1]>=0?0:y.domain()[1]:y.domain()[0])}).apply(this,[d.values])}),groups.exit().selectAll("path.nv-area").remove(),areaPaths.watchTransition(renderWatch,"line: areaPaths").attr("d",function(d){return d3.svg.area().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x(getX(d,i)))}).y0(function(d,i){return nv.utils.NaNtoZero(y(getY(d,i)))}).y1(function(){return y(y.domain()[0]<=0?y.domain()[1]>=0?0:y.domain()[1]:y.domain()[0])}).apply(this,[d.values])});var linePaths=groups.selectAll("path.nv-line").data(function(d){return[d.values]});linePaths.enter().append("path").attr("class","nv-line").attr("d",d3.svg.line().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x0(getX(d,i)))}).y(function(d,i){return nv.utils.NaNtoZero(y0(getY(d,i)))})),linePaths.watchTransition(renderWatch,"line: linePaths").attr("d",d3.svg.line().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x(getX(d,i)))}).y(function(d,i){return nv.utils.NaNtoZero(y(getY(d,i)))})),x0=x.copy(),y0=y.copy()}),renderWatch.renderEnd("line immediate"),chart}var x,y,scatter=nv.models.scatter(),margin={top:0,right:0,bottom:0,left:0},width=960,height=500,container=null,strokeWidth=1.5,color=nv.utils.defaultColor(),getX=function(d){return d.x},getY=function(d){return d.y},defined=function(d,i){return!isNaN(getY(d,i))&&null!==getY(d,i)},isArea=function(d){return d.area},clipEdge=!1,interpolate="linear",duration=250,dispatch=d3.dispatch("elementClick","elementMouseover","elementMouseout","renderEnd");scatter.pointSize(16).pointDomain([16,256]);var x0,y0,renderWatch=nv.utils.renderWatch(dispatch,duration);return chart.dispatch=dispatch,chart.scatter=scatter,scatter.dispatch.on("elementClick",function(){dispatch.elementClick.apply(this,arguments)}),scatter.dispatch.on("elementMouseover",function(){dispatch.elementMouseover.apply(this,arguments)}),scatter.dispatch.on("elementMouseout",function(){dispatch.elementMouseout.apply(this,arguments)}),chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},defined:{get:function(){return defined},set:function(_){defined=_}},interpolate:{get:function(){return interpolate},set:function(_){interpolate=_}},clipEdge:{get:function(){return clipEdge},set:function(_){clipEdge=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration),scatter.duration(duration)}},isArea:{get:function(){return isArea},set:function(_){isArea=d3.functor(_)}},x:{get:function(){return getX},set:function(_){getX=_,scatter.x(_)}},y:{get:function(){return getY},set:function(_){getY=_,scatter.y(_)}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),scatter.color(color)}}}),nv.utils.inheritOptions(chart,scatter),nv.utils.initOptions(chart),chart},nv.models.lineChart=function(){"use strict";function chart(selection){return renderWatch.reset(),renderWatch.models(lines),showXAxis&&renderWatch.models(xAxis),showYAxis&&renderWatch.models(yAxis),selection.each(function(data){var container=d3.select(this),that=this;nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);if(chart.update=function(){0===duration?container.call(chart):container.transition().duration(duration).call(chart)},chart.container=this,state.setter(stateSetter(data),chart.update).getter(stateGetter(data)).update(),state.disabled=data.map(function(d){return!!d.disabled}),!defaultState){var key;defaultState={};for(key in state)defaultState[key]=state[key]instanceof Array?state[key].slice(0):state[key]}if(!(data&&data.length&&data.filter(function(d){return d.values.length}).length))return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove(),x=lines.xScale(),y=lines.yScale();var wrap=container.selectAll("g.nv-wrap.nv-lineChart").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-lineChart").append("g"),g=wrap.select("g");gEnter.append("rect").style("opacity",0),gEnter.append("g").attr("class","nv-x nv-axis"),gEnter.append("g").attr("class","nv-y nv-axis"),gEnter.append("g").attr("class","nv-linesWrap"),gEnter.append("g").attr("class","nv-legendWrap"),gEnter.append("g").attr("class","nv-interactive"),g.select("rect").attr("width",availableWidth).attr("height",availableHeight>0?availableHeight:0),showLegend&&(legend.width(availableWidth),g.select(".nv-legendWrap").datum(data).call(legend),margin.top!=legend.height()&&(margin.top=legend.height(),availableHeight=nv.utils.availableHeight(height,container,margin)),wrap.select(".nv-legendWrap").attr("transform","translate(0,"+-margin.top+")")),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),rightAlignYAxis&&g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)"),useInteractiveGuideline&&(interactiveLayer.width(availableWidth).height(availableHeight).margin({left:margin.left,top:margin.top}).svgContainer(container).xScale(x),wrap.select(".nv-interactive").call(interactiveLayer)),lines.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled}));var linesWrap=g.select(".nv-linesWrap").datum(data.filter(function(d){return!d.disabled}));linesWrap.call(lines),showXAxis&&(xAxis.scale(x)._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight,0),g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")"),g.select(".nv-x.nv-axis").call(xAxis)),showYAxis&&(yAxis.scale(y)._ticks(nv.utils.calcTicksY(availableHeight/36,data)).tickSize(-availableWidth,0),g.select(".nv-y.nv-axis").call(yAxis)),legend.dispatch.on("stateChange",function(newState){for(var key in newState)state[key]=newState[key];dispatch.stateChange(state),chart.update()}),interactiveLayer.dispatch.on("elementMousemove",function(e){lines.clearHighlights();var singlePoint,pointIndex,pointXLocation,allData=[];if(data.filter(function(series,i){return series.seriesIndex=i,!series.disabled}).forEach(function(series,i){pointIndex=nv.interactiveBisect(series.values,e.pointXValue,chart.x());var point=series.values[pointIndex],pointYValue=chart.y()(point,pointIndex);null!=pointYValue&&lines.highlightPoint(i,pointIndex,!0),void 0!==point&&(void 0===singlePoint&&(singlePoint=point),void 0===pointXLocation&&(pointXLocation=chart.xScale()(chart.x()(point,pointIndex))),allData.push({key:series.key,value:pointYValue,color:color(series,series.seriesIndex)}))}),allData.length>2){var yValue=chart.yScale().invert(e.mouseY),domainExtent=Math.abs(chart.yScale().domain()[0]-chart.yScale().domain()[1]),threshold=.03*domainExtent,indexToHighlight=nv.nearestValueIndex(allData.map(function(d){return d.value}),yValue,threshold);null!==indexToHighlight&&(allData[indexToHighlight].highlight=!0)}var xValue=xAxis.tickFormat()(chart.x()(singlePoint,pointIndex));interactiveLayer.tooltip.position({left:e.mouseX+margin.left,top:e.mouseY+margin.top}).chartContainer(that.parentNode).valueFormatter(function(d){return null==d?"N/A":yAxis.tickFormat()(d)}).data({value:xValue,index:pointIndex,series:allData})(),interactiveLayer.renderGuideLine(pointXLocation)}),interactiveLayer.dispatch.on("elementClick",function(e){var pointXLocation,allData=[];data.filter(function(series,i){return series.seriesIndex=i,!series.disabled}).forEach(function(series){var pointIndex=nv.interactiveBisect(series.values,e.pointXValue,chart.x()),point=series.values[pointIndex];if("undefined"!=typeof point){"undefined"==typeof pointXLocation&&(pointXLocation=chart.xScale()(chart.x()(point,pointIndex)));var yPos=chart.yScale()(chart.y()(point,pointIndex));allData.push({point:point,pointIndex:pointIndex,pos:[pointXLocation,yPos],seriesIndex:series.seriesIndex,series:series})}}),lines.dispatch.elementClick(allData)}),interactiveLayer.dispatch.on("elementMouseout",function(){lines.clearHighlights()}),dispatch.on("changeState",function(e){"undefined"!=typeof e.disabled&&data.length===e.disabled.length&&(data.forEach(function(series,i){series.disabled=e.disabled[i]}),state.disabled=e.disabled),chart.update()})}),renderWatch.renderEnd("lineChart immediate"),chart}var x,y,lines=nv.models.line(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),interactiveLayer=nv.interactiveGuideline(),tooltip=nv.models.tooltip(),margin={top:30,right:20,bottom:50,left:60},color=nv.utils.defaultColor(),width=null,height=null,showLegend=!0,showXAxis=!0,showYAxis=!0,rightAlignYAxis=!1,useInteractiveGuideline=!1,state=nv.utils.state(),defaultState=null,noData=null,dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState","renderEnd"),duration=250;xAxis.orient("bottom").tickPadding(7),yAxis.orient(rightAlignYAxis?"right":"left"),tooltip.valueFormatter(function(d,i){return yAxis.tickFormat()(d,i)}).headerFormatter(function(d,i){return xAxis.tickFormat()(d,i)});var renderWatch=nv.utils.renderWatch(dispatch,duration),stateGetter=function(data){return function(){return{active:data.map(function(d){return!d.disabled})}}},stateSetter=function(data){return function(state){void 0!==state.active&&data.forEach(function(series,i){series.disabled=!state.active[i]})}};return lines.dispatch.on("elementMouseover.tooltip",function(evt){tooltip.data(evt).position(evt.pos).hidden(!1)}),lines.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),chart.dispatch=dispatch,chart.lines=lines,chart.legend=legend,chart.xAxis=xAxis,chart.yAxis=yAxis,chart.interactiveLayer=interactiveLayer,chart.tooltip=tooltip,chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},showLegend:{get:function(){return showLegend},set:function(_){showLegend=_}},showXAxis:{get:function(){return showXAxis},set:function(_){showXAxis=_}},showYAxis:{get:function(){return showYAxis},set:function(_){showYAxis=_}},defaultState:{get:function(){return defaultState},set:function(_){defaultState=_}},noData:{get:function(){return noData},set:function(_){noData=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration),lines.duration(duration),xAxis.duration(duration),yAxis.duration(duration)}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),legend.color(color),lines.color(color)}},rightAlignYAxis:{get:function(){return rightAlignYAxis},set:function(_){rightAlignYAxis=_,yAxis.orient(rightAlignYAxis?"right":"left")}},useInteractiveGuideline:{get:function(){return useInteractiveGuideline},set:function(_){useInteractiveGuideline=_,useInteractiveGuideline&&(lines.interactive(!1),lines.useVoronoi(!1))}}}),nv.utils.inheritOptions(chart,lines),nv.utils.initOptions(chart),chart},nv.models.linePlusBarChart=function(){"use strict";function chart(selection){return selection.each(function(data){function resizePath(d){var e=+("e"==d),x=e?1:-1,y=availableHeight2/3;return"M"+.5*x+","+y+"A6,6 0 0 "+e+" "+6.5*x+","+(y+6)+"V"+(2*y-6)+"A6,6 0 0 "+e+" "+.5*x+","+2*y+"ZM"+2.5*x+","+(y+8)+"V"+(2*y-8)+"M"+4.5*x+","+(y+8)+"V"+(2*y-8)}function updateBrushBG(){brush.empty()||brush.extent(brushExtent),brushBG.data([brush.empty()?x2.domain():brushExtent]).each(function(d){var leftWidth=x2(d[0])-x2.range()[0],rightWidth=x2.range()[1]-x2(d[1]);d3.select(this).select(".left").attr("width",0>leftWidth?0:leftWidth),d3.select(this).select(".right").attr("x",x2(d[1])).attr("width",0>rightWidth?0:rightWidth)})}function onBrush(){brushExtent=brush.empty()?null:brush.extent(),extent=brush.empty()?x2.domain():brush.extent(),dispatch.brush({extent:extent,brush:brush}),updateBrushBG(),bars.width(availableWidth).height(availableHeight1).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled&&data[i].bar})),lines.width(availableWidth).height(availableHeight1).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled&&!data[i].bar}));var focusBarsWrap=g.select(".nv-focus .nv-barsWrap").datum(dataBars.length?dataBars.map(function(d){return{key:d.key,values:d.values.filter(function(d,i){return bars.x()(d,i)>=extent[0]&&bars.x()(d,i)<=extent[1]})}}):[{values:[]}]),focusLinesWrap=g.select(".nv-focus .nv-linesWrap").datum(dataLines[0].disabled?[{values:[]}]:dataLines.map(function(d){return{area:d.area,fillOpacity:d.fillOpacity,key:d.key,values:d.values.filter(function(d,i){return lines.x()(d,i)>=extent[0]&&lines.x()(d,i)<=extent[1]})}}));x=dataBars.length?bars.xScale():lines.xScale(),xAxis.scale(x)._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight1,0),xAxis.domain([Math.ceil(extent[0]),Math.floor(extent[1])]),g.select(".nv-x.nv-axis").transition().duration(transitionDuration).call(xAxis),focusBarsWrap.transition().duration(transitionDuration).call(bars),focusLinesWrap.transition().duration(transitionDuration).call(lines),g.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+y1.range()[0]+")"),y1Axis.scale(y1)._ticks(nv.utils.calcTicksY(availableHeight1/36,data)).tickSize(-availableWidth,0),y2Axis.scale(y2)._ticks(nv.utils.calcTicksY(availableHeight1/36,data)).tickSize(dataBars.length?0:-availableWidth,0),g.select(".nv-focus .nv-y1.nv-axis").style("opacity",dataBars.length?1:0),g.select(".nv-focus .nv-y2.nv-axis").style("opacity",dataLines.length&&!dataLines[0].disabled?1:0).attr("transform","translate("+x.range()[1]+",0)"),g.select(".nv-focus .nv-y1.nv-axis").transition().duration(transitionDuration).call(y1Axis),g.select(".nv-focus .nv-y2.nv-axis").transition().duration(transitionDuration).call(y2Axis)}var container=d3.select(this);nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight1=nv.utils.availableHeight(height,container,margin)-(focusEnable?focusHeight:0),availableHeight2=focusHeight-margin2.top-margin2.bottom;if(chart.update=function(){container.transition().duration(transitionDuration).call(chart)},chart.container=this,state.setter(stateSetter(data),chart.update).getter(stateGetter(data)).update(),state.disabled=data.map(function(d){return!!d.disabled}),!defaultState){var key;defaultState={};for(key in state)defaultState[key]=state[key]instanceof Array?state[key].slice(0):state[key]}if(!(data&&data.length&&data.filter(function(d){return d.values.length}).length))return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove();var dataBars=data.filter(function(d){return!d.disabled&&d.bar}),dataLines=data.filter(function(d){return!d.bar});x=bars.xScale(),x2=x2Axis.scale(),y1=bars.yScale(),y2=lines.yScale(),y3=bars2.yScale(),y4=lines2.yScale();var series1=data.filter(function(d){return!d.disabled&&d.bar}).map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i)}})}),series2=data.filter(function(d){return!d.disabled&&!d.bar}).map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i)}})});x.range([0,availableWidth]),x2.domain(d3.extent(d3.merge(series1.concat(series2)),function(d){return d.x})).range([0,availableWidth]);var wrap=container.selectAll("g.nv-wrap.nv-linePlusBar").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-linePlusBar").append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-legendWrap");var focusEnter=gEnter.append("g").attr("class","nv-focus");focusEnter.append("g").attr("class","nv-x nv-axis"),focusEnter.append("g").attr("class","nv-y1 nv-axis"),focusEnter.append("g").attr("class","nv-y2 nv-axis"),focusEnter.append("g").attr("class","nv-barsWrap"),focusEnter.append("g").attr("class","nv-linesWrap");var contextEnter=gEnter.append("g").attr("class","nv-context");if(contextEnter.append("g").attr("class","nv-x nv-axis"),contextEnter.append("g").attr("class","nv-y1 nv-axis"),contextEnter.append("g").attr("class","nv-y2 nv-axis"),contextEnter.append("g").attr("class","nv-barsWrap"),contextEnter.append("g").attr("class","nv-linesWrap"),contextEnter.append("g").attr("class","nv-brushBackground"),contextEnter.append("g").attr("class","nv-x nv-brush"),showLegend){var legendWidth=legend.align()?availableWidth/2:availableWidth,legendXPosition=legend.align()?legendWidth:0;legend.width(legendWidth),g.select(".nv-legendWrap").datum(data.map(function(series){return series.originalKey=void 0===series.originalKey?series.key:series.originalKey,series.key=series.originalKey+(series.bar?legendLeftAxisHint:legendRightAxisHint),series})).call(legend),margin.top!=legend.height()&&(margin.top=legend.height(),availableHeight1=nv.utils.availableHeight(height,container,margin)-focusHeight),g.select(".nv-legendWrap").attr("transform","translate("+legendXPosition+","+-margin.top+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")"),g.select(".nv-context").style("display",focusEnable?"initial":"none"),bars2.width(availableWidth).height(availableHeight2).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled&&data[i].bar})),lines2.width(availableWidth).height(availableHeight2).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled&&!data[i].bar}));var bars2Wrap=g.select(".nv-context .nv-barsWrap").datum(dataBars.length?dataBars:[{values:[]}]),lines2Wrap=g.select(".nv-context .nv-linesWrap").datum(dataLines[0].disabled?[{values:[]}]:dataLines);g.select(".nv-context").attr("transform","translate(0,"+(availableHeight1+margin.bottom+margin2.top)+")"),bars2Wrap.transition().call(bars2),lines2Wrap.transition().call(lines2),focusShowAxisX&&(x2Axis._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight2,0),g.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y3.range()[0]+")"),g.select(".nv-context .nv-x.nv-axis").transition().call(x2Axis)),focusShowAxisY&&(y3Axis.scale(y3)._ticks(availableHeight2/36).tickSize(-availableWidth,0),y4Axis.scale(y4)._ticks(availableHeight2/36).tickSize(dataBars.length?0:-availableWidth,0),g.select(".nv-context .nv-y3.nv-axis").style("opacity",dataBars.length?1:0).attr("transform","translate(0,"+x2.range()[0]+")"),g.select(".nv-context .nv-y2.nv-axis").style("opacity",dataLines.length?1:0).attr("transform","translate("+x2.range()[1]+",0)"),g.select(".nv-context .nv-y1.nv-axis").transition().call(y3Axis),g.select(".nv-context .nv-y2.nv-axis").transition().call(y4Axis)),brush.x(x2).on("brush",onBrush),brushExtent&&brush.extent(brushExtent);var brushBG=g.select(".nv-brushBackground").selectAll("g").data([brushExtent||brush.extent()]),brushBGenter=brushBG.enter().append("g");brushBGenter.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",availableHeight2),brushBGenter.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",availableHeight2);var gBrush=g.select(".nv-x.nv-brush").call(brush);gBrush.selectAll("rect").attr("height",availableHeight2),gBrush.selectAll(".resize").append("path").attr("d",resizePath),legend.dispatch.on("stateChange",function(newState){for(var key in newState)state[key]=newState[key];dispatch.stateChange(state),chart.update()}),dispatch.on("changeState",function(e){"undefined"!=typeof e.disabled&&(data.forEach(function(series,i){series.disabled=e.disabled[i]}),state.disabled=e.disabled),chart.update()}),onBrush()}),chart}var extent,x,x2,y1,y2,y3,y4,lines=nv.models.line(),lines2=nv.models.line(),bars=nv.models.historicalBar(),bars2=nv.models.historicalBar(),xAxis=nv.models.axis(),x2Axis=nv.models.axis(),y1Axis=nv.models.axis(),y2Axis=nv.models.axis(),y3Axis=nv.models.axis(),y4Axis=nv.models.axis(),legend=nv.models.legend(),brush=d3.svg.brush(),tooltip=nv.models.tooltip(),margin={top:30,right:30,bottom:30,left:60},margin2={top:0,right:30,bottom:20,left:60},width=null,height=null,getX=function(d){return d.x},getY=function(d){return d.y},color=nv.utils.defaultColor(),showLegend=!0,focusEnable=!0,focusShowAxisY=!1,focusShowAxisX=!0,focusHeight=50,brushExtent=null,noData=null,dispatch=d3.dispatch("brush","stateChange","changeState"),transitionDuration=0,state=nv.utils.state(),defaultState=null,legendLeftAxisHint=" (left axis)",legendRightAxisHint=" (right axis)";lines.clipEdge(!0),lines2.interactive(!1),xAxis.orient("bottom").tickPadding(5),y1Axis.orient("left"),y2Axis.orient("right"),x2Axis.orient("bottom").tickPadding(5),y3Axis.orient("left"),y4Axis.orient("right"),tooltip.headerEnabled(!0).headerFormatter(function(d,i){return xAxis.tickFormat()(d,i)});var stateGetter=function(data){return function(){return{active:data.map(function(d){return!d.disabled})}}},stateSetter=function(data){return function(state){void 0!==state.active&&data.forEach(function(series,i){series.disabled=!state.active[i]})}};return lines.dispatch.on("elementMouseover.tooltip",function(evt){tooltip.duration(100).valueFormatter(function(d,i){return y2Axis.tickFormat()(d,i)}).data(evt).position(evt.pos).hidden(!1)}),lines.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),bars.dispatch.on("elementMouseover.tooltip",function(evt){evt.value=chart.x()(evt.data),evt.series={value:chart.y()(evt.data),color:evt.color},tooltip.duration(0).valueFormatter(function(d,i){return y1Axis.tickFormat()(d,i)}).data(evt).hidden(!1)}),bars.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),bars.dispatch.on("elementMousemove.tooltip",function(){tooltip.position({top:d3.event.pageY,left:d3.event.pageX})()}),chart.dispatch=dispatch,chart.legend=legend,chart.lines=lines,chart.lines2=lines2,chart.bars=bars,chart.bars2=bars2,chart.xAxis=xAxis,chart.x2Axis=x2Axis,chart.y1Axis=y1Axis,chart.y2Axis=y2Axis,chart.y3Axis=y3Axis,chart.y4Axis=y4Axis,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},showLegend:{get:function(){return showLegend},set:function(_){showLegend=_}},brushExtent:{get:function(){return brushExtent},set:function(_){brushExtent=_}},noData:{get:function(){return noData},set:function(_){noData=_}},focusEnable:{get:function(){return focusEnable},set:function(_){focusEnable=_}},focusHeight:{get:function(){return focusHeight},set:function(_){focusHeight=_}},focusShowAxisX:{get:function(){return focusShowAxisX},set:function(_){focusShowAxisX=_}},focusShowAxisY:{get:function(){return focusShowAxisY},set:function(_){focusShowAxisY=_}},legendLeftAxisHint:{get:function(){return legendLeftAxisHint},set:function(_){legendLeftAxisHint=_}},legendRightAxisHint:{get:function(){return legendRightAxisHint},set:function(_){legendRightAxisHint=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()
},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return transitionDuration},set:function(_){transitionDuration=_}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),legend.color(color)}},x:{get:function(){return getX},set:function(_){getX=_,lines.x(_),lines2.x(_),bars.x(_),bars2.x(_)}},y:{get:function(){return getY},set:function(_){getY=_,lines.y(_),lines2.y(_),bars.y(_),bars2.y(_)}}}),nv.utils.inheritOptions(chart,lines),nv.utils.initOptions(chart),chart},nv.models.lineWithFocusChart=function(){"use strict";function chart(selection){return selection.each(function(data){function resizePath(d){var e=+("e"==d),x=e?1:-1,y=availableHeight2/3;return"M"+.5*x+","+y+"A6,6 0 0 "+e+" "+6.5*x+","+(y+6)+"V"+(2*y-6)+"A6,6 0 0 "+e+" "+.5*x+","+2*y+"ZM"+2.5*x+","+(y+8)+"V"+(2*y-8)+"M"+4.5*x+","+(y+8)+"V"+(2*y-8)}function updateBrushBG(){brush.empty()||brush.extent(brushExtent),brushBG.data([brush.empty()?x2.domain():brushExtent]).each(function(d){var leftWidth=x2(d[0])-x.range()[0],rightWidth=availableWidth-x2(d[1]);d3.select(this).select(".left").attr("width",0>leftWidth?0:leftWidth),d3.select(this).select(".right").attr("x",x2(d[1])).attr("width",0>rightWidth?0:rightWidth)})}function onBrush(){brushExtent=brush.empty()?null:brush.extent();var extent=brush.empty()?x2.domain():brush.extent();if(!(Math.abs(extent[0]-extent[1])<=1)){dispatch.brush({extent:extent,brush:brush}),updateBrushBG();var focusLinesWrap=g.select(".nv-focus .nv-linesWrap").datum(data.filter(function(d){return!d.disabled}).map(function(d){return{key:d.key,area:d.area,values:d.values.filter(function(d,i){return lines.x()(d,i)>=extent[0]&&lines.x()(d,i)<=extent[1]})}}));focusLinesWrap.transition().duration(transitionDuration).call(lines),g.select(".nv-focus .nv-x.nv-axis").transition().duration(transitionDuration).call(xAxis),g.select(".nv-focus .nv-y.nv-axis").transition().duration(transitionDuration).call(yAxis)}}var container=d3.select(this),that=this;nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight1=nv.utils.availableHeight(height,container,margin)-height2,availableHeight2=height2-margin2.top-margin2.bottom;if(chart.update=function(){container.transition().duration(transitionDuration).call(chart)},chart.container=this,state.setter(stateSetter(data),chart.update).getter(stateGetter(data)).update(),state.disabled=data.map(function(d){return!!d.disabled}),!defaultState){var key;defaultState={};for(key in state)defaultState[key]=state[key]instanceof Array?state[key].slice(0):state[key]}if(!(data&&data.length&&data.filter(function(d){return d.values.length}).length))return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove(),x=lines.xScale(),y=lines.yScale(),x2=lines2.xScale(),y2=lines2.yScale();var wrap=container.selectAll("g.nv-wrap.nv-lineWithFocusChart").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-lineWithFocusChart").append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-legendWrap");var focusEnter=gEnter.append("g").attr("class","nv-focus");focusEnter.append("g").attr("class","nv-x nv-axis"),focusEnter.append("g").attr("class","nv-y nv-axis"),focusEnter.append("g").attr("class","nv-linesWrap"),focusEnter.append("g").attr("class","nv-interactive");var contextEnter=gEnter.append("g").attr("class","nv-context");contextEnter.append("g").attr("class","nv-x nv-axis"),contextEnter.append("g").attr("class","nv-y nv-axis"),contextEnter.append("g").attr("class","nv-linesWrap"),contextEnter.append("g").attr("class","nv-brushBackground"),contextEnter.append("g").attr("class","nv-x nv-brush"),showLegend&&(legend.width(availableWidth),g.select(".nv-legendWrap").datum(data).call(legend),margin.top!=legend.height()&&(margin.top=legend.height(),availableHeight1=nv.utils.availableHeight(height,container,margin)-height2),g.select(".nv-legendWrap").attr("transform","translate(0,"+-margin.top+")")),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),useInteractiveGuideline&&(interactiveLayer.width(availableWidth).height(availableHeight1).margin({left:margin.left,top:margin.top}).svgContainer(container).xScale(x),wrap.select(".nv-interactive").call(interactiveLayer)),lines.width(availableWidth).height(availableHeight1).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled})),lines2.defined(lines.defined()).width(availableWidth).height(availableHeight2).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled})),g.select(".nv-context").attr("transform","translate(0,"+(availableHeight1+margin.bottom+margin2.top)+")");var contextLinesWrap=g.select(".nv-context .nv-linesWrap").datum(data.filter(function(d){return!d.disabled}));d3.transition(contextLinesWrap).call(lines2),xAxis.scale(x)._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight1,0),yAxis.scale(y)._ticks(nv.utils.calcTicksY(availableHeight1/36,data)).tickSize(-availableWidth,0),g.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+availableHeight1+")"),brush.x(x2).on("brush",function(){onBrush()}),brushExtent&&brush.extent(brushExtent);var brushBG=g.select(".nv-brushBackground").selectAll("g").data([brushExtent||brush.extent()]),brushBGenter=brushBG.enter().append("g");brushBGenter.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",availableHeight2),brushBGenter.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",availableHeight2);var gBrush=g.select(".nv-x.nv-brush").call(brush);gBrush.selectAll("rect").attr("height",availableHeight2),gBrush.selectAll(".resize").append("path").attr("d",resizePath),onBrush(),x2Axis.scale(x2)._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight2,0),g.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y2.range()[0]+")"),d3.transition(g.select(".nv-context .nv-x.nv-axis")).call(x2Axis),y2Axis.scale(y2)._ticks(nv.utils.calcTicksY(availableHeight2/36,data)).tickSize(-availableWidth,0),d3.transition(g.select(".nv-context .nv-y.nv-axis")).call(y2Axis),g.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y2.range()[0]+")"),legend.dispatch.on("stateChange",function(newState){for(var key in newState)state[key]=newState[key];dispatch.stateChange(state),chart.update()}),interactiveLayer.dispatch.on("elementMousemove",function(e){lines.clearHighlights();var singlePoint,pointIndex,pointXLocation,allData=[];if(data.filter(function(series,i){return series.seriesIndex=i,!series.disabled}).forEach(function(series,i){var extent=brush.empty()?x2.domain():brush.extent(),currentValues=series.values.filter(function(d,i){return lines.x()(d,i)>=extent[0]&&lines.x()(d,i)<=extent[1]});pointIndex=nv.interactiveBisect(currentValues,e.pointXValue,lines.x());var point=currentValues[pointIndex],pointYValue=chart.y()(point,pointIndex);null!=pointYValue&&lines.highlightPoint(i,pointIndex,!0),void 0!==point&&(void 0===singlePoint&&(singlePoint=point),void 0===pointXLocation&&(pointXLocation=chart.xScale()(chart.x()(point,pointIndex))),allData.push({key:series.key,value:chart.y()(point,pointIndex),color:color(series,series.seriesIndex)}))}),allData.length>2){var yValue=chart.yScale().invert(e.mouseY),domainExtent=Math.abs(chart.yScale().domain()[0]-chart.yScale().domain()[1]),threshold=.03*domainExtent,indexToHighlight=nv.nearestValueIndex(allData.map(function(d){return d.value}),yValue,threshold);null!==indexToHighlight&&(allData[indexToHighlight].highlight=!0)}var xValue=xAxis.tickFormat()(chart.x()(singlePoint,pointIndex));interactiveLayer.tooltip.position({left:e.mouseX+margin.left,top:e.mouseY+margin.top}).chartContainer(that.parentNode).valueFormatter(function(d){return null==d?"N/A":yAxis.tickFormat()(d)}).data({value:xValue,index:pointIndex,series:allData})(),interactiveLayer.renderGuideLine(pointXLocation)}),interactiveLayer.dispatch.on("elementMouseout",function(){lines.clearHighlights()}),dispatch.on("changeState",function(e){"undefined"!=typeof e.disabled&&data.forEach(function(series,i){series.disabled=e.disabled[i]}),chart.update()})}),chart}var x,y,x2,y2,lines=nv.models.line(),lines2=nv.models.line(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),x2Axis=nv.models.axis(),y2Axis=nv.models.axis(),legend=nv.models.legend(),brush=d3.svg.brush(),tooltip=nv.models.tooltip(),interactiveLayer=nv.interactiveGuideline(),margin={top:30,right:30,bottom:30,left:60},margin2={top:0,right:30,bottom:20,left:60},color=nv.utils.defaultColor(),width=null,height=null,height2=50,useInteractiveGuideline=!1,showLegend=!0,brushExtent=null,noData=null,dispatch=d3.dispatch("brush","stateChange","changeState"),transitionDuration=250,state=nv.utils.state(),defaultState=null;lines.clipEdge(!0).duration(0),lines2.interactive(!1),xAxis.orient("bottom").tickPadding(5),yAxis.orient("left"),x2Axis.orient("bottom").tickPadding(5),y2Axis.orient("left"),tooltip.valueFormatter(function(d,i){return yAxis.tickFormat()(d,i)}).headerFormatter(function(d,i){return xAxis.tickFormat()(d,i)});var stateGetter=function(data){return function(){return{active:data.map(function(d){return!d.disabled})}}},stateSetter=function(data){return function(state){void 0!==state.active&&data.forEach(function(series,i){series.disabled=!state.active[i]})}};return lines.dispatch.on("elementMouseover.tooltip",function(evt){tooltip.data(evt).position(evt.pos).hidden(!1)}),lines.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),chart.dispatch=dispatch,chart.legend=legend,chart.lines=lines,chart.lines2=lines2,chart.xAxis=xAxis,chart.yAxis=yAxis,chart.x2Axis=x2Axis,chart.y2Axis=y2Axis,chart.interactiveLayer=interactiveLayer,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},focusHeight:{get:function(){return height2},set:function(_){height2=_}},showLegend:{get:function(){return showLegend},set:function(_){showLegend=_}},brushExtent:{get:function(){return brushExtent},set:function(_){brushExtent=_}},defaultState:{get:function(){return defaultState},set:function(_){defaultState=_}},noData:{get:function(){return noData},set:function(_){noData=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),legend.color(color)}},interpolate:{get:function(){return lines.interpolate()},set:function(_){lines.interpolate(_),lines2.interpolate(_)}},xTickFormat:{get:function(){return xAxis.tickFormat()},set:function(_){xAxis.tickFormat(_),x2Axis.tickFormat(_)}},yTickFormat:{get:function(){return yAxis.tickFormat()},set:function(_){yAxis.tickFormat(_),y2Axis.tickFormat(_)}},duration:{get:function(){return transitionDuration},set:function(_){transitionDuration=_,yAxis.duration(transitionDuration),y2Axis.duration(transitionDuration),xAxis.duration(transitionDuration),x2Axis.duration(transitionDuration)}},x:{get:function(){return lines.x()},set:function(_){lines.x(_),lines2.x(_)}},y:{get:function(){return lines.y()},set:function(_){lines.y(_),lines2.y(_)}},useInteractiveGuideline:{get:function(){return useInteractiveGuideline},set:function(_){useInteractiveGuideline=_,useInteractiveGuideline&&(lines.interactive(!1),lines.useVoronoi(!1))}}}),nv.utils.inheritOptions(chart,lines),nv.utils.initOptions(chart),chart},nv.models.multiBar=function(){"use strict";function chart(selection){return renderWatch.reset(),selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom;container=d3.select(this),nv.utils.initSVG(container);var nonStackableCount=0;if(hideable&&data.length&&(hideable=[{values:data[0].values.map(function(d){return{x:d.x,y:0,series:d.series,size:.01}})}]),stacked){var parsed=d3.layout.stack().offset(stackOffset).values(function(d){return d.values}).y(getY)(!data.length&&hideable?hideable:data);parsed.forEach(function(series,i){series.nonStackable?(data[i].nonStackableSeries=nonStackableCount++,parsed[i]=data[i]):i>0&&parsed[i-1].nonStackable&&parsed[i].values.map(function(d,j){d.y0-=parsed[i-1].values[j].y,d.y1=d.y0+d.y})}),data=parsed}data.forEach(function(series,i){series.values.forEach(function(point){point.series=i,point.key=series.key})}),stacked&&data[0].values.map(function(d,i){var posBase=0,negBase=0;data.map(function(d,idx){if(!data[idx].nonStackable){var f=d.values[i];f.size=Math.abs(f.y),f.y<0?(f.y1=negBase,negBase-=f.size):(f.y1=f.size+posBase,posBase+=f.size)}})});var seriesData=xDomain&&yDomain?[]:data.map(function(d,idx){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),y0:d.y0,y1:d.y1,idx:idx}})});x.domain(xDomain||d3.merge(seriesData).map(function(d){return d.x})).rangeBands(xRange||[0,availableWidth],groupSpacing),y.domain(yDomain||d3.extent(d3.merge(seriesData).map(function(d){var domain=d.y;return stacked&&!data[d.idx].nonStackable&&(domain=d.y>0?d.y1:d.y1+d.y),domain}).concat(forceY))).range(yRange||[availableHeight,0]),x.domain()[0]===x.domain()[1]&&x.domain(x.domain()[0]?[x.domain()[0]-.01*x.domain()[0],x.domain()[1]+.01*x.domain()[1]]:[-1,1]),y.domain()[0]===y.domain()[1]&&y.domain(y.domain()[0]?[y.domain()[0]+.01*y.domain()[0],y.domain()[1]-.01*y.domain()[1]]:[-1,1]),x0=x0||x,y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-multibar").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multibar"),defsEnter=wrapEnter.append("defs"),gEnter=wrapEnter.append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-groups"),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect"),wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight),g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d,i){return i});groups.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6);var exitTransition=renderWatch.transition(groups.exit().selectAll("rect.nv-bar"),"multibarExit",Math.min(100,duration)).attr("y",function(d){var yVal=y0(0)||0;return stacked&&data[d.series]&&!data[d.series].nonStackable&&(yVal=y0(d.y0)),yVal}).attr("height",0).remove();exitTransition.delay&&exitTransition.delay(function(d,i){var delay=i*(duration/(last_datalength+1))-i;return delay}),groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}).style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)}),groups.style("stroke-opacity",1).style("fill-opacity",.75);var bars=groups.selectAll("rect.nv-bar").data(function(d){return hideable&&!data.length?hideable.values:d.values});bars.exit().remove();bars.enter().append("rect").attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).attr("x",function(d,i,j){return stacked&&!data[j].nonStackable?0:j*x.rangeBand()/data.length}).attr("y",function(d,i,j){return y0(stacked&&!data[j].nonStackable?d.y0:0)||0}).attr("height",0).attr("width",function(d,i,j){return x.rangeBand()/(stacked&&!data[j].nonStackable?1:data.length)}).attr("transform",function(d,i){return"translate("+x(getX(d,i))+",0)"});bars.style("fill",function(d,i,j){return color(d,j,i)}).style("stroke",function(d,i,j){return color(d,j,i)}).on("mouseover",function(d,i){d3.select(this).classed("hover",!0),dispatch.elementMouseover({data:d,index:i,color:d3.select(this).style("fill")})}).on("mouseout",function(d,i){d3.select(this).classed("hover",!1),dispatch.elementMouseout({data:d,index:i,color:d3.select(this).style("fill")})}).on("mousemove",function(d,i){dispatch.elementMousemove({data:d,index:i,color:d3.select(this).style("fill")})}).on("click",function(d,i){dispatch.elementClick({data:d,index:i,color:d3.select(this).style("fill")}),d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({data:d,index:i,color:d3.select(this).style("fill")}),d3.event.stopPropagation()}),bars.attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).attr("transform",function(d,i){return"translate("+x(getX(d,i))+",0)"}),barColor&&(disabled||(disabled=data.map(function(){return!0})),bars.style("fill",function(d,i,j){return d3.rgb(barColor(d,i)).darker(disabled.map(function(d,i){return i}).filter(function(d,i){return!disabled[i]})[j]).toString()}).style("stroke",function(d,i,j){return d3.rgb(barColor(d,i)).darker(disabled.map(function(d,i){return i}).filter(function(d,i){return!disabled[i]})[j]).toString()}));var barSelection=bars.watchTransition(renderWatch,"multibar",Math.min(250,duration)).delay(function(d,i){return i*duration/data[0].values.length});stacked?barSelection.attr("y",function(d,i,j){var yVal=0;return yVal=data[j].nonStackable?getY(d,i)<0?y(0):y(0)-y(getY(d,i))<-1?y(0)-1:y(getY(d,i))||0:y(d.y1)}).attr("height",function(d,i,j){return data[j].nonStackable?Math.max(Math.abs(y(getY(d,i))-y(0)),1)||0:Math.max(Math.abs(y(d.y+d.y0)-y(d.y0)),1)}).attr("x",function(d,i,j){var width=0;return data[j].nonStackable&&(width=d.series*x.rangeBand()/data.length,data.length!==nonStackableCount&&(width=data[j].nonStackableSeries*x.rangeBand()/(2*nonStackableCount))),width}).attr("width",function(d,i,j){if(data[j].nonStackable){var width=x.rangeBand()/nonStackableCount;return data.length!==nonStackableCount&&(width=x.rangeBand()/(2*nonStackableCount)),width}return x.rangeBand()}):barSelection.attr("x",function(d){return d.series*x.rangeBand()/data.length}).attr("width",x.rangeBand()/data.length).attr("y",function(d,i){return getY(d,i)<0?y(0):y(0)-y(getY(d,i))<1?y(0)-1:y(getY(d,i))||0}).attr("height",function(d,i){return Math.max(Math.abs(y(getY(d,i))-y(0)),1)||0}),x0=x.copy(),y0=y.copy(),data[0]&&data[0].values&&(last_datalength=data[0].values.length)}),renderWatch.renderEnd("multibar immediate"),chart}var disabled,xDomain,yDomain,xRange,yRange,x0,y0,margin={top:0,right:0,bottom:0,left:0},width=960,height=500,x=d3.scale.ordinal(),y=d3.scale.linear(),id=Math.floor(1e4*Math.random()),container=null,getX=function(d){return d.x},getY=function(d){return d.y},forceY=[0],clipEdge=!0,stacked=!1,stackOffset="zero",color=nv.utils.defaultColor(),hideable=!1,barColor=null,duration=500,groupSpacing=.1,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),renderWatch=nv.utils.renderWatch(dispatch,duration),last_datalength=0;return chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},x:{get:function(){return getX},set:function(_){getX=_}},y:{get:function(){return getY},set:function(_){getY=_}},xScale:{get:function(){return x},set:function(_){x=_}},yScale:{get:function(){return y},set:function(_){y=_}},xDomain:{get:function(){return xDomain},set:function(_){xDomain=_}},yDomain:{get:function(){return yDomain},set:function(_){yDomain=_}},xRange:{get:function(){return xRange},set:function(_){xRange=_}},yRange:{get:function(){return yRange},set:function(_){yRange=_}},forceY:{get:function(){return forceY},set:function(_){forceY=_}},stacked:{get:function(){return stacked},set:function(_){stacked=_}},stackOffset:{get:function(){return stackOffset},set:function(_){stackOffset=_}},clipEdge:{get:function(){return clipEdge},set:function(_){clipEdge=_}},disabled:{get:function(){return disabled},set:function(_){disabled=_}},id:{get:function(){return id},set:function(_){id=_}},hideable:{get:function(){return hideable},set:function(_){hideable=_}},groupSpacing:{get:function(){return groupSpacing},set:function(_){groupSpacing=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration)}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}},barColor:{get:function(){return barColor},set:function(_){barColor=_?nv.utils.getColor(_):null}}}),nv.utils.initOptions(chart),chart},nv.models.multiBarChart=function(){"use strict";function chart(selection){return renderWatch.reset(),renderWatch.models(multibar),showXAxis&&renderWatch.models(xAxis),showYAxis&&renderWatch.models(yAxis),selection.each(function(data){var container=d3.select(this);nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);if(chart.update=function(){0===duration?container.call(chart):container.transition().duration(duration).call(chart)},chart.container=this,state.setter(stateSetter(data),chart.update).getter(stateGetter(data)).update(),state.disabled=data.map(function(d){return!!d.disabled}),!defaultState){var key;defaultState={};for(key in state)defaultState[key]=state[key]instanceof Array?state[key].slice(0):state[key]}if(!(data&&data.length&&data.filter(function(d){return d.values.length}).length))return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove(),x=multibar.xScale(),y=multibar.yScale();var wrap=container.selectAll("g.nv-wrap.nv-multiBarWithLegend").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarWithLegend").append("g"),g=wrap.select("g");if(gEnter.append("g").attr("class","nv-x nv-axis"),gEnter.append("g").attr("class","nv-y nv-axis"),gEnter.append("g").attr("class","nv-barsWrap"),gEnter.append("g").attr("class","nv-legendWrap"),gEnter.append("g").attr("class","nv-controlsWrap"),showLegend&&(legend.width(availableWidth-controlWidth()),g.select(".nv-legendWrap").datum(data).call(legend),margin.top!=legend.height()&&(margin.top=legend.height(),availableHeight=nv.utils.availableHeight(height,container,margin)),g.select(".nv-legendWrap").attr("transform","translate("+controlWidth()+","+-margin.top+")")),showControls){var controlsData=[{key:controlLabels.grouped||"Grouped",disabled:multibar.stacked()},{key:controlLabels.stacked||"Stacked",disabled:!multibar.stacked()}];controls.width(controlWidth()).color(["#444","#444","#444"]),g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+-margin.top+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")"),rightAlignYAxis&&g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)"),multibar.disabled(data.map(function(series){return series.disabled})).width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled}));var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return!d.disabled}));if(barsWrap.call(multibar),showXAxis){xAxis.scale(x)._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight,0),g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")"),g.select(".nv-x.nv-axis").call(xAxis);var xTicks=g.select(".nv-x.nv-axis > g").selectAll("g");if(xTicks.selectAll("line, text").style("opacity",1),staggerLabels){var getTranslate=function(x,y){return"translate("+x+","+y+")"},staggerUp=5,staggerDown=17;xTicks.selectAll("text").attr("transform",function(d,i,j){return getTranslate(0,j%2==0?staggerUp:staggerDown)});var totalInBetweenTicks=d3.selectAll(".nv-x.nv-axis .nv-wrap g g text")[0].length;g.selectAll(".nv-x.nv-axis .nv-axisMaxMin text").attr("transform",function(d,i){return getTranslate(0,0===i||totalInBetweenTicks%2!==0?staggerDown:staggerUp)})}reduceXTicks&&xTicks.filter(function(d,i){return i%Math.ceil(data[0].values.length/(availableWidth/100))!==0}).selectAll("text, line").style("opacity",0),rotateLabels&&xTicks.selectAll(".tick text").attr("transform","rotate("+rotateLabels+" 0,0)").style("text-anchor",rotateLabels>0?"start":"end"),g.select(".nv-x.nv-axis").selectAll("g.nv-axisMaxMin text").style("opacity",1)}showYAxis&&(yAxis.scale(y)._ticks(nv.utils.calcTicksY(availableHeight/36,data)).tickSize(-availableWidth,0),g.select(".nv-y.nv-axis").call(yAxis)),legend.dispatch.on("stateChange",function(newState){for(var key in newState)state[key]=newState[key];dispatch.stateChange(state),chart.update()}),controls.dispatch.on("legendClick",function(d){if(d.disabled){switch(controlsData=controlsData.map(function(s){return s.disabled=!0,s}),d.disabled=!1,d.key){case"Grouped":case controlLabels.grouped:multibar.stacked(!1);break;case"Stacked":case controlLabels.stacked:multibar.stacked(!0)}state.stacked=multibar.stacked(),dispatch.stateChange(state),chart.update()}}),dispatch.on("changeState",function(e){"undefined"!=typeof e.disabled&&(data.forEach(function(series,i){series.disabled=e.disabled[i]}),state.disabled=e.disabled),"undefined"!=typeof e.stacked&&(multibar.stacked(e.stacked),state.stacked=e.stacked,stacked=e.stacked),chart.update()})}),renderWatch.renderEnd("multibarchart immediate"),chart}var x,y,multibar=nv.models.multiBar(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend(),tooltip=nv.models.tooltip(),margin={top:30,right:20,bottom:50,left:60},width=null,height=null,color=nv.utils.defaultColor(),showControls=!0,controlLabels={},showLegend=!0,showXAxis=!0,showYAxis=!0,rightAlignYAxis=!1,reduceXTicks=!0,staggerLabels=!1,rotateLabels=0,state=nv.utils.state(),defaultState=null,noData=null,dispatch=d3.dispatch("stateChange","changeState","renderEnd"),controlWidth=function(){return showControls?180:0},duration=250;state.stacked=!1,multibar.stacked(!1),xAxis.orient("bottom").tickPadding(7).showMaxMin(!1).tickFormat(function(d){return d}),yAxis.orient(rightAlignYAxis?"right":"left").tickFormat(d3.format(",.1f")),tooltip.duration(0).valueFormatter(function(d,i){return yAxis.tickFormat()(d,i)}).headerFormatter(function(d,i){return xAxis.tickFormat()(d,i)}),controls.updateState(!1);var renderWatch=nv.utils.renderWatch(dispatch),stacked=!1,stateGetter=function(data){return function(){return{active:data.map(function(d){return!d.disabled}),stacked:stacked}}},stateSetter=function(data){return function(state){void 0!==state.stacked&&(stacked=state.stacked),void 0!==state.active&&data.forEach(function(series,i){series.disabled=!state.active[i]})}};return multibar.dispatch.on("elementMouseover.tooltip",function(evt){evt.value=chart.x()(evt.data),evt.series={key:evt.data.key,value:chart.y()(evt.data),color:evt.color},tooltip.data(evt).hidden(!1)}),multibar.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),multibar.dispatch.on("elementMousemove.tooltip",function(){tooltip.position({top:d3.event.pageY,left:d3.event.pageX})()}),chart.dispatch=dispatch,chart.multibar=multibar,chart.legend=legend,chart.controls=controls,chart.xAxis=xAxis,chart.yAxis=yAxis,chart.state=state,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},showLegend:{get:function(){return showLegend},set:function(_){showLegend=_}},showControls:{get:function(){return showControls},set:function(_){showControls=_}},controlLabels:{get:function(){return controlLabels},set:function(_){controlLabels=_}},showXAxis:{get:function(){return showXAxis},set:function(_){showXAxis=_}},showYAxis:{get:function(){return showYAxis},set:function(_){showYAxis=_}},defaultState:{get:function(){return defaultState},set:function(_){defaultState=_}},noData:{get:function(){return noData},set:function(_){noData=_}},reduceXTicks:{get:function(){return reduceXTicks},set:function(_){reduceXTicks=_}},rotateLabels:{get:function(){return rotateLabels},set:function(_){rotateLabels=_}},staggerLabels:{get:function(){return staggerLabels},set:function(_){staggerLabels=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return duration},set:function(_){duration=_,multibar.duration(duration),xAxis.duration(duration),yAxis.duration(duration),renderWatch.reset(duration)}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),legend.color(color)}},rightAlignYAxis:{get:function(){return rightAlignYAxis},set:function(_){rightAlignYAxis=_,yAxis.orient(rightAlignYAxis?"right":"left")}},barColor:{get:function(){return multibar.barColor},set:function(_){multibar.barColor(_),legend.color(function(d,i){return d3.rgb("#ccc").darker(1.5*i).toString()})}}}),nv.utils.inheritOptions(chart,multibar),nv.utils.initOptions(chart),chart},nv.models.multiBarHorizontal=function(){"use strict";function chart(selection){return renderWatch.reset(),selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom;container=d3.select(this),nv.utils.initSVG(container),stacked&&(data=d3.layout.stack().offset("zero").values(function(d){return d.values}).y(getY)(data)),data.forEach(function(series,i){series.values.forEach(function(point){point.series=i,point.key=series.key})}),stacked&&data[0].values.map(function(d,i){var posBase=0,negBase=0;data.map(function(d){var f=d.values[i];f.size=Math.abs(f.y),f.y<0?(f.y1=negBase-f.size,negBase-=f.size):(f.y1=posBase,posBase+=f.size)})});var seriesData=xDomain&&yDomain?[]:data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),y0:d.y0,y1:d.y1}})});x.domain(xDomain||d3.merge(seriesData).map(function(d){return d.x})).rangeBands(xRange||[0,availableHeight],groupSpacing),y.domain(yDomain||d3.extent(d3.merge(seriesData).map(function(d){return stacked?d.y>0?d.y1+d.y:d.y1:d.y}).concat(forceY))),y.range(showValues&&!stacked?yRange||[y.domain()[0]<0?valuePadding:0,availableWidth-(y.domain()[1]>0?valuePadding:0)]:yRange||[0,availableWidth]),x0=x0||x,y0=y0||d3.scale.linear().domain(y.domain()).range([y(0),y(0)]);{var wrap=d3.select(this).selectAll("g.nv-wrap.nv-multibarHorizontal").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multibarHorizontal"),gEnter=(wrapEnter.append("defs"),wrapEnter.append("g"));wrap.select("g")}gEnter.append("g").attr("class","nv-groups"),wrap.attr("transform","translate("+margin.left+","+margin.top+")");
var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d,i){return i});groups.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),groups.exit().watchTransition(renderWatch,"multibarhorizontal: exit groups").style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}).style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)}),groups.watchTransition(renderWatch,"multibarhorizontal: groups").style("stroke-opacity",1).style("fill-opacity",.75);var bars=groups.selectAll("g.nv-bar").data(function(d){return d.values});bars.exit().remove();var barsEnter=bars.enter().append("g").attr("transform",function(d,i,j){return"translate("+y0(stacked?d.y0:0)+","+(stacked?0:j*x.rangeBand()/data.length+x(getX(d,i)))+")"});barsEnter.append("rect").attr("width",0).attr("height",x.rangeBand()/(stacked?1:data.length)),bars.on("mouseover",function(d,i){d3.select(this).classed("hover",!0),dispatch.elementMouseover({data:d,index:i,color:d3.select(this).style("fill")})}).on("mouseout",function(d,i){d3.select(this).classed("hover",!1),dispatch.elementMouseout({data:d,index:i,color:d3.select(this).style("fill")})}).on("mouseout",function(d,i){dispatch.elementMouseout({data:d,index:i,color:d3.select(this).style("fill")})}).on("mousemove",function(d,i){dispatch.elementMousemove({data:d,index:i,color:d3.select(this).style("fill")})}).on("click",function(d,i){dispatch.elementClick({data:d,index:i,color:d3.select(this).style("fill")}),d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({data:d,index:i,color:d3.select(this).style("fill")}),d3.event.stopPropagation()}),getYerr(data[0],0)&&(barsEnter.append("polyline"),bars.select("polyline").attr("fill","none").attr("points",function(d,i){var xerr=getYerr(d,i),mid=.8*x.rangeBand()/(2*(stacked?1:data.length));xerr=xerr.length?xerr:[-Math.abs(xerr),Math.abs(xerr)],xerr=xerr.map(function(e){return y(e)-y(0)});var a=[[xerr[0],-mid],[xerr[0],mid],[xerr[0],0],[xerr[1],0],[xerr[1],-mid],[xerr[1],mid]];return a.map(function(path){return path.join(",")}).join(" ")}).attr("transform",function(d,i){var mid=x.rangeBand()/(2*(stacked?1:data.length));return"translate("+(getY(d,i)<0?0:y(getY(d,i))-y(0))+", "+mid+")"})),barsEnter.append("text"),showValues&&!stacked?(bars.select("text").attr("text-anchor",function(d,i){return getY(d,i)<0?"end":"start"}).attr("y",x.rangeBand()/(2*data.length)).attr("dy",".32em").text(function(d,i){var t=valueFormat(getY(d,i)),yerr=getYerr(d,i);return void 0===yerr?t:yerr.length?t+"+"+valueFormat(Math.abs(yerr[1]))+"-"+valueFormat(Math.abs(yerr[0])):t+"±"+valueFormat(Math.abs(yerr))}),bars.watchTransition(renderWatch,"multibarhorizontal: bars").select("text").attr("x",function(d,i){return getY(d,i)<0?-4:y(getY(d,i))-y(0)+4})):bars.selectAll("text").text(""),showBarLabels&&!stacked?(barsEnter.append("text").classed("nv-bar-label",!0),bars.select("text.nv-bar-label").attr("text-anchor",function(d,i){return getY(d,i)<0?"start":"end"}).attr("y",x.rangeBand()/(2*data.length)).attr("dy",".32em").text(function(d,i){return getX(d,i)}),bars.watchTransition(renderWatch,"multibarhorizontal: bars").select("text.nv-bar-label").attr("x",function(d,i){return getY(d,i)<0?y(0)-y(getY(d,i))+4:-4})):bars.selectAll("text.nv-bar-label").text(""),bars.attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}),barColor&&(disabled||(disabled=data.map(function(){return!0})),bars.style("fill",function(d,i,j){return d3.rgb(barColor(d,i)).darker(disabled.map(function(d,i){return i}).filter(function(d,i){return!disabled[i]})[j]).toString()}).style("stroke",function(d,i,j){return d3.rgb(barColor(d,i)).darker(disabled.map(function(d,i){return i}).filter(function(d,i){return!disabled[i]})[j]).toString()})),stacked?bars.watchTransition(renderWatch,"multibarhorizontal: bars").attr("transform",function(d,i){return"translate("+y(d.y1)+","+x(getX(d,i))+")"}).select("rect").attr("width",function(d,i){return Math.abs(y(getY(d,i)+d.y0)-y(d.y0))}).attr("height",x.rangeBand()):bars.watchTransition(renderWatch,"multibarhorizontal: bars").attr("transform",function(d,i){return"translate("+y(getY(d,i)<0?getY(d,i):0)+","+(d.series*x.rangeBand()/data.length+x(getX(d,i)))+")"}).select("rect").attr("height",x.rangeBand()/data.length).attr("width",function(d,i){return Math.max(Math.abs(y(getY(d,i))-y(0)),1)}),x0=x.copy(),y0=y.copy()}),renderWatch.renderEnd("multibarHorizontal immediate"),chart}var disabled,xDomain,yDomain,xRange,yRange,x0,y0,margin={top:0,right:0,bottom:0,left:0},width=960,height=500,id=Math.floor(1e4*Math.random()),container=null,x=d3.scale.ordinal(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},getYerr=function(d){return d.yErr},forceY=[0],color=nv.utils.defaultColor(),barColor=null,stacked=!1,showValues=!1,showBarLabels=!1,valuePadding=60,groupSpacing=.1,valueFormat=d3.format(",.2f"),duration=250,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),renderWatch=nv.utils.renderWatch(dispatch,duration);return chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},x:{get:function(){return getX},set:function(_){getX=_}},y:{get:function(){return getY},set:function(_){getY=_}},yErr:{get:function(){return getYerr},set:function(_){getYerr=_}},xScale:{get:function(){return x},set:function(_){x=_}},yScale:{get:function(){return y},set:function(_){y=_}},xDomain:{get:function(){return xDomain},set:function(_){xDomain=_}},yDomain:{get:function(){return yDomain},set:function(_){yDomain=_}},xRange:{get:function(){return xRange},set:function(_){xRange=_}},yRange:{get:function(){return yRange},set:function(_){yRange=_}},forceY:{get:function(){return forceY},set:function(_){forceY=_}},stacked:{get:function(){return stacked},set:function(_){stacked=_}},showValues:{get:function(){return showValues},set:function(_){showValues=_}},disabled:{get:function(){return disabled},set:function(_){disabled=_}},id:{get:function(){return id},set:function(_){id=_}},valueFormat:{get:function(){return valueFormat},set:function(_){valueFormat=_}},valuePadding:{get:function(){return valuePadding},set:function(_){valuePadding=_}},groupSpacing:{get:function(){return groupSpacing},set:function(_){groupSpacing=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration)}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}},barColor:{get:function(){return barColor},set:function(_){barColor=_?nv.utils.getColor(_):null}}}),nv.utils.initOptions(chart),chart},nv.models.multiBarHorizontalChart=function(){"use strict";function chart(selection){return renderWatch.reset(),renderWatch.models(multibar),showXAxis&&renderWatch.models(xAxis),showYAxis&&renderWatch.models(yAxis),selection.each(function(data){var container=d3.select(this);nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);if(chart.update=function(){container.transition().duration(duration).call(chart)},chart.container=this,stacked=multibar.stacked(),state.setter(stateSetter(data),chart.update).getter(stateGetter(data)).update(),state.disabled=data.map(function(d){return!!d.disabled}),!defaultState){var key;defaultState={};for(key in state)defaultState[key]=state[key]instanceof Array?state[key].slice(0):state[key]}if(!(data&&data.length&&data.filter(function(d){return d.values.length}).length))return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove(),x=multibar.xScale(),y=multibar.yScale();var wrap=container.selectAll("g.nv-wrap.nv-multiBarHorizontalChart").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarHorizontalChart").append("g"),g=wrap.select("g");if(gEnter.append("g").attr("class","nv-x nv-axis"),gEnter.append("g").attr("class","nv-y nv-axis").append("g").attr("class","nv-zeroLine").append("line"),gEnter.append("g").attr("class","nv-barsWrap"),gEnter.append("g").attr("class","nv-legendWrap"),gEnter.append("g").attr("class","nv-controlsWrap"),showLegend&&(legend.width(availableWidth-controlWidth()),g.select(".nv-legendWrap").datum(data).call(legend),margin.top!=legend.height()&&(margin.top=legend.height(),availableHeight=nv.utils.availableHeight(height,container,margin)),g.select(".nv-legendWrap").attr("transform","translate("+controlWidth()+","+-margin.top+")")),showControls){var controlsData=[{key:controlLabels.grouped||"Grouped",disabled:multibar.stacked()},{key:controlLabels.stacked||"Stacked",disabled:!multibar.stacked()}];controls.width(controlWidth()).color(["#444","#444","#444"]),g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+-margin.top+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")"),multibar.disabled(data.map(function(series){return series.disabled})).width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled}));var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return!d.disabled}));if(barsWrap.transition().call(multibar),showXAxis){xAxis.scale(x)._ticks(nv.utils.calcTicksY(availableHeight/24,data)).tickSize(-availableWidth,0),g.select(".nv-x.nv-axis").call(xAxis);var xTicks=g.select(".nv-x.nv-axis").selectAll("g");xTicks.selectAll("line, text")}showYAxis&&(yAxis.scale(y)._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight,0),g.select(".nv-y.nv-axis").attr("transform","translate(0,"+availableHeight+")"),g.select(".nv-y.nv-axis").call(yAxis)),g.select(".nv-zeroLine line").attr("x1",y(0)).attr("x2",y(0)).attr("y1",0).attr("y2",-availableHeight),legend.dispatch.on("stateChange",function(newState){for(var key in newState)state[key]=newState[key];dispatch.stateChange(state),chart.update()}),controls.dispatch.on("legendClick",function(d){if(d.disabled){switch(controlsData=controlsData.map(function(s){return s.disabled=!0,s}),d.disabled=!1,d.key){case"Grouped":multibar.stacked(!1);break;case"Stacked":multibar.stacked(!0)}state.stacked=multibar.stacked(),dispatch.stateChange(state),stacked=multibar.stacked(),chart.update()}}),dispatch.on("changeState",function(e){"undefined"!=typeof e.disabled&&(data.forEach(function(series,i){series.disabled=e.disabled[i]}),state.disabled=e.disabled),"undefined"!=typeof e.stacked&&(multibar.stacked(e.stacked),state.stacked=e.stacked,stacked=e.stacked),chart.update()})}),renderWatch.renderEnd("multibar horizontal chart immediate"),chart}var x,y,multibar=nv.models.multiBarHorizontal(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend().height(30),controls=nv.models.legend().height(30),tooltip=nv.models.tooltip(),margin={top:30,right:20,bottom:50,left:60},width=null,height=null,color=nv.utils.defaultColor(),showControls=!0,controlLabels={},showLegend=!0,showXAxis=!0,showYAxis=!0,stacked=!1,state=nv.utils.state(),defaultState=null,noData=null,dispatch=d3.dispatch("stateChange","changeState","renderEnd"),controlWidth=function(){return showControls?180:0},duration=250;state.stacked=!1,multibar.stacked(stacked),xAxis.orient("left").tickPadding(5).showMaxMin(!1).tickFormat(function(d){return d}),yAxis.orient("bottom").tickFormat(d3.format(",.1f")),tooltip.duration(0).valueFormatter(function(d,i){return yAxis.tickFormat()(d,i)}).headerFormatter(function(d,i){return xAxis.tickFormat()(d,i)}),controls.updateState(!1);var stateGetter=function(data){return function(){return{active:data.map(function(d){return!d.disabled}),stacked:stacked}}},stateSetter=function(data){return function(state){void 0!==state.stacked&&(stacked=state.stacked),void 0!==state.active&&data.forEach(function(series,i){series.disabled=!state.active[i]})}},renderWatch=nv.utils.renderWatch(dispatch,duration);return multibar.dispatch.on("elementMouseover.tooltip",function(evt){evt.value=chart.x()(evt.data),evt.series={key:evt.data.key,value:chart.y()(evt.data),color:evt.color},tooltip.data(evt).hidden(!1)}),multibar.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),multibar.dispatch.on("elementMousemove.tooltip",function(){tooltip.position({top:d3.event.pageY,left:d3.event.pageX})()}),chart.dispatch=dispatch,chart.multibar=multibar,chart.legend=legend,chart.controls=controls,chart.xAxis=xAxis,chart.yAxis=yAxis,chart.state=state,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},showLegend:{get:function(){return showLegend},set:function(_){showLegend=_}},showControls:{get:function(){return showControls},set:function(_){showControls=_}},controlLabels:{get:function(){return controlLabels},set:function(_){controlLabels=_}},showXAxis:{get:function(){return showXAxis},set:function(_){showXAxis=_}},showYAxis:{get:function(){return showYAxis},set:function(_){showYAxis=_}},defaultState:{get:function(){return defaultState},set:function(_){defaultState=_}},noData:{get:function(){return noData},set:function(_){noData=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration),multibar.duration(duration),xAxis.duration(duration),yAxis.duration(duration)}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),legend.color(color)}},barColor:{get:function(){return multibar.barColor},set:function(_){multibar.barColor(_),legend.color(function(d,i){return d3.rgb("#ccc").darker(1.5*i).toString()})}}}),nv.utils.inheritOptions(chart,multibar),nv.utils.initOptions(chart),chart},nv.models.multiChart=function(){"use strict";function chart(selection){return selection.each(function(data){function mouseover_line(evt){var yaxis=2===data[evt.seriesIndex].yAxis?yAxis2:yAxis1;evt.value=evt.point.x,evt.series={value:evt.point.y,color:evt.point.color},tooltip.duration(100).valueFormatter(function(d,i){return yaxis.tickFormat()(d,i)}).data(evt).position(evt.pos).hidden(!1)}function mouseover_stack(evt){var yaxis=2===data[evt.seriesIndex].yAxis?yAxis2:yAxis1;evt.point.x=stack1.x()(evt.point),evt.point.y=stack1.y()(evt.point),tooltip.duration(100).valueFormatter(function(d,i){return yaxis.tickFormat()(d,i)}).data(evt).position(evt.pos).hidden(!1)}function mouseover_bar(evt){var yaxis=2===data[evt.data.series].yAxis?yAxis2:yAxis1;evt.value=bars1.x()(evt.data),evt.series={value:bars1.y()(evt.data),color:evt.color},tooltip.duration(0).valueFormatter(function(d,i){return yaxis.tickFormat()(d,i)}).data(evt).hidden(!1)}var container=d3.select(this);nv.utils.initSVG(container),chart.update=function(){container.transition().call(chart)},chart.container=this;var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin),dataLines1=data.filter(function(d){return"line"==d.type&&1==d.yAxis}),dataLines2=data.filter(function(d){return"line"==d.type&&2==d.yAxis}),dataBars1=data.filter(function(d){return"bar"==d.type&&1==d.yAxis}),dataBars2=data.filter(function(d){return"bar"==d.type&&2==d.yAxis}),dataStack1=data.filter(function(d){return"area"==d.type&&1==d.yAxis}),dataStack2=data.filter(function(d){return"area"==d.type&&2==d.yAxis});if(!(data&&data.length&&data.filter(function(d){return d.values.length}).length))return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove();var series1=data.filter(function(d){return!d.disabled&&1==d.yAxis}).map(function(d){return d.values.map(function(d){return{x:d.x,y:d.y}})}),series2=data.filter(function(d){return!d.disabled&&2==d.yAxis}).map(function(d){return d.values.map(function(d){return{x:d.x,y:d.y}})});x.domain(d3.extent(d3.merge(series1.concat(series2)),function(d){return d.x})).range([0,availableWidth]);var wrap=container.selectAll("g.wrap.multiChart").data([data]),gEnter=wrap.enter().append("g").attr("class","wrap nvd3 multiChart").append("g");gEnter.append("g").attr("class","nv-x nv-axis"),gEnter.append("g").attr("class","nv-y1 nv-axis"),gEnter.append("g").attr("class","nv-y2 nv-axis"),gEnter.append("g").attr("class","lines1Wrap"),gEnter.append("g").attr("class","lines2Wrap"),gEnter.append("g").attr("class","bars1Wrap"),gEnter.append("g").attr("class","bars2Wrap"),gEnter.append("g").attr("class","stack1Wrap"),gEnter.append("g").attr("class","stack2Wrap"),gEnter.append("g").attr("class","legendWrap");var g=wrap.select("g"),color_array=data.map(function(d,i){return data[i].color||color(d,i)});if(showLegend){var legendWidth=legend.align()?availableWidth/2:availableWidth,legendXPosition=legend.align()?legendWidth:0;legend.width(legendWidth),legend.color(color_array),g.select(".legendWrap").datum(data.map(function(series){return series.originalKey=void 0===series.originalKey?series.key:series.originalKey,series.key=series.originalKey+(1==series.yAxis?"":" (right axis)"),series})).call(legend),margin.top!=legend.height()&&(margin.top=legend.height(),availableHeight=nv.utils.availableHeight(height,container,margin)),g.select(".legendWrap").attr("transform","translate("+legendXPosition+","+-margin.top+")")}lines1.width(availableWidth).height(availableHeight).interpolate(interpolate).color(color_array.filter(function(d,i){return!data[i].disabled&&1==data[i].yAxis&&"line"==data[i].type})),lines2.width(availableWidth).height(availableHeight).interpolate(interpolate).color(color_array.filter(function(d,i){return!data[i].disabled&&2==data[i].yAxis&&"line"==data[i].type})),bars1.width(availableWidth).height(availableHeight).color(color_array.filter(function(d,i){return!data[i].disabled&&1==data[i].yAxis&&"bar"==data[i].type})),bars2.width(availableWidth).height(availableHeight).color(color_array.filter(function(d,i){return!data[i].disabled&&2==data[i].yAxis&&"bar"==data[i].type})),stack1.width(availableWidth).height(availableHeight).color(color_array.filter(function(d,i){return!data[i].disabled&&1==data[i].yAxis&&"area"==data[i].type})),stack2.width(availableWidth).height(availableHeight).color(color_array.filter(function(d,i){return!data[i].disabled&&2==data[i].yAxis&&"area"==data[i].type})),g.attr("transform","translate("+margin.left+","+margin.top+")");var lines1Wrap=g.select(".lines1Wrap").datum(dataLines1.filter(function(d){return!d.disabled})),bars1Wrap=g.select(".bars1Wrap").datum(dataBars1.filter(function(d){return!d.disabled})),stack1Wrap=g.select(".stack1Wrap").datum(dataStack1.filter(function(d){return!d.disabled})),lines2Wrap=g.select(".lines2Wrap").datum(dataLines2.filter(function(d){return!d.disabled})),bars2Wrap=g.select(".bars2Wrap").datum(dataBars2.filter(function(d){return!d.disabled})),stack2Wrap=g.select(".stack2Wrap").datum(dataStack2.filter(function(d){return!d.disabled})),extraValue1=dataStack1.length?dataStack1.map(function(a){return a.values}).reduce(function(a,b){return a.map(function(aVal,i){return{x:aVal.x,y:aVal.y+b[i].y}})}).concat([{x:0,y:0}]):[],extraValue2=dataStack2.length?dataStack2.map(function(a){return a.values}).reduce(function(a,b){return a.map(function(aVal,i){return{x:aVal.x,y:aVal.y+b[i].y}})}).concat([{x:0,y:0}]):[];yScale1.domain(yDomain1||d3.extent(d3.merge(series1).concat(extraValue1),function(d){return d.y})).range([0,availableHeight]),yScale2.domain(yDomain2||d3.extent(d3.merge(series2).concat(extraValue2),function(d){return d.y})).range([0,availableHeight]),lines1.yDomain(yScale1.domain()),bars1.yDomain(yScale1.domain()),stack1.yDomain(yScale1.domain()),lines2.yDomain(yScale2.domain()),bars2.yDomain(yScale2.domain()),stack2.yDomain(yScale2.domain()),dataStack1.length&&d3.transition(stack1Wrap).call(stack1),dataStack2.length&&d3.transition(stack2Wrap).call(stack2),dataBars1.length&&d3.transition(bars1Wrap).call(bars1),dataBars2.length&&d3.transition(bars2Wrap).call(bars2),dataLines1.length&&d3.transition(lines1Wrap).call(lines1),dataLines2.length&&d3.transition(lines2Wrap).call(lines2),xAxis._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight,0),g.select(".nv-x.nv-axis").attr("transform","translate(0,"+availableHeight+")"),d3.transition(g.select(".nv-x.nv-axis")).call(xAxis),yAxis1._ticks(nv.utils.calcTicksY(availableHeight/36,data)).tickSize(-availableWidth,0),d3.transition(g.select(".nv-y1.nv-axis")).call(yAxis1),yAxis2._ticks(nv.utils.calcTicksY(availableHeight/36,data)).tickSize(-availableWidth,0),d3.transition(g.select(".nv-y2.nv-axis")).call(yAxis2),g.select(".nv-y1.nv-axis").classed("nv-disabled",series1.length?!1:!0).attr("transform","translate("+x.range()[0]+",0)"),g.select(".nv-y2.nv-axis").classed("nv-disabled",series2.length?!1:!0).attr("transform","translate("+x.range()[1]+",0)"),legend.dispatch.on("stateChange",function(){chart.update()}),lines1.dispatch.on("elementMouseover.tooltip",mouseover_line),lines2.dispatch.on("elementMouseover.tooltip",mouseover_line),lines1.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),lines2.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),stack1.dispatch.on("elementMouseover.tooltip",mouseover_stack),stack2.dispatch.on("elementMouseover.tooltip",mouseover_stack),stack1.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),stack2.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),bars1.dispatch.on("elementMouseover.tooltip",mouseover_bar),bars2.dispatch.on("elementMouseover.tooltip",mouseover_bar),bars1.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),bars2.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),bars1.dispatch.on("elementMousemove.tooltip",function(){tooltip.position({top:d3.event.pageY,left:d3.event.pageX})()}),bars2.dispatch.on("elementMousemove.tooltip",function(){tooltip.position({top:d3.event.pageY,left:d3.event.pageX})()})}),chart}var yDomain1,yDomain2,margin={top:30,right:20,bottom:50,left:60},color=nv.utils.defaultColor(),width=null,height=null,showLegend=!0,noData=null,getX=function(d){return d.x},getY=function(d){return d.y},interpolate="monotone",useVoronoi=!0,x=d3.scale.linear(),yScale1=d3.scale.linear(),yScale2=d3.scale.linear(),lines1=nv.models.line().yScale(yScale1),lines2=nv.models.line().yScale(yScale2),bars1=nv.models.multiBar().stacked(!1).yScale(yScale1),bars2=nv.models.multiBar().stacked(!1).yScale(yScale2),stack1=nv.models.stackedArea().yScale(yScale1),stack2=nv.models.stackedArea().yScale(yScale2),xAxis=nv.models.axis().scale(x).orient("bottom").tickPadding(5),yAxis1=nv.models.axis().scale(yScale1).orient("left"),yAxis2=nv.models.axis().scale(yScale2).orient("right"),legend=nv.models.legend().height(30),tooltip=nv.models.tooltip(),dispatch=d3.dispatch();return chart.dispatch=dispatch,chart.lines1=lines1,chart.lines2=lines2,chart.bars1=bars1,chart.bars2=bars2,chart.stack1=stack1,chart.stack2=stack2,chart.xAxis=xAxis,chart.yAxis1=yAxis1,chart.yAxis2=yAxis2,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},showLegend:{get:function(){return showLegend},set:function(_){showLegend=_}},yDomain1:{get:function(){return yDomain1},set:function(_){yDomain1=_}},yDomain2:{get:function(){return yDomain2},set:function(_){yDomain2=_}},noData:{get:function(){return noData},set:function(_){noData=_}},interpolate:{get:function(){return interpolate},set:function(_){interpolate=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}},x:{get:function(){return getX},set:function(_){getX=_,lines1.x(_),lines2.x(_),bars1.x(_),bars2.x(_),stack1.x(_),stack2.x(_)}},y:{get:function(){return getY},set:function(_){getY=_,lines1.y(_),lines2.y(_),stack1.y(_),stack2.y(_),bars1.y(_),bars2.y(_)}},useVoronoi:{get:function(){return useVoronoi},set:function(_){useVoronoi=_,lines1.useVoronoi(_),lines2.useVoronoi(_),stack1.useVoronoi(_),stack2.useVoronoi(_)}}}),nv.utils.initOptions(chart),chart},nv.models.ohlcBar=function(){"use strict";function chart(selection){return selection.each(function(data){container=d3.select(this);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);nv.utils.initSVG(container);var w=availableWidth/data[0].values.length*.9;x.domain(xDomain||d3.extent(data[0].values.map(getX).concat(forceX))),x.range(padData?xRange||[.5*availableWidth/data[0].values.length,availableWidth*(data[0].values.length-.5)/data[0].values.length]:xRange||[5+w/2,availableWidth-w/2-5]),y.domain(yDomain||[d3.min(data[0].values.map(getLow).concat(forceY)),d3.max(data[0].values.map(getHigh).concat(forceY))]).range(yRange||[availableHeight,0]),x.domain()[0]===x.domain()[1]&&x.domain(x.domain()[0]?[x.domain()[0]-.01*x.domain()[0],x.domain()[1]+.01*x.domain()[1]]:[-1,1]),y.domain()[0]===y.domain()[1]&&y.domain(y.domain()[0]?[y.domain()[0]+.01*y.domain()[0],y.domain()[1]-.01*y.domain()[1]]:[-1,1]);var wrap=d3.select(this).selectAll("g.nv-wrap.nv-ohlcBar").data([data[0].values]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-ohlcBar"),defsEnter=wrapEnter.append("defs"),gEnter=wrapEnter.append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-ticks"),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),container.on("click",function(d,i){dispatch.chartClick({data:d,index:i,pos:d3.event,id:id})}),defsEnter.append("clipPath").attr("id","nv-chart-clip-path-"+id).append("rect"),wrap.select("#nv-chart-clip-path-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight),g.attr("clip-path",clipEdge?"url(#nv-chart-clip-path-"+id+")":"");var ticks=wrap.select(".nv-ticks").selectAll(".nv-tick").data(function(d){return d});ticks.exit().remove(),ticks.enter().append("path").attr("class",function(d,i,j){return(getOpen(d,i)>getClose(d,i)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+j+"-"+i}).attr("d",function(d,i){return"m0,0l0,"+(y(getOpen(d,i))-y(getHigh(d,i)))+"l"+-w/2+",0l"+w/2+",0l0,"+(y(getLow(d,i))-y(getOpen(d,i)))+"l0,"+(y(getClose(d,i))-y(getLow(d,i)))+"l"+w/2+",0l"+-w/2+",0z"}).attr("transform",function(d,i){return"translate("+x(getX(d,i))+","+y(getHigh(d,i))+")"}).attr("fill",function(){return color[0]}).attr("stroke",function(){return color[0]}).attr("x",0).attr("y",function(d,i){return y(Math.max(0,getY(d,i)))}).attr("height",function(d,i){return Math.abs(y(getY(d,i))-y(0))}),ticks.attr("class",function(d,i,j){return(getOpen(d,i)>getClose(d,i)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+j+"-"+i}),d3.transition(ticks).attr("transform",function(d,i){return"translate("+x(getX(d,i))+","+y(getHigh(d,i))+")"}).attr("d",function(d,i){var w=availableWidth/data[0].values.length*.9;return"m0,0l0,"+(y(getOpen(d,i))-y(getHigh(d,i)))+"l"+-w/2+",0l"+w/2+",0l0,"+(y(getLow(d,i))-y(getOpen(d,i)))+"l0,"+(y(getClose(d,i))-y(getLow(d,i)))+"l"+w/2+",0l"+-w/2+",0z"})}),chart}var xDomain,yDomain,xRange,yRange,margin={top:0,right:0,bottom:0,left:0},width=null,height=null,id=Math.floor(1e4*Math.random()),container=null,x=d3.scale.linear(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},getOpen=function(d){return d.open},getClose=function(d){return d.close},getHigh=function(d){return d.high},getLow=function(d){return d.low},forceX=[],forceY=[],padData=!1,clipEdge=!0,color=nv.utils.defaultColor(),interactive=!1,dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState","renderEnd","chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove");return chart.highlightPoint=function(pointIndex,isHoverOver){chart.clearHighlights(),container.select(".nv-ohlcBar .nv-tick-0-"+pointIndex).classed("hover",isHoverOver)},chart.clearHighlights=function(){container.select(".nv-ohlcBar .nv-tick.hover").classed("hover",!1)},chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},xScale:{get:function(){return x},set:function(_){x=_}},yScale:{get:function(){return y},set:function(_){y=_}},xDomain:{get:function(){return xDomain},set:function(_){xDomain=_}},yDomain:{get:function(){return yDomain},set:function(_){yDomain=_}},xRange:{get:function(){return xRange},set:function(_){xRange=_}},yRange:{get:function(){return yRange},set:function(_){yRange=_}},forceX:{get:function(){return forceX},set:function(_){forceX=_}},forceY:{get:function(){return forceY},set:function(_){forceY=_}},padData:{get:function(){return padData},set:function(_){padData=_}},clipEdge:{get:function(){return clipEdge},set:function(_){clipEdge=_}},id:{get:function(){return id},set:function(_){id=_}},interactive:{get:function(){return interactive},set:function(_){interactive=_}},x:{get:function(){return getX},set:function(_){getX=_}},y:{get:function(){return getY},set:function(_){getY=_}},open:{get:function(){return getOpen()},set:function(_){getOpen=_}},close:{get:function(){return getClose()},set:function(_){getClose=_}},high:{get:function(){return getHigh},set:function(_){getHigh=_}},low:{get:function(){return getLow},set:function(_){getLow=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!=_.top?_.top:margin.top,margin.right=void 0!=_.right?_.right:margin.right,margin.bottom=void 0!=_.bottom?_.bottom:margin.bottom,margin.left=void 0!=_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}}}),nv.utils.initOptions(chart),chart},nv.models.parallelCoordinates=function(){"use strict";function chart(selection){return selection.each(function(data){function path(d){return line(dimensionNames.map(function(p){if(isNaN(d[p])||isNaN(parseFloat(d[p]))){var domain=y[p].domain(),range=y[p].range(),min=domain[0]-(domain[1]-domain[0])/9;if(axisWithMissingValues.indexOf(p)<0){var newscale=d3.scale.linear().domain([min,domain[1]]).range([availableHeight-12,range[1]]);y[p].brush.y(newscale),axisWithMissingValues.push(p)
}return[x(p),y[p](min)]}return axisWithMissingValues.length>0?(missingValuesline.style("display","inline"),missingValueslineText.style("display","inline")):(missingValuesline.style("display","none"),missingValueslineText.style("display","none")),[x(p),y[p](d[p])]}))}function brush(){var actives=dimensionNames.filter(function(p){return!y[p].brush.empty()}),extents=actives.map(function(p){return y[p].brush.extent()});filters=[],actives.forEach(function(d,i){filters[i]={dimension:d,extent:extents[i]}}),active=[],foreground.style("display",function(d){var isActive=actives.every(function(p,i){return isNaN(d[p])&&extents[i][0]==y[p].brush.y().domain()[0]?!0:extents[i][0]<=d[p]&&d[p]<=extents[i][1]});return isActive&&active.push(d),isActive?null:"none"}),dispatch.brush({filters:filters,active:active})}function dragStart(d){dragging[d]=this.parentNode.__origin__=x(d),background.attr("visibility","hidden")}function dragMove(d){dragging[d]=Math.min(availableWidth,Math.max(0,this.parentNode.__origin__+=d3.event.x)),foreground.attr("d",path),dimensionNames.sort(function(a,b){return position(a)-position(b)}),x.domain(dimensionNames),dimensions.attr("transform",function(d){return"translate("+position(d)+")"})}function dragEnd(d){delete this.parentNode.__origin__,delete dragging[d],d3.select(this.parentNode).attr("transform","translate("+x(d)+")"),foreground.attr("d",path),background.attr("d",path).attr("visibility",null)}function position(d){var v=dragging[d];return null==v?x(d):v}var container=d3.select(this),availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);nv.utils.initSVG(container),active=data,x.rangePoints([0,availableWidth],1).domain(dimensionNames);var onlyNanValues={};dimensionNames.forEach(function(d){var extent=d3.extent(data,function(p){return+p[d]});return onlyNanValues[d]=!1,void 0===extent[0]&&(onlyNanValues[d]=!0,extent[0]=0,extent[1]=0),extent[0]===extent[1]&&(extent[0]=extent[0]-1,extent[1]=extent[1]+1),y[d]=d3.scale.linear().domain(extent).range([.9*(availableHeight-12),0]),y[d].brush=d3.svg.brush().y(y[d]).on("brush",brush),"name"!=d});var wrap=container.selectAll("g.nv-wrap.nv-parallelCoordinates").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-parallelCoordinates"),gEnter=wrapEnter.append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-parallelCoordinates background"),gEnter.append("g").attr("class","nv-parallelCoordinates foreground"),gEnter.append("g").attr("class","nv-parallelCoordinates missingValuesline"),wrap.attr("transform","translate("+margin.left+","+margin.top+")");var missingValuesline,missingValueslineText,line=d3.svg.line().interpolate("cardinal").tension(lineTension),axis=d3.svg.axis().orient("left"),axisDrag=d3.behavior.drag().on("dragstart",dragStart).on("drag",dragMove).on("dragend",dragEnd),step=x.range()[1]-x.range()[0],axisWithMissingValues=[],lineData=[0+step/2,availableHeight-12,availableWidth-step/2,availableHeight-12];missingValuesline=wrap.select(".missingValuesline").selectAll("line").data([lineData]),missingValuesline.enter().append("line"),missingValuesline.exit().remove(),missingValuesline.attr("x1",function(d){return d[0]}).attr("y1",function(d){return d[1]}).attr("x2",function(d){return d[2]}).attr("y2",function(d){return d[3]}),missingValueslineText=wrap.select(".missingValuesline").selectAll("text").data(["undefined values"]),missingValueslineText.append("text").data(["undefined values"]),missingValueslineText.enter().append("text"),missingValueslineText.exit().remove(),missingValueslineText.attr("y",availableHeight).attr("x",availableWidth-92-step/2).text(function(d){return d});var background=wrap.select(".background").selectAll("path").data(data);background.enter().append("path"),background.exit().remove(),background.attr("d",path);var foreground=wrap.select(".foreground").selectAll("path").data(data);foreground.enter().append("path"),foreground.exit().remove(),foreground.attr("d",path).attr("stroke",color),foreground.on("mouseover",function(d,i){d3.select(this).classed("hover",!0),dispatch.elementMouseover({label:d.name,data:d.data,index:i,pos:[d3.mouse(this.parentNode)[0],d3.mouse(this.parentNode)[1]]})}),foreground.on("mouseout",function(d,i){d3.select(this).classed("hover",!1),dispatch.elementMouseout({label:d.name,data:d.data,index:i})});var dimensions=g.selectAll(".dimension").data(dimensionNames),dimensionsEnter=dimensions.enter().append("g").attr("class","nv-parallelCoordinates dimension");dimensionsEnter.append("g").attr("class","nv-parallelCoordinates nv-axis"),dimensionsEnter.append("g").attr("class","nv-parallelCoordinates-brush"),dimensionsEnter.append("text").attr("class","nv-parallelCoordinates nv-label"),dimensions.attr("transform",function(d){return"translate("+x(d)+",0)"}),dimensions.exit().remove(),dimensions.select(".nv-label").style("cursor","move").attr("dy","-1em").attr("text-anchor","middle").text(String).on("mouseover",function(d){dispatch.elementMouseover({dim:d,pos:[d3.mouse(this.parentNode.parentNode)[0],d3.mouse(this.parentNode.parentNode)[1]]})}).on("mouseout",function(d){dispatch.elementMouseout({dim:d})}).call(axisDrag),dimensions.select(".nv-axis").each(function(d,i){d3.select(this).call(axis.scale(y[d]).tickFormat(d3.format(dimensionFormats[i])))}),dimensions.select(".nv-parallelCoordinates-brush").each(function(d){d3.select(this).call(y[d].brush)}).selectAll("rect").attr("x",-8).attr("width",16)}),chart}var margin={top:30,right:0,bottom:10,left:0},width=null,height=null,x=d3.scale.ordinal(),y={},dimensionNames=[],dimensionFormats=[],color=nv.utils.defaultColor(),filters=[],active=[],dragging=[],lineTension=1,dispatch=d3.dispatch("brush","elementMouseover","elementMouseout");return chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},dimensionNames:{get:function(){return dimensionNames},set:function(_){dimensionNames=_}},dimensionFormats:{get:function(){return dimensionFormats},set:function(_){dimensionFormats=_}},lineTension:{get:function(){return lineTension},set:function(_){lineTension=_}},dimensions:{get:function(){return dimensionNames},set:function(_){nv.deprecated("dimensions","use dimensionNames instead"),dimensionNames=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}}}),nv.utils.initOptions(chart),chart},nv.models.pie=function(){"use strict";function chart(selection){return renderWatch.reset(),selection.each(function(data){function arcTween(a,idx){a.endAngle=isNaN(a.endAngle)?0:a.endAngle,a.startAngle=isNaN(a.startAngle)?0:a.startAngle,donut||(a.innerRadius=0);var i=d3.interpolate(this._current,a);return this._current=i(0),function(t){return arcs[idx](i(t))}}var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,radius=Math.min(availableWidth,availableHeight)/2,arcsRadiusOuter=[],arcsRadiusInner=[];if(container=d3.select(this),0===arcsRadius.length)for(var outer=radius-radius/5,inner=donutRatio*radius,i=0;i<data[0].length;i++)arcsRadiusOuter.push(outer),arcsRadiusInner.push(inner);else arcsRadiusOuter=arcsRadius.map(function(d){return(d.outer-d.outer/5)*radius}),arcsRadiusInner=arcsRadius.map(function(d){return(d.inner-d.inner/5)*radius}),donutRatio=d3.min(arcsRadius.map(function(d){return d.inner-d.inner/5}));nv.utils.initSVG(container);var wrap=container.selectAll(".nv-wrap.nv-pie").data(data),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-pie nv-chart-"+id),gEnter=wrapEnter.append("g"),g=wrap.select("g"),g_pie=gEnter.append("g").attr("class","nv-pie");gEnter.append("g").attr("class","nv-pieLabels"),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),g.select(".nv-pie").attr("transform","translate("+availableWidth/2+","+availableHeight/2+")"),g.select(".nv-pieLabels").attr("transform","translate("+availableWidth/2+","+availableHeight/2+")"),container.on("click",function(d,i){dispatch.chartClick({data:d,index:i,pos:d3.event,id:id})}),arcs=[],arcsOver=[];for(var i=0;i<data[0].length;i++){var arc=d3.svg.arc().outerRadius(arcsRadiusOuter[i]),arcOver=d3.svg.arc().outerRadius(arcsRadiusOuter[i]+5);startAngle!==!1&&(arc.startAngle(startAngle),arcOver.startAngle(startAngle)),endAngle!==!1&&(arc.endAngle(endAngle),arcOver.endAngle(endAngle)),donut&&(arc.innerRadius(arcsRadiusInner[i]),arcOver.innerRadius(arcsRadiusInner[i])),arc.cornerRadius&&cornerRadius&&(arc.cornerRadius(cornerRadius),arcOver.cornerRadius(cornerRadius)),arcs.push(arc),arcsOver.push(arcOver)}var pie=d3.layout.pie().sort(null).value(function(d){return d.disabled?0:getY(d)});pie.padAngle&&padAngle&&pie.padAngle(padAngle),donut&&title&&(g_pie.append("text").attr("class","nv-pie-title"),wrap.select(".nv-pie-title").style("text-anchor","middle").text(function(){return title}).style("font-size",Math.min(availableWidth,availableHeight)*donutRatio*2/(title.length+2)+"px").attr("dy","0.35em").attr("transform",function(){return"translate(0, "+titleOffset+")"}));var slices=wrap.select(".nv-pie").selectAll(".nv-slice").data(pie),pieLabels=wrap.select(".nv-pieLabels").selectAll(".nv-label").data(pie);slices.exit().remove(),pieLabels.exit().remove();var ae=slices.enter().append("g");ae.attr("class","nv-slice"),ae.on("mouseover",function(d,i){d3.select(this).classed("hover",!0),growOnHover&&d3.select(this).select("path").transition().duration(70).attr("d",arcsOver[i]),dispatch.elementMouseover({data:d.data,index:i,color:d3.select(this).style("fill")})}),ae.on("mouseout",function(d,i){d3.select(this).classed("hover",!1),growOnHover&&d3.select(this).select("path").transition().duration(50).attr("d",arcs[i]),dispatch.elementMouseout({data:d.data,index:i})}),ae.on("mousemove",function(d,i){dispatch.elementMousemove({data:d.data,index:i})}),ae.on("click",function(d,i){dispatch.elementClick({data:d.data,index:i,color:d3.select(this).style("fill")})}),ae.on("dblclick",function(d,i){dispatch.elementDblClick({data:d.data,index:i,color:d3.select(this).style("fill")})}),slices.attr("fill",function(d,i){return color(d.data,i)}),slices.attr("stroke",function(d,i){return color(d.data,i)});ae.append("path").each(function(d){this._current=d});if(slices.select("path").transition().attr("d",function(d,i){return arcs[i](d)}).attrTween("d",arcTween),showLabels){for(var labelsArc=[],i=0;i<data[0].length;i++)labelsArc.push(arcs[i]),labelsOutside?donut&&(labelsArc[i]=d3.svg.arc().outerRadius(arcs[i].outerRadius()),startAngle!==!1&&labelsArc[i].startAngle(startAngle),endAngle!==!1&&labelsArc[i].endAngle(endAngle)):donut||labelsArc[i].innerRadius(0);pieLabels.enter().append("g").classed("nv-label",!0).each(function(d){var group=d3.select(this);group.attr("transform",function(d,i){if(labelSunbeamLayout){d.outerRadius=arcsRadiusOuter[i]+10,d.innerRadius=arcsRadiusOuter[i]+15;var rotateAngle=(d.startAngle+d.endAngle)/2*(180/Math.PI);return(d.startAngle+d.endAngle)/2<Math.PI?rotateAngle-=90:rotateAngle+=90,"translate("+labelsArc[i].centroid(d)+") rotate("+rotateAngle+")"}return d.outerRadius=radius+10,d.innerRadius=radius+15,"translate("+labelsArc[i].centroid(d)+")"}),group.append("rect").style("stroke","#fff").style("fill","#fff").attr("rx",3).attr("ry",3),group.append("text").style("text-anchor",labelSunbeamLayout?(d.startAngle+d.endAngle)/2<Math.PI?"start":"end":"middle").style("fill","#000")});var labelLocationHash={},avgHeight=14,avgWidth=140,createHashKey=function(coordinates){return Math.floor(coordinates[0]/avgWidth)*avgWidth+","+Math.floor(coordinates[1]/avgHeight)*avgHeight};pieLabels.watchTransition(renderWatch,"pie labels").attr("transform",function(d,i){if(labelSunbeamLayout){d.outerRadius=arcsRadiusOuter[i]+10,d.innerRadius=arcsRadiusOuter[i]+15;var rotateAngle=(d.startAngle+d.endAngle)/2*(180/Math.PI);return(d.startAngle+d.endAngle)/2<Math.PI?rotateAngle-=90:rotateAngle+=90,"translate("+labelsArc[i].centroid(d)+") rotate("+rotateAngle+")"}d.outerRadius=radius+10,d.innerRadius=radius+15;var center=labelsArc[i].centroid(d);if(d.value){var hashKey=createHashKey(center);labelLocationHash[hashKey]&&(center[1]-=avgHeight),labelLocationHash[createHashKey(center)]=!0}return"translate("+center+")"}),pieLabels.select(".nv-label text").style("text-anchor",function(d){return labelSunbeamLayout?(d.startAngle+d.endAngle)/2<Math.PI?"start":"end":"middle"}).text(function(d,i){var percent=(d.endAngle-d.startAngle)/(2*Math.PI),label="";if(!d.value||labelThreshold>percent)return"";if("function"==typeof labelType)label=labelType(d,i,{key:getX(d.data),value:getY(d.data),percent:valueFormat(percent)});else switch(labelType){case"key":label=getX(d.data);break;case"value":label=valueFormat(getY(d.data));break;case"percent":label=d3.format("%")(percent)}return label})}}),renderWatch.renderEnd("pie immediate"),chart}var margin={top:0,right:0,bottom:0,left:0},width=500,height=500,getX=function(d){return d.x},getY=function(d){return d.y},id=Math.floor(1e4*Math.random()),container=null,color=nv.utils.defaultColor(),valueFormat=d3.format(",.2f"),showLabels=!0,labelsOutside=!1,labelType="key",labelThreshold=.02,donut=!1,title=!1,growOnHover=!0,titleOffset=0,labelSunbeamLayout=!1,startAngle=!1,padAngle=!1,endAngle=!1,cornerRadius=0,donutRatio=.5,arcsRadius=[],dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),arcs=[],arcsOver=[],renderWatch=nv.utils.renderWatch(dispatch);return chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{arcsRadius:{get:function(){return arcsRadius},set:function(_){arcsRadius=_}},width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},showLabels:{get:function(){return showLabels},set:function(_){showLabels=_}},title:{get:function(){return title},set:function(_){title=_}},titleOffset:{get:function(){return titleOffset},set:function(_){titleOffset=_}},labelThreshold:{get:function(){return labelThreshold},set:function(_){labelThreshold=_}},valueFormat:{get:function(){return valueFormat},set:function(_){valueFormat=_}},x:{get:function(){return getX},set:function(_){getX=_}},id:{get:function(){return id},set:function(_){id=_}},endAngle:{get:function(){return endAngle},set:function(_){endAngle=_}},startAngle:{get:function(){return startAngle},set:function(_){startAngle=_}},padAngle:{get:function(){return padAngle},set:function(_){padAngle=_}},cornerRadius:{get:function(){return cornerRadius},set:function(_){cornerRadius=_}},donutRatio:{get:function(){return donutRatio},set:function(_){donutRatio=_}},labelsOutside:{get:function(){return labelsOutside},set:function(_){labelsOutside=_}},labelSunbeamLayout:{get:function(){return labelSunbeamLayout},set:function(_){labelSunbeamLayout=_}},donut:{get:function(){return donut},set:function(_){donut=_}},growOnHover:{get:function(){return growOnHover},set:function(_){growOnHover=_}},pieLabelsOutside:{get:function(){return labelsOutside},set:function(_){labelsOutside=_,nv.deprecated("pieLabelsOutside","use labelsOutside instead")}},donutLabelsOutside:{get:function(){return labelsOutside},set:function(_){labelsOutside=_,nv.deprecated("donutLabelsOutside","use labelsOutside instead")}},labelFormat:{get:function(){return valueFormat},set:function(_){valueFormat=_,nv.deprecated("labelFormat","use valueFormat instead")}},margin:{get:function(){return margin},set:function(_){margin.top="undefined"!=typeof _.top?_.top:margin.top,margin.right="undefined"!=typeof _.right?_.right:margin.right,margin.bottom="undefined"!=typeof _.bottom?_.bottom:margin.bottom,margin.left="undefined"!=typeof _.left?_.left:margin.left}},y:{get:function(){return getY},set:function(_){getY=d3.functor(_)}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}},labelType:{get:function(){return labelType},set:function(_){labelType=_||"key"}}}),nv.utils.initOptions(chart),chart},nv.models.pieChart=function(){"use strict";function chart(selection){return renderWatch.reset(),renderWatch.models(pie),selection.each(function(data){var container=d3.select(this);nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);if(chart.update=function(){container.transition().call(chart)},chart.container=this,state.setter(stateSetter(data),chart.update).getter(stateGetter(data)).update(),state.disabled=data.map(function(d){return!!d.disabled}),!defaultState){var key;defaultState={};for(key in state)defaultState[key]=state[key]instanceof Array?state[key].slice(0):state[key]}if(!data||!data.length)return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove();var wrap=container.selectAll("g.nv-wrap.nv-pieChart").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-pieChart").append("g"),g=wrap.select("g");if(gEnter.append("g").attr("class","nv-pieWrap"),gEnter.append("g").attr("class","nv-legendWrap"),showLegend)if("top"===legendPosition)legend.width(availableWidth).key(pie.x()),wrap.select(".nv-legendWrap").datum(data).call(legend),margin.top!=legend.height()&&(margin.top=legend.height(),availableHeight=nv.utils.availableHeight(height,container,margin)),wrap.select(".nv-legendWrap").attr("transform","translate(0,"+-margin.top+")");else if("right"===legendPosition){var legendWidth=nv.models.legend().width();legendWidth>availableWidth/2&&(legendWidth=availableWidth/2),legend.height(availableHeight).key(pie.x()),legend.width(legendWidth),availableWidth-=legend.width(),wrap.select(".nv-legendWrap").datum(data).call(legend).attr("transform","translate("+availableWidth+",0)")}wrap.attr("transform","translate("+margin.left+","+margin.top+")"),pie.width(availableWidth).height(availableHeight);var pieWrap=g.select(".nv-pieWrap").datum([data]);d3.transition(pieWrap).call(pie),legend.dispatch.on("stateChange",function(newState){for(var key in newState)state[key]=newState[key];dispatch.stateChange(state),chart.update()}),dispatch.on("changeState",function(e){"undefined"!=typeof e.disabled&&(data.forEach(function(series,i){series.disabled=e.disabled[i]}),state.disabled=e.disabled),chart.update()})}),renderWatch.renderEnd("pieChart immediate"),chart}var pie=nv.models.pie(),legend=nv.models.legend(),tooltip=nv.models.tooltip(),margin={top:30,right:20,bottom:20,left:20},width=null,height=null,showLegend=!0,legendPosition="top",color=nv.utils.defaultColor(),state=nv.utils.state(),defaultState=null,noData=null,duration=250,dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState","renderEnd");tooltip.headerEnabled(!1).duration(0).valueFormatter(function(d,i){return pie.valueFormat()(d,i)});var renderWatch=nv.utils.renderWatch(dispatch),stateGetter=function(data){return function(){return{active:data.map(function(d){return!d.disabled})}}},stateSetter=function(data){return function(state){void 0!==state.active&&data.forEach(function(series,i){series.disabled=!state.active[i]})}};return pie.dispatch.on("elementMouseover.tooltip",function(evt){evt.series={key:chart.x()(evt.data),value:chart.y()(evt.data),color:evt.color},tooltip.data(evt).hidden(!1)}),pie.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),pie.dispatch.on("elementMousemove.tooltip",function(){tooltip.position({top:d3.event.pageY,left:d3.event.pageX})()}),chart.legend=legend,chart.dispatch=dispatch,chart.pie=pie,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{noData:{get:function(){return noData},set:function(_){noData=_}},showLegend:{get:function(){return showLegend},set:function(_){showLegend=_}},legendPosition:{get:function(){return legendPosition},set:function(_){legendPosition=_}},defaultState:{get:function(){return defaultState},set:function(_){defaultState=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},color:{get:function(){return color},set:function(_){color=_,legend.color(color),pie.color(color)}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}}}),nv.utils.inheritOptions(chart,pie),nv.utils.initOptions(chart),chart},nv.models.scatter=function(){"use strict";function chart(selection){return renderWatch.reset(),selection.each(function(data){function updateInteractiveLayer(){if(needsUpdate=!1,!interactive)return!1;if(useVoronoi===!0){var vertices=d3.merge(data.map(function(group,groupIndex){return group.values.map(function(point,pointIndex){var pX=getX(point,pointIndex),pY=getY(point,pointIndex);return[x(pX)+1e-4*Math.random(),y(pY)+1e-4*Math.random(),groupIndex,pointIndex,point]}).filter(function(pointArray,pointIndex){return pointActive(pointArray[4],pointIndex)})}));if(0==vertices.length)return!1;vertices.length<3&&(vertices.push([x.range()[0]-20,y.range()[0]-20,null,null]),vertices.push([x.range()[1]+20,y.range()[1]+20,null,null]),vertices.push([x.range()[0]-20,y.range()[0]+20,null,null]),vertices.push([x.range()[1]+20,y.range()[1]-20,null,null]));var bounds=d3.geom.polygon([[-10,-10],[-10,height+10],[width+10,height+10],[width+10,-10]]),voronoi=d3.geom.voronoi(vertices).map(function(d,i){return{data:bounds.clip(d),series:vertices[i][2],point:vertices[i][3]}});wrap.select(".nv-point-paths").selectAll("path").remove();var pointPaths=wrap.select(".nv-point-paths").selectAll("path").data(voronoi),vPointPaths=pointPaths.enter().append("svg:path").attr("d",function(d){return d&&d.data&&0!==d.data.length?"M"+d.data.join(",")+"Z":"M 0 0"}).attr("id",function(d,i){return"nv-path-"+i}).attr("clip-path",function(d,i){return"url(#nv-clip-"+i+")"});showVoronoi&&vPointPaths.style("fill",d3.rgb(230,230,230)).style("fill-opacity",.4).style("stroke-opacity",1).style("stroke",d3.rgb(200,200,200)),clipVoronoi&&(wrap.select(".nv-point-clips").selectAll("clipPath").remove(),wrap.select(".nv-point-clips").selectAll("clipPath").data(vertices).enter().append("svg:clipPath").attr("id",function(d,i){return"nv-clip-"+i}).append("svg:circle").attr("cx",function(d){return d[0]}).attr("cy",function(d){return d[1]}).attr("r",clipRadius));var mouseEventCallback=function(d,mDispatch){if(needsUpdate)return 0;var series=data[d.series];if(void 0!==series){var point=series.values[d.point];point.color=color(series,d.series),point.x=getX(point),point.y=getY(point);var box=container.node().getBoundingClientRect(),scrollTop=window.pageYOffset||document.documentElement.scrollTop,scrollLeft=window.pageXOffset||document.documentElement.scrollLeft,pos={left:x(getX(point,d.point))+box.left+scrollLeft+margin.left+10,top:y(getY(point,d.point))+box.top+scrollTop+margin.top+10};mDispatch({point:point,series:series,pos:pos,seriesIndex:d.series,pointIndex:d.point})}};pointPaths.on("click",function(d){mouseEventCallback(d,dispatch.elementClick)}).on("dblclick",function(d){mouseEventCallback(d,dispatch.elementDblClick)}).on("mouseover",function(d){mouseEventCallback(d,dispatch.elementMouseover)}).on("mouseout",function(d){mouseEventCallback(d,dispatch.elementMouseout)})}else wrap.select(".nv-groups").selectAll(".nv-group").selectAll(".nv-point").on("click",function(d,i){if(needsUpdate||!data[d.series])return 0;var series=data[d.series],point=series.values[i];dispatch.elementClick({point:point,series:series,pos:[x(getX(point,i))+margin.left,y(getY(point,i))+margin.top],seriesIndex:d.series,pointIndex:i})}).on("dblclick",function(d,i){if(needsUpdate||!data[d.series])return 0;var series=data[d.series],point=series.values[i];dispatch.elementDblClick({point:point,series:series,pos:[x(getX(point,i))+margin.left,y(getY(point,i))+margin.top],seriesIndex:d.series,pointIndex:i})}).on("mouseover",function(d,i){if(needsUpdate||!data[d.series])return 0;var series=data[d.series],point=series.values[i];dispatch.elementMouseover({point:point,series:series,pos:[x(getX(point,i))+margin.left,y(getY(point,i))+margin.top],seriesIndex:d.series,pointIndex:i,color:color(d,i)})}).on("mouseout",function(d,i){if(needsUpdate||!data[d.series])return 0;var series=data[d.series],point=series.values[i];dispatch.elementMouseout({point:point,series:series,seriesIndex:d.series,pointIndex:i,color:color(d,i)})})}container=d3.select(this);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);nv.utils.initSVG(container),data.forEach(function(series,i){series.values.forEach(function(point){point.series=i})});var seriesData=xDomain&&yDomain&&sizeDomain?[]:d3.merge(data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),size:getSize(d,i)}})}));x.domain(xDomain||d3.extent(seriesData.map(function(d){return d.x}).concat(forceX))),x.range(padData&&data[0]?xRange||[(availableWidth*padDataOuter+availableWidth)/(2*data[0].values.length),availableWidth-availableWidth*(1+padDataOuter)/(2*data[0].values.length)]:xRange||[0,availableWidth]),y.domain(yDomain||d3.extent(seriesData.map(function(d){return d.y}).concat(forceY))).range(yRange||[availableHeight,0]),z.domain(sizeDomain||d3.extent(seriesData.map(function(d){return d.size}).concat(forceSize))).range(sizeRange||_sizeRange_def),singlePoint=x.domain()[0]===x.domain()[1]||y.domain()[0]===y.domain()[1],x.domain()[0]===x.domain()[1]&&x.domain(x.domain()[0]?[x.domain()[0]-.01*x.domain()[0],x.domain()[1]+.01*x.domain()[1]]:[-1,1]),y.domain()[0]===y.domain()[1]&&y.domain(y.domain()[0]?[y.domain()[0]-.01*y.domain()[0],y.domain()[1]+.01*y.domain()[1]]:[-1,1]),isNaN(x.domain()[0])&&x.domain([-1,1]),isNaN(y.domain()[0])&&y.domain([-1,1]),x0=x0||x,y0=y0||y,z0=z0||z;var wrap=container.selectAll("g.nv-wrap.nv-scatter").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-scatter nv-chart-"+id),defsEnter=wrapEnter.append("defs"),gEnter=wrapEnter.append("g"),g=wrap.select("g");wrap.classed("nv-single-point",singlePoint),gEnter.append("g").attr("class","nv-groups"),gEnter.append("g").attr("class","nv-point-paths"),wrapEnter.append("g").attr("class","nv-point-clips"),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect"),wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight>0?availableHeight:0),g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":""),needsUpdate=!0;var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),groups.exit().remove(),groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}),groups.watchTransition(renderWatch,"scatter: groups").style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)}).style("stroke-opacity",1).style("fill-opacity",.5);var points=groups.selectAll("path.nv-point").data(function(d){return d.values.map(function(point,pointIndex){return[point,pointIndex]}).filter(function(pointArray,pointIndex){return pointActive(pointArray[0],pointIndex)})});points.enter().append("path").style("fill",function(d){return d.color}).style("stroke",function(d){return d.color}).attr("transform",function(d){return"translate("+x0(getX(d[0],d[1]))+","+y0(getY(d[0],d[1]))+")"}).attr("d",nv.utils.symbol().type(function(d){return getShape(d[0])}).size(function(d){return z(getSize(d[0],d[1]))})),points.exit().remove(),groups.exit().selectAll("path.nv-point").watchTransition(renderWatch,"scatter exit").attr("transform",function(d){return"translate("+x(getX(d[0],d[1]))+","+y(getY(d[0],d[1]))+")"}).remove(),points.each(function(d){d3.select(this).classed("nv-point",!0).classed("nv-point-"+d[1],!0).classed("nv-noninteractive",!interactive).classed("hover",!1)}),points.watchTransition(renderWatch,"scatter points").attr("transform",function(d){return"translate("+x(getX(d[0],d[1]))+","+y(getY(d[0],d[1]))+")"}).attr("d",nv.utils.symbol().type(function(d){return getShape(d[0])}).size(function(d){return z(getSize(d[0],d[1]))})),clearTimeout(timeoutID),timeoutID=setTimeout(updateInteractiveLayer,300),x0=x.copy(),y0=y.copy(),z0=z.copy()}),renderWatch.renderEnd("scatter immediate"),chart}var x0,y0,z0,timeoutID,margin={top:0,right:0,bottom:0,left:0},width=null,height=null,color=nv.utils.defaultColor(),id=Math.floor(1e5*Math.random()),container=null,x=d3.scale.linear(),y=d3.scale.linear(),z=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},getSize=function(d){return d.size||1},getShape=function(d){return d.shape||"circle"},forceX=[],forceY=[],forceSize=[],interactive=!0,pointActive=function(d){return!d.notActive},padData=!1,padDataOuter=.1,clipEdge=!1,clipVoronoi=!0,showVoronoi=!1,clipRadius=function(){return 25},xDomain=null,yDomain=null,xRange=null,yRange=null,sizeDomain=null,sizeRange=null,singlePoint=!1,dispatch=d3.dispatch("elementClick","elementDblClick","elementMouseover","elementMouseout","renderEnd"),useVoronoi=!0,duration=250,needsUpdate=!1,renderWatch=nv.utils.renderWatch(dispatch,duration),_sizeRange_def=[16,256];return chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._calls=new function(){this.clearHighlights=function(){return nv.dom.write(function(){container.selectAll(".nv-point.hover").classed("hover",!1)}),null},this.highlightPoint=function(seriesIndex,pointIndex,isHoverOver){nv.dom.write(function(){container.select(" .nv-series-"+seriesIndex+" .nv-point-"+pointIndex).classed("hover",isHoverOver)})}},dispatch.on("elementMouseover.point",function(d){interactive&&chart._calls.highlightPoint(d.seriesIndex,d.pointIndex,!0)}),dispatch.on("elementMouseout.point",function(d){interactive&&chart._calls.highlightPoint(d.seriesIndex,d.pointIndex,!1)}),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},xScale:{get:function(){return x},set:function(_){x=_}},yScale:{get:function(){return y},set:function(_){y=_}},pointScale:{get:function(){return z},set:function(_){z=_}},xDomain:{get:function(){return xDomain},set:function(_){xDomain=_}},yDomain:{get:function(){return yDomain},set:function(_){yDomain=_}},pointDomain:{get:function(){return sizeDomain},set:function(_){sizeDomain=_}},xRange:{get:function(){return xRange},set:function(_){xRange=_}},yRange:{get:function(){return yRange},set:function(_){yRange=_}},pointRange:{get:function(){return sizeRange},set:function(_){sizeRange=_}},forceX:{get:function(){return forceX},set:function(_){forceX=_}},forceY:{get:function(){return forceY},set:function(_){forceY=_}},forcePoint:{get:function(){return forceSize},set:function(_){forceSize=_}},interactive:{get:function(){return interactive},set:function(_){interactive=_}},pointActive:{get:function(){return pointActive},set:function(_){pointActive=_}},padDataOuter:{get:function(){return padDataOuter},set:function(_){padDataOuter=_}},padData:{get:function(){return padData
},set:function(_){padData=_}},clipEdge:{get:function(){return clipEdge},set:function(_){clipEdge=_}},clipVoronoi:{get:function(){return clipVoronoi},set:function(_){clipVoronoi=_}},clipRadius:{get:function(){return clipRadius},set:function(_){clipRadius=_}},showVoronoi:{get:function(){return showVoronoi},set:function(_){showVoronoi=_}},id:{get:function(){return id},set:function(_){id=_}},x:{get:function(){return getX},set:function(_){getX=d3.functor(_)}},y:{get:function(){return getY},set:function(_){getY=d3.functor(_)}},pointSize:{get:function(){return getSize},set:function(_){getSize=d3.functor(_)}},pointShape:{get:function(){return getShape},set:function(_){getShape=d3.functor(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration)}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}},useVoronoi:{get:function(){return useVoronoi},set:function(_){useVoronoi=_,useVoronoi===!1&&(clipVoronoi=!1)}}}),nv.utils.initOptions(chart),chart},nv.models.scatterChart=function(){"use strict";function chart(selection){return renderWatch.reset(),renderWatch.models(scatter),showXAxis&&renderWatch.models(xAxis),showYAxis&&renderWatch.models(yAxis),showDistX&&renderWatch.models(distX),showDistY&&renderWatch.models(distY),selection.each(function(data){container=d3.select(this),nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);if(chart.update=function(){0===duration?container.call(chart):container.transition().duration(duration).call(chart)},chart.container=this,state.setter(stateSetter(data),chart.update).getter(stateGetter(data)).update(),state.disabled=data.map(function(d){return!!d.disabled}),!defaultState){var key;defaultState={};for(key in state)defaultState[key]=state[key]instanceof Array?state[key].slice(0):state[key]}if(!(data&&data.length&&data.filter(function(d){return d.values.length}).length))return nv.utils.noData(chart,container),renderWatch.renderEnd("scatter immediate"),chart;container.selectAll(".nv-noData").remove(),x=scatter.xScale(),y=scatter.yScale();var wrap=container.selectAll("g.nv-wrap.nv-scatterChart").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-scatterChart nv-chart-"+scatter.id()),gEnter=wrapEnter.append("g"),g=wrap.select("g");if(gEnter.append("rect").attr("class","nvd3 nv-background").style("pointer-events","none"),gEnter.append("g").attr("class","nv-x nv-axis"),gEnter.append("g").attr("class","nv-y nv-axis"),gEnter.append("g").attr("class","nv-scatterWrap"),gEnter.append("g").attr("class","nv-regressionLinesWrap"),gEnter.append("g").attr("class","nv-distWrap"),gEnter.append("g").attr("class","nv-legendWrap"),rightAlignYAxis&&g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)"),showLegend){var legendWidth=availableWidth;legend.width(legendWidth),wrap.select(".nv-legendWrap").datum(data).call(legend),margin.top!=legend.height()&&(margin.top=legend.height(),availableHeight=nv.utils.availableHeight(height,container,margin)),wrap.select(".nv-legendWrap").attr("transform","translate(0,"+-margin.top+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")"),scatter.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color=d.color||color(d,i),d.color}).filter(function(d,i){return!data[i].disabled})),wrap.select(".nv-scatterWrap").datum(data.filter(function(d){return!d.disabled})).call(scatter),wrap.select(".nv-regressionLinesWrap").attr("clip-path","url(#nv-edge-clip-"+scatter.id()+")");var regWrap=wrap.select(".nv-regressionLinesWrap").selectAll(".nv-regLines").data(function(d){return d});regWrap.enter().append("g").attr("class","nv-regLines");var regLine=regWrap.selectAll(".nv-regLine").data(function(d){return[d]});regLine.enter().append("line").attr("class","nv-regLine").style("stroke-opacity",0),regLine.filter(function(d){return d.intercept&&d.slope}).watchTransition(renderWatch,"scatterPlusLineChart: regline").attr("x1",x.range()[0]).attr("x2",x.range()[1]).attr("y1",function(d){return y(x.domain()[0]*d.slope+d.intercept)}).attr("y2",function(d){return y(x.domain()[1]*d.slope+d.intercept)}).style("stroke",function(d,i,j){return color(d,j)}).style("stroke-opacity",function(d){return d.disabled||"undefined"==typeof d.slope||"undefined"==typeof d.intercept?0:1}),showXAxis&&(xAxis.scale(x)._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight,0),g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")").call(xAxis)),showYAxis&&(yAxis.scale(y)._ticks(nv.utils.calcTicksY(availableHeight/36,data)).tickSize(-availableWidth,0),g.select(".nv-y.nv-axis").call(yAxis)),showDistX&&(distX.getData(scatter.x()).scale(x).width(availableWidth).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled})),gEnter.select(".nv-distWrap").append("g").attr("class","nv-distributionX"),g.select(".nv-distributionX").attr("transform","translate(0,"+y.range()[0]+")").datum(data.filter(function(d){return!d.disabled})).call(distX)),showDistY&&(distY.getData(scatter.y()).scale(y).width(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data[i].disabled})),gEnter.select(".nv-distWrap").append("g").attr("class","nv-distributionY"),g.select(".nv-distributionY").attr("transform","translate("+(rightAlignYAxis?availableWidth:-distY.size())+",0)").datum(data.filter(function(d){return!d.disabled})).call(distY)),legend.dispatch.on("stateChange",function(newState){for(var key in newState)state[key]=newState[key];dispatch.stateChange(state),chart.update()}),dispatch.on("changeState",function(e){"undefined"!=typeof e.disabled&&(data.forEach(function(series,i){series.disabled=e.disabled[i]}),state.disabled=e.disabled),chart.update()}),scatter.dispatch.on("elementMouseout.tooltip",function(evt){tooltip.hidden(!0),container.select(".nv-chart-"+scatter.id()+" .nv-series-"+evt.seriesIndex+" .nv-distx-"+evt.pointIndex).attr("y1",0),container.select(".nv-chart-"+scatter.id()+" .nv-series-"+evt.seriesIndex+" .nv-disty-"+evt.pointIndex).attr("x2",distY.size())}),scatter.dispatch.on("elementMouseover.tooltip",function(evt){container.select(".nv-series-"+evt.seriesIndex+" .nv-distx-"+evt.pointIndex).attr("y1",evt.pos.top-availableHeight-margin.top),container.select(".nv-series-"+evt.seriesIndex+" .nv-disty-"+evt.pointIndex).attr("x2",evt.pos.left+distX.size()-margin.left),tooltip.position(evt.pos).data(evt).hidden(!1)}),x0=x.copy(),y0=y.copy()}),renderWatch.renderEnd("scatter with line immediate"),chart}var scatter=nv.models.scatter(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),distX=nv.models.distribution(),distY=nv.models.distribution(),tooltip=nv.models.tooltip(),margin={top:30,right:20,bottom:50,left:75},width=null,height=null,container=null,color=nv.utils.defaultColor(),x=scatter.xScale(),y=scatter.yScale(),showDistX=!1,showDistY=!1,showLegend=!0,showXAxis=!0,showYAxis=!0,rightAlignYAxis=!1,state=nv.utils.state(),defaultState=null,dispatch=d3.dispatch("stateChange","changeState","renderEnd"),noData=null,duration=250;scatter.xScale(x).yScale(y),xAxis.orient("bottom").tickPadding(10),yAxis.orient(rightAlignYAxis?"right":"left").tickPadding(10),distX.axis("x"),distY.axis("y"),tooltip.headerFormatter(function(d,i){return xAxis.tickFormat()(d,i)}).valueFormatter(function(d,i){return yAxis.tickFormat()(d,i)});var x0,y0,renderWatch=nv.utils.renderWatch(dispatch,duration),stateGetter=function(data){return function(){return{active:data.map(function(d){return!d.disabled})}}},stateSetter=function(data){return function(state){void 0!==state.active&&data.forEach(function(series,i){series.disabled=!state.active[i]})}};return chart.dispatch=dispatch,chart.scatter=scatter,chart.legend=legend,chart.xAxis=xAxis,chart.yAxis=yAxis,chart.distX=distX,chart.distY=distY,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},container:{get:function(){return container},set:function(_){container=_}},showDistX:{get:function(){return showDistX},set:function(_){showDistX=_}},showDistY:{get:function(){return showDistY},set:function(_){showDistY=_}},showLegend:{get:function(){return showLegend},set:function(_){showLegend=_}},showXAxis:{get:function(){return showXAxis},set:function(_){showXAxis=_}},showYAxis:{get:function(){return showYAxis},set:function(_){showYAxis=_}},defaultState:{get:function(){return defaultState},set:function(_){defaultState=_}},noData:{get:function(){return noData},set:function(_){noData=_}},duration:{get:function(){return duration},set:function(_){duration=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},tooltipXContent:{get:function(){return tooltip.contentGenerator()},set:function(){nv.deprecated("tooltipContent","This option is removed, put values into main tooltip.")}},tooltipYContent:{get:function(){return tooltip.contentGenerator()},set:function(){nv.deprecated("tooltipContent","This option is removed, put values into main tooltip.")}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},rightAlignYAxis:{get:function(){return rightAlignYAxis},set:function(_){rightAlignYAxis=_,yAxis.orient(_?"right":"left")}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),legend.color(color),distX.color(color),distY.color(color)}}}),nv.utils.inheritOptions(chart,scatter),nv.utils.initOptions(chart),chart},nv.models.sparkline=function(){"use strict";function chart(selection){return selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom;container=d3.select(this),nv.utils.initSVG(container),x.domain(xDomain||d3.extent(data,getX)).range(xRange||[0,availableWidth]),y.domain(yDomain||d3.extent(data,getY)).range(yRange||[availableHeight,0]);{var wrap=container.selectAll("g.nv-wrap.nv-sparkline").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-sparkline");wrapEnter.append("g"),wrap.select("g")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");var paths=wrap.selectAll("path").data(function(d){return[d]});paths.enter().append("path"),paths.exit().remove(),paths.style("stroke",function(d,i){return d.color||color(d,i)}).attr("d",d3.svg.line().x(function(d,i){return x(getX(d,i))}).y(function(d,i){return y(getY(d,i))}));var points=wrap.selectAll("circle.nv-point").data(function(data){function pointIndex(index){if(-1!=index){var result=data[index];return result.pointIndex=index,result}return null}var yValues=data.map(function(d,i){return getY(d,i)}),maxPoint=pointIndex(yValues.lastIndexOf(y.domain()[1])),minPoint=pointIndex(yValues.indexOf(y.domain()[0])),currentPoint=pointIndex(yValues.length-1);return[minPoint,maxPoint,currentPoint].filter(function(d){return null!=d})});points.enter().append("circle"),points.exit().remove(),points.attr("cx",function(d){return x(getX(d,d.pointIndex))}).attr("cy",function(d){return y(getY(d,d.pointIndex))}).attr("r",2).attr("class",function(d){return getX(d,d.pointIndex)==x.domain()[1]?"nv-point nv-currentValue":getY(d,d.pointIndex)==y.domain()[0]?"nv-point nv-minValue":"nv-point nv-maxValue"})}),chart}var xDomain,yDomain,xRange,yRange,margin={top:2,right:0,bottom:2,left:0},width=400,height=32,container=null,animate=!0,x=d3.scale.linear(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},color=nv.utils.getColor(["#000"]);return chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},xDomain:{get:function(){return xDomain},set:function(_){xDomain=_}},yDomain:{get:function(){return yDomain},set:function(_){yDomain=_}},xRange:{get:function(){return xRange},set:function(_){xRange=_}},yRange:{get:function(){return yRange},set:function(_){yRange=_}},xScale:{get:function(){return x},set:function(_){x=_}},yScale:{get:function(){return y},set:function(_){y=_}},animate:{get:function(){return animate},set:function(_){animate=_}},x:{get:function(){return getX},set:function(_){getX=d3.functor(_)}},y:{get:function(){return getY},set:function(_){getY=d3.functor(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}}}),nv.utils.initOptions(chart),chart},nv.models.sparklinePlus=function(){"use strict";function chart(selection){return selection.each(function(data){function updateValueLine(){if(!paused){var hoverValue=g.selectAll(".nv-hoverValue").data(index),hoverEnter=hoverValue.enter().append("g").attr("class","nv-hoverValue").style("stroke-opacity",0).style("fill-opacity",0);hoverValue.exit().transition().duration(250).style("stroke-opacity",0).style("fill-opacity",0).remove(),hoverValue.attr("transform",function(d){return"translate("+x(sparkline.x()(data[d],d))+",0)"}).transition().duration(250).style("stroke-opacity",1).style("fill-opacity",1),index.length&&(hoverEnter.append("line").attr("x1",0).attr("y1",-margin.top).attr("x2",0).attr("y2",availableHeight),hoverEnter.append("text").attr("class","nv-xValue").attr("x",-6).attr("y",-margin.top).attr("text-anchor","end").attr("dy",".9em"),g.select(".nv-hoverValue .nv-xValue").text(xTickFormat(sparkline.x()(data[index[0]],index[0]))),hoverEnter.append("text").attr("class","nv-yValue").attr("x",6).attr("y",-margin.top).attr("text-anchor","start").attr("dy",".9em"),g.select(".nv-hoverValue .nv-yValue").text(yTickFormat(sparkline.y()(data[index[0]],index[0]))))}}function sparklineHover(){function getClosestIndex(data,x){for(var distance=Math.abs(sparkline.x()(data[0],0)-x),closestIndex=0,i=0;i<data.length;i++)Math.abs(sparkline.x()(data[i],i)-x)<distance&&(distance=Math.abs(sparkline.x()(data[i],i)-x),closestIndex=i);return closestIndex}if(!paused){var pos=d3.mouse(this)[0]-margin.left;index=[getClosestIndex(data,Math.round(x.invert(pos)))],updateValueLine()}}var container=d3.select(this);nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);if(chart.update=function(){container.call(chart)},chart.container=this,!data||!data.length)return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove();var currentValue=sparkline.y()(data[data.length-1],data.length-1);x=sparkline.xScale(),y=sparkline.yScale();var wrap=container.selectAll("g.nv-wrap.nv-sparklineplus").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-sparklineplus"),gEnter=wrapEnter.append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-sparklineWrap"),gEnter.append("g").attr("class","nv-valueWrap"),gEnter.append("g").attr("class","nv-hoverArea"),wrap.attr("transform","translate("+margin.left+","+margin.top+")");var sparklineWrap=g.select(".nv-sparklineWrap");if(sparkline.width(availableWidth).height(availableHeight),sparklineWrap.call(sparkline),showLastValue){var valueWrap=g.select(".nv-valueWrap"),value=valueWrap.selectAll(".nv-currentValue").data([currentValue]);value.enter().append("text").attr("class","nv-currentValue").attr("dx",rightAlignValue?-8:8).attr("dy",".9em").style("text-anchor",rightAlignValue?"end":"start"),value.attr("x",availableWidth+(rightAlignValue?margin.right:0)).attr("y",alignValue?function(d){return y(d)}:0).style("fill",sparkline.color()(data[data.length-1],data.length-1)).text(yTickFormat(currentValue))}gEnter.select(".nv-hoverArea").append("rect").on("mousemove",sparklineHover).on("click",function(){paused=!paused}).on("mouseout",function(){index=[],updateValueLine()}),g.select(".nv-hoverArea rect").attr("transform",function(){return"translate("+-margin.left+","+-margin.top+")"}).attr("width",availableWidth+margin.left+margin.right).attr("height",availableHeight+margin.top)}),chart}var x,y,sparkline=nv.models.sparkline(),margin={top:15,right:100,bottom:10,left:50},width=null,height=null,index=[],paused=!1,xTickFormat=d3.format(",r"),yTickFormat=d3.format(",.2f"),showLastValue=!0,alignValue=!0,rightAlignValue=!1,noData=null;return chart.sparkline=sparkline,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},xTickFormat:{get:function(){return xTickFormat},set:function(_){xTickFormat=_}},yTickFormat:{get:function(){return yTickFormat},set:function(_){yTickFormat=_}},showLastValue:{get:function(){return showLastValue},set:function(_){showLastValue=_}},alignValue:{get:function(){return alignValue},set:function(_){alignValue=_}},rightAlignValue:{get:function(){return rightAlignValue},set:function(_){rightAlignValue=_}},noData:{get:function(){return noData},set:function(_){noData=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}}}),nv.utils.inheritOptions(chart,sparkline),nv.utils.initOptions(chart),chart},nv.models.stackedArea=function(){"use strict";function chart(selection){return renderWatch.reset(),renderWatch.models(scatter),selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom;container=d3.select(this),nv.utils.initSVG(container),x=scatter.xScale(),y=scatter.yScale();var dataRaw=data;data.forEach(function(aseries,i){aseries.seriesIndex=i,aseries.values=aseries.values.map(function(d,j){return d.index=j,d.seriesIndex=i,d})});var dataFiltered=data.filter(function(series){return!series.disabled});data=d3.layout.stack().order(order).offset(offset).values(function(d){return d.values}).x(getX).y(getY).out(function(d,y0,y){d.display={y:y,y0:y0}})(dataFiltered);var wrap=container.selectAll("g.nv-wrap.nv-stackedarea").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedarea"),defsEnter=wrapEnter.append("defs"),gEnter=wrapEnter.append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-areaWrap"),gEnter.append("g").attr("class","nv-scatterWrap"),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),0==scatter.forceY().length&&scatter.forceY().push(0),scatter.width(availableWidth).height(availableHeight).x(getX).y(function(d){return d.display.y+d.display.y0}).forceY([0]).color(data.map(function(d){return d.color||color(d,d.seriesIndex)}));var scatterWrap=g.select(".nv-scatterWrap").datum(data);scatterWrap.call(scatter),defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect"),wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight),g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");var area=d3.svg.area().x(function(d,i){return x(getX(d,i))}).y0(function(d){return y(d.display.y0)}).y1(function(d){return y(d.display.y+d.display.y0)}).interpolate(interpolate),zeroArea=d3.svg.area().x(function(d,i){return x(getX(d,i))}).y0(function(d){return y(d.display.y0)}).y1(function(d){return y(d.display.y0)}),path=g.select(".nv-areaWrap").selectAll("path.nv-area").data(function(d){return d});path.enter().append("path").attr("class",function(d,i){return"nv-area nv-area-"+i}).attr("d",function(d){return zeroArea(d.values,d.seriesIndex)}).on("mouseover",function(d){d3.select(this).classed("hover",!0),dispatch.areaMouseover({point:d,series:d.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:d.seriesIndex})}).on("mouseout",function(d){d3.select(this).classed("hover",!1),dispatch.areaMouseout({point:d,series:d.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:d.seriesIndex})}).on("click",function(d){d3.select(this).classed("hover",!1),dispatch.areaClick({point:d,series:d.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:d.seriesIndex})}),path.exit().remove(),path.style("fill",function(d){return d.color||color(d,d.seriesIndex)}).style("stroke",function(d){return d.color||color(d,d.seriesIndex)}),path.watchTransition(renderWatch,"stackedArea path").attr("d",function(d,i){return area(d.values,i)}),scatter.dispatch.on("elementMouseover.area",function(e){g.select(".nv-chart-"+id+" .nv-area-"+e.seriesIndex).classed("hover",!0)}),scatter.dispatch.on("elementMouseout.area",function(e){g.select(".nv-chart-"+id+" .nv-area-"+e.seriesIndex).classed("hover",!1)}),chart.d3_stackedOffset_stackPercent=function(stackData){var i,j,o,n=stackData.length,m=stackData[0].length,y0=[];for(j=0;m>j;++j){for(i=0,o=0;i<dataRaw.length;i++)o+=getY(dataRaw[i].values[j]);if(o)for(i=0;n>i;i++)stackData[i][j][1]/=o;else for(i=0;n>i;i++)stackData[i][j][1]=0}for(j=0;m>j;++j)y0[j]=0;return y0}}),renderWatch.renderEnd("stackedArea immediate"),chart}var x,y,margin={top:0,right:0,bottom:0,left:0},width=960,height=500,color=nv.utils.defaultColor(),id=Math.floor(1e5*Math.random()),container=null,getX=function(d){return d.x},getY=function(d){return d.y},style="stack",offset="zero",order="default",interpolate="linear",clipEdge=!1,scatter=nv.models.scatter(),duration=250,dispatch=d3.dispatch("areaClick","areaMouseover","areaMouseout","renderEnd","elementClick","elementMouseover","elementMouseout");scatter.pointSize(2.2).pointDomain([2.2,2.2]);var renderWatch=nv.utils.renderWatch(dispatch,duration);return chart.dispatch=dispatch,chart.scatter=scatter,scatter.dispatch.on("elementClick",function(){dispatch.elementClick.apply(this,arguments)}),scatter.dispatch.on("elementMouseover",function(){dispatch.elementMouseover.apply(this,arguments)}),scatter.dispatch.on("elementMouseout",function(){dispatch.elementMouseout.apply(this,arguments)}),chart.interpolate=function(_){return arguments.length?(interpolate=_,chart):interpolate},chart.duration=function(_){return arguments.length?(duration=_,renderWatch.reset(duration),scatter.duration(duration),chart):duration},chart.dispatch=dispatch,chart.scatter=scatter,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},clipEdge:{get:function(){return clipEdge},set:function(_){clipEdge=_}},offset:{get:function(){return offset},set:function(_){offset=_}},order:{get:function(){return order},set:function(_){order=_}},interpolate:{get:function(){return interpolate},set:function(_){interpolate=_}},x:{get:function(){return getX},set:function(_){getX=d3.functor(_)}},y:{get:function(){return getY},set:function(_){getY=d3.functor(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}},style:{get:function(){return style},set:function(_){switch(style=_){case"stack":chart.offset("zero"),chart.order("default");break;case"stream":chart.offset("wiggle"),chart.order("inside-out");break;case"stream-center":chart.offset("silhouette"),chart.order("inside-out");break;case"expand":chart.offset("expand"),chart.order("default");break;case"stack_percent":chart.offset(chart.d3_stackedOffset_stackPercent),chart.order("default")}}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration),scatter.duration(duration)}}}),nv.utils.inheritOptions(chart,scatter),nv.utils.initOptions(chart),chart},nv.models.stackedAreaChart=function(){"use strict";function chart(selection){return renderWatch.reset(),renderWatch.models(stacked),showXAxis&&renderWatch.models(xAxis),showYAxis&&renderWatch.models(yAxis),selection.each(function(data){var container=d3.select(this),that=this;nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);if(chart.update=function(){container.transition().duration(duration).call(chart)},chart.container=this,state.setter(stateSetter(data),chart.update).getter(stateGetter(data)).update(),state.disabled=data.map(function(d){return!!d.disabled}),!defaultState){var key;defaultState={};for(key in state)defaultState[key]=state[key]instanceof Array?state[key].slice(0):state[key]}if(!(data&&data.length&&data.filter(function(d){return d.values.length}).length))return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove(),x=stacked.xScale(),y=stacked.yScale();var wrap=container.selectAll("g.nv-wrap.nv-stackedAreaChart").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedAreaChart").append("g"),g=wrap.select("g");if(gEnter.append("rect").style("opacity",0),gEnter.append("g").attr("class","nv-x nv-axis"),gEnter.append("g").attr("class","nv-y nv-axis"),gEnter.append("g").attr("class","nv-stackedWrap"),gEnter.append("g").attr("class","nv-legendWrap"),gEnter.append("g").attr("class","nv-controlsWrap"),gEnter.append("g").attr("class","nv-interactive"),g.select("rect").attr("width",availableWidth).attr("height",availableHeight),showLegend){var legendWidth=showControls?availableWidth-controlWidth:availableWidth;legend.width(legendWidth),g.select(".nv-legendWrap").datum(data).call(legend),margin.top!=legend.height()&&(margin.top=legend.height(),availableHeight=nv.utils.availableHeight(height,container,margin)),g.select(".nv-legendWrap").attr("transform","translate("+(availableWidth-legendWidth)+","+-margin.top+")")}if(showControls){var controlsData=[{key:controlLabels.stacked||"Stacked",metaKey:"Stacked",disabled:"stack"!=stacked.style(),style:"stack"},{key:controlLabels.stream||"Stream",metaKey:"Stream",disabled:"stream"!=stacked.style(),style:"stream"},{key:controlLabels.expanded||"Expanded",metaKey:"Expanded",disabled:"expand"!=stacked.style(),style:"expand"},{key:controlLabels.stack_percent||"Stack %",metaKey:"Stack_Percent",disabled:"stack_percent"!=stacked.style(),style:"stack_percent"}];controlWidth=controlOptions.length/3*260,controlsData=controlsData.filter(function(d){return-1!==controlOptions.indexOf(d.metaKey)}),controls.width(controlWidth).color(["#444","#444","#444"]),g.select(".nv-controlsWrap").datum(controlsData).call(controls),margin.top!=Math.max(controls.height(),legend.height())&&(margin.top=Math.max(controls.height(),legend.height()),availableHeight=nv.utils.availableHeight(height,container,margin)),g.select(".nv-controlsWrap").attr("transform","translate(0,"+-margin.top+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")"),rightAlignYAxis&&g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)"),useInteractiveGuideline&&(interactiveLayer.width(availableWidth).height(availableHeight).margin({left:margin.left,top:margin.top}).svgContainer(container).xScale(x),wrap.select(".nv-interactive").call(interactiveLayer)),stacked.width(availableWidth).height(availableHeight);var stackedWrap=g.select(".nv-stackedWrap").datum(data);if(stackedWrap.transition().call(stacked),showXAxis&&(xAxis.scale(x)._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight,0),g.select(".nv-x.nv-axis").attr("transform","translate(0,"+availableHeight+")"),g.select(".nv-x.nv-axis").transition().duration(0).call(xAxis)),showYAxis){var ticks;if(ticks="wiggle"===stacked.offset()?0:nv.utils.calcTicksY(availableHeight/36,data),yAxis.scale(y)._ticks(ticks).tickSize(-availableWidth,0),"expand"===stacked.style()||"stack_percent"===stacked.style()){var currentFormat=yAxis.tickFormat();oldYTickFormat&&currentFormat===percentFormatter||(oldYTickFormat=currentFormat),yAxis.tickFormat(percentFormatter)}else oldYTickFormat&&(yAxis.tickFormat(oldYTickFormat),oldYTickFormat=null);g.select(".nv-y.nv-axis").transition().duration(0).call(yAxis)}stacked.dispatch.on("areaClick.toggle",function(e){data.forEach(1===data.filter(function(d){return!d.disabled}).length?function(d){d.disabled=!1}:function(d,i){d.disabled=i!=e.seriesIndex}),state.disabled=data.map(function(d){return!!d.disabled}),dispatch.stateChange(state),chart.update()}),legend.dispatch.on("stateChange",function(newState){for(var key in newState)state[key]=newState[key];dispatch.stateChange(state),chart.update()}),controls.dispatch.on("legendClick",function(d){d.disabled&&(controlsData=controlsData.map(function(s){return s.disabled=!0,s}),d.disabled=!1,stacked.style(d.style),state.style=stacked.style(),dispatch.stateChange(state),chart.update())}),interactiveLayer.dispatch.on("elementMousemove",function(e){stacked.clearHighlights();var singlePoint,pointIndex,pointXLocation,allData=[];if(data.filter(function(series,i){return series.seriesIndex=i,!series.disabled}).forEach(function(series,i){pointIndex=nv.interactiveBisect(series.values,e.pointXValue,chart.x());var point=series.values[pointIndex],pointYValue=chart.y()(point,pointIndex);if(null!=pointYValue&&stacked.highlightPoint(i,pointIndex,!0),"undefined"!=typeof point){"undefined"==typeof singlePoint&&(singlePoint=point),"undefined"==typeof pointXLocation&&(pointXLocation=chart.xScale()(chart.x()(point,pointIndex)));var tooltipValue="expand"==stacked.style()?point.display.y:chart.y()(point,pointIndex);allData.push({key:series.key,value:tooltipValue,color:color(series,series.seriesIndex),stackedValue:point.display})}}),allData.reverse(),allData.length>2){var yValue=chart.yScale().invert(e.mouseY),indexToHighlight=null;allData.forEach(function(series,i){yValue=Math.abs(yValue);var stackedY0=Math.abs(series.stackedValue.y0),stackedY=Math.abs(series.stackedValue.y);return yValue>=stackedY0&&stackedY+stackedY0>=yValue?void(indexToHighlight=i):void 0}),null!=indexToHighlight&&(allData[indexToHighlight].highlight=!0)}var xValue=xAxis.tickFormat()(chart.x()(singlePoint,pointIndex)),valueFormatter=interactiveLayer.tooltip.valueFormatter();"expand"===stacked.style()||"stack_percent"===stacked.style()?(oldValueFormatter||(oldValueFormatter=valueFormatter),valueFormatter=d3.format(".1%")):oldValueFormatter&&(valueFormatter=oldValueFormatter,oldValueFormatter=null),interactiveLayer.tooltip.position({left:pointXLocation+margin.left,top:e.mouseY+margin.top}).chartContainer(that.parentNode).valueFormatter(valueFormatter).data({value:xValue,series:allData})(),interactiveLayer.renderGuideLine(pointXLocation)}),interactiveLayer.dispatch.on("elementMouseout",function(){stacked.clearHighlights()}),dispatch.on("changeState",function(e){"undefined"!=typeof e.disabled&&data.length===e.disabled.length&&(data.forEach(function(series,i){series.disabled=e.disabled[i]}),state.disabled=e.disabled),"undefined"!=typeof e.style&&(stacked.style(e.style),style=e.style),chart.update()
})}),renderWatch.renderEnd("stacked Area chart immediate"),chart}var x,y,stacked=nv.models.stackedArea(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend(),interactiveLayer=nv.interactiveGuideline(),tooltip=nv.models.tooltip(),margin={top:30,right:25,bottom:50,left:60},width=null,height=null,color=nv.utils.defaultColor(),showControls=!0,showLegend=!0,showXAxis=!0,showYAxis=!0,rightAlignYAxis=!1,useInteractiveGuideline=!1,state=nv.utils.state(),defaultState=null,noData=null,dispatch=d3.dispatch("stateChange","changeState","renderEnd"),controlWidth=250,controlOptions=["Stacked","Stream","Expanded"],controlLabels={},duration=250;state.style=stacked.style(),xAxis.orient("bottom").tickPadding(7),yAxis.orient(rightAlignYAxis?"right":"left"),tooltip.headerFormatter(function(d,i){return xAxis.tickFormat()(d,i)}).valueFormatter(function(d,i){return yAxis.tickFormat()(d,i)}),interactiveLayer.tooltip.headerFormatter(function(d,i){return xAxis.tickFormat()(d,i)}).valueFormatter(function(d,i){return yAxis.tickFormat()(d,i)});var oldYTickFormat=null,oldValueFormatter=null;controls.updateState(!1);var renderWatch=nv.utils.renderWatch(dispatch),style=stacked.style(),stateGetter=function(data){return function(){return{active:data.map(function(d){return!d.disabled}),style:stacked.style()}}},stateSetter=function(data){return function(state){void 0!==state.style&&(style=state.style),void 0!==state.active&&data.forEach(function(series,i){series.disabled=!state.active[i]})}},percentFormatter=d3.format("%");return stacked.dispatch.on("elementMouseover.tooltip",function(evt){evt.point.x=stacked.x()(evt.point),evt.point.y=stacked.y()(evt.point),tooltip.data(evt).position(evt.pos).hidden(!1)}),stacked.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),chart.dispatch=dispatch,chart.stacked=stacked,chart.legend=legend,chart.controls=controls,chart.xAxis=xAxis,chart.yAxis=yAxis,chart.interactiveLayer=interactiveLayer,chart.tooltip=tooltip,chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},showLegend:{get:function(){return showLegend},set:function(_){showLegend=_}},showXAxis:{get:function(){return showXAxis},set:function(_){showXAxis=_}},showYAxis:{get:function(){return showYAxis},set:function(_){showYAxis=_}},defaultState:{get:function(){return defaultState},set:function(_){defaultState=_}},noData:{get:function(){return noData},set:function(_){noData=_}},showControls:{get:function(){return showControls},set:function(_){showControls=_}},controlLabels:{get:function(){return controlLabels},set:function(_){controlLabels=_}},controlOptions:{get:function(){return controlOptions},set:function(_){controlOptions=_}},tooltips:{get:function(){return tooltip.enabled()},set:function(_){nv.deprecated("tooltips","use chart.tooltip.enabled() instead"),tooltip.enabled(!!_)}},tooltipContent:{get:function(){return tooltip.contentGenerator()},set:function(_){nv.deprecated("tooltipContent","use chart.tooltip.contentGenerator() instead"),tooltip.contentGenerator(_)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration),stacked.duration(duration),xAxis.duration(duration),yAxis.duration(duration)}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),legend.color(color),stacked.color(color)}},rightAlignYAxis:{get:function(){return rightAlignYAxis},set:function(_){rightAlignYAxis=_,yAxis.orient(rightAlignYAxis?"right":"left")}},useInteractiveGuideline:{get:function(){return useInteractiveGuideline},set:function(_){useInteractiveGuideline=!!_,chart.interactive(!_),chart.useVoronoi(!_),stacked.scatter.interactive(!_)}}}),nv.utils.inheritOptions(chart,stacked),nv.utils.initOptions(chart),chart},nv.models.sunburst=function(){"use strict";function chart(selection){return renderWatch.reset(),selection.each(function(data){function stash(d){d.x0=d.x,d.dx0=d.dx}function arcTweenZoom(d){var xd=d3.interpolate(x.domain(),[d.x,d.x+d.dx]),yd=d3.interpolate(y.domain(),[d.y,1]),yr=d3.interpolate(y.range(),[d.y?20:0,radius]);return function(d,i){return i?function(){return arc(d)}:function(t){return x.domain(xd(t)),y.domain(yd(t)).range(yr(t)),arc(d)}}}container=d3.select(this);var path,availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin),radius=Math.min(availableWidth,availableHeight)/2;nv.utils.initSVG(container);var wrap=container.selectAll(".nv-wrap.nv-sunburst").data(data),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-sunburst nv-chart-"+id),g=wrapEnter.selectAll("nv-sunburst");wrap.attr("transform","translate("+availableWidth/2+","+availableHeight/2+")"),container.on("click",function(d,i){dispatch.chartClick({data:d,index:i,pos:d3.event,id:id})}),y.range([0,radius]),node=node||data,rootNode=data[0],partition.value(modes[mode]||modes.count),path=g.data(partition.nodes).enter().append("path").attr("d",arc).style("fill",function(d){return color((d.children?d:d.parent).name)}).style("stroke","#FFF").on("click",function(d){prevNode!==node&&node!==d&&(prevNode=node),node=d,path.transition().duration(duration).attrTween("d",arcTweenZoom(d))}).each(stash).on("dblclick",function(d){prevNode.parent==d&&path.transition().duration(duration).attrTween("d",arcTweenZoom(rootNode))}).each(stash).on("mouseover",function(d){d3.select(this).classed("hover",!0).style("opacity",.8),dispatch.elementMouseover({data:d,color:d3.select(this).style("fill")})}).on("mouseout",function(d){d3.select(this).classed("hover",!1).style("opacity",1),dispatch.elementMouseout({data:d})}).on("mousemove",function(d){dispatch.elementMousemove({data:d})})}),renderWatch.renderEnd("sunburst immediate"),chart}var node,prevNode,rootNode,margin={top:0,right:0,bottom:0,left:0},width=null,height=null,mode="count",modes={count:function(){return 1},size:function(d){return d.size}},id=Math.floor(1e4*Math.random()),container=null,color=nv.utils.defaultColor(),duration=500,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMousemove","elementMouseover","elementMouseout","renderEnd"),x=d3.scale.linear().range([0,2*Math.PI]),y=d3.scale.sqrt(),partition=d3.layout.partition().sort(null).value(function(){return 1}),arc=d3.svg.arc().startAngle(function(d){return Math.max(0,Math.min(2*Math.PI,x(d.x)))}).endAngle(function(d){return Math.max(0,Math.min(2*Math.PI,x(d.x+d.dx)))}).innerRadius(function(d){return Math.max(0,y(d.y))}).outerRadius(function(d){return Math.max(0,y(d.y+d.dy))}),renderWatch=nv.utils.renderWatch(dispatch);return chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},mode:{get:function(){return mode},set:function(_){mode=_}},id:{get:function(){return id},set:function(_){id=_}},duration:{get:function(){return duration},set:function(_){duration=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!=_.top?_.top:margin.top,margin.right=void 0!=_.right?_.right:margin.right,margin.bottom=void 0!=_.bottom?_.bottom:margin.bottom,margin.left=void 0!=_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}}}),nv.utils.initOptions(chart),chart},nv.models.sunburstChart=function(){"use strict";function chart(selection){return renderWatch.reset(),renderWatch.models(sunburst),selection.each(function(data){var container=d3.select(this);nv.utils.initSVG(container);var availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin);if(chart.update=function(){0===duration?container.call(chart):container.transition().duration(duration).call(chart)},chart.container=this,!data||!data.length)return nv.utils.noData(chart,container),chart;container.selectAll(".nv-noData").remove();var wrap=container.selectAll("g.nv-wrap.nv-sunburstChart").data(data),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-sunburstChart").append("g"),g=wrap.select("g");gEnter.append("g").attr("class","nv-sunburstWrap"),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),sunburst.width(availableWidth).height(availableHeight);var sunWrap=g.select(".nv-sunburstWrap").datum(data);d3.transition(sunWrap).call(sunburst)}),renderWatch.renderEnd("sunburstChart immediate"),chart}var sunburst=nv.models.sunburst(),tooltip=nv.models.tooltip(),margin={top:30,right:20,bottom:20,left:20},width=null,height=null,color=nv.utils.defaultColor(),defaultState=(Math.round(1e5*Math.random()),null),noData=null,duration=250,dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState","renderEnd"),renderWatch=nv.utils.renderWatch(dispatch);return tooltip.headerEnabled(!1).duration(0).valueFormatter(function(d){return d}),sunburst.dispatch.on("elementMouseover.tooltip",function(evt){evt.series={key:evt.data.name,value:evt.data.size,color:evt.color},tooltip.data(evt).hidden(!1)}),sunburst.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),sunburst.dispatch.on("elementMousemove.tooltip",function(){tooltip.position({top:d3.event.pageY,left:d3.event.pageX})()}),chart.dispatch=dispatch,chart.sunburst=sunburst,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{noData:{get:function(){return noData},set:function(_){noData=_}},defaultState:{get:function(){return defaultState},set:function(_){defaultState=_}},color:{get:function(){return color},set:function(_){color=_,sunburst.color(color)}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration),sunburst.duration(duration)}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}}}),nv.utils.inheritOptions(chart,sunburst),nv.utils.initOptions(chart),chart},nv.version="1.8.1"}(),function(){"use strict";angular.module("nvd3",[]).directive("nvd3",["nvd3Utils",function(nvd3Utils){return{restrict:"AE",scope:{data:"=",options:"=",api:"=?",events:"=?",config:"=?"},link:function(scope,element){function configure(chart,options,chartType){chart&&options&&angular.forEach(chart,function(value,key){"_"===key[0]||("dispatch"===key?((void 0===options[key]||null===options[key])&&scope._config.extended&&(options[key]={}),configureEvents(value,options[key])):"tooltip"===key?((void 0===options[key]||null===options[key])&&scope._config.extended&&(options[key]={}),configure(chart[key],options[key],chartType)):"contentGenerator"===key?options[key]&&chart[key](options[key]):-1===["axis","clearHighlights","defined","highlightPoint","nvPointerEventsClass","options","rangeBand","rangeBands","scatter","open","close"].indexOf(key)&&(void 0===options[key]||null===options[key]?scope._config.extended&&(options[key]=value()):chart[key](options[key])))})}function configureEvents(dispatch,options){dispatch&&options&&angular.forEach(dispatch,function(value,key){void 0===options[key]||null===options[key]?scope._config.extended&&(options[key]=value.on):dispatch.on(key+"._",options[key])})}function configureWrapper(name){var _=nvd3Utils.deepExtend(defaultWrapper(name),scope.options[name]||{});scope._config.extended&&(scope.options[name]=_);var wrapElement=angular.element("<div></div>").html(_.html||"").addClass(name).addClass(_.className).removeAttr("style").css(_.css);_.html||wrapElement.text(_.text),_.enable&&("title"===name?element.prepend(wrapElement):"subtitle"===name?angular.element(element[0].querySelector(".title")).after(wrapElement):"caption"===name&&element.append(wrapElement))}function configureStyles(){var _=nvd3Utils.deepExtend(defaultStyles(),scope.options.styles||{});scope._config.extended&&(scope.options.styles=_),angular.forEach(_.classes,function(value,key){value?element.addClass(key):element.removeClass(key)}),element.removeAttr("style").css(_.css)}function defaultWrapper(_){switch(_){case"title":return{enable:!1,text:"Write Your Title",className:"h4",css:{width:scope.options.chart.width+"px",textAlign:"center"}};case"subtitle":return{enable:!1,text:"Write Your Subtitle",css:{width:scope.options.chart.width+"px",textAlign:"center"}};case"caption":return{enable:!1,text:"Figure 1. Write Your Caption text.",css:{width:scope.options.chart.width+"px",textAlign:"center"}}}}function defaultStyles(){return{classes:{"with-3d-shadow":!0,"with-transitions":!0,gallery:!1},css:{}}}var defaultConfig={extended:!1,visible:!0,disabled:!1,autorefresh:!0,refreshDataOnly:!0,deepWatchOptions:!0,deepWatchData:!1,deepWatchConfig:!0,debounce:10};scope._config=angular.extend(defaultConfig,scope.config),scope.api={refresh:function(){scope.api.updateWithOptions(scope.options)},update:function(){scope.chart&&scope.chart.update()},updateWithOptions:function(options){scope.api.clearElement(),angular.isDefined(options)!==!1&&scope._config.visible&&(scope.chart=nv.models[options.chart.type](),scope.chart.id=Math.random().toString(36).substr(2,15),angular.forEach(scope.chart,function(value,key){"_"===key[0]||["clearHighlights","highlightPoint","id","options","resizeHandler","state","open","close","tooltipContent"].indexOf(key)>=0||("dispatch"===key?((void 0===options.chart[key]||null===options.chart[key])&&scope._config.extended&&(options.chart[key]={}),configureEvents(scope.chart[key],options.chart[key])):["bars","bars1","bars2","boxplot","bullet","controls","discretebar","distX","distY","interactiveLayer","legend","lines","lines1","lines2","multibar","pie","scatter","sparkline","stack1","stack2","sunburst","tooltip","x2Axis","xAxis","y1Axis","y2Axis","y3Axis","y4Axis","yAxis","yAxis1","yAxis2"].indexOf(key)>=0||"stacked"===key&&"stackedAreaChart"===options.chart.type?((void 0===options.chart[key]||null===options.chart[key])&&scope._config.extended&&(options.chart[key]={}),configure(scope.chart[key],options.chart[key],options.chart.type)):("xTickFormat"!==key&&"yTickFormat"!==key||"lineWithFocusChart"!==options.chart.type)&&("tooltips"===key&&"boxPlotChart"===options.chart.type||("tooltipXContent"!==key&&"tooltipYContent"!==key||"scatterChart"!==options.chart.type)&&(void 0===options.chart[key]||null===options.chart[key]?scope._config.extended&&(options.chart[key]=value()):scope.chart[key](options.chart[key]))))}),scope.api.updateWithData("sunburstChart"===options.chart.type?angular.copy(scope.data):scope.data),(options.title||scope._config.extended)&&configureWrapper("title"),(options.subtitle||scope._config.extended)&&configureWrapper("subtitle"),(options.caption||scope._config.extended)&&configureWrapper("caption"),(options.styles||scope._config.extended)&&configureStyles(),nv.addGraph(function(){return scope.chart?(scope.chart.resizeHandler&&scope.chart.resizeHandler.clear(),scope.chart.resizeHandler=nv.utils.windowResize(function(){scope.chart&&scope.chart.update&&scope.chart.update()}),void 0!==options.chart.zoom&&["scatterChart","lineChart","candlestickBarChart","cumulativeLineChart","historicalBarChart","ohlcBarChart","stackedAreaChart"].indexOf(options.chart.type)>-1&&nvd3Utils.zoom(scope,options),scope.chart):void 0},options.chart.callback))},updateWithData:function(data){if(data){d3.select(element[0]).select("svg").remove();var h,w;scope.svg=d3.select(element[0]).append("svg"),(h=scope.options.chart.height)&&(isNaN(+h)||(h+="px"),scope.svg.attr("height",h).style({height:h})),(w=scope.options.chart.width)?(isNaN(+w)||(w+="px"),scope.svg.attr("width",w).style({width:w})):scope.svg.attr("width","100%").style({width:"100%"}),scope.svg.datum(data).call(scope.chart)}},clearElement:function(){if(element.find(".title").remove(),element.find(".subtitle").remove(),element.find(".caption").remove(),element.empty(),scope.chart&&scope.chart.tooltip&&scope.chart.tooltip.id&&d3.select("#"+scope.chart.tooltip.id()).remove(),nv.graphs&&scope.chart)for(var i=nv.graphs.length-1;i>=0;i--)nv.graphs[i]&&nv.graphs[i].id===scope.chart.id&&nv.graphs.splice(i,1);nv.tooltip&&nv.tooltip.cleanup&&nv.tooltip.cleanup(),scope.chart&&scope.chart.resizeHandler&&scope.chart.resizeHandler.clear(),scope.chart=null},getScope:function(){return scope}},scope.$watch("options",nvd3Utils.debounce(function(){!scope._config.disabled&&scope._config.autorefresh&&scope.api.refresh()},scope._config.debounce,!0),scope._config.deepWatchOptions),scope.$watch("data",function(newData,oldData){newData!==oldData&&scope.chart&&!scope._config.disabled&&scope._config.autorefresh&&(scope._config.refreshDataOnly&&scope.chart.update?scope.chart.update():scope.api.refresh())},scope._config.deepWatchData),scope.$watch("config",function(newConfig,oldConfig){newConfig!==oldConfig&&(scope._config=angular.extend(defaultConfig,newConfig),scope.api.refresh())},scope._config.deepWatchConfig),angular.forEach(scope.events,function(eventHandler,event){scope.$on(event,function(e){return eventHandler(e,scope)})}),element.on("$destroy",function(){scope.api.clearElement()})}}}]).factory("nvd3Utils",function(){return{debounce:function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,immediate||func.apply(context,args)},callNow=immediate&&!timeout;clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&func.apply(context,args)}},deepExtend:function(dst){var me=this;return angular.forEach(arguments,function(obj){obj!==dst&&angular.forEach(obj,function(value,key){dst[key]&&dst[key].constructor&&dst[key].constructor===Object?me.deepExtend(dst[key],value):dst[key]=value})}),dst},zoom:function(scope,options){var zoom=options.chart.zoom,enabled="undefined"==typeof zoom.enabled||null===zoom.enabled?!0:zoom.enabled;if(enabled){var fixDomain,d3zoom,zoomed,unzoomed,xScale=scope.chart.xAxis.scale(),yScale=scope.chart.yAxis.scale(),xDomain=scope.chart.xDomain||xScale.domain,yDomain=scope.chart.yDomain||yScale.domain,x_boundary=xScale.domain().slice(),y_boundary=yScale.domain().slice(),scale=zoom.scale||1,translate=zoom.translate||[0,0],scaleExtent=zoom.scaleExtent||[1,10],useFixedDomain=zoom.useFixedDomain||!1,useNiceScale=zoom.useNiceScale||!1,horizontalOff=zoom.horizontalOff||!1,verticalOff=zoom.verticalOff||!1,unzoomEventType=zoom.unzoomEventType||"dblclick.zoom";useNiceScale&&(xScale.nice(),yScale.nice()),fixDomain=function(domain,boundary){return domain[0]=Math.min(Math.max(domain[0],boundary[0]),boundary[1]-boundary[1]/scaleExtent[1]),domain[1]=Math.max(boundary[0]+boundary[1]/scaleExtent[1],Math.min(domain[1],boundary[1])),domain},zoomed=function(){if(void 0!==zoom.zoomed){var domains=zoom.zoomed(xScale.domain(),yScale.domain());horizontalOff||xDomain([domains.x1,domains.x2]),verticalOff||yDomain([domains.y1,domains.y2])}else horizontalOff||xDomain(useFixedDomain?fixDomain(xScale.domain(),x_boundary):xScale.domain()),verticalOff||yDomain(useFixedDomain?fixDomain(yScale.domain(),y_boundary):yScale.domain());scope.chart.update()},unzoomed=function(){if(void 0!==zoom.unzoomed){var domains=zoom.unzoomed(xScale.domain(),yScale.domain());horizontalOff||xDomain([domains.x1,domains.x2]),verticalOff||yDomain([domains.y1,domains.y2])}else horizontalOff||xDomain(x_boundary),verticalOff||yDomain(y_boundary);d3zoom.scale(scale).translate(translate),scope.chart.update()},d3zoom=d3.behavior.zoom().x(xScale).y(yScale).scaleExtent(scaleExtent).on("zoom",zoomed),scope.svg.call(d3zoom),d3zoom.scale(scale).translate(translate).event(scope.svg),"none"!==unzoomEventType&&scope.svg.on(unzoomEventType,unzoomed)}}}})}(),function(angular,factory){return"function"==typeof define&&define.amd?void define("angular-file-upload",["angular"],function(angular){return factory(angular)}):factory(angular)}("undefined"==typeof angular?null:angular,function(angular){var module=angular.module("angularFileUpload",[]);return module.value("fileUploaderOptions",{url:"/",alias:"file",headers:{},queue:[],progress:0,autoUpload:!1,removeAfterUpload:!1,method:"POST",filters:[],formData:[],queueLimit:Number.MAX_VALUE,withCredentials:!1}).factory("FileUploader",["fileUploaderOptions","$rootScope","$http","$window","$compile",function(fileUploaderOptions,$rootScope,$http,$window,$compile){function FileUploader(options){var settings=angular.copy(fileUploaderOptions);angular.extend(this,settings,options,{isUploading:!1,_nextIndex:0,_failFilterIndex:-1,_directives:{select:[],drop:[],over:[]}}),this.filters.unshift({name:"queueLimit",fn:this._queueLimitFilter}),this.filters.unshift({name:"folder",fn:this._folderFilter})}function FileLikeObject(fakePathOrObject){var postfix=angular.isString(fakePathOrObject)?"FakePath":"Object",method="_createFrom"+postfix;this[method](fakePathOrObject)}function FileItem(uploader,file,options,input){file=uploader._getFileOrFileLikeObject(file),angular.extend(this,{url:uploader.url,alias:uploader.alias,headers:angular.copy(uploader.headers),formData:angular.copy(uploader.formData),removeAfterUpload:uploader.removeAfterUpload,withCredentials:uploader.withCredentials,method:uploader.method},options,{uploader:uploader,file:new FileUploader.FileLikeObject(file),isReady:!1,isUploading:!1,isUploaded:!1,isSuccess:!1,isCancel:!1,isError:!1,progress:0,index:null,_file:file}),input&&(this._input=angular.element(input),this._replaceNode(this._input))}function FileDirective(options){angular.extend(this,options),this.uploader._directives[this.prop].push(this),this._saveLinks(),this.bind()}function FileSelect(){FileSelect.super_.apply(this,arguments),this.uploader.isHTML5||this.element.removeAttr("multiple"),this.element.prop("value",null)}function FileDrop(){FileDrop.super_.apply(this,arguments)}function FileOver(){FileOver.super_.apply(this,arguments)}return FileUploader.prototype.isHTML5=!(!$window.File||!$window.FormData),FileUploader.prototype.addToQueue=function(files,options,filters){var list=angular.isElement(files)?[files]:files,arrayOfFilters=this._getFilters(filters),count=this.queue.length,addedFileItems=[];angular.forEach(list,function(file){var item=this._getFileOrFileLikeObject(file);if(this._isValidFile(item,arrayOfFilters,options)){var input=this.isFile(item)?null:file,fileItem=new FileUploader.FileItem(this,item,options,input);addedFileItems.push(fileItem),this.queue.push(fileItem),this._onAfterAddingFile(fileItem)}else{var filter=this.filters[this._failFilterIndex];this._onWhenAddingFileFailed(item,filter,options)}},this),this.queue.length!==count&&(this._onAfterAddingAll(addedFileItems),this.progress=this._getTotalProgress()),this._render(),this.autoUpload&&this.uploadAll()},FileUploader.prototype.removeFromQueue=function(value){var index=this.getIndexOfItem(value),item=this.queue[index];item.isUploading&&item.cancel(),this.queue.splice(index,1),item._destroy(),this.progress=this._getTotalProgress()},FileUploader.prototype.clearQueue=function(){for(;this.queue.length;)this.queue[0].remove();this.progress=0},FileUploader.prototype.uploadItem=function(value){var index=this.getIndexOfItem(value),item=this.queue[index],transport=this.isHTML5?"_xhrTransport":"_iframeTransport";item._prepareToUploading(),this.isUploading||(this.isUploading=!0,this[transport](item))},FileUploader.prototype.cancelItem=function(value){var index=this.getIndexOfItem(value),item=this.queue[index],prop=this.isHTML5?"_xhr":"_form";item&&item.isUploading&&item[prop].abort()},FileUploader.prototype.uploadAll=function(){var items=this.getNotUploadedItems().filter(function(item){return!item.isUploading});items.length&&(angular.forEach(items,function(item){item._prepareToUploading()}),items[0].upload())},FileUploader.prototype.cancelAll=function(){var items=this.getNotUploadedItems();angular.forEach(items,function(item){item.cancel()})},FileUploader.prototype.isFile=function(value){var fn=$window.File;return fn&&value instanceof fn},FileUploader.prototype.isFileLikeObject=function(value){return value instanceof FileUploader.FileLikeObject},FileUploader.prototype.getIndexOfItem=function(value){return angular.isNumber(value)?value:this.queue.indexOf(value)},FileUploader.prototype.getNotUploadedItems=function(){return this.queue.filter(function(item){return!item.isUploaded})},FileUploader.prototype.getReadyItems=function(){return this.queue.filter(function(item){return item.isReady&&!item.isUploading}).sort(function(item1,item2){return item1.index-item2.index})},FileUploader.prototype.destroy=function(){angular.forEach(this._directives,function(key){angular.forEach(this._directives[key],function(object){object.destroy()},this)},this)},FileUploader.prototype.onAfterAddingAll=function(){},FileUploader.prototype.onAfterAddingFile=function(){},FileUploader.prototype.onWhenAddingFileFailed=function(){},FileUploader.prototype.onBeforeUploadItem=function(){},FileUploader.prototype.onProgressItem=function(){},FileUploader.prototype.onProgressAll=function(){},FileUploader.prototype.onSuccessItem=function(){},FileUploader.prototype.onErrorItem=function(){},FileUploader.prototype.onCancelItem=function(){},FileUploader.prototype.onCompleteItem=function(){},FileUploader.prototype.onCompleteAll=function(){},FileUploader.prototype._getTotalProgress=function(value){if(this.removeAfterUpload)return value||0;var notUploaded=this.getNotUploadedItems().length,uploaded=notUploaded?this.queue.length-notUploaded:this.queue.length,ratio=100/this.queue.length,current=(value||0)*ratio/100;return Math.round(uploaded*ratio+current)},FileUploader.prototype._getFilters=function(filters){if(angular.isUndefined(filters))return this.filters;if(angular.isArray(filters))return filters;var names=filters.split(/\s*,/);return this.filters.filter(function(filter){return-1!==names.indexOf(filter.name)},this)},FileUploader.prototype._render=function(){$rootScope.$$phase||$rootScope.$apply()},FileUploader.prototype._folderFilter=function(item){return!(!item.size&&!item.type)},FileUploader.prototype._queueLimitFilter=function(){return this.queue.length<this.queueLimit},FileUploader.prototype._isValidFile=function(file,filters,options){return this._failFilterIndex=-1,filters.length?filters.every(function(filter){return this._failFilterIndex++,filter.fn.call(this,file,options)},this):!0},FileUploader.prototype._getFileOrFileLikeObject=function(some){return this.isFile(some)||this.isFileLikeObject(some)?some:new FileUploader.FileLikeObject(some.value)},FileUploader.prototype._isSuccessCode=function(status){return status>=200&&300>status||304===status},FileUploader.prototype._transformResponse=function(response){return angular.forEach($http.defaults.transformResponse,function(transformFn){response=transformFn(response)}),response},FileUploader.prototype._parseHeaders=function(headers){function trim(string){return string.replace(/^\s+/,"").replace(/\s+$/,"")}function lowercase(string){return string.toLowerCase()}var key,val,i,parsed={};return headers?(angular.forEach(headers.split("\n"),function(line){i=line.indexOf(":"),key=lowercase(trim(line.substr(0,i))),val=trim(line.substr(i+1)),key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}),parsed):parsed},FileUploader.prototype._xhrTransport=function(item){var xhr=item._xhr=new XMLHttpRequest,form=new FormData,that=this;that._onBeforeUploadItem(item),angular.forEach(item.formData,function(obj){angular.forEach(obj,function(value,key){form.append(key,value)})}),form.append(item.alias,item._file),xhr.upload.onprogress=function(event){var progress=Math.round(event.lengthComputable?100*event.loaded/event.total:0);that._onProgressItem(item,progress)},xhr.onload=function(){var headers=that._parseHeaders(xhr.getAllResponseHeaders()),response=that._transformResponse(xhr.response),gist=that._isSuccessCode(xhr.status)?"Success":"Error",method="_on"+gist+"Item";that[method](item,response,xhr.status,headers),that._onCompleteItem(item,response,xhr.status,headers)},xhr.onerror=function(){var headers=that._parseHeaders(xhr.getAllResponseHeaders()),response=that._transformResponse(xhr.response);that._onErrorItem(item,response,xhr.status,headers),that._onCompleteItem(item,response,xhr.status,headers)},xhr.onabort=function(){var headers=that._parseHeaders(xhr.getAllResponseHeaders()),response=that._transformResponse(xhr.response);that._onCancelItem(item,response,xhr.status,headers),that._onCompleteItem(item,response,xhr.status,headers)},xhr.open(item.method,item.url,!0),xhr.withCredentials=item.withCredentials,angular.forEach(item.headers,function(value,name){xhr.setRequestHeader(name,value)}),xhr.send(form),this._render()},FileUploader.prototype._iframeTransport=function(item){var form=angular.element('<form style="display: none;" />'),iframe=angular.element('<iframe name="iframeTransport'+Date.now()+'">'),input=item._input,that=this;item._form&&item._form.replaceWith(input),item._form=form,that._onBeforeUploadItem(item),input.prop("name",item.alias),angular.forEach(item.formData,function(obj){angular.forEach(obj,function(value,key){form.append(angular.element('<input type="hidden" name="'+key+'" value="'+value+'" />'))})}),form.prop({action:item.url,method:"POST",target:iframe.prop("name"),enctype:"multipart/form-data",encoding:"multipart/form-data"}),iframe.bind("load",function(){try{var html=iframe[0].contentDocument.body.innerHTML}catch(e){}var xhr={response:html,status:200,dummy:!0},response=that._transformResponse(xhr.response),headers={};that._onSuccessItem(item,response,xhr.status,headers),that._onCompleteItem(item,response,xhr.status,headers)}),form.abort=function(){var response,xhr={status:0,dummy:!0},headers={};iframe.unbind("load").prop("src","javascript:false;"),form.replaceWith(input),that._onCancelItem(item,response,xhr.status,headers),that._onCompleteItem(item,response,xhr.status,headers)},input.after(form),form.append(input).append(iframe),form[0].submit(),this._render()},FileUploader.prototype._onWhenAddingFileFailed=function(item,filter,options){this.onWhenAddingFileFailed(item,filter,options)},FileUploader.prototype._onAfterAddingFile=function(item){this.onAfterAddingFile(item)},FileUploader.prototype._onAfterAddingAll=function(items){this.onAfterAddingAll(items)},FileUploader.prototype._onBeforeUploadItem=function(item){item._onBeforeUpload(),this.onBeforeUploadItem(item)},FileUploader.prototype._onProgressItem=function(item,progress){var total=this._getTotalProgress(progress);this.progress=total,item._onProgress(progress),this.onProgressItem(item,progress),this.onProgressAll(total),this._render()},FileUploader.prototype._onSuccessItem=function(item,response,status,headers){item._onSuccess(response,status,headers),this.onSuccessItem(item,response,status,headers)},FileUploader.prototype._onErrorItem=function(item,response,status,headers){item._onError(response,status,headers),this.onErrorItem(item,response,status,headers)},FileUploader.prototype._onCancelItem=function(item,response,status,headers){item._onCancel(response,status,headers),this.onCancelItem(item,response,status,headers)},FileUploader.prototype._onCompleteItem=function(item,response,status,headers){item._onComplete(response,status,headers),this.onCompleteItem(item,response,status,headers);var nextItem=this.getReadyItems()[0];return this.isUploading=!1,angular.isDefined(nextItem)?void nextItem.upload():(this.onCompleteAll(),this.progress=this._getTotalProgress(),void this._render())},FileUploader.isFile=FileUploader.prototype.isFile,FileUploader.isFileLikeObject=FileUploader.prototype.isFileLikeObject,FileUploader.isHTML5=FileUploader.prototype.isHTML5,FileUploader.inherit=function(target,source){target.prototype=Object.create(source.prototype),target.prototype.constructor=target,target.super_=source
},FileUploader.FileLikeObject=FileLikeObject,FileUploader.FileItem=FileItem,FileUploader.FileDirective=FileDirective,FileUploader.FileSelect=FileSelect,FileUploader.FileDrop=FileDrop,FileUploader.FileOver=FileOver,FileLikeObject.prototype._createFromFakePath=function(path){this.lastModifiedDate=null,this.size=null,this.type="like/"+path.slice(path.lastIndexOf(".")+1).toLowerCase(),this.name=path.slice(path.lastIndexOf("/")+path.lastIndexOf("\\")+2)},FileLikeObject.prototype._createFromObject=function(object){this.lastModifiedDate=angular.copy(object.lastModifiedDate),this.size=object.size,this.type=object.type,this.name=object.name},FileItem.prototype.upload=function(){this.uploader.uploadItem(this)},FileItem.prototype.cancel=function(){this.uploader.cancelItem(this)},FileItem.prototype.remove=function(){this.uploader.removeFromQueue(this)},FileItem.prototype.onBeforeUpload=function(){},FileItem.prototype.onProgress=function(){},FileItem.prototype.onSuccess=function(){},FileItem.prototype.onError=function(){},FileItem.prototype.onCancel=function(){},FileItem.prototype.onComplete=function(){},FileItem.prototype._onBeforeUpload=function(){this.isReady=!0,this.isUploading=!0,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!1,this.isError=!1,this.progress=0,this.onBeforeUpload()},FileItem.prototype._onProgress=function(progress){this.progress=progress,this.onProgress(progress)},FileItem.prototype._onSuccess=function(response,status,headers){this.isReady=!1,this.isUploading=!1,this.isUploaded=!0,this.isSuccess=!0,this.isCancel=!1,this.isError=!1,this.progress=100,this.index=null,this.onSuccess(response,status,headers)},FileItem.prototype._onError=function(response,status,headers){this.isReady=!1,this.isUploading=!1,this.isUploaded=!0,this.isSuccess=!1,this.isCancel=!1,this.isError=!0,this.progress=0,this.index=null,this.onError(response,status,headers)},FileItem.prototype._onCancel=function(response,status,headers){this.isReady=!1,this.isUploading=!1,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!0,this.isError=!1,this.progress=0,this.index=null,this.onCancel(response,status,headers)},FileItem.prototype._onComplete=function(response,status,headers){this.onComplete(response,status,headers),this.removeAfterUpload&&this.remove()},FileItem.prototype._destroy=function(){this._input&&this._input.remove(),this._form&&this._form.remove(),delete this._form,delete this._input},FileItem.prototype._prepareToUploading=function(){this.index=this.index||++this.uploader._nextIndex,this.isReady=!0},FileItem.prototype._replaceNode=function(input){var clone=$compile(input.clone())(input.scope());clone.prop("value",null),input.css("display","none"),input.after(clone)},FileDirective.prototype.events={},FileDirective.prototype.bind=function(){for(var key in this.events){var prop=this.events[key];this.element.bind(key,this[prop])}},FileDirective.prototype.unbind=function(){for(var key in this.events)this.element.unbind(key,this.events[key])},FileDirective.prototype.destroy=function(){var index=this.uploader._directives[this.prop].indexOf(this);this.uploader._directives[this.prop].splice(index,1),this.unbind()},FileDirective.prototype._saveLinks=function(){for(var key in this.events){var prop=this.events[key];this[prop]=this[prop].bind(this)}},FileUploader.inherit(FileSelect,FileDirective),FileSelect.prototype.events={$destroy:"destroy",change:"onChange"},FileSelect.prototype.prop="select",FileSelect.prototype.getOptions=function(){},FileSelect.prototype.getFilters=function(){},FileSelect.prototype.isEmptyAfterSelection=function(){return!!this.element.attr("multiple")},FileSelect.prototype.onChange=function(){var files=this.uploader.isHTML5?this.element[0].files:this.element[0],options=this.getOptions(),filters=this.getFilters();this.uploader.isHTML5||this.destroy(),this.uploader.addToQueue(files,options,filters),this.isEmptyAfterSelection()&&this.element.prop("value",null)},FileUploader.inherit(FileDrop,FileDirective),FileDrop.prototype.events={$destroy:"destroy",drop:"onDrop",dragover:"onDragOver",dragleave:"onDragLeave"},FileDrop.prototype.prop="drop",FileDrop.prototype.getOptions=function(){},FileDrop.prototype.getFilters=function(){},FileDrop.prototype.onDrop=function(event){var transfer=this._getTransfer(event);if(transfer){var options=this.getOptions(),filters=this.getFilters();this._preventAndStop(event),angular.forEach(this.uploader._directives.over,this._removeOverClass,this),this.uploader.addToQueue(transfer.files,options,filters)}},FileDrop.prototype.onDragOver=function(event){var transfer=this._getTransfer(event);this._haveFiles(transfer.types)&&(transfer.dropEffect="copy",this._preventAndStop(event),angular.forEach(this.uploader._directives.over,this._addOverClass,this))},FileDrop.prototype.onDragLeave=function(event){event.target===this.element[0]&&(this._preventAndStop(event),angular.forEach(this.uploader._directives.over,this._removeOverClass,this))},FileDrop.prototype._getTransfer=function(event){return event.dataTransfer?event.dataTransfer:event.originalEvent.dataTransfer},FileDrop.prototype._preventAndStop=function(event){event.preventDefault(),event.stopPropagation()},FileDrop.prototype._haveFiles=function(types){return types?types.indexOf?-1!==types.indexOf("Files"):types.contains?types.contains("Files"):!1:!1},FileDrop.prototype._addOverClass=function(item){item.addOverClass()},FileDrop.prototype._removeOverClass=function(item){item.removeOverClass()},FileUploader.inherit(FileOver,FileDirective),FileOver.prototype.events={$destroy:"destroy"},FileOver.prototype.prop="over",FileOver.prototype.overClass="nv-file-over",FileOver.prototype.addOverClass=function(){this.element.addClass(this.getOverClass())},FileOver.prototype.removeOverClass=function(){this.element.removeClass(this.getOverClass())},FileOver.prototype.getOverClass=function(){return this.overClass},FileUploader}]).directive("nvFileSelect",["$parse","FileUploader",function($parse,FileUploader){return{link:function(scope,element,attributes){var uploader=scope.$eval(attributes.uploader);if(!(uploader instanceof FileUploader))throw new TypeError('"Uploader" must be an instance of FileUploader');var object=new FileUploader.FileSelect({uploader:uploader,element:element});object.getOptions=$parse(attributes.options).bind(object,scope),object.getFilters=function(){return attributes.filters}}}}]).directive("nvFileDrop",["$parse","FileUploader",function($parse,FileUploader){return{link:function(scope,element,attributes){var uploader=scope.$eval(attributes.uploader);if(!(uploader instanceof FileUploader))throw new TypeError('"Uploader" must be an instance of FileUploader');if(uploader.isHTML5){var object=new FileUploader.FileDrop({uploader:uploader,element:element});object.getOptions=$parse(attributes.options).bind(object,scope),object.getFilters=function(){return attributes.filters}}}}}]).directive("nvFileOver",["FileUploader",function(FileUploader){return{link:function(scope,element,attributes){var uploader=scope.$eval(attributes.uploader);if(!(uploader instanceof FileUploader))throw new TypeError('"Uploader" must be an instance of FileUploader');var object=new FileUploader.FileOver({uploader:uploader,element:element});object.getOverClass=function(){return attributes.overClass||this.overClass}}}}]),module}),!function(){function a(a,b){window.XMLHttpRequest.prototype[a]=b(window.XMLHttpRequest.prototype[a])}function b(a,b,c){try{Object.defineProperty(a,b,{get:c})}catch(d){}}if(window.FileAPI||(window.FileAPI={}),FileAPI.shouldLoad=window.XMLHttpRequest&&!window.FormData||FileAPI.forceLoad,FileAPI.shouldLoad){var c=function(a){if(!a.__listeners){a.upload||(a.upload={}),a.__listeners=[];var b=a.upload.addEventListener;a.upload.addEventListener=function(c,d){a.__listeners[c]=d,b&&b.apply(this,arguments)}}};a("open",function(a){return function(b,d,e){c(this),this.__url=d;try{a.apply(this,[b,d,e])}catch(f){f.message.indexOf("Access is denied")>-1&&(this.__origError=f,a.apply(this,[b,"_fix_for_ie_crossdomain__",e]))}}}),a("getResponseHeader",function(a){return function(b){return this.__fileApiXHR&&this.__fileApiXHR.getResponseHeader?this.__fileApiXHR.getResponseHeader(b):null==a?null:a.apply(this,[b])}}),a("getAllResponseHeaders",function(a){return function(){return this.__fileApiXHR&&this.__fileApiXHR.getAllResponseHeaders?this.__fileApiXHR.getAllResponseHeaders():null==a?null:a.apply(this)}}),a("abort",function(a){return function(){return this.__fileApiXHR&&this.__fileApiXHR.abort?this.__fileApiXHR.abort():null==a?null:a.apply(this)}}),a("setRequestHeader",function(a){return function(b,d){if("__setXHR_"===b){c(this);var e=d(this);e instanceof Function&&e(this)}else this.__requestHeaders=this.__requestHeaders||{},this.__requestHeaders[b]=d,a.apply(this,arguments)}}),a("send",function(a){return function(){var c=this;if(arguments[0]&&arguments[0].__isFileAPIShim){var d=arguments[0],e={url:c.__url,jsonp:!1,cache:!0,complete:function(a,d){c.__completed=!0,!a&&c.__listeners.load&&c.__listeners.load({type:"load",loaded:c.__loaded,total:c.__total,target:c,lengthComputable:!0}),!a&&c.__listeners.loadend&&c.__listeners.loadend({type:"loadend",loaded:c.__loaded,total:c.__total,target:c,lengthComputable:!0}),"abort"===a&&c.__listeners.abort&&c.__listeners.abort({type:"abort",loaded:c.__loaded,total:c.__total,target:c,lengthComputable:!0}),void 0!==d.status&&b(c,"status",function(){return 0===d.status&&a&&"abort"!==a?500:d.status}),void 0!==d.statusText&&b(c,"statusText",function(){return d.statusText}),b(c,"readyState",function(){return 4}),void 0!==d.response&&b(c,"response",function(){return d.response});var e=d.responseText||(a&&0===d.status&&"abort"!==a?a:void 0);b(c,"responseText",function(){return e}),b(c,"response",function(){return e}),a&&b(c,"err",function(){return a}),c.__fileApiXHR=d,c.onreadystatechange&&c.onreadystatechange(),c.onload&&c.onload()},progress:function(a){if(a.target=c,c.__listeners.progress&&c.__listeners.progress(a),c.__total=a.total,c.__loaded=a.loaded,a.total===a.loaded){var b=this;setTimeout(function(){c.__completed||(c.getAllResponseHeaders=function(){},b.complete(null,{status:204,statusText:"No Content"}))},FileAPI.noContentTimeout||1e4)}},headers:c.__requestHeaders};e.data={},e.files={};for(var f=0;f<d.data.length;f++){var g=d.data[f];null!=g.val&&null!=g.val.name&&null!=g.val.size&&null!=g.val.type?e.files[g.key]=g.val:e.data[g.key]=g.val}setTimeout(function(){if(!FileAPI.hasFlash)throw'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';c.__fileApiXHR=FileAPI.upload(e)},1)}else{if(this.__origError)throw this.__origError;a.apply(c,arguments)}}}),window.XMLHttpRequest.__isFileAPIShim=!0,window.FormData=FormData=function(){return{append:function(a,b,c){b.__isFileAPIBlobShim&&(b=b.data[0]),this.data.push({key:a,val:b,name:c})},data:[],__isFileAPIShim:!0}},window.Blob=Blob=function(a){return{data:a,__isFileAPIBlobShim:!0}}}}(),function(){function a(a){return"input"===a[0].tagName.toLowerCase()&&a.attr("type")&&"file"===a.attr("type").toLowerCase()}function b(){try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(a)return!0}catch(b){if(void 0!==navigator.mimeTypes["application/x-shockwave-flash"])return!0}return!1}function c(a){var b=0,c=0;if(window.jQuery)return jQuery(a).offset();if(a.offsetParent)do b+=a.offsetLeft-a.scrollLeft,c+=a.offsetTop-a.scrollTop,a=a.offsetParent;while(a);return{left:b,top:c}}if(FileAPI.shouldLoad){if(FileAPI.forceLoad&&(FileAPI.html5=!1),!FileAPI.upload){var d,e,f,g,h,i=document.createElement("script"),j=document.getElementsByTagName("script");if(window.FileAPI.jsUrl)d=window.FileAPI.jsUrl;else if(window.FileAPI.jsPath)e=window.FileAPI.jsPath;else for(f=0;f<j.length;f++)if(h=j[f].src,g=h.search(/\/ng\-file\-upload[\-a-zA-z0-9\.]*\.js/),g>-1){e=h.substring(0,g+1);break}null==FileAPI.staticPath&&(FileAPI.staticPath=e),i.setAttribute("src",d||e+"FileAPI.min.js"),document.getElementsByTagName("head")[0].appendChild(i),FileAPI.hasFlash=b()}FileAPI.ngfFixIE=function(d,e,f,g){if(!b())throw'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';var h=function(){if(d.attr("disabled"))d.$$ngfRefElem.removeClass("js-fileapi-wrapper");else{var b=d.$$ngfRefElem;b?f(d.$$ngfRefElem):(b=d.$$ngfRefElem=e(),b.addClass("js-fileapi-wrapper"),!a(d),setTimeout(function(){b.bind("mouseenter",h)},10),b.bind("change",function(a){i.apply(this,[a]),g.apply(this,[a])})),a(d)||b.css("position","absolute").css("top",c(d[0]).top+"px").css("left",c(d[0]).left+"px").css("width",d[0].offsetWidth+"px").css("height",d[0].offsetHeight+"px").css("filter","alpha(opacity=0)").css("display",d.css("display")).css("overflow","hidden").css("z-index","900000").css("visibility","visible")}};d.bind("mouseenter",h);var i=function(a){for(var b=FileAPI.getFiles(a),c=0;c<b.length;c++)void 0===b[c].size&&(b[c].size=0),void 0===b[c].name&&(b[c].name="file"),void 0===b[c].type&&(b[c].type="undefined");a.target||(a.target={}),a.target.files=b,a.target.files!==b&&(a.__files_=b),(a.__files_||a.target.files).item=function(b){return(a.__files_||a.target.files)[b]||null}}},FileAPI.disableFileInput=function(a,b){b?a.removeClass("js-fileapi-wrapper"):a.addClass("js-fileapi-wrapper")}}}(),window.FileReader||(window.FileReader=function(){var a=this,b=!1;this.listeners={},this.addEventListener=function(b,c){a.listeners[b]=a.listeners[b]||[],a.listeners[b].push(c)},this.removeEventListener=function(b,c){a.listeners[b]&&a.listeners[b].splice(a.listeners[b].indexOf(c),1)},this.dispatchEvent=function(b){var c=a.listeners[b.type];if(c)for(var d=0;d<c.length;d++)c[d].call(a,b)},this.onabort=this.onerror=this.onload=this.onloadstart=this.onloadend=this.onprogress=null;var c=function(b,c){var d={type:b,target:a,loaded:c.loaded,total:c.total,error:c.error};return null!=c.result&&(d.target.result=c.result),d},d=function(d){b||(b=!0,a.onloadstart&&a.onloadstart(c("loadstart",d)));var e;"load"===d.type?(a.onloadend&&a.onloadend(c("loadend",d)),e=c("load",d),a.onload&&a.onload(e),a.dispatchEvent(e)):"progress"===d.type?(e=c("progress",d),a.onprogress&&a.onprogress(e),a.dispatchEvent(e)):(e=c("error",d),a.onerror&&a.onerror(e),a.dispatchEvent(e))};this.readAsArrayBuffer=function(a){FileAPI.readAsBinaryString(a,d)},this.readAsBinaryString=function(a){FileAPI.readAsBinaryString(a,d)},this.readAsDataURL=function(a){FileAPI.readAsDataURL(a,d)},this.readAsText=function(a){FileAPI.readAsText(a,d)}}),!window.XMLHttpRequest||window.FileAPI&&FileAPI.shouldLoad||(window.XMLHttpRequest.prototype.setRequestHeader=function(a){return function(b,c){if("__setXHR_"===b){var d=c(this);d instanceof Function&&d(this)}else a.apply(this,arguments)}}(window.XMLHttpRequest.prototype.setRequestHeader));var ngFileUpload=angular.module("ngFileUpload",[]);ngFileUpload.version="5.0.9",ngFileUpload.service("Upload",["$http","$q","$timeout",function(a,b,c){function d(d){d.method=d.method||"POST",d.headers=d.headers||{};var e=b.defer(),f=e.promise;return d.headers.__setXHR_=function(){return function(a){a&&(d.__XHR=a,d.xhrFn&&d.xhrFn(a),a.upload.addEventListener("progress",function(a){a.config=d,e.notify?e.notify(a):f.progressFunc&&c(function(){f.progressFunc(a)})},!1),a.upload.addEventListener("load",function(a){a.lengthComputable&&(a.config=d,e.notify?e.notify(a):f.progressFunc&&c(function(){f.progressFunc(a)}))},!1))}},a(d).then(function(a){e.resolve(a)},function(a){e.reject(a)},function(a){e.notify(a)}),f.success=function(a){return f.then(function(b){a(b.data,b.status,b.headers,d)}),f},f.error=function(a){return f.then(null,function(b){a(b.data,b.status,b.headers,d)}),f},f.progress=function(a){return f.progressFunc=a,f.then(null,null,function(b){a(b)}),f},f.abort=function(){return d.__XHR&&c(function(){d.__XHR.abort()}),f},f.xhr=function(a){return d.xhrFn=function(b){return function(){b&&b.apply(f,arguments),a.apply(f,arguments)}}(d.xhrFn),f},f}this.upload=function(a){function b(c,d,e){if(void 0!==d)if(angular.isDate(d)&&(d=d.toISOString()),angular.isString(d))c.append(e,d);else if("form"===a.sendFieldsAs)if(angular.isObject(d))for(var f in d)d.hasOwnProperty(f)&&b(c,d[f],e+"["+f+"]");else c.append(e,d);else d=angular.isString(d)?d:JSON.stringify(d),"json-blob"===a.sendFieldsAs?c.append(e,new Blob([d],{type:"application/json"})):c.append(e,d)}return a.headers=a.headers||{},a.headers["Content-Type"]=void 0,a.transformRequest=a.transformRequest?angular.isArray(a.transformRequest)?a.transformRequest:[a.transformRequest]:[],a.transformRequest.push(function(c){var d,e=new FormData,f={};for(d in a.fields)a.fields.hasOwnProperty(d)&&(f[d]=a.fields[d]);c&&(f.data=c);for(d in f)if(f.hasOwnProperty(d)){var g=f[d];a.formDataAppender?a.formDataAppender(e,d,g):b(e,g,d)}if(null!=a.file){var h=a.fileFormDataName||"file";if(angular.isArray(a.file))for(var i=angular.isString(h),j=0;j<a.file.length;j++)e.append(i?h:h[j],a.file[j],a.fileName&&a.fileName[j]||a.file[j].name);else e.append(h,a.file,a.fileName||a.file.name)}return e}),d(a)},this.http=function(b){return b.transformRequest=b.transformRequest||function(b){return window.ArrayBuffer&&b instanceof window.ArrayBuffer||b instanceof Blob?b:a.defaults.transformRequest[0](arguments)},d(b)}}]),function(){function a(a,e,f,g,h,i,j){function k(){return"input"===e[0].tagName.toLowerCase()&&f.type&&"file"===f.type.toLowerCase()}function l(b){if(!r){r=!0;try{for(var e=b.__files_||b.target&&b.target.files,j=[],k=[],l=0;l<e.length;l++){var m=e.item(l);c(a,h,f,m,b)?j.push(m):k.push(m)}d(h,i,a,g,f,f.ngfChange||f.ngfSelect,j,k,b),0===j.length&&(b.target.value=j)}finally{r=!1}}}function m(b){f.ngfMultiple&&b.attr("multiple",h(f.ngfMultiple)(a)),f.ngfCapture&&b.attr("capture",h(f.ngfCapture)(a)),f.accept&&b.attr("accept",f.accept);for(var c=0;c<e[0].attributes.length;c++){var d=e[0].attributes[c];(k()&&"type"!==d.name||"type"!==d.name&&"class"!==d.name&&"id"!==d.name&&"style"!==d.name)&&b.attr(d.name,d.value)}}function n(b,c){if(!c&&(b||k()))return e.$$ngfRefElem||e;var d=angular.element('<input type="file">');return m(d),k()?(e.replaceWith(d),e=d,d.attr("__ngf_gen__",!0),j(e)(a)):(d.css("visibility","hidden").css("position","absolute").css("overflow","hidden").css("width","0px").css("height","0px").css("z-index","-100000").css("border","none").css("margin","0px").css("padding","0px").attr("tabindex","-1"),e.$$ngfRefElem&&e.$$ngfRefElem.remove(),e.$$ngfRefElem=d,document.body.appendChild(d[0])),d}function o(b){d(h,i,a,g,f,f.ngfChange||f.ngfSelect,[],[],b,!0)}function p(c){function d(a){a&&i[0].click(),(k()||!a)&&e.bind("click touchend",p)}if(e.attr("disabled")||q)return!1;null!=c&&(c.preventDefault(),c.stopPropagation());var g=h(f.ngfResetOnClick)(a)!==!1,i=n(c,g);return i&&((!c||g)&&i.bind("change",l),c&&g&&h(f.ngfResetModelOnClick)(a)!==!1&&o(c),b(navigator.userAgent)?setTimeout(function(){d(c)},0):d(c)),!1}if(!e.attr("__ngf_gen__")){a.$on("$destroy",function(){e.$$ngfRefElem&&e.$$ngfRefElem.remove()});var q=!1;-1===f.ngfSelect.search(/\W+$files\W+/)&&a.$watch(f.ngfSelect,function(a){q=a===!1});var r=!1;window.FileAPI&&window.FileAPI.ngfFixIE?window.FileAPI.ngfFixIE(e,n,m,l):p()}}function b(a){var b=a.match(/Android[^\d]*(\d+)\.(\d+)/);return b&&b.length>2?parseInt(b[1])<4||4===parseInt(b[1])&&parseInt(b[2])<4:/.*Windows.*Safari.*/.test(a)}ngFileUpload.directive("ngfSelect",["$parse","$timeout","$compile",function(b,c,d){return{restrict:"AEC",require:"?ngModel",link:function(e,f,g,h){a(e,f,g,h,b,c,d)}}}]),ngFileUpload.validate=function(a,b,c,d,e){function f(a){if(a.length>2&&"/"===a[0]&&"/"===a[a.length-1])return a.substring(1,a.length-1);var b=a.split(","),c="";if(b.length>1)for(var d=0;d<b.length;d++)c+="("+f(b[d])+")",d<b.length-1&&(c+="|");else 0===a.indexOf(".")&&(a="*"+a),c="^"+a.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&")+"$",c=c.replace(/\\\*/g,".*").replace(/\\\?/g,".");return c}var g=b(c.ngfAccept)(a,{$file:d,$event:e}),h=b(c.ngfMaxSize)(a,{$file:d,$event:e})||9007199254740991,i=b(c.ngfMinSize)(a,{$file:d,$event:e})||-1;if(null!=g&&angular.isString(g)){var j=new RegExp(f(g),"gi");g=null!=d.type&&j.test(d.type.toLowerCase())||null!=d.name&&j.test(d.name.toLowerCase())}return(null==g||g)&&(null==d.size||d.size<h&&d.size>i)},ngFileUpload.updateModel=function(a,b,c,d,e,f,g,h,i,j){function k(){if(a(e.ngfKeep)(c)===!0){var j=(d.$modelValue||[]).slice(0);if(g&&g.length)if(a(e.ngfKeepDistinct)(c)===!0){for(var k=j.length,l=0;l<g.length;l++){for(var m=0;k>m&&g[l].name!==j[m].name;m++);m===k&&j.push(g[l])}g=j}else g=j.concat(g);else g=j}d&&(a(e.ngModel).assign(c,g),b(function(){d&&d.$setViewValue(null!=g&&0===g.length?null:g)})),e.ngModelRejected&&a(e.ngModelRejected).assign(c,h),f&&a(f)(c,{$files:g,$rejectedFiles:h,$event:i})}j?k():b(function(){k()})};var c=ngFileUpload.validate,d=ngFileUpload.updateModel}(),function(){function a(a,e,f,g,h,i,j){function k(a,b,d){var e=!0,f=d.dataTransfer.items;if(null!=f)for(var g=0;g<f.length&&e;g++)e=e&&("file"===f[g].kind||""===f[g].kind)&&c(a,h,b,f[g],d);var i=h(b.ngfDragOverClass)(a,{$event:d});return i&&(i.delay&&(r=i.delay),i.accept&&(i=e?i.accept:i.reject)),i||b.ngfDragOverClass||"dragover"}function l(b,d,e,g){function k(d){c(a,h,f,d,b)?m.push(d):n.push(d)}function l(a,b,c){if(null!=b)if(b.isDirectory){var d=(c||"")+b.name;k({name:b.name,type:"directory",path:d});var e=b.createReader(),f=[];p++;var g=function(){e.readEntries(function(d){try{if(d.length)f=f.concat(Array.prototype.slice.call(d||[],0)),g();else{for(var e=0;e<f.length;e++)l(a,f[e],(c?c:"")+b.name+"/");p--}}catch(h){p--,console.error(h)}},function(){p--})};g()}else p++,b.file(function(a){try{p--,a.path=(c?c:"")+a.name,k(a)}catch(b){p--,console.error(b)}},function(){p--})}var m=[],n=[],o=b.dataTransfer.items,p=0;if(o&&o.length>0&&"file"!==j.protocol())for(var q=0;q<o.length;q++){if(o[q].webkitGetAsEntry&&o[q].webkitGetAsEntry()&&o[q].webkitGetAsEntry().isDirectory){var r=o[q].webkitGetAsEntry();if(r.isDirectory&&!e)continue;null!=r&&l(m,r)}else{var s=o[q].getAsFile();null!=s&&k(s)}if(!g&&m.length>0)break}else{var t=b.dataTransfer.files;if(null!=t)for(var u=0;u<t.length&&(k(t.item(u)),g||!(m.length>0));u++);}var v=0;!function w(a){i(function(){if(p)10*v++<2e4&&w(10);else{if(!g&&m.length>1){for(q=0;"directory"===m[q].type;)q++;m=[m[q]]}d(m,n)}},a||0)}()}var m=b();if(f.dropAvailable&&i(function(){a[f.dropAvailable]?a[f.dropAvailable].value=m:a[f.dropAvailable]=m}),!m)return void(h(f.ngfHideOnDropNotAvailable)(a)===!0&&e.css("display","none"));var n=!1;-1===f.ngfDrop.search(/\W+$files\W+/)&&a.$watch(f.ngfDrop,function(a){n=a===!1});var o,p=null,q=h(f.ngfStopPropagation),r=1;e[0].addEventListener("dragover",function(b){if(!e.attr("disabled")&&!n){if(b.preventDefault(),q(a)&&b.stopPropagation(),navigator.userAgent.indexOf("Chrome")>-1){var c=b.dataTransfer.effectAllowed;b.dataTransfer.dropEffect="move"===c||"linkMove"===c?"move":"copy"}i.cancel(p),a.actualDragOverClass||(o=k(a,f,b)),e.addClass(o)}},!1),e[0].addEventListener("dragenter",function(b){e.attr("disabled")||n||(b.preventDefault(),q(a)&&b.stopPropagation())},!1),e[0].addEventListener("dragleave",function(){e.attr("disabled")||n||(p=i(function(){e.removeClass(o),o=null},r||1))},!1),e[0].addEventListener("drop",function(b){e.attr("disabled")||n||(b.preventDefault(),q(a)&&b.stopPropagation(),e.removeClass(o),o=null,l(b,function(c,e){d(h,i,a,g,f,f.ngfChange||f.ngfDrop,c,e,b)},h(f.ngfAllowDir)(a)!==!1,f.multiple||h(f.ngfMultiple)(a)))},!1)}function b(){var a=document.createElement("div");return"draggable"in a&&"ondrop"in a}var c=ngFileUpload.validate,d=ngFileUpload.updateModel;ngFileUpload.directive("ngfDrop",["$parse","$timeout","$location",function(b,c,d){return{restrict:"AEC",require:"?ngModel",link:function(e,f,g,h){a(e,f,g,h,b,c,d)}}}]),ngFileUpload.directive("ngfNoFileDrop",function(){return function(a,c){b()&&c.css("display","none")}}),ngFileUpload.directive("ngfDropAvailable",["$parse","$timeout",function(a,c){return function(d,e,f){if(b()){var g=a(f.ngfDropAvailable);c(function(){g(d),g.assign&&g.assign(d,!0)})}}}]),ngFileUpload.directive("ngfSrc",["$parse","$timeout",function(a,b){return{restrict:"AE",link:function(d,e,f){window.FileReader&&d.$watch(f.ngfSrc,function(g){g&&c(d,a,f,g,null)&&(!window.FileAPI||-1===navigator.userAgent.indexOf("MSIE 8")||g.size<2e4)&&(!window.FileAPI||-1===navigator.userAgent.indexOf("MSIE 9")||g.size<4e6)?b(function(){var a=window.URL||window.webkitURL;if(a&&a.createObjectURL)e.attr("src",a.createObjectURL(g));else{var c=new FileReader;c.readAsDataURL(g),c.onload=function(a){b(function(){e.attr("src",a.target.result)})}}}):e.attr("src",f.ngfDefaultSrc||"")})}}}])}(),function(root,factory){"use strict";"function"==typeof define&&define.amd?define(factory):"object"==typeof exports?module.exports=factory():root.returnExports=factory()}(this,function(){function isPrimitive(input){var type=typeof input;return null===input||"undefined"===type||"boolean"===type||"number"===type||"string"===type}var isCallable,ArrayPrototype=Array.prototype,ObjectPrototype=Object.prototype,FunctionPrototype=Function.prototype,StringPrototype=String.prototype,NumberPrototype=Number.prototype,array_slice=ArrayPrototype.slice,array_splice=ArrayPrototype.splice,array_push=ArrayPrototype.push,array_unshift=ArrayPrototype.unshift,call=FunctionPrototype.call,to_string=ObjectPrototype.toString,isArray=Array.isArray||function(obj){return"[object Array]"===to_string.call(obj)},hasToStringTag="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,fnToStr=Function.prototype.toString,tryFunctionObject=function(value){try{return fnToStr.call(value),!0}catch(e){return!1}},fnClass="[object Function]",genClass="[object GeneratorFunction]";isCallable=function(value){if("function"!=typeof value)return!1;if(hasToStringTag)return tryFunctionObject(value);var strClass=to_string.call(value);return strClass===fnClass||strClass===genClass};var isRegex,regexExec=RegExp.prototype.exec,tryRegexExec=function(value){try{return regexExec.call(value),!0}catch(e){return!1}},regexClass="[object RegExp]";isRegex=function(value){return"object"!=typeof value?!1:hasToStringTag?tryRegexExec(value):to_string.call(value)===regexClass};var isString,strValue=String.prototype.valueOf,tryStringObject=function(value){try{return strValue.call(value),!0}catch(e){return!1}},stringClass="[object String]";isString=function(value){return"string"==typeof value?!0:"object"!=typeof value?!1:hasToStringTag?tryStringObject(value):to_string.call(value)===stringClass};var isArguments=function(value){var str=to_string.call(value),isArgs="[object Arguments]"===str;return isArgs||(isArgs=!isArray(value)&&null!==value&&"object"==typeof value&&"number"==typeof value.length&&value.length>=0&&isCallable(value.callee)),isArgs},defineProperties=function(has){var defineProperty,supportsDescriptors=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}();return defineProperty=supportsDescriptors?function(object,name,method,forceAssign){!forceAssign&&name in object||Object.defineProperty(object,name,{configurable:!0,enumerable:!1,writable:!0,value:method})}:function(object,name,method,forceAssign){!forceAssign&&name in object||(object[name]=method)},function(object,map,forceAssign){for(var name in map)has.call(map,name)&&defineProperty(object,name,map[name],forceAssign)}}(ObjectPrototype.hasOwnProperty),ES={ToInteger:function(num){var n=+num;return n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n},ToPrimitive:function(input){var val,valueOf,toStr;if(isPrimitive(input))return input;if(valueOf=input.valueOf,isCallable(valueOf)&&(val=valueOf.call(input),isPrimitive(val)))return val;if(toStr=input.toString,isCallable(toStr)&&(val=toStr.call(input),isPrimitive(val)))return val;throw new TypeError},ToObject:function(o){if(null==o)throw new TypeError("can't convert "+o+" to object");return Object(o)},ToUint32:function(x){return x>>>0}},Empty=function(){};defineProperties(FunctionPrototype,{bind:function(that){var target=this;if(!isCallable(target))throw new TypeError("Function.prototype.bind called on incompatible "+target);for(var bound,args=array_slice.call(arguments,1),binder=function(){if(this instanceof bound){var result=target.apply(this,args.concat(array_slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(array_slice.call(arguments)))},boundLength=Math.max(0,target.length-args.length),boundArgs=[],i=0;boundLength>i;i++)boundArgs.push("$"+i);return bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this, arguments); }")(binder),target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound}});var owns=call.bind(ObjectPrototype.hasOwnProperty),spliceNoopReturnsEmptyArray=function(){var a=[1,2],result=a.splice();return 2===a.length&&isArray(result)&&0===result.length}();defineProperties(ArrayPrototype,{splice:function(){return 0===arguments.length?[]:array_splice.apply(this,arguments)}},!spliceNoopReturnsEmptyArray);var spliceWorksWithEmptyObject=function(){var obj={};return ArrayPrototype.splice.call(obj,0,0,1),1===obj.length}();defineProperties(ArrayPrototype,{splice:function(start,deleteCount){if(0===arguments.length)return[];var args=arguments;return this.length=Math.max(ES.ToInteger(this.length),0),arguments.length>0&&"number"!=typeof deleteCount&&(args=array_slice.call(arguments),args.length<2?args.push(this.length-start):args[1]=ES.ToInteger(deleteCount)),array_splice.apply(this,args)}},!spliceWorksWithEmptyObject);var hasUnshiftReturnValueBug=1!==[].unshift(0);defineProperties(ArrayPrototype,{unshift:function(){return array_unshift.apply(this,arguments),this.length}},hasUnshiftReturnValueBug),defineProperties(Array,{isArray:isArray});var boxedString=Object("a"),splitString="a"!==boxedString[0]||!(0 in boxedString),properlyBoxesContext=function(method){var properlyBoxesNonStrict=!0,properlyBoxesStrict=!0;return method&&(method.call("foo",function(_,__,context){"object"!=typeof context&&(properlyBoxesNonStrict=!1)}),method.call([1],function(){"use strict";properlyBoxesStrict="string"==typeof this},"x")),!!method&&properlyBoxesNonStrict&&properlyBoxesStrict};defineProperties(ArrayPrototype,{forEach:function(fun){var object=ES.ToObject(this),self=splitString&&isString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if(!isCallable(fun))throw new TypeError;for(;++i<length;)i in self&&fun.call(thisp,self[i],i,object)}},!properlyBoxesContext(ArrayPrototype.forEach)),defineProperties(ArrayPrototype,{map:function(fun){var object=ES.ToObject(this),self=splitString&&isString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if(!isCallable(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}},!properlyBoxesContext(ArrayPrototype.map)),defineProperties(ArrayPrototype,{filter:function(fun){var value,object=ES.ToObject(this),self=splitString&&isString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if(!isCallable(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}},!properlyBoxesContext(ArrayPrototype.filter)),defineProperties(ArrayPrototype,{every:function(fun){var object=ES.ToObject(this),self=splitString&&isString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if(!isCallable(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}},!properlyBoxesContext(ArrayPrototype.every)),defineProperties(ArrayPrototype,{some:function(fun){var object=ES.ToObject(this),self=splitString&&isString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if(!isCallable(fun))throw new TypeError(fun+" is not a function");
for(var i=0;length>i;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}},!properlyBoxesContext(ArrayPrototype.some));var reduceCoercesToObject=!1;ArrayPrototype.reduce&&(reduceCoercesToObject="object"==typeof ArrayPrototype.reduce.call("es5",function(_,__,___,list){return list})),defineProperties(ArrayPrototype,{reduce:function(fun){var object=ES.ToObject(this),self=splitString&&isString(this)?this.split(""):object,length=self.length>>>0;if(!isCallable(fun))throw new TypeError(fun+" is not a function");if(!length&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}},!reduceCoercesToObject);var reduceRightCoercesToObject=!1;ArrayPrototype.reduceRight&&(reduceRightCoercesToObject="object"==typeof ArrayPrototype.reduceRight.call("es5",function(_,__,___,list){return list})),defineProperties(ArrayPrototype,{reduceRight:function(fun){var object=ES.ToObject(this),self=splitString&&isString(this)?this.split(""):object,length=self.length>>>0;if(!isCallable(fun))throw new TypeError(fun+" is not a function");if(!length&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(--i<0)throw new TypeError("reduceRight of empty array with no initial value")}if(0>i)return result;do i in self&&(result=fun.call(void 0,result,self[i],i,object));while(i--);return result}},!reduceRightCoercesToObject);var hasFirefox2IndexOfBug=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);defineProperties(ArrayPrototype,{indexOf:function(sought){var self=splitString&&isString(this)?this.split(""):ES.ToObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=ES.ToInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);length>i;i++)if(i in self&&self[i]===sought)return i;return-1}},hasFirefox2IndexOfBug);var hasFirefox2LastIndexOfBug=Array.prototype.lastIndexOf&&-1!==[0,1].lastIndexOf(0,-3);defineProperties(ArrayPrototype,{lastIndexOf:function(sought){var self=splitString&&isString(this)?this.split(""):ES.ToObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,ES.ToInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}},hasFirefox2LastIndexOfBug);var hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString"),hasProtoEnumBug=function(){}.propertyIsEnumerable("prototype"),hasStringEnumBug=!owns("x","0"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;defineProperties(Object,{keys:function(object){var isFn=isCallable(object),isArgs=isArguments(object),isObject=null!==object&&"object"==typeof object,isStr=isObject&&isString(object);if(!isObject&&!isFn&&!isArgs)throw new TypeError("Object.keys called on a non-object");var theKeys=[],skipProto=hasProtoEnumBug&&isFn;if(isStr&&hasStringEnumBug||isArgs)for(var i=0;i<object.length;++i)theKeys.push(String(i));if(!isArgs)for(var name in object)skipProto&&"prototype"===name||!owns(object,name)||theKeys.push(String(name));if(hasDontEnumBug)for(var ctor=object.constructor,skipConstructor=ctor&&ctor.prototype===object,j=0;dontEnumsLength>j;j++){var dontEnum=dontEnums[j];skipConstructor&&"constructor"===dontEnum||!owns(object,dontEnum)||theKeys.push(dontEnum)}return theKeys}});var keysWorksWithArguments=Object.keys&&function(){return 2===Object.keys(arguments).length}(1,2),originalKeys=Object.keys;defineProperties(Object,{keys:function(object){return originalKeys(isArguments(object)?ArrayPrototype.slice.call(object):object)}},!keysWorksWithArguments);var negativeDate=-621987552e5,negativeYearString="-000001",hasNegativeDateBug=Date.prototype.toISOString&&-1===new Date(negativeDate).toISOString().indexOf(negativeYearString);defineProperties(Date.prototype,{toISOString:function(){var result,length,value,year,month;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(year=this.getUTCFullYear(),month=this.getUTCMonth(),year+=Math.floor(month/12),month=(month%12+12)%12,result=[month+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],year=(0>year?"-":year>9999?"+":"")+("00000"+Math.abs(year)).slice(year>=0&&9999>=year?-4:-6),length=result.length;length--;)value=result[length],10>value&&(result[length]="0"+value);return year+"-"+result.slice(0,2).join("-")+"T"+result.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"}},hasNegativeDateBug);var dateToJSONIsSupported=function(){try{return Date.prototype.toJSON&&null===new Date(0/0).toJSON()&&-1!==new Date(negativeDate).toJSON().indexOf(negativeYearString)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(e){return!1}}();dateToJSONIsSupported||(Date.prototype.toJSON=function(){var O=Object(this),tv=ES.ToPrimitive(O);if("number"==typeof tv&&!isFinite(tv))return null;var toISO=O.toISOString;if(!isCallable(toISO))throw new TypeError("toISOString property is not callable");return toISO.call(O)});var supportsExtendedYears=1e15===Date.parse("+033658-09-27T01:46:40.000Z"),acceptsInvalidDates=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z")),doesNotParseY2KNewYear=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));(!Date.parse||doesNotParseY2KNewYear||acceptsInvalidDates||!supportsExtendedYears)&&(Date=function(NativeDate){function Date(Y,M,D,h,m,s,ms){var length=arguments.length;if(this instanceof NativeDate){var date=1===length&&String(Y)===Y?new NativeDate(Date.parse(Y)):length>=7?new NativeDate(Y,M,D,h,m,s,ms):length>=6?new NativeDate(Y,M,D,h,m,s):length>=5?new NativeDate(Y,M,D,h,m):length>=4?new NativeDate(Y,M,D,h):length>=3?new NativeDate(Y,M,D):length>=2?new NativeDate(Y,M):length>=1?new NativeDate(Y):new NativeDate;return defineProperties(date,{constructor:Date},!0),date}return NativeDate.apply(this,arguments)}function dayFromMonth(year,month){var t=month>1?1:0;return months[month]+Math.floor((year-1969+t)/4)-Math.floor((year-1901+t)/100)+Math.floor((year-1601+t)/400)+365*(year-1970)}function toUTC(t){return Number(new NativeDate(1970,0,1,0,0,0,t))}var isoDateExpression=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),months=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(var key in NativeDate)Date[key]=NativeDate[key];return Date.now=NativeDate.now,Date.UTC=NativeDate.UTC,Date.prototype=NativeDate.prototype,Date.prototype.constructor=Date,Date.parse=function(string){var match=isoDateExpression.exec(string);if(match){var result,year=Number(match[1]),month=Number(match[2]||1)-1,day=Number(match[3]||1)-1,hour=Number(match[4]||0),minute=Number(match[5]||0),second=Number(match[6]||0),millisecond=Math.floor(1e3*Number(match[7]||0)),isLocalTime=Boolean(match[4]&&!match[8]),signOffset="-"===match[9]?1:-1,hourOffset=Number(match[10]||0),minuteOffset=Number(match[11]||0);return(minute>0||second>0||millisecond>0?24:25)>hour&&60>minute&&60>second&&1e3>millisecond&&month>-1&&12>month&&24>hourOffset&&60>minuteOffset&&day>-1&&day<dayFromMonth(year,month+1)-dayFromMonth(year,month)&&(result=60*(24*(dayFromMonth(year,month)+day)+hour+hourOffset*signOffset),result=1e3*(60*(result+minute+minuteOffset*signOffset)+second)+millisecond,isLocalTime&&(result=toUTC(result)),result>=-864e13&&864e13>=result)?result:0/0}return NativeDate.parse.apply(this,arguments)},Date}(Date)),Date.now||(Date.now=function(){return(new Date).getTime()});var hasToFixedBugs=NumberPrototype.toFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==0xde0b6b3a7640080.toFixed(0)),toFixedHelpers={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function(n,c){for(var i=-1,c2=c;++i<toFixedHelpers.size;)c2+=n*toFixedHelpers.data[i],toFixedHelpers.data[i]=c2%toFixedHelpers.base,c2=Math.floor(c2/toFixedHelpers.base)},divide:function(n){for(var i=toFixedHelpers.size,c=0;--i>=0;)c+=toFixedHelpers.data[i],toFixedHelpers.data[i]=Math.floor(c/n),c=c%n*toFixedHelpers.base},numToString:function(){for(var i=toFixedHelpers.size,s="";--i>=0;)if(""!==s||0===i||0!==toFixedHelpers.data[i]){var t=String(toFixedHelpers.data[i]);""===s?s=t:s+="0000000".slice(0,7-t.length)+t}return s},pow:function pow(x,n,acc){return 0===n?acc:n%2===1?pow(x,n-1,acc*x):pow(x*x,n/2,acc)},log:function(x){for(var n=0,x2=x;x2>=4096;)n+=12,x2/=4096;for(;x2>=2;)n+=1,x2/=2;return n}};defineProperties(NumberPrototype,{toFixed:function(fractionDigits){var f,x,s,m,e,z,j,k;if(f=Number(fractionDigits),f=f!==f?0:Math.floor(f),0>f||f>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(x=Number(this),x!==x)return"NaN";if(-1e21>=x||x>=1e21)return String(x);if(s="",0>x&&(s="-",x=-x),m="0",x>1e-21)if(e=toFixedHelpers.log(x*toFixedHelpers.pow(2,69,1))-69,z=0>e?x*toFixedHelpers.pow(2,-e,1):x/toFixedHelpers.pow(2,e,1),z*=4503599627370496,e=52-e,e>0){for(toFixedHelpers.multiply(0,z),j=f;j>=7;)toFixedHelpers.multiply(1e7,0),j-=7;for(toFixedHelpers.multiply(toFixedHelpers.pow(10,j,1),0),j=e-1;j>=23;)toFixedHelpers.divide(1<<23),j-=23;toFixedHelpers.divide(1<<j),toFixedHelpers.multiply(1,1),toFixedHelpers.divide(2),m=toFixedHelpers.numToString()}else toFixedHelpers.multiply(0,z),toFixedHelpers.multiply(1<<-e,0),m=toFixedHelpers.numToString()+"0.00000000000000000000".slice(2,2+f);return f>0?(k=m.length,m=f>=k?s+"0.0000000000000000000".slice(0,f-k+2)+m:s+m.slice(0,k-f)+"."+m.slice(k-f)):m=s+m,m}},hasToFixedBugs);var string_split=StringPrototype.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var compliantExecNpcg="undefined"==typeof/()??/.exec("")[1];StringPrototype.split=function(separator,limit){var string=this;if("undefined"==typeof separator&&0===limit)return[];if(!isRegex(separator))return string_split.call(this,separator,limit);var separator2,match,lastIndex,lastLength,output=[],flags=(separator.ignoreCase?"i":"")+(separator.multiline?"m":"")+(separator.extended?"x":"")+(separator.sticky?"y":""),lastLastIndex=0,separatorCopy=new RegExp(separator.source,flags+"g");string+="",compliantExecNpcg||(separator2=new RegExp("^"+separatorCopy.source+"$(?!\\s)",flags));var splitLimit="undefined"==typeof limit?-1>>>0:ES.ToUint32(limit);for(match=separatorCopy.exec(string);match&&(lastIndex=match.index+match[0].length,!(lastIndex>lastLastIndex&&(output.push(string.slice(lastLastIndex,match.index)),!compliantExecNpcg&&match.length>1&&match[0].replace(separator2,function(){for(var i=1;i<arguments.length-2;i++)"undefined"==typeof arguments[i]&&(match[i]=void 0)}),match.length>1&&match.index<string.length&&array_push.apply(output,match.slice(1)),lastLength=match[0].length,lastLastIndex=lastIndex,output.length>=splitLimit)));)separatorCopy.lastIndex===match.index&&separatorCopy.lastIndex++,match=separatorCopy.exec(string);return lastLastIndex===string.length?(lastLength||!separatorCopy.test(""))&&output.push(""):output.push(string.slice(lastLastIndex)),output.length>splitLimit?output.slice(0,splitLimit):output}}():"0".split(void 0,0).length&&(StringPrototype.split=function(separator,limit){return"undefined"==typeof separator&&0===limit?[]:string_split.call(this,separator,limit)});var str_replace=StringPrototype.replace,replaceReportsGroupsCorrectly=function(){var groups=[];return"x".replace(/x(.)?/g,function(match,group){groups.push(group)}),1===groups.length&&"undefined"==typeof groups[0]}();replaceReportsGroupsCorrectly||(StringPrototype.replace=function(searchValue,replaceValue){var isFn=isCallable(replaceValue),hasCapturingGroups=isRegex(searchValue)&&/\)[*?]/.test(searchValue.source);if(isFn&&hasCapturingGroups){var wrappedReplaceValue=function(match){var length=arguments.length,originalLastIndex=searchValue.lastIndex;searchValue.lastIndex=0;var args=searchValue.exec(match)||[];return searchValue.lastIndex=originalLastIndex,args.push(arguments[length-2],arguments[length-1]),replaceValue.apply(this,args)};return str_replace.call(this,searchValue,wrappedReplaceValue)}return str_replace.call(this,searchValue,replaceValue)});var string_substr=StringPrototype.substr,hasNegativeSubstrBug="".substr&&"b"!=="0b".substr(-1);defineProperties(StringPrototype,{substr:function(start,length){var normalizedStart=start;return 0>start&&(normalizedStart=Math.max(this.length+start,0)),string_substr.call(this,normalizedStart,length)}},hasNegativeSubstrBug);var ws="	\n\f\r   ᠎             　\u2028\u2029﻿",zeroWidth="​",wsRegexChars="["+ws+"]",trimBeginRegexp=new RegExp("^"+wsRegexChars+wsRegexChars+"*"),trimEndRegexp=new RegExp(wsRegexChars+wsRegexChars+"*$"),hasTrimWhitespaceBug=StringPrototype.trim&&(ws.trim()||!zeroWidth.trim());defineProperties(StringPrototype,{trim:function(){if("undefined"==typeof this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}},hasTrimWhitespaceBug),(8!==parseInt(ws+"08")||22!==parseInt(ws+"0x16"))&&(parseInt=function(origParseInt){var hexRegex=/^0[xX]/;return function(str,radix){var string=String(str).trim(),defaultedRadix=Number(radix)||(hexRegex.test(string)?16:10);return origParseInt(string,defaultedRadix)}}(parseInt))}),function(window,angular){"use strict";function $SanitizeProvider(){this.$get=["$$sanitizeUri",function($$sanitizeUri){return function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}]}function sanitizeText(chars){var buf=[],writer=htmlSanitizeWriter(buf,angular.noop);return writer.chars(chars),buf.join("")}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function htmlParser(html,handler){function parseStartTag(tag,tagName,rest,unary){if(tagName=angular.lowercase(tagName),blockElements[tagName])for(;stack.last()&&inlineElements[stack.last()];)parseEndTag("",stack.last());optionalEndTagElements[tagName]&&stack.last()==tagName&&parseEndTag("",tagName),unary=voidElements[tagName]||!!unary,unary||stack.push(tagName);var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQuotedValue,unquotedValue){var value=doubleQuotedValue||singleQuotedValue||unquotedValue||"";attrs[name]=decodeEntities(value)}),handler.start&&handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var i,pos=0;if(tagName=angular.lowercase(tagName))for(pos=stack.length-1;pos>=0&&stack[pos]!=tagName;pos--);if(pos>=0){for(i=stack.length-1;i>=pos;i--)handler.end&&handler.end(stack[i]);stack.length=pos}}"string"!=typeof html&&(html=null===html||"undefined"==typeof html?"":""+html);var index,chars,match,text,stack=[],last=html;for(stack.last=function(){return stack[stack.length-1]};html;){if(text="",chars=!0,stack.last()&&specialElements[stack.last()]?(html=html.replace(new RegExp("([\\W\\w]*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){return text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1"),handler.chars&&handler.chars(decodeEntities(text)),""}),parseEndTag("",stack.last())):(0===html.indexOf("<!--")?(index=html.indexOf("--",4),index>=0&&html.lastIndexOf("-->",index)===index&&(handler.comment&&handler.comment(html.substring(4,index)),html=html.substring(index+3),chars=!1)):DOCTYPE_REGEXP.test(html)?(match=html.match(DOCTYPE_REGEXP),match&&(html=html.replace(match[0],""),chars=!1)):BEGING_END_TAGE_REGEXP.test(html)?(match=html.match(END_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(END_TAG_REGEXP,parseEndTag),chars=!1)):BEGIN_TAG_REGEXP.test(html)&&(match=html.match(START_TAG_REGEXP),match?(match[4]&&(html=html.substring(match[0].length),match[0].replace(START_TAG_REGEXP,parseStartTag)),chars=!1):(text+="<",html=html.substring(1))),chars&&(index=html.indexOf("<"),text+=0>index?html:html.substring(0,index),html=0>index?"":html.substring(index),handler.chars&&handler.chars(decodeEntities(text)))),html==last)throw $sanitizeMinErr("badparse","The sanitizer was unable to parse the following block of html: {0}",html);last=html}parseEndTag()}function decodeEntities(value){return value?(hiddenPre.innerHTML=value.replace(/</g,"&lt;"),hiddenPre.textContent):""}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){var hi=value.charCodeAt(0),low=value.charCodeAt(1);return"&#"+(1024*(hi-55296)+(low-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf,uriValidator){var ignore=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag),!ignore&&specialElements[tag]&&(ignore=tag),ignore||validElements[tag]!==!0||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;validAttrs[lkey]!==!0||uriAttrs[lkey]===!0&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(unary?"/>":">"))},end:function(tag){tag=angular.lowercase(tag),ignore||validElements[tag]!==!0||(out("</"),out(tag),out(">")),tag==ignore&&(ignore=!1)},chars:function(chars){ignore||out(encodeEntities(chars))}}}var $sanitizeMinErr=angular.$$minErr("$sanitize"),START_TAG_REGEXP=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,END_TAG_REGEXP=/^<\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\//,COMMENT_REGEXP=/<!--(.*?)-->/g,DOCTYPE_REGEXP=/<!DOCTYPE([^>]*?)>/i,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g,voidElements=makeMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),svgElements=makeMap("animate,animateColor,animateMotion,animateTransform,circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,set,stop,svg,switch,text,title,tspan,use"),specialElements=makeMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements,svgElements),uriAttrs=makeMap("background,cite,href,longdesc,src,usemap,xlink:href"),htmlAttrs=makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width"),svgAttrs=makeMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,attributeName,attributeType,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan"),validAttrs=angular.extend({},uriAttrs,svgAttrs,htmlAttrs),hiddenPre=document.createElement("pre");angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"”’]/,MAILTO_REGEXP=/^mailto:/;return function(text,target){function addText(text){text&&html.push(sanitizeText(text))}function addLink(url,text){html.push("<a "),angular.isDefined(target)&&html.push('target="',target,'" '),html.push('href="',url.replace(/"/g,"&quot;"),'">'),addText(text),html.push("</a>")}if(!text)return text;for(var match,url,i,raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]||match[4]||(url=(match[3]?"http://":"mailto:")+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""))}}])}(window,window.angular),function(window){angular.module("ngCsv.config",[]).value("ngCsv.config",{debug:!0}).config(["$compileProvider",function($compileProvider){angular.isDefined($compileProvider.urlSanitizationWhitelist)?$compileProvider.urlSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/):$compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/)}]),angular.module("ngCsv.directives",["ngCsv.services"]),angular.module("ngCsv.services",[]),angular.module("ngCsv",["ngCsv.config","ngCsv.services","ngCsv.directives","ngSanitize"]),angular.module("ngCsv.services").service("CSV",["$q",function($q){var EOL=encodeURIComponent("\r\n"),DATA_URI_PREFIX="data:text/csv;charset=utf-8,";this.stringifyField=function(data,delimier,quoteText){return"string"==typeof data?(data=data.replace(/"/g,'""'),(quoteText||data.indexOf(",")>-1||data.indexOf("\n")>-1||data.indexOf("\r")>-1)&&(data=delimier+data+delimier),encodeURIComponent(data)):"boolean"==typeof data?data?"TRUE":"FALSE":data},this.stringify=function(data,options){var csv,def=$q.defer(),that=this,csvContent="",dataPromise=$q.when(data).then(function(responseData){if(responseData=angular.copy(responseData),angular.isDefined(options.header)&&options.header){var encodingArray,headerString;encodingArray=[],angular.forEach(options.header,function(title){this.push(that.stringifyField(title,options.txtDelim,options.quoteStrings))},encodingArray),headerString=encodingArray.join(options.fieldSep?options.fieldSep:","),csvContent+=headerString+EOL}var arrData;arrData=angular.isArray(responseData)?responseData:responseData(),angular.forEach(arrData,function(row,index){var dataString,infoArray;infoArray=[],angular.forEach(row,function(field){this.push(that.stringifyField(field,options.txtDelim,options.quoteStrings))},infoArray),dataString=infoArray.join(options.fieldSep?options.fieldSep:","),csvContent+=index<arrData.length?dataString+EOL:dataString}),csv=window.navigator.msSaveOrOpenBlob?csvContent:DATA_URI_PREFIX+csvContent,def.resolve(csv)});return"function"==typeof dataPromise.catch&&dataPromise.catch(function(err){def.reject(err)}),def.promise}}]),angular.module("ngCsv.directives").directive("ngCsv",["$parse","$q","CSV","$document","$timeout",function($parse,$q,CSV,$document,$timeout){return{restrict:"AC",scope:{data:"&ngCsv",filename:"@filename",header:"&csvHeader",txtDelim:"@textDelimiter",quoteStrings:"@quoteStrings",fieldSep:"@fieldSeparator",lazyLoad:"@lazyLoad",ngClick:"&"},controller:["$scope","$element","$attrs","$transclude",function($scope,$element,$attrs){function getBuildCsvOptions(){var options={txtDelim:$scope.txtDelim?$scope.txtDelim:'"',quoteStrings:$scope.quoteStrings};return angular.isDefined($attrs.csvHeader)&&(options.header=$scope.$eval($scope.header)),options.fieldSep=$scope.fieldSep?$scope.fieldSep:",",options}$scope.csv="",angular.isDefined($scope.lazyLoad)&&"true"==$scope.lazyLoad||angular.isArray($scope.data)&&$scope.$watch("data",function(){$scope.buildCSV()},!0),$scope.getFilename=function(){return $scope.filename||"download.csv"},$scope.buildCSV=function(){var deferred=$q.defer();return CSV.stringify($scope.data(),getBuildCsvOptions()).then(function(csv){$scope.csv=csv,deferred.resolve(csv)}),$scope.$apply(),deferred.promise}}],link:function(scope,element){function doClick(){if(window.navigator.msSaveOrOpenBlob){var blob=new Blob([scope.csv],{type:"text/csv;charset=utf-8;"});navigator.msSaveBlob(blob,scope.getFilename())}else{var downloadLink=angular.element("<a></a>");downloadLink.attr("href",scope.csv),downloadLink.attr("download",scope.getFilename()),$document.find("body").append(downloadLink),$timeout(function(){downloadLink[0].click(),downloadLink.remove()},null)}}element.bind("click",function(){scope.buildCSV().then(function(){doClick()}),scope.$apply()})}}}])}(window,document),angular.module("xeditable",[]).value("editableOptions",{theme:"default",buttons:"right",blurElem:"cancel",blurForm:"ignore",activate:"focus"}),angular.module("xeditable").directive("editableBsdate",["editableDirectiveFactory",function(editableDirectiveFactory){return editableDirectiveFactory({directiveName:"editableBsdate",inputTpl:'<input type="text">'})}]),angular.module("xeditable").directive("editableBstime",["editableDirectiveFactory",function(editableDirectiveFactory){return editableDirectiveFactory({directiveName:"editableBstime",inputTpl:"<timepicker></timepicker>",render:function(){this.parent.render.call(this);var div=angular.element('<div class="well well-small" style="display:inline-block;"></div>');div.attr("ng-model",this.inputEl.attr("ng-model")),this.inputEl.removeAttr("ng-model"),this.attrs.eNgChange&&(div.attr("ng-change",this.inputEl.attr("ng-change")),this.inputEl.removeAttr("ng-change")),this.inputEl.wrap(div)}})}]),angular.module("xeditable").directive("editableCheckbox",["editableDirectiveFactory",function(editableDirectiveFactory){return editableDirectiveFactory({directiveName:"editableCheckbox",inputTpl:'<input type="checkbox">',render:function(){this.parent.render.call(this),this.attrs.eTitle&&(this.inputEl.wrap("<label></label>"),this.inputEl.after(angular.element("<span></span>").text(this.attrs.eTitle)))},autosubmit:function(){var self=this;self.inputEl.bind("change",function(){setTimeout(function(){self.scope.$apply(function(){self.scope.$form.$submit()})},500)})}})}]),angular.module("xeditable").directive("editableChecklist",["editableDirectiveFactory","editableNgOptionsParser",function(editableDirectiveFactory,editableNgOptionsParser){return editableDirectiveFactory({directiveName:"editableChecklist",inputTpl:"<span></span>",useCopy:!0,render:function(){this.parent.render.call(this);var parsed=editableNgOptionsParser(this.attrs.eNgOptions),html='<label ng-repeat="'+parsed.ngRepeat+'"><input type="checkbox" checklist-model="$parent.$data" checklist-value="'+parsed.locals.valueFn+'"><span ng-bind="'+parsed.locals.displayFn+'"></span></label>';this.inputEl.removeAttr("ng-model"),this.inputEl.removeAttr("ng-options"),this.inputEl.html(html)}})}]),function(){var types="text|email|tel|number|url|search|color|date|datetime|time|month|week".split("|");angular.forEach(types,function(type){var directiveName="editable"+type.charAt(0).toUpperCase()+type.slice(1);angular.module("xeditable").directive(directiveName,["editableDirectiveFactory",function(editableDirectiveFactory){return editableDirectiveFactory({directiveName:directiveName,inputTpl:'<input type="'+type+'">'})}])}),angular.module("xeditable").directive("editableRange",["editableDirectiveFactory",function(editableDirectiveFactory){return editableDirectiveFactory({directiveName:"editableRange",inputTpl:'<input type="range" id="range" name="range">',render:function(){this.parent.render.call(this),this.inputEl.after("<output>{{$data}}</output>")}})}])}(),angular.module("xeditable").directive("editableRadiolist",["editableDirectiveFactory","editableNgOptionsParser",function(editableDirectiveFactory,editableNgOptionsParser){return editableDirectiveFactory({directiveName:"editableRadiolist",inputTpl:"<span></span>",render:function(){this.parent.render.call(this);var parsed=editableNgOptionsParser(this.attrs.eNgOptions),html='<label ng-repeat="'+parsed.ngRepeat+'"><input type="radio" ng-model="$parent.$data" value="{{'+parsed.locals.valueFn+'}}"><span ng-bind="'+parsed.locals.displayFn+'"></span></label>';this.inputEl.removeAttr("ng-model"),this.inputEl.removeAttr("ng-options"),this.inputEl.html(html)},autosubmit:function(){var self=this;self.inputEl.bind("change",function(){setTimeout(function(){self.scope.$apply(function(){self.scope.$form.$submit()})},500)})}})}]),angular.module("xeditable").directive("editableSelect",["editableDirectiveFactory",function(editableDirectiveFactory){return editableDirectiveFactory({directiveName:"editableSelect",inputTpl:"<select></select>",autosubmit:function(){var self=this;self.inputEl.bind("change",function(){self.scope.$apply(function(){self.scope.$form.$submit()})})}})}]),angular.module("xeditable").directive("editableTextarea",["editableDirectiveFactory",function(editableDirectiveFactory){return editableDirectiveFactory({directiveName:"editableTextarea",inputTpl:"<textarea></textarea>",addListeners:function(){var self=this;self.parent.addListeners.call(self),self.single&&"no"!==self.buttons&&self.autosubmit()},autosubmit:function(){var self=this;self.inputEl.bind("keydown",function(e){(e.ctrlKey||e.metaKey)&&13===e.keyCode&&self.scope.$apply(function(){self.scope.$form.$submit()})})}})}]),angular.module("xeditable").factory("editableController",["$q","editableUtils",function($q,editableUtils){function EditableController($scope,$attrs,$element,$parse,editableThemes,editableOptions,$rootScope,$compile,$q){var valueGetter,inWaiting,self=this;self.scope=$scope,self.elem=$element,self.attrs=$attrs,self.inputEl=null,self.editorEl=null,self.single=!0,self.error="",self.theme=editableThemes[editableOptions.theme]||editableThemes["default"],self.parent={},self.inputTpl="",self.directiveName="",self.useCopy=!1,self.single=null,self.buttons="right",self.init=function(single){if(self.single=single,self.name=$attrs.eName||$attrs[self.directiveName],!$attrs[self.directiveName])throw"You should provide value for `"+self.directiveName+"` in editable element!";valueGetter=$parse($attrs[self.directiveName]),self.buttons=self.single?self.attrs.buttons||editableOptions.buttons:"no",$attrs.eName&&self.scope.$watch("$data",function(newVal){self.scope.$form.$data[$attrs.eName]=newVal}),$attrs.onshow&&(self.onshow=function(){return self.catchError($parse($attrs.onshow)($scope))}),$attrs.onhide&&(self.onhide=function(){return $parse($attrs.onhide)($scope)
}),$attrs.oncancel&&(self.oncancel=function(){return $parse($attrs.oncancel)($scope)}),$attrs.onbeforesave&&(self.onbeforesave=function(){return self.catchError($parse($attrs.onbeforesave)($scope))}),$attrs.onaftersave&&(self.onaftersave=function(){return self.catchError($parse($attrs.onaftersave)($scope))}),$scope.$parent.$watch($attrs[self.directiveName],function(){self.handleEmpty()})},self.render=function(){var theme=self.theme;self.inputEl=angular.element(self.inputTpl),self.controlsEl=angular.element(theme.controlsTpl),self.controlsEl.append(self.inputEl),"no"!==self.buttons&&(self.buttonsEl=angular.element(theme.buttonsTpl),self.submitEl=angular.element(theme.submitTpl),self.cancelEl=angular.element(theme.cancelTpl),self.buttonsEl.append(self.submitEl).append(self.cancelEl),self.controlsEl.append(self.buttonsEl),self.inputEl.addClass("editable-has-buttons")),self.errorEl=angular.element(theme.errorTpl),self.controlsEl.append(self.errorEl),self.editorEl=angular.element(self.single?theme.formTpl:theme.noformTpl),self.editorEl.append(self.controlsEl);for(var k in $attrs.$attr)if(!(k.length<=1)){var transferAttr=!1,nextLetter=k.substring(1,2);if("e"===k.substring(0,1)&&nextLetter===nextLetter.toUpperCase()&&(transferAttr=k.substring(1),"Form"!==transferAttr&&"NgSubmit"!==transferAttr)){transferAttr=transferAttr.substring(0,1).toLowerCase()+editableUtils.camelToDash(transferAttr.substring(1));var attrValue=""===$attrs[k]?transferAttr:$attrs[k];self.inputEl.attr(transferAttr,attrValue)}}self.inputEl.addClass("editable-input"),self.inputEl.attr("ng-model","$data"),self.editorEl.addClass(editableUtils.camelToDash(self.directiveName)),self.single&&(self.editorEl.attr("editable-form","$form"),self.editorEl.attr("blur",self.attrs.blur||("no"===self.buttons?"cancel":editableOptions.blurElem))),angular.isFunction(theme.postrender)&&theme.postrender.call(self)},self.setLocalValue=function(){self.scope.$data=self.useCopy?angular.copy(valueGetter($scope.$parent)):valueGetter($scope.$parent)},self.show=function(){return self.setLocalValue(),self.render(),$element.after(self.editorEl),$compile(self.editorEl)($scope),self.addListeners(),$element.addClass("editable-hide"),self.onshow()},self.hide=function(){return self.editorEl.remove(),$element.removeClass("editable-hide"),self.onhide()},self.cancel=function(){self.oncancel()},self.addListeners=function(){self.inputEl.bind("keyup",function(e){if(self.single)switch(e.keyCode){case 27:self.scope.$apply(function(){self.scope.$form.$cancel()})}}),self.single&&"no"===self.buttons&&self.autosubmit(),self.editorEl.bind("click",function(e){1===e.which&&self.scope.$form.$visible&&(self.scope.$form._clicked=!0)})},self.setWaiting=function(value){value?(inWaiting=!self.inputEl.attr("disabled")&&!self.inputEl.attr("ng-disabled")&&!self.inputEl.attr("ng-enabled"),inWaiting&&(self.inputEl.attr("disabled","disabled"),self.buttonsEl&&self.buttonsEl.find("button").attr("disabled","disabled"))):inWaiting&&(self.inputEl.removeAttr("disabled"),self.buttonsEl&&self.buttonsEl.find("button").removeAttr("disabled"))},self.activate=function(){setTimeout(function(){var el=self.inputEl[0];"focus"===editableOptions.activate&&el.focus&&el.focus(),"select"===editableOptions.activate&&el.select&&el.select()},0)},self.setError=function(msg){angular.isObject(msg)||($scope.$error=msg,self.error=msg)},self.catchError=function(result,noPromise){return angular.isObject(result)&&noPromise!==!0?$q.when(result).then(angular.bind(this,function(r){this.catchError(r,!0)}),angular.bind(this,function(r){this.catchError(r,!0)})):noPromise&&angular.isObject(result)&&result.status&&200!==result.status&&result.data&&angular.isString(result.data)?(this.setError(result.data),result=result.data):angular.isString(result)&&this.setError(result),result},self.save=function(){valueGetter.assign($scope.$parent,angular.copy(self.scope.$data))},self.handleEmpty=function(){var val=valueGetter($scope.$parent),isEmpty=null===val||void 0===val||""===val||angular.isArray(val)&&0===val.length;$element.toggleClass("editable-empty",isEmpty)},self.autosubmit=angular.noop,self.onshow=angular.noop,self.onhide=angular.noop,self.oncancel=angular.noop,self.onbeforesave=angular.noop,self.onaftersave=angular.noop}return EditableController.$inject=["$scope","$attrs","$element","$parse","editableThemes","editableOptions","$rootScope","$compile","$q"],EditableController}]),angular.module("xeditable").factory("editableDirectiveFactory",["$parse","$compile","editableThemes","$rootScope","$document","editableController","editableFormController",function($parse,$compile,editableThemes,$rootScope,$document,editableController,editableFormController){return function(overwrites){return{restrict:"A",scope:!0,require:[overwrites.directiveName,"?^form"],controller:editableController,link:function(scope,elem,attrs,ctrl){var eFormCtrl,eCtrl=ctrl[0],hasForm=!1;if(ctrl[1])eFormCtrl=ctrl[1],hasForm=!0;else if(attrs.eForm){var getter=$parse(attrs.eForm)(scope);if(getter)eFormCtrl=getter,hasForm=!0;else for(var i=0;i<$document[0].forms.length;i++)if($document[0].forms[i].name===attrs.eForm){eFormCtrl=null,hasForm=!0;break}}if(angular.forEach(overwrites,function(v,k){void 0!==eCtrl[k]&&(eCtrl.parent[k]=eCtrl[k])}),angular.extend(eCtrl,overwrites),eCtrl.init(!hasForm),scope.$editable=eCtrl,elem.addClass("editable"),hasForm)if(eFormCtrl){if(scope.$form=eFormCtrl,!scope.$form.$addEditable)throw"Form with editable elements should have `editable-form` attribute.";scope.$form.$addEditable(eCtrl)}else $rootScope.$$editableBuffer=$rootScope.$$editableBuffer||{},$rootScope.$$editableBuffer[attrs.eForm]=$rootScope.$$editableBuffer[attrs.eForm]||[],$rootScope.$$editableBuffer[attrs.eForm].push(eCtrl),scope.$form=null;else scope.$form=editableFormController(),scope.$form.$addEditable(eCtrl),attrs.eForm&&(scope.$parent[attrs.eForm]=scope.$form),attrs.eForm||(elem.addClass("editable-click"),elem.bind("click",function(e){e.preventDefault(),e.editable=eCtrl,scope.$apply(function(){scope.$form.$show()})}))}}}}]),angular.module("xeditable").factory("editableFormController",["$parse","$document","$rootScope","editablePromiseCollection","editableUtils",function($parse,$document,$rootScope,editablePromiseCollection,editableUtils){var shown=[];$document.bind("click",function(e){if(1===e.which){for(var toCancel=[],toSubmit=[],i=0;i<shown.length;i++)shown[i]._clicked?shown[i]._clicked=!1:shown[i].$waiting||("cancel"===shown[i]._blur&&toCancel.push(shown[i]),"submit"===shown[i]._blur&&toSubmit.push(shown[i]));(toCancel.length||toSubmit.length)&&$rootScope.$apply(function(){angular.forEach(toCancel,function(v){v.$cancel()}),angular.forEach(toSubmit,function(v){v.$submit()})})}});var base={$addEditable:function(editable){this.$editables.push(editable),editable.elem.bind("$destroy",angular.bind(this,this.$removeEditable,editable)),editable.scope.$form||(editable.scope.$form=this),this.$visible&&editable.catchError(editable.show())},$removeEditable:function(editable){for(var i=0;i<this.$editables.length;i++)if(this.$editables[i]===editable)return void this.$editables.splice(i,1)},$show:function(){if(!this.$visible){this.$visible=!0;var pc=editablePromiseCollection();pc.when(this.$onshow()),this.$setError(null,""),angular.forEach(this.$editables,function(editable){pc.when(editable.show())}),pc.then({onWait:angular.bind(this,this.$setWaiting),onTrue:angular.bind(this,this.$activate),onFalse:angular.bind(this,this.$activate),onString:angular.bind(this,this.$activate)}),setTimeout(angular.bind(this,function(){this._clicked=!1,-1===editableUtils.indexOf(shown,this)&&shown.push(this)}),0)}},$activate:function(name){var i;if(this.$editables.length){if(angular.isString(name))for(i=0;i<this.$editables.length;i++)if(this.$editables[i].name===name)return void this.$editables[i].activate();for(i=0;i<this.$editables.length;i++)if(this.$editables[i].error)return void this.$editables[i].activate();this.$editables[0].activate()}},$hide:function(){this.$visible&&(this.$visible=!1,this.$onhide(),angular.forEach(this.$editables,function(editable){editable.hide()}),editableUtils.arrayRemove(shown,this))},$cancel:function(){this.$visible&&(this.$oncancel(),angular.forEach(this.$editables,function(editable){editable.cancel()}),this.$hide())},$setWaiting:function(value){this.$waiting=!!value,angular.forEach(this.$editables,function(editable){editable.setWaiting(!!value)})},$setError:function(name,msg){angular.forEach(this.$editables,function(editable){name&&editable.name!==name||editable.setError(msg)})},$submit:function(){function checkSelf(childrenTrue){var pc=editablePromiseCollection();pc.when(this.$onbeforesave()),pc.then({onWait:angular.bind(this,this.$setWaiting),onTrue:childrenTrue?angular.bind(this,this.$save):angular.bind(this,this.$hide),onFalse:angular.bind(this,this.$hide),onString:angular.bind(this,this.$activate)})}if(!this.$waiting){this.$setError(null,"");var pc=editablePromiseCollection();angular.forEach(this.$editables,function(editable){pc.when(editable.onbeforesave())}),pc.then({onWait:angular.bind(this,this.$setWaiting),onTrue:angular.bind(this,checkSelf,!0),onFalse:angular.bind(this,checkSelf,!1),onString:angular.bind(this,this.$activate)})}},$save:function(){angular.forEach(this.$editables,function(editable){editable.save()});var pc=editablePromiseCollection();pc.when(this.$onaftersave()),angular.forEach(this.$editables,function(editable){pc.when(editable.onaftersave())}),pc.then({onWait:angular.bind(this,this.$setWaiting),onTrue:angular.bind(this,this.$hide),onFalse:angular.bind(this,this.$hide),onString:angular.bind(this,this.$activate)})},$onshow:angular.noop,$oncancel:angular.noop,$onhide:angular.noop,$onbeforesave:angular.noop,$onaftersave:angular.noop};return function(){return angular.extend({$editables:[],$visible:!1,$waiting:!1,$data:{},_clicked:!1,_blur:null},base)}}]),angular.module("xeditable").directive("editableForm",["$rootScope","$parse","editableFormController","editableOptions",function($rootScope,$parse,editableFormController,editableOptions){return{restrict:"A",require:["form"],compile:function(){return{pre:function(scope,elem,attrs,ctrl){var eForm,form=ctrl[0];attrs.editableForm?scope[attrs.editableForm]&&scope[attrs.editableForm].$show?(eForm=scope[attrs.editableForm],angular.extend(form,eForm)):(eForm=editableFormController(),scope[attrs.editableForm]=eForm,angular.extend(eForm,form)):(eForm=editableFormController(),angular.extend(form,eForm));var buf=$rootScope.$$editableBuffer,name=form.$name;name&&buf&&buf[name]&&(angular.forEach(buf[name],function(editable){eForm.$addEditable(editable)}),delete buf[name])},post:function(scope,elem,attrs,ctrl){var eForm;eForm=attrs.editableForm&&scope[attrs.editableForm]&&scope[attrs.editableForm].$show?scope[attrs.editableForm]:ctrl[0],attrs.onshow&&(eForm.$onshow=angular.bind(eForm,$parse(attrs.onshow),scope)),attrs.onhide&&(eForm.$onhide=angular.bind(eForm,$parse(attrs.onhide),scope)),attrs.oncancel&&(eForm.$oncancel=angular.bind(eForm,$parse(attrs.oncancel),scope)),attrs.shown&&$parse(attrs.shown)(scope)&&eForm.$show(),eForm._blur=attrs.blur||editableOptions.blurForm,attrs.ngSubmit||attrs.submit||(attrs.onbeforesave&&(eForm.$onbeforesave=function(){return $parse(attrs.onbeforesave)(scope,{$data:eForm.$data})}),attrs.onaftersave&&(eForm.$onaftersave=function(){return $parse(attrs.onaftersave)(scope,{$data:eForm.$data})}),elem.bind("submit",function(event){event.preventDefault(),scope.$apply(function(){eForm.$submit()})})),elem.bind("click",function(e){1===e.which&&eForm.$visible&&(eForm._clicked=!0)})}}}}}]),angular.module("xeditable").factory("editablePromiseCollection",["$q",function($q){function promiseCollection(){return{promises:[],hasFalse:!1,hasString:!1,when:function(result,noPromise){if(result===!1)this.hasFalse=!0;else if(!noPromise&&angular.isObject(result))this.promises.push($q.when(result));else{if(!angular.isString(result))return;this.hasString=!0}},then:function(callbacks){function applyCallback(){self.hasString||self.hasFalse?!self.hasString&&self.hasFalse?onFalse():onString():onTrue()}callbacks=callbacks||{};var onTrue=callbacks.onTrue||angular.noop,onFalse=callbacks.onFalse||angular.noop,onString=callbacks.onString||angular.noop,onWait=callbacks.onWait||angular.noop,self=this;this.promises.length?(onWait(!0),$q.all(this.promises).then(function(results){onWait(!1),angular.forEach(results,function(result){self.when(result,!0)}),applyCallback()},function(){onWait(!1),onString()})):applyCallback()}}}return promiseCollection}]),angular.module("xeditable").factory("editableUtils",[function(){return{indexOf:function(array,obj){if(array.indexOf)return array.indexOf(obj);for(var i=0;i<array.length;i++)if(obj===array[i])return i;return-1},arrayRemove:function(array,value){var index=this.indexOf(array,value);return index>=0&&array.splice(index,1),value},camelToDash:function(str){var SNAKE_CASE_REGEXP=/[A-Z]/g;return str.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?"-":"")+letter.toLowerCase()})},dashToCamel:function(str){var SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/;return str.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}}}]),angular.module("xeditable").factory("editableNgOptionsParser",[function(){function parser(optionsExp){var match;if(!(match=optionsExp.match(NG_OPTIONS_REGEXP)))throw"ng-options parse error";var ngRepeat,displayFn=match[2]||match[1],valueName=match[4]||match[6],keyName=match[5],valueFn=(match[3]||"",match[2]?match[1]:valueName),valuesFn=match[7],track=match[8],trackFn=track?match[8]:null;return void 0===keyName?(ngRepeat=valueName+" in "+valuesFn,void 0!==track&&(ngRepeat+=" track by "+trackFn)):ngRepeat="("+keyName+", "+valueName+") in "+valuesFn,{ngRepeat:ngRepeat,locals:{valueName:valueName,keyName:keyName,valueFn:valueFn,displayFn:displayFn}}}var NG_OPTIONS_REGEXP=/^\s*(.*?)(?:\s+as\s+(.*?))?(?:\s+group\s+by\s+(.*))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(.*?)(?:\s+track\s+by\s+(.*?))?$/;return parser}]),angular.module("xeditable").factory("editableThemes",function(){var themes={"default":{formTpl:'<form class="editable-wrap"></form>',noformTpl:'<span class="editable-wrap"></span>',controlsTpl:'<span class="editable-controls"></span>',inputTpl:"",errorTpl:'<div class="editable-error" ng-show="$error" ng-bind="$error"></div>',buttonsTpl:'<span class="editable-buttons"></span>',submitTpl:'<button type="submit">save</button>',cancelTpl:'<button type="button" ng-click="$form.$cancel()">cancel</button>'},bs2:{formTpl:'<form class="form-inline editable-wrap" role="form"></form>',noformTpl:'<span class="editable-wrap"></span>',controlsTpl:'<div class="editable-controls controls control-group" ng-class="{\'error\': $error}"></div>',inputTpl:"",errorTpl:'<div class="editable-error help-block" ng-show="$error" ng-bind="$error"></div>',buttonsTpl:'<span class="editable-buttons"></span>',submitTpl:'<button type="submit" class="btn btn-primary"><span class="icon-ok icon-white"></span></button>',cancelTpl:'<button type="button" class="btn" ng-click="$form.$cancel()"><span class="icon-remove"></span></button>'},bs3:{formTpl:'<form class="form-inline editable-wrap" role="form"></form>',noformTpl:'<span class="editable-wrap"></span>',controlsTpl:'<div class="editable-controls form-group" ng-class="{\'has-error\': $error}"></div>',inputTpl:"",errorTpl:'<div class="editable-error help-block" ng-show="$error" ng-bind="$error"></div>',buttonsTpl:'<span class="editable-buttons"></span>',submitTpl:'<button type="submit" class="btn btn-primary"><span class="glyphicon glyphicon-ok"></span></button>',cancelTpl:'<button type="button" class="btn btn-default" ng-click="$form.$cancel()"><span class="glyphicon glyphicon-remove"></span></button>',buttonsClass:"",inputClass:"",postrender:function(){switch(this.directiveName){case"editableText":case"editableSelect":case"editableTextarea":case"editableEmail":case"editableTel":case"editableNumber":case"editableUrl":case"editableSearch":case"editableDate":case"editableDatetime":case"editableTime":case"editableMonth":case"editableWeek":if(this.inputEl.addClass("form-control"),this.theme.inputClass){if(this.inputEl.attr("multiple")&&("input-sm"===this.theme.inputClass||"input-lg"===this.theme.inputClass))break;this.inputEl.addClass(this.theme.inputClass)}}this.buttonsEl&&this.theme.buttonsClass&&this.buttonsEl.find("button").addClass(this.theme.buttonsClass)}}};return themes}),function(window,angular,undefined){"use strict";function toArray(object){return isArray(object)?object:Object.keys(object).map(function(key){return object[key]})}function isNull(value){return null===value}function objectContains(partial,object){var keys=Object.keys(partial);return-1==keys.map(function(el){return object[el]!==undefined&&object[el]==partial[el]}).indexOf(!1)}function hasApproxPattern(word,pattern){if(""===pattern)return word;var index=word.indexOf(pattern.charAt(0));return-1===index?!1:hasApproxPattern(word.substr(index+1),pattern.substr(1))}function getFirstMatches(array,n,expression){var count=0;return array.filter(function(elm){var rest=isDefined(expression)?n>count&&expression(elm):n>count;return count=rest?count+1:count,rest})}function convertToDecimal(num,decimal,$math){return $math.round(num*$math.pow(10,decimal))/$math.pow(10,decimal)}function deepKeys(obj,stack,parent){stack=stack||[];var keys=Object.keys(obj);return keys.forEach(function(el){if(isObject(obj[el])&&!isArray(obj[el])){var p=parent?parent+"."+el:parent;deepKeys(obj[el],stack,p||el)}else{var key=parent?parent+"."+el:el;stack.push(key)}}),stack}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isGreaterThanFilter(){return function(input,check){return input>check}}function isGreaterThanOrEqualToFilter(){return function(input,check){return input>=check}}function isLessThanFilter(){return function(input,check){return check>input}}function isLessThanOrEqualToFilter(){return function(input,check){return check>=input}}function isEqualToFilter(){return function(input,check){return input==check}}function isNotEqualToFilter(){return function(input,check){return input!=check}}function isIdenticalToFilter(){return function(input,check){return input===check}}function isNotIdenticalToFilter(){return function(input,check){return input!==check}}function containsFilter($parse){return function(collection,expression){return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(expression)?!1:collection.some(function(elm){return isObject(elm)||isFunction(expression)?$parse(expression)(elm):elm===expression})}}function flatten(array,i){return i=i||0,i>=array.length?array:isArray(array[i])?flatten(array.slice(0,i).concat(array[i],array.slice(i+1)),i):flatten(array,i+1)}function uniqFilter($parse){return function(collection,property){function some(array,member){return isUndefined(member)?!1:array.some(function(el){return equals(el,member)})}if(collection=isObject(collection)?toArray(collection):collection,!isArray(collection))return collection;var uniqueItems=[],get=$parse(property);return collection.filter(isUndefined(property)?function(elm,pos,self){return self.indexOf(elm)===pos}:function(elm){var prop=get(elm);return some(uniqueItems,prop)?!1:(uniqueItems.push(prop),!0)})}}function strRepeat(str,n,sep){return n?str+sep+strRepeat(str,--n,sep):str}var isDefined=angular.isDefined,isUndefined=angular.isUndefined,isFunction=angular.isFunction,isString=angular.isString,isNumber=angular.isNumber,isObject=angular.isObject,isArray=angular.isArray,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,equals=angular.equals;String.prototype.contains||(String.prototype.contains=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),angular.module("a8m.angular",[]).filter("isUndefined",function(){return function(input){return angular.isUndefined(input)}}).filter("isDefined",function(){return function(input){return angular.isDefined(input)}}).filter("isFunction",function(){return function(input){return angular.isFunction(input)}}).filter("isString",function(){return function(input){return angular.isString(input)}}).filter("isNumber",function(){return function(input){return angular.isNumber(input)}}).filter("isArray",function(){return function(input){return angular.isArray(input)}}).filter("isObject",function(){return function(input){return angular.isObject(input)}}).filter("isEqual",function(){return function(o1,o2){return angular.equals(o1,o2)}}),angular.module("a8m.conditions",[]).filter({isGreaterThan:isGreaterThanFilter,">":isGreaterThanFilter,isGreaterThanOrEqualTo:isGreaterThanOrEqualToFilter,">=":isGreaterThanOrEqualToFilter,isLessThan:isLessThanFilter,"<":isLessThanFilter,isLessThanOrEqualTo:isLessThanOrEqualToFilter,"<=":isLessThanOrEqualToFilter,isEqualTo:isEqualToFilter,"==":isEqualToFilter,isNotEqualTo:isNotEqualToFilter,"!=":isNotEqualToFilter,isIdenticalTo:isIdenticalToFilter,"===":isIdenticalToFilter,isNotIdenticalTo:isNotIdenticalToFilter,"!==":isNotIdenticalToFilter}),angular.module("a8m.is-null",[]).filter("isNull",function(){return function(input){return isNull(input)}}),angular.module("a8m.after-where",[]).filter("afterWhere",function(){return function(collection,object){if(collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(object))return collection;var index=collection.map(function(elm){return objectContains(object,elm)}).indexOf(!0);return collection.slice(-1===index?0:index)}}),angular.module("a8m.after",[]).filter("after",function(){return function(collection,count){return collection=isObject(collection)?toArray(collection):collection,isArray(collection)?collection.slice(count):collection}}),angular.module("a8m.before-where",[]).filter("beforeWhere",function(){return function(collection,object){if(collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(object))return collection;var index=collection.map(function(elm){return objectContains(object,elm)}).indexOf(!0);return collection.slice(0,-1===index?collection.length:++index)}}),angular.module("a8m.before",[]).filter("before",function(){return function(collection,count){return collection=isObject(collection)?toArray(collection):collection,isArray(collection)?collection.slice(0,count?--count:count):collection}}),angular.module("a8m.concat",[]).filter("concat",[function(){return function(collection,joined){if(isUndefined(joined))return collection;if(isArray(collection))return collection.concat(isObject(joined)?toArray(joined):joined);if(isObject(collection)){var array=toArray(collection);return array.concat(isObject(joined)?toArray(joined):joined)}return collection}}]),angular.module("a8m.contains",[]).filter({contains:["$parse",containsFilter],some:["$parse",containsFilter]}),angular.module("a8m.count-by",[]).filter("countBy",["$parse",function($parse){return function(collection,property){var prop,result={},get=$parse(property);return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(property)?collection:(collection.forEach(function(elm){prop=get(elm),result[prop]||(result[prop]=0),result[prop]++}),result)}}]),angular.module("a8m.defaults",[]).filter("defaults",["$parse",function($parse){return function(collection,defaults){if(collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||!isObject(defaults))return collection;var keys=deepKeys(defaults);return collection.forEach(function(elm){keys.forEach(function(key){var getter=$parse(key),setter=getter.assign;isUndefined(getter(elm))&&setter(elm,getter(defaults))})}),collection}}]),angular.module("a8m.every",[]).filter("every",["$parse",function($parse){return function(collection,expression){return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(expression)?!0:collection.every(function(elm){return isObject(elm)||isFunction(expression)?$parse(expression)(elm):elm===expression})}}]),angular.module("a8m.filter-by",[]).filter("filterBy",["$parse",function($parse){return function(collection,properties,search){var comparator;return search=isString(search)||isNumber(search)?String(search).toLowerCase():undefined,collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(search)?collection:collection.filter(function(elm){return properties.some(function(prop){if(~prop.indexOf("+")){var propList=prop.replace(new RegExp("\\s","g"),"").split("+");comparator=propList.reduce(function(prev,cur,index){return 1===index?$parse(prev)(elm)+" "+$parse(cur)(elm):prev+" "+$parse(cur)(elm)})}else comparator=$parse(prop)(elm);return isString(comparator)||isNumber(comparator)?String(comparator).toLowerCase().contains(search):!1})})}}]),angular.module("a8m.first",[]).filter("first",["$parse",function($parse){return function(collection){var n,getter,args;return collection=isObject(collection)?toArray(collection):collection,isArray(collection)?(args=Array.prototype.slice.call(arguments,1),n=isNumber(args[0])?args[0]:1,getter=isNumber(args[0])?isNumber(args[1])?undefined:args[1]:args[0],args.length?getFirstMatches(collection,n,getter?$parse(getter):getter):collection[0]):collection}}]),angular.module("a8m.flatten",[]).filter("flatten",function(){return function(collection,shallow){return shallow=shallow||!1,collection=isObject(collection)?toArray(collection):collection,isArray(collection)?shallow?[].concat.apply([],collection):flatten(collection,0):collection}}),angular.module("a8m.fuzzy-by",[]).filter("fuzzyBy",["$parse",function($parse){return function(collection,property,search,csensitive){var prop,getter,sensitive=csensitive||!1;return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(property)||isUndefined(search)?collection:(getter=$parse(property),collection.filter(function(elm){return prop=getter(elm),isString(prop)?(prop=sensitive?prop:prop.toLowerCase(),search=sensitive?search:search.toLowerCase(),hasApproxPattern(prop,search)!==!1):!1}))}}]),angular.module("a8m.fuzzy",[]).filter("fuzzy",function(){return function(collection,search,csensitive){function _hasApproximateKey(object,search){var prop,flag,properties=Object.keys(object);return 0<properties.filter(function(elm){return prop=object[elm],flag?!0:isString(prop)?(prop=sensitive?prop:prop.toLowerCase(),flag=hasApproxPattern(prop,search)!==!1):!1}).length}var sensitive=csensitive||!1;return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(search)?collection:(search=sensitive?search:search.toLowerCase(),collection.filter(function(elm){return isString(elm)?(elm=sensitive?elm:elm.toLowerCase(),hasApproxPattern(elm,search)!==!1):isObject(elm)?_hasApproximateKey(elm,search):!1}))}}),angular.module("a8m.group-by",["a8m.filter-watcher"]).filter("groupBy",["$parse","filterWatcher",function($parse,filterWatcher){return function(collection,property){function _groupBy(collection,getter){var prop,result={};return forEach(collection,function(elm){prop=getter(elm),result[prop]||(result[prop]=[]),result[prop].push(elm)}),result}if(!isObject(collection)||isUndefined(property))return collection;var getterFn=$parse(property);return filterWatcher.isMemoized("groupBy",arguments)||filterWatcher.memoize("groupBy",arguments,this,_groupBy(collection,getterFn))}}]),angular.module("a8m.is-empty",[]).filter("isEmpty",function(){return function(collection){return isObject(collection)?!toArray(collection).length:!collection.length}}),angular.module("a8m.join",[]).filter("join",function(){return function(input,delimiter){return isUndefined(input)||!isArray(input)?input:(isUndefined(delimiter)&&(delimiter=" "),input.join(delimiter))}}),angular.module("a8m.last",[]).filter("last",["$parse",function($parse){return function(collection){var n,getter,args,reversed=copy(collection);return reversed=isObject(reversed)?toArray(reversed):reversed,isArray(reversed)?(args=Array.prototype.slice.call(arguments,1),n=isNumber(args[0])?args[0]:1,getter=isNumber(args[0])?isNumber(args[1])?undefined:args[1]:args[0],args.length?getFirstMatches(reversed.reverse(),n,getter?$parse(getter):getter).reverse():reversed[reversed.length-1]):reversed}}]),angular.module("a8m.map",[]).filter("map",["$parse",function($parse){return function(collection,expression){return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(expression)?collection:collection.map(function(elm){return $parse(expression)(elm)})}}]),angular.module("a8m.omit",[]).filter("omit",["$parse",function($parse){return function(collection,expression){return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(expression)?collection:collection.filter(function(elm){return!$parse(expression)(elm)})}}]),angular.module("a8m.pick",[]).filter("pick",["$parse",function($parse){return function(collection,expression){return collection=isObject(collection)?toArray(collection):collection,!isArray(collection)||isUndefined(expression)?collection:collection.filter(function(elm){return $parse(expression)(elm)})}}]),angular.module("a8m.remove-with",[]).filter("removeWith",function(){return function(collection,object){return isUndefined(object)?collection:(collection=isObject(collection)?toArray(collection):collection,collection.filter(function(elm){return!objectContains(object,elm)}))}}),angular.module("a8m.remove",[]).filter("remove",function(){return function(collection){collection=isObject(collection)?toArray(collection):collection;var args=Array.prototype.slice.call(arguments,1);return isArray(collection)?collection.filter(function(member){return!args.some(function(nest){return equals(nest,member)})}):collection}}),angular.module("a8m.reverse",[]).filter("reverse",[function(){return function(input){return input=isObject(input)?toArray(input):input,isString(input)?input.split("").reverse().join(""):isArray(input)?input.slice().reverse():input}}]),angular.module("a8m.search-field",[]).filter("searchField",["$parse",function($parse){return function(collection){var get,field;collection=isObject(collection)?toArray(collection):collection;var args=Array.prototype.slice.call(arguments,1);return isArray(collection)&&args.length?collection.map(function(member){return field=args.map(function(field){return(get=$parse(field))(member)}).join(" "),extend(member,{searchField:field})}):collection}}]),angular.module("a8m.to-array",[]).filter("toArray",function(){return function(collection,addKey){return isObject(collection)?addKey?Object.keys(collection).map(function(key){return extend(collection[key],{$key:key})}):toArray(collection):collection}}),angular.module("a8m.unique",[]).filter({unique:["$parse",uniqFilter],uniq:["$parse",uniqFilter]}),angular.module("a8m.where",[]).filter("where",function(){return function(collection,object){return isUndefined(object)?collection:(collection=isObject(collection)?toArray(collection):collection,collection.filter(function(elm){return objectContains(object,elm)}))}}),angular.module("a8m.xor",[]).filter("xor",["$parse",function($parse){return function(col1,col2,expression){function some(el,col){var getter=$parse(expression);return col.some(function(dElm){return expression?equals(getter(dElm),getter(el)):equals(dElm,el)})}return expression=expression||!1,col1=isObject(col1)?toArray(col1):col1,col2=isObject(col2)?toArray(col2):col2,isArray(col1)&&isArray(col2)?col1.concat(col2).filter(function(elm){return!(some(elm,col1)&&some(elm,col2))}):col1}}]),angular.module("a8m.math.byteFmt",["a8m.math"]).filter("byteFmt",["$math",function($math){return function(bytes,decimal){return isNumber(decimal)&&isFinite(decimal)&&decimal%1===0&&decimal>=0&&isNumber(bytes)&&isFinite(bytes)?1024>bytes?convertToDecimal(bytes,decimal,$math)+" B":1048576>bytes?convertToDecimal(bytes/1024,decimal,$math)+" KB":1073741824>bytes?convertToDecimal(bytes/1048576,decimal,$math)+" MB":convertToDecimal(bytes/1073741824,decimal,$math)+" GB":"NaN"
}}]),angular.module("a8m.math.degrees",["a8m.math"]).filter("degrees",["$math",function($math){return function(radians,decimal){if(isNumber(decimal)&&isFinite(decimal)&&decimal%1===0&&decimal>=0&&isNumber(radians)&&isFinite(radians)){var degrees=180*radians/$math.PI;return $math.round(degrees*$math.pow(10,decimal))/$math.pow(10,decimal)}return"NaN"}}]),angular.module("a8m.math.kbFmt",["a8m.math"]).filter("kbFmt",["$math",function($math){return function(bytes,decimal){return isNumber(decimal)&&isFinite(decimal)&&decimal%1===0&&decimal>=0&&isNumber(bytes)&&isFinite(bytes)?1024>bytes?convertToDecimal(bytes,decimal,$math)+" KB":1048576>bytes?convertToDecimal(bytes/1024,decimal,$math)+" MB":convertToDecimal(bytes/1048576,decimal,$math)+" GB":"NaN"}}]),angular.module("a8m.math",[]).factory("$math",["$window",function($window){return $window.Math}]),angular.module("a8m.math.max",["a8m.math"]).filter("max",["$math","$parse",function($math,$parse){function indexByMax(array,exp){var mappedArray=array.map(function(elm){return $parse(exp)(elm)});return mappedArray.indexOf($math.max.apply($math,mappedArray))}return function(input,expression){return isArray(input)?isUndefined(expression)?$math.max.apply($math,input):input[indexByMax(input,expression)]:input}}]),angular.module("a8m.math.min",["a8m.math"]).filter("min",["$math","$parse",function($math,$parse){function indexByMin(array,exp){var mappedArray=array.map(function(elm){return $parse(exp)(elm)});return mappedArray.indexOf($math.min.apply($math,mappedArray))}return function(input,expression){return isArray(input)?isUndefined(expression)?$math.min.apply($math,input):input[indexByMin(input,expression)]:input}}]),angular.module("a8m.math.percent",["a8m.math"]).filter("percent",["$math","$window",function($math,$window){return function(input,divided,round){var divider=isString(input)?$window.Number(input):input;return divided=divided||100,round=round||!1,!isNumber(divider)||$window.isNaN(divider)?input:round?$math.round(divider/divided*100):divider/divided*100}}]),angular.module("a8m.math.radians",["a8m.math"]).filter("radians",["$math",function($math){return function(degrees,decimal){if(isNumber(decimal)&&isFinite(decimal)&&decimal%1===0&&decimal>=0&&isNumber(degrees)&&isFinite(degrees)){var radians=3.14159265359*degrees/180;return $math.round(radians*$math.pow(10,decimal))/$math.pow(10,decimal)}return"NaN"}}]),angular.module("a8m.math.radix",[]).filter("radix",function(){return function(input,radix){var RANGE=/^[2-9]$|^[1-2]\d$|^3[0-6]$/;return isNumber(input)&&RANGE.test(radix)?input.toString(radix).toUpperCase():input}}),angular.module("a8m.math.shortFmt",["a8m.math"]).filter("shortFmt",["$math",function($math){return function(number,decimal){return isNumber(decimal)&&isFinite(decimal)&&decimal%1===0&&decimal>=0&&isNumber(number)&&isFinite(number)?1e3>number?number:1e6>number?convertToDecimal(number/1e3,decimal,$math)+" K":1e9>number?convertToDecimal(number/1e6,decimal,$math)+" M":convertToDecimal(number/1e9,decimal,$math)+" B":"NaN"}}]),angular.module("a8m.math.sum",[]).filter("sum",function(){return function(input,initial){return isArray(input)?input.reduce(function(prev,curr){return prev+curr},initial||0):input}}),angular.module("a8m.ends-with",[]).filter("endsWith",function(){return function(input,ends,csensitive){var position,sensitive=csensitive||!1;return!isString(input)||isUndefined(ends)?input:(input=sensitive?input:input.toLowerCase(),position=input.length-ends.length,-1!==input.indexOf(sensitive?ends:ends.toLowerCase(),position))}}),angular.module("a8m.latinize",[]).filter("latinize",[function(){function removeDiacritics(str){return str.replace(/[^\u0000-\u007E]/g,function(a){return diacriticsMap[a]||a})}for(var defaultDiacriticsRemovalap=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"OE",letters:"Œ"},{base:"oe",letters:"œ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],diacriticsMap={},i=0;i<defaultDiacriticsRemovalap.length;i++)for(var letters=defaultDiacriticsRemovalap[i].letters.split(""),j=0;j<letters.length;j++)diacriticsMap[letters[j]]=defaultDiacriticsRemovalap[i].base;return function(input){return isString(input)?removeDiacritics(input):input}}]),angular.module("a8m.ltrim",[]).filter("ltrim",function(){return function(input,chars){var trim=chars||"\\s";return isString(input)?input.replace(new RegExp("^"+trim+"+"),""):input}}),angular.module("a8m.match",[]).filter("match",function(){return function(input,pattern,flag){var reg=new RegExp(pattern,flag);return isString(input)?input.match(reg):null}}),angular.module("a8m.repeat",[]).filter("repeat",[function(){return function(input,n,separator){var times=~~n;return isString(input)&&times?strRepeat(input,--n,separator||""):input}}]),angular.module("a8m.rtrim",[]).filter("rtrim",function(){return function(input,chars){var trim=chars||"\\s";return isString(input)?input.replace(new RegExp(trim+"+$"),""):input}}),angular.module("a8m.slugify",[]).filter("slugify",[function(){return function(input,sub){var replace=isUndefined(sub)?"-":sub;return isString(input)?input.toLowerCase().replace(/\s+/g,replace):input}}]),angular.module("a8m.starts-with",[]).filter("startsWith",function(){return function(input,start,csensitive){var sensitive=csensitive||!1;return!isString(input)||isUndefined(start)?input:(input=sensitive?input:input.toLowerCase(),!input.indexOf(sensitive?start:start.toLowerCase()))}}),angular.module("a8m.stringular",[]).filter("stringular",function(){return function(input){var args=Array.prototype.slice.call(arguments,1);return input.replace(/{(\d+)}/g,function(match,number){return isUndefined(args[number])?match:args[number]})}}),angular.module("a8m.strip-tags",[]).filter("stripTags",function(){return function(input){return isString(input)?input.replace(/<\S[^><]*>/g,""):input}}),angular.module("a8m.test",[]).filter("test",function(){return function(input,pattern,flag){var reg=new RegExp(pattern,flag);return isString(input)?reg.test(input):input}}),angular.module("a8m.trim",[]).filter("trim",function(){return function(input,chars){var trim=chars||"\\s";return isString(input)?input.replace(new RegExp("^"+trim+"+|"+trim+"+$","g"),""):input}}),angular.module("a8m.truncate",[]).filter("truncate",function(){return function(input,length,suffix,preserve){return length=isUndefined(length)?input.length:length,preserve=preserve||!1,suffix=suffix||"",!isString(input)||input.length<=length?input:input.substring(0,preserve?-1===input.indexOf(" ",length)?input.length:input.indexOf(" ",length):length)+suffix}}),angular.module("a8m.ucfirst",[]).filter("ucfirst",[function(){return function(input){return isString(input)?input.split(" ").map(function(ch){return ch.charAt(0).toUpperCase()+ch.substring(1)}).join(" "):input}}]),angular.module("a8m.uri-component-encode",[]).filter("uriComponentEncode",["$window",function($window){return function(input){return isString(input)?$window.encodeURIComponent(input):input}}]),angular.module("a8m.uri-encode",[]).filter("uriEncode",["$window",function($window){return function(input){return isString(input)?$window.encodeURI(input):input}}]),angular.module("a8m.wrap",[]).filter("wrap",function(){return function(input,wrap,ends){return isString(input)&&isDefined(wrap)?[wrap,input,ends||wrap].join(""):input}}),angular.module("a8m.filter-watcher",[]).provider("filterWatcher",function(){this.$get=["$window","$rootScope",function($window,$rootScope){function getHashKey(fName,args){return[fName,angular.toJson(args)].join("#").replace(/"/g,"")}function removeCache(event){var id=event.targetScope.$id;forEach($$listeners[id],function(key){delete $$cache[key]}),delete $$listeners[id]}function cleanStateless(){$$timeout(function(){$rootScope.$$phase||($$cache={})})}function addListener(scope,hashKey){var id=scope.$id;return isUndefined($$listeners[id])&&(scope.$on("$destroy",removeCache),$$listeners[id]=[]),$$listeners[id].push(hashKey)}function $$isMemoized(filterName,args){var hashKey=getHashKey(filterName,args);return $$cache[hashKey]}function $$memoize(filterName,args,scope,result){var hashKey=getHashKey(filterName,args);return $$cache[hashKey]=result,isScope(scope)?addListener(scope,hashKey):cleanStateless(),result}var $$cache={},$$listeners={},$$timeout=$window.setTimeout;return{isMemoized:$$isMemoized,memoize:$$memoize}}]}),angular.module("angular.filter",["a8m.ucfirst","a8m.uri-encode","a8m.uri-component-encode","a8m.slugify","a8m.latinize","a8m.strip-tags","a8m.stringular","a8m.truncate","a8m.starts-with","a8m.ends-with","a8m.wrap","a8m.trim","a8m.ltrim","a8m.rtrim","a8m.repeat","a8m.test","a8m.match","a8m.to-array","a8m.concat","a8m.contains","a8m.unique","a8m.is-empty","a8m.after","a8m.after-where","a8m.before","a8m.before-where","a8m.defaults","a8m.where","a8m.reverse","a8m.remove","a8m.remove-with","a8m.group-by","a8m.count-by","a8m.search-field","a8m.fuzzy-by","a8m.fuzzy","a8m.omit","a8m.pick","a8m.every","a8m.filter-by","a8m.xor","a8m.map","a8m.first","a8m.last","a8m.flatten","a8m.join","a8m.math","a8m.math.max","a8m.math.min","a8m.math.percent","a8m.math.radix","a8m.math.sum","a8m.math.degrees","a8m.math.radians","a8m.math.byteFmt","a8m.math.kbFmt","a8m.math.shortFmt","a8m.angular","a8m.conditions","a8m.is-null","a8m.filter-watcher"])}(window,window.angular),function(mod){if("object"==typeof exports&&"object"==typeof module)module.exports=mod();else{if("function"==typeof define&&define.amd)return define([],mod);this.CodeMirror=mod()}}(function(){"use strict";function CodeMirror(place,options){if(!(this instanceof CodeMirror))return new CodeMirror(place,options);this.options=options=options?copyObj(options):{},copyObj(defaults,options,!1),setGuttersForLineNumbers(options);var doc=options.value;"string"==typeof doc&&(doc=new Doc(doc,options.mode,null,options.lineSeparator)),this.doc=doc;var input=new CodeMirror.inputStyles[options.inputStyle](this),display=this.display=new Display(place,doc,input);display.wrapper.CodeMirror=this,updateGutters(this),themeChanged(this),options.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),options.autofocus&&!mobile&&display.input.focus(),initScrollbars(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new Delayed,keySeq:null,specialChars:null};var cm=this;ie&&11>ie_version&&setTimeout(function(){cm.display.input.reset(!0)},20),registerEventHandlers(this),ensureGlobalHandlers(),startOperation(this),this.curOp.forceUpdate=!0,attachDoc(this,doc),options.autofocus&&!mobile||cm.hasFocus()?setTimeout(bind(onFocus,this),20):onBlur(this);for(var opt in optionHandlers)optionHandlers.hasOwnProperty(opt)&&optionHandlers[opt](this,options[opt],Init);maybeUpdateLineNumberWidth(this),options.finishInit&&options.finishInit(this);for(var i=0;i<initHooks.length;++i)initHooks[i](this);endOperation(this),webkit&&options.lineWrapping&&"optimizelegibility"==getComputedStyle(display.lineDiv).textRendering&&(display.lineDiv.style.textRendering="auto")}function Display(place,doc,input){var d=this;this.input=input,d.scrollbarFiller=elt("div",null,"CodeMirror-scrollbar-filler"),d.scrollbarFiller.setAttribute("cm-not-content","true"),d.gutterFiller=elt("div",null,"CodeMirror-gutter-filler"),d.gutterFiller.setAttribute("cm-not-content","true"),d.lineDiv=elt("div",null,"CodeMirror-code"),d.selectionDiv=elt("div",null,null,"position: relative; z-index: 1"),d.cursorDiv=elt("div",null,"CodeMirror-cursors"),d.measure=elt("div",null,"CodeMirror-measure"),d.lineMeasure=elt("div",null,"CodeMirror-measure"),d.lineSpace=elt("div",[d.measure,d.lineMeasure,d.selectionDiv,d.cursorDiv,d.lineDiv],null,"position: relative; outline: none"),d.mover=elt("div",[elt("div",[d.lineSpace],"CodeMirror-lines")],null,"position: relative"),d.sizer=elt("div",[d.mover],"CodeMirror-sizer"),d.sizerWidth=null,d.heightForcer=elt("div",null,null,"position: absolute; height: "+scrollerGap+"px; width: 1px;"),d.gutters=elt("div",null,"CodeMirror-gutters"),d.lineGutter=null,d.scroller=elt("div",[d.sizer,d.heightForcer,d.gutters],"CodeMirror-scroll"),d.scroller.setAttribute("tabIndex","-1"),d.wrapper=elt("div",[d.scrollbarFiller,d.gutterFiller,d.scroller],"CodeMirror"),ie&&8>ie_version&&(d.gutters.style.zIndex=-1,d.scroller.style.paddingRight=0),webkit||gecko&&mobile||(d.scroller.draggable=!0),place&&(place.appendChild?place.appendChild(d.wrapper):place(d.wrapper)),d.viewFrom=d.viewTo=doc.first,d.reportedViewFrom=d.reportedViewTo=doc.first,d.view=[],d.renderedView=null,d.externalMeasured=null,d.viewOffset=0,d.lastWrapHeight=d.lastWrapWidth=0,d.updateLineNumbers=null,d.nativeBarWidth=d.barHeight=d.barWidth=0,d.scrollbarsClipped=!1,d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null,d.alignWidgets=!1,d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null,d.maxLine=null,d.maxLineLength=0,d.maxLineChanged=!1,d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null,d.shift=!1,d.selForContextMenu=null,d.activeTouch=null,input.init(d)}function loadMode(cm){cm.doc.mode=CodeMirror.getMode(cm.options,cm.doc.modeOption),resetModeState(cm)}function resetModeState(cm){cm.doc.iter(function(line){line.stateAfter&&(line.stateAfter=null),line.styles&&(line.styles=null)}),cm.doc.frontier=cm.doc.first,startWorker(cm,100),cm.state.modeGen++,cm.curOp&&regChange(cm)}function wrappingChanged(cm){cm.options.lineWrapping?(addClass(cm.display.wrapper,"CodeMirror-wrap"),cm.display.sizer.style.minWidth="",cm.display.sizerWidth=null):(rmClass(cm.display.wrapper,"CodeMirror-wrap"),findMaxLine(cm)),estimateLineHeights(cm),regChange(cm),clearCaches(cm),setTimeout(function(){updateScrollbars(cm)},100)}function estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping,perLine=wrapping&&Math.max(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){if(lineIsHidden(cm.doc,line))return 0;var widgetsHeight=0;if(line.widgets)for(var i=0;i<line.widgets.length;i++)line.widgets[i].height&&(widgetsHeight+=line.widgets[i].height);return wrapping?widgetsHeight+(Math.ceil(line.text.length/perLine)||1)*th:widgetsHeight+th}}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter(function(line){var estHeight=est(line);estHeight!=line.height&&updateLineHeight(line,estHeight)})}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+cm.options.theme.replace(/(^|\s)\s*/g," cm-s-"),clearCaches(cm)}function guttersChanged(cm){updateGutters(cm),regChange(cm),setTimeout(function(){alignHorizontally(cm)},20)}function updateGutters(cm){var gutters=cm.display.gutters,specs=cm.options.gutters;removeChildren(gutters);for(var i=0;i<specs.length;++i){var gutterClass=specs[i],gElt=gutters.appendChild(elt("div",null,"CodeMirror-gutter "+gutterClass));"CodeMirror-linenumbers"==gutterClass&&(cm.display.lineGutter=gElt,gElt.style.width=(cm.display.lineNumWidth||1)+"px")}gutters.style.display=i?"":"none",updateGutterSpace(cm)}function updateGutterSpace(cm){var width=cm.display.gutters.offsetWidth;cm.display.sizer.style.marginLeft=width+"px"}function lineLength(line){if(0==line.height)return 0;for(var merged,len=line.text.length,cur=line;merged=collapsedSpanAtStart(cur);){var found=merged.find(0,!0);cur=found.from.line,len+=found.from.ch-found.to.ch}for(cur=line;merged=collapsedSpanAtEnd(cur);){var found=merged.find(0,!0);len-=cur.text.length-found.from.ch,cur=found.to.line,len+=cur.text.length-found.to.ch}return len}function findMaxLine(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first),d.maxLineLength=lineLength(d.maxLine),d.maxLineChanged=!0,doc.iter(function(line){var len=lineLength(line);len>d.maxLineLength&&(d.maxLineLength=len,d.maxLine=line)})}function setGuttersForLineNumbers(options){var found=indexOf(options.gutters,"CodeMirror-linenumbers");-1==found&&options.lineNumbers?options.gutters=options.gutters.concat(["CodeMirror-linenumbers"]):found>-1&&!options.lineNumbers&&(options.gutters=options.gutters.slice(0),options.gutters.splice(found,1))}function measureForScrollbars(cm){var d=cm.display,gutterW=d.gutters.offsetWidth,docH=Math.round(cm.doc.height+paddingVert(cm.display));return{clientHeight:d.scroller.clientHeight,viewHeight:d.wrapper.clientHeight,scrollWidth:d.scroller.scrollWidth,clientWidth:d.scroller.clientWidth,viewWidth:d.wrapper.clientWidth,barLeft:cm.options.fixedGutter?gutterW:0,docHeight:docH,scrollHeight:docH+scrollGap(cm)+d.barHeight,nativeBarWidth:d.nativeBarWidth,gutterWidth:gutterW}}function NativeScrollbars(place,scroll,cm){this.cm=cm;var vert=this.vert=elt("div",[elt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),horiz=this.horiz=elt("div",[elt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");place(vert),place(horiz),on(vert,"scroll",function(){vert.clientHeight&&scroll(vert.scrollTop,"vertical")}),on(horiz,"scroll",function(){horiz.clientWidth&&scroll(horiz.scrollLeft,"horizontal")}),this.checkedOverlay=!1,ie&&8>ie_version&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function NullScrollbars(){}function initScrollbars(cm){cm.display.scrollbars&&(cm.display.scrollbars.clear(),cm.display.scrollbars.addClass&&rmClass(cm.display.wrapper,cm.display.scrollbars.addClass)),cm.display.scrollbars=new CodeMirror.scrollbarModel[cm.options.scrollbarStyle](function(node){cm.display.wrapper.insertBefore(node,cm.display.scrollbarFiller),on(node,"mousedown",function(){cm.state.focused&&setTimeout(function(){cm.display.input.focus()},0)}),node.setAttribute("cm-not-content","true")},function(pos,axis){"horizontal"==axis?setScrollLeft(cm,pos):setScrollTop(cm,pos)},cm),cm.display.scrollbars.addClass&&addClass(cm.display.wrapper,cm.display.scrollbars.addClass)}function updateScrollbars(cm,measure){measure||(measure=measureForScrollbars(cm));var startWidth=cm.display.barWidth,startHeight=cm.display.barHeight;updateScrollbarsInner(cm,measure);for(var i=0;4>i&&startWidth!=cm.display.barWidth||startHeight!=cm.display.barHeight;i++)startWidth!=cm.display.barWidth&&cm.options.lineWrapping&&updateHeightsInViewport(cm),updateScrollbarsInner(cm,measureForScrollbars(cm)),startWidth=cm.display.barWidth,startHeight=cm.display.barHeight}function updateScrollbarsInner(cm,measure){var d=cm.display,sizes=d.scrollbars.update(measure);d.sizer.style.paddingRight=(d.barWidth=sizes.right)+"px",d.sizer.style.paddingBottom=(d.barHeight=sizes.bottom)+"px",sizes.right&&sizes.bottom?(d.scrollbarFiller.style.display="block",d.scrollbarFiller.style.height=sizes.bottom+"px",d.scrollbarFiller.style.width=sizes.right+"px"):d.scrollbarFiller.style.display="",sizes.bottom&&cm.options.coverGutterNextToScrollbar&&cm.options.fixedGutter?(d.gutterFiller.style.display="block",d.gutterFiller.style.height=sizes.bottom+"px",d.gutterFiller.style.width=measure.gutterWidth+"px"):d.gutterFiller.style.display=""}function visibleLines(display,doc,viewport){var top=viewport&&null!=viewport.top?Math.max(0,viewport.top):display.scroller.scrollTop;top=Math.floor(top-paddingTop(display));var bottom=viewport&&null!=viewport.bottom?viewport.bottom:top+display.wrapper.clientHeight,from=lineAtHeight(doc,top),to=lineAtHeight(doc,bottom);if(viewport&&viewport.ensure){var ensureFrom=viewport.ensure.from.line,ensureTo=viewport.ensure.to.line;from>ensureFrom?(from=ensureFrom,to=lineAtHeight(doc,heightAtLine(getLine(doc,ensureFrom))+display.wrapper.clientHeight)):Math.min(ensureTo,doc.lastLine())>=to&&(from=lineAtHeight(doc,heightAtLine(getLine(doc,ensureTo))-display.wrapper.clientHeight),to=ensureTo)}return{from:from,to:Math.max(to,from+1)}}function alignHorizontally(cm){var display=cm.display,view=display.view;if(display.alignWidgets||display.gutters.firstChild&&cm.options.fixedGutter){for(var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft,gutterW=display.gutters.offsetWidth,left=comp+"px",i=0;i<view.length;i++)if(!view[i].hidden){cm.options.fixedGutter&&view[i].gutter&&(view[i].gutter.style.left=left);var align=view[i].alignable;if(align)for(var j=0;j<align.length;j++)align[j].style.left=left}cm.options.fixedGutter&&(display.gutters.style.left=comp+gutterW+"px")}}function maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers)return!1;var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt("div",[elt("div",last)],"CodeMirror-linenumber CodeMirror-gutter-elt")),innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;return display.lineGutter.style.width="",display.lineNumInnerWidth=Math.max(innerW,display.lineGutter.offsetWidth-padding)+1,display.lineNumWidth=display.lineNumInnerWidth+padding,display.lineNumChars=display.lineNumInnerWidth?last.length:-1,display.lineGutter.style.width=display.lineNumWidth+"px",updateGutterSpace(cm),!0}return!1}function lineNumberFor(options,i){return String(options.lineNumberFormatter(i+options.firstLineNumber))}function compensateForHScroll(display){return display.scroller.getBoundingClientRect().left-display.sizer.getBoundingClientRect().left}function DisplayUpdate(cm,viewport,force){var display=cm.display;this.viewport=viewport,this.visible=visibleLines(display,cm.doc,viewport),this.editorIsHidden=!display.wrapper.offsetWidth,this.wrapperHeight=display.wrapper.clientHeight,this.wrapperWidth=display.wrapper.clientWidth,this.oldDisplayWidth=displayWidth(cm),this.force=force,this.dims=getDimensions(cm),this.events=[]}function maybeClipScrollbars(cm){var display=cm.display;!display.scrollbarsClipped&&display.scroller.offsetWidth&&(display.nativeBarWidth=display.scroller.offsetWidth-display.scroller.clientWidth,display.heightForcer.style.height=scrollGap(cm)+"px",display.sizer.style.marginBottom=-display.nativeBarWidth+"px",display.sizer.style.borderRightWidth=scrollGap(cm)+"px",display.scrollbarsClipped=!0)}function updateDisplayIfNeeded(cm,update){var display=cm.display,doc=cm.doc;if(update.editorIsHidden)return resetView(cm),!1;if(!update.force&&update.visible.from>=display.viewFrom&&update.visible.to<=display.viewTo&&(null==display.updateLineNumbers||display.updateLineNumbers>=display.viewTo)&&display.renderedView==display.view&&0==countDirtyView(cm))return!1;maybeUpdateLineNumberWidth(cm)&&(resetView(cm),update.dims=getDimensions(cm));var end=doc.first+doc.size,from=Math.max(update.visible.from-cm.options.viewportMargin,doc.first),to=Math.min(end,update.visible.to+cm.options.viewportMargin);display.viewFrom<from&&from-display.viewFrom<20&&(from=Math.max(doc.first,display.viewFrom)),display.viewTo>to&&display.viewTo-to<20&&(to=Math.min(end,display.viewTo)),sawCollapsedSpans&&(from=visualLineNo(cm.doc,from),to=visualLineEndNo(cm.doc,to));var different=from!=display.viewFrom||to!=display.viewTo||display.lastWrapHeight!=update.wrapperHeight||display.lastWrapWidth!=update.wrapperWidth;adjustView(cm,from,to),display.viewOffset=heightAtLine(getLine(cm.doc,display.viewFrom)),cm.display.mover.style.top=display.viewOffset+"px";var toUpdate=countDirtyView(cm);if(!different&&0==toUpdate&&!update.force&&display.renderedView==display.view&&(null==display.updateLineNumbers||display.updateLineNumbers>=display.viewTo))return!1;var focused=activeElt();return toUpdate>4&&(display.lineDiv.style.display="none"),patchDisplay(cm,display.updateLineNumbers,update.dims),toUpdate>4&&(display.lineDiv.style.display=""),display.renderedView=display.view,focused&&activeElt()!=focused&&focused.offsetHeight&&focused.focus(),removeChildren(display.cursorDiv),removeChildren(display.selectionDiv),display.gutters.style.height=display.sizer.style.minHeight=0,different&&(display.lastWrapHeight=update.wrapperHeight,display.lastWrapWidth=update.wrapperWidth,startWorker(cm,400)),display.updateLineNumbers=null,!0}function postUpdateDisplay(cm,update){for(var viewport=update.viewport,first=!0;(first&&cm.options.lineWrapping&&update.oldDisplayWidth!=displayWidth(cm)||(viewport&&null!=viewport.top&&(viewport={top:Math.min(cm.doc.height+paddingVert(cm.display)-displayHeight(cm),viewport.top)}),update.visible=visibleLines(cm.display,cm.doc,viewport),!(update.visible.from>=cm.display.viewFrom&&update.visible.to<=cm.display.viewTo)))&&updateDisplayIfNeeded(cm,update);first=!1){updateHeightsInViewport(cm);var barMeasure=measureForScrollbars(cm);updateSelection(cm),setDocumentHeight(cm,barMeasure),updateScrollbars(cm,barMeasure)}update.signal(cm,"update",cm),(cm.display.viewFrom!=cm.display.reportedViewFrom||cm.display.viewTo!=cm.display.reportedViewTo)&&(update.signal(cm,"viewportChange",cm,cm.display.viewFrom,cm.display.viewTo),cm.display.reportedViewFrom=cm.display.viewFrom,cm.display.reportedViewTo=cm.display.viewTo)}function updateDisplaySimple(cm,viewport){var update=new DisplayUpdate(cm,viewport);if(updateDisplayIfNeeded(cm,update)){updateHeightsInViewport(cm),postUpdateDisplay(cm,update);var barMeasure=measureForScrollbars(cm);updateSelection(cm),setDocumentHeight(cm,barMeasure),updateScrollbars(cm,barMeasure),update.finish()}}function setDocumentHeight(cm,measure){cm.display.sizer.style.minHeight=measure.docHeight+"px";var total=measure.docHeight+cm.display.barHeight;cm.display.heightForcer.style.top=total+"px",cm.display.gutters.style.height=Math.max(total+scrollGap(cm),measure.clientHeight)+"px"}function updateHeightsInViewport(cm){for(var display=cm.display,prevBottom=display.lineDiv.offsetTop,i=0;i<display.view.length;i++){var height,cur=display.view[i];if(!cur.hidden){if(ie&&8>ie_version){var bot=cur.node.offsetTop+cur.node.offsetHeight;height=bot-prevBottom,prevBottom=bot}else{var box=cur.node.getBoundingClientRect();height=box.bottom-box.top}var diff=cur.line.height-height;if(2>height&&(height=textHeight(display)),(diff>.001||-.001>diff)&&(updateLineHeight(cur.line,height),updateWidgetHeight(cur.line),cur.rest))for(var j=0;j<cur.rest.length;j++)updateWidgetHeight(cur.rest[j])}}}function updateWidgetHeight(line){if(line.widgets)for(var i=0;i<line.widgets.length;++i)line.widgets[i].height=line.widgets[i].node.offsetHeight}function getDimensions(cm){for(var d=cm.display,left={},width={},gutterLeft=d.gutters.clientLeft,n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i)left[cm.options.gutters[i]]=n.offsetLeft+n.clientLeft+gutterLeft,width[cm.options.gutters[i]]=n.clientWidth;return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth}}function patchDisplay(cm,updateNumbersFrom,dims){function rm(node){var next=node.nextSibling;return webkit&&mac&&cm.display.currentWheelTarget==node?node.style.display="none":node.parentNode.removeChild(node),next}for(var display=cm.display,lineNumbers=cm.options.lineNumbers,container=display.lineDiv,cur=container.firstChild,view=display.view,lineN=display.viewFrom,i=0;i<view.length;i++){var lineView=view[i];if(lineView.hidden);else if(lineView.node&&lineView.node.parentNode==container){for(;cur!=lineView.node;)cur=rm(cur);var updateNumber=lineNumbers&&null!=updateNumbersFrom&&lineN>=updateNumbersFrom&&lineView.lineNumber;lineView.changes&&(indexOf(lineView.changes,"gutter")>-1&&(updateNumber=!1),updateLineForChanges(cm,lineView,lineN,dims)),updateNumber&&(removeChildren(lineView.lineNumber),lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options,lineN)))),cur=lineView.node.nextSibling}else{var node=buildLineElement(cm,lineView,lineN,dims);container.insertBefore(node,cur)}lineN+=lineView.size}for(;cur;)cur=rm(cur)}function updateLineForChanges(cm,lineView,lineN,dims){for(var j=0;j<lineView.changes.length;j++){var type=lineView.changes[j];"text"==type?updateLineText(cm,lineView):"gutter"==type?updateLineGutter(cm,lineView,lineN,dims):"class"==type?updateLineClasses(lineView):"widget"==type&&updateLineWidgets(cm,lineView,dims)}lineView.changes=null}function ensureLineWrapped(lineView){return lineView.node==lineView.text&&(lineView.node=elt("div",null,null,"position: relative"),lineView.text.parentNode&&lineView.text.parentNode.replaceChild(lineView.node,lineView.text),lineView.node.appendChild(lineView.text),ie&&8>ie_version&&(lineView.node.style.zIndex=2)),lineView.node}function updateLineBackground(lineView){var cls=lineView.bgClass?lineView.bgClass+" "+(lineView.line.bgClass||""):lineView.line.bgClass;if(cls&&(cls+=" CodeMirror-linebackground"),lineView.background)cls?lineView.background.className=cls:(lineView.background.parentNode.removeChild(lineView.background),lineView.background=null);else if(cls){var wrap=ensureLineWrapped(lineView);lineView.background=wrap.insertBefore(elt("div",null,cls),wrap.firstChild)}}function getLineContent(cm,lineView){var ext=cm.display.externalMeasured;return ext&&ext.line==lineView.line?(cm.display.externalMeasured=null,lineView.measure=ext.measure,ext.built):buildLineContent(cm,lineView)}function updateLineText(cm,lineView){var cls=lineView.text.className,built=getLineContent(cm,lineView);lineView.text==lineView.node&&(lineView.node=built.pre),lineView.text.parentNode.replaceChild(built.pre,lineView.text),lineView.text=built.pre,built.bgClass!=lineView.bgClass||built.textClass!=lineView.textClass?(lineView.bgClass=built.bgClass,lineView.textClass=built.textClass,updateLineClasses(lineView)):cls&&(lineView.text.className=cls)
}function updateLineClasses(lineView){updateLineBackground(lineView),lineView.line.wrapClass?ensureLineWrapped(lineView).className=lineView.line.wrapClass:lineView.node!=lineView.text&&(lineView.node.className="");var textClass=lineView.textClass?lineView.textClass+" "+(lineView.line.textClass||""):lineView.line.textClass;lineView.text.className=textClass||""}function updateLineGutter(cm,lineView,lineN,dims){if(lineView.gutter&&(lineView.node.removeChild(lineView.gutter),lineView.gutter=null),lineView.gutterBackground&&(lineView.node.removeChild(lineView.gutterBackground),lineView.gutterBackground=null),lineView.line.gutterClass){var wrap=ensureLineWrapped(lineView);lineView.gutterBackground=elt("div",null,"CodeMirror-gutter-background "+lineView.line.gutterClass,"left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px; width: "+dims.gutterTotalWidth+"px"),wrap.insertBefore(lineView.gutterBackground,lineView.text)}var markers=lineView.line.gutterMarkers;if(cm.options.lineNumbers||markers){var wrap=ensureLineWrapped(lineView),gutterWrap=lineView.gutter=elt("div",null,"CodeMirror-gutter-wrapper","left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px");if(cm.display.input.setUneditable(gutterWrap),wrap.insertBefore(gutterWrap,lineView.text),lineView.line.gutterClass&&(gutterWrap.className+=" "+lineView.line.gutterClass),!cm.options.lineNumbers||markers&&markers["CodeMirror-linenumbers"]||(lineView.lineNumber=gutterWrap.appendChild(elt("div",lineNumberFor(cm.options,lineN),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+dims.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+cm.display.lineNumInnerWidth+"px"))),markers)for(var k=0;k<cm.options.gutters.length;++k){var id=cm.options.gutters[k],found=markers.hasOwnProperty(id)&&markers[id];found&&gutterWrap.appendChild(elt("div",[found],"CodeMirror-gutter-elt","left: "+dims.gutterLeft[id]+"px; width: "+dims.gutterWidth[id]+"px"))}}}function updateLineWidgets(cm,lineView,dims){lineView.alignable&&(lineView.alignable=null);for(var next,node=lineView.node.firstChild;node;node=next){var next=node.nextSibling;"CodeMirror-linewidget"==node.className&&lineView.node.removeChild(node)}insertLineWidgets(cm,lineView,dims)}function buildLineElement(cm,lineView,lineN,dims){var built=getLineContent(cm,lineView);return lineView.text=lineView.node=built.pre,built.bgClass&&(lineView.bgClass=built.bgClass),built.textClass&&(lineView.textClass=built.textClass),updateLineClasses(lineView),updateLineGutter(cm,lineView,lineN,dims),insertLineWidgets(cm,lineView,dims),lineView.node}function insertLineWidgets(cm,lineView,dims){if(insertLineWidgetsFor(cm,lineView.line,lineView,dims,!0),lineView.rest)for(var i=0;i<lineView.rest.length;i++)insertLineWidgetsFor(cm,lineView.rest[i],lineView,dims,!1)}function insertLineWidgetsFor(cm,line,lineView,dims,allowAbove){if(line.widgets)for(var wrap=ensureLineWrapped(lineView),i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt("div",[widget.node],"CodeMirror-linewidget");widget.handleMouseEvents||node.setAttribute("cm-ignore-events","true"),positionLineWidget(widget,node,lineView,dims),cm.display.input.setUneditable(node),allowAbove&&widget.above?wrap.insertBefore(node,lineView.gutter||lineView.text):wrap.appendChild(node),signalLater(widget,"redraw")}}function positionLineWidget(widget,node,lineView,dims){if(widget.noHScroll){(lineView.alignable||(lineView.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+"px",widget.coverGutter||(width-=dims.gutterTotalWidth,node.style.paddingLeft=dims.gutterTotalWidth+"px"),node.style.width=width+"px"}widget.coverGutter&&(node.style.zIndex=5,node.style.position="relative",widget.noHScroll||(node.style.marginLeft=-dims.gutterTotalWidth+"px"))}function copyPos(x){return Pos(x.line,x.ch)}function maxPos(a,b){return cmp(a,b)<0?b:a}function minPos(a,b){return cmp(a,b)<0?a:b}function ensureFocus(cm){cm.state.focused||(cm.display.input.focus(),onFocus(cm))}function isReadOnly(cm){return cm.options.readOnly||cm.doc.cantEdit}function applyTextInput(cm,inserted,deleted,sel,origin){var doc=cm.doc;cm.display.shift=!1,sel||(sel=doc.sel);var paste=cm.state.pasteIncoming||"paste"==origin,textLines=doc.splitLines(inserted),multiPaste=null;if(paste&&sel.ranges.length>1)if(lastCopied&&lastCopied.join("\n")==inserted){if(sel.ranges.length%lastCopied.length==0){multiPaste=[];for(var i=0;i<lastCopied.length;i++)multiPaste.push(doc.splitLines(lastCopied[i]))}}else textLines.length==sel.ranges.length&&(multiPaste=map(textLines,function(l){return[l]}));for(var i=sel.ranges.length-1;i>=0;i--){var range=sel.ranges[i],from=range.from(),to=range.to();range.empty()&&(deleted&&deleted>0?from=Pos(from.line,from.ch-deleted):cm.state.overwrite&&!paste&&(to=Pos(to.line,Math.min(getLine(doc,to.line).text.length,to.ch+lst(textLines).length))));var updateInput=cm.curOp.updateInput,changeEvent={from:from,to:to,text:multiPaste?multiPaste[i%multiPaste.length]:textLines,origin:origin||(paste?"paste":cm.state.cutIncoming?"cut":"+input")};makeChange(cm.doc,changeEvent),signalLater(cm,"inputRead",cm,changeEvent)}inserted&&!paste&&triggerElectric(cm,inserted),ensureCursorVisible(cm),cm.curOp.updateInput=updateInput,cm.curOp.typing=!0,cm.state.pasteIncoming=cm.state.cutIncoming=!1}function handlePaste(e,cm){var pasted=e.clipboardData&&e.clipboardData.getData("text/plain");return pasted?(e.preventDefault(),isReadOnly(cm)||cm.options.disableInput||runInOp(cm,function(){applyTextInput(cm,pasted,0,null,"paste")}),!0):void 0}function triggerElectric(cm,inserted){if(cm.options.electricChars&&cm.options.smartIndent)for(var sel=cm.doc.sel,i=sel.ranges.length-1;i>=0;i--){var range=sel.ranges[i];if(!(range.head.ch>100||i&&sel.ranges[i-1].head.line==range.head.line)){var mode=cm.getModeAt(range.head),indented=!1;if(mode.electricChars){for(var j=0;j<mode.electricChars.length;j++)if(inserted.indexOf(mode.electricChars.charAt(j))>-1){indented=indentLine(cm,range.head.line,"smart");break}}else mode.electricInput&&mode.electricInput.test(getLine(cm.doc,range.head.line).text.slice(0,range.head.ch))&&(indented=indentLine(cm,range.head.line,"smart"));indented&&signalLater(cm,"electricInput",cm,range.head.line)}}}function copyableRanges(cm){for(var text=[],ranges=[],i=0;i<cm.doc.sel.ranges.length;i++){var line=cm.doc.sel.ranges[i].head.line,lineRange={anchor:Pos(line,0),head:Pos(line+1,0)};ranges.push(lineRange),text.push(cm.getRange(lineRange.anchor,lineRange.head))}return{text:text,ranges:ranges}}function disableBrowserMagic(field){field.setAttribute("autocorrect","off"),field.setAttribute("autocapitalize","off"),field.setAttribute("spellcheck","false")}function TextareaInput(cm){this.cm=cm,this.prevInput="",this.pollingFast=!1,this.polling=new Delayed,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function hiddenTextarea(){var te=elt("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),div=elt("div",[te],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return webkit?te.style.width="1000px":te.setAttribute("wrap","off"),ios&&(te.style.border="1px solid black"),disableBrowserMagic(te),div}function ContentEditableInput(cm){this.cm=cm,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Delayed,this.gracePeriod=!1}function posToDOM(cm,pos){var view=findViewForLine(cm,pos.line);if(!view||view.hidden)return null;var line=getLine(cm.doc,pos.line),info=mapFromLineView(view,line,pos.line),order=getOrder(line),side="left";if(order){var partPos=getBidiPartAt(order,pos.ch);side=partPos%2?"right":"left"}var result=nodeAndOffsetInLineMap(info.map,pos.ch,side);return result.offset="right"==result.collapse?result.end:result.start,result}function badPos(pos,bad){return bad&&(pos.bad=!0),pos}function domToPos(cm,node,offset){var lineNode;if(node==cm.display.lineDiv){if(lineNode=cm.display.lineDiv.childNodes[offset],!lineNode)return badPos(cm.clipPos(Pos(cm.display.viewTo-1)),!0);node=null,offset=0}else for(lineNode=node;;lineNode=lineNode.parentNode){if(!lineNode||lineNode==cm.display.lineDiv)return null;if(lineNode.parentNode&&lineNode.parentNode==cm.display.lineDiv)break}for(var i=0;i<cm.display.view.length;i++){var lineView=cm.display.view[i];if(lineView.node==lineNode)return locateNodeInLineView(lineView,node,offset)}}function locateNodeInLineView(lineView,node,offset){function find(textNode,topNode,offset){for(var i=-1;i<(maps?maps.length:0);i++)for(var map=0>i?measure.map:maps[i],j=0;j<map.length;j+=3){var curNode=map[j+2];if(curNode==textNode||curNode==topNode){var line=lineNo(0>i?lineView.line:lineView.rest[i]),ch=map[j]+offset;return(0>offset||curNode!=textNode)&&(ch=map[j+(offset?1:0)]),Pos(line,ch)}}}var wrapper=lineView.text.firstChild,bad=!1;if(!node||!contains(wrapper,node))return badPos(Pos(lineNo(lineView.line),0),!0);if(node==wrapper&&(bad=!0,node=wrapper.childNodes[offset],offset=0,!node)){var line=lineView.rest?lst(lineView.rest):lineView.line;return badPos(Pos(lineNo(line),line.text.length),bad)}var textNode=3==node.nodeType?node:null,topNode=node;for(textNode||1!=node.childNodes.length||3!=node.firstChild.nodeType||(textNode=node.firstChild,offset&&(offset=textNode.nodeValue.length));topNode.parentNode!=wrapper;)topNode=topNode.parentNode;var measure=lineView.measure,maps=measure.maps,found=find(textNode,topNode,offset);if(found)return badPos(found,bad);for(var after=topNode.nextSibling,dist=textNode?textNode.nodeValue.length-offset:0;after;after=after.nextSibling){if(found=find(after,after.firstChild,0))return badPos(Pos(found.line,found.ch-dist),bad);dist+=after.textContent.length}for(var before=topNode.previousSibling,dist=offset;before;before=before.previousSibling){if(found=find(before,before.firstChild,-1))return badPos(Pos(found.line,found.ch+dist),bad);dist+=after.textContent.length}}function domTextBetween(cm,from,to,fromLine,toLine){function recognizeMarker(id){return function(marker){return marker.id==id}}function walk(node){if(1==node.nodeType){var cmText=node.getAttribute("cm-text");if(null!=cmText)return""==cmText&&(cmText=node.textContent.replace(/\u200b/g,"")),void(text+=cmText);var range,markerID=node.getAttribute("cm-marker");if(markerID){var found=cm.findMarks(Pos(fromLine,0),Pos(toLine+1,0),recognizeMarker(+markerID));return void(found.length&&(range=found[0].find())&&(text+=getBetween(cm.doc,range.from,range.to).join(lineSep)))}if("false"==node.getAttribute("contenteditable"))return;for(var i=0;i<node.childNodes.length;i++)walk(node.childNodes[i]);/^(pre|div|p)$/i.test(node.nodeName)&&(closing=!0)}else if(3==node.nodeType){var val=node.nodeValue;if(!val)return;closing&&(text+=lineSep,closing=!1),text+=val}}for(var text="",closing=!1,lineSep=cm.doc.lineSeparator();walk(from),from!=to;)from=from.nextSibling;return text}function Selection(ranges,primIndex){this.ranges=ranges,this.primIndex=primIndex}function Range(anchor,head){this.anchor=anchor,this.head=head}function normalizeSelection(ranges,primIndex){var prim=ranges[primIndex];ranges.sort(function(a,b){return cmp(a.from(),b.from())}),primIndex=indexOf(ranges,prim);for(var i=1;i<ranges.length;i++){var cur=ranges[i],prev=ranges[i-1];if(cmp(prev.to(),cur.from())>=0){var from=minPos(prev.from(),cur.from()),to=maxPos(prev.to(),cur.to()),inv=prev.empty()?cur.from()==cur.head:prev.from()==prev.head;primIndex>=i&&--primIndex,ranges.splice(--i,2,new Range(inv?to:from,inv?from:to))}}return new Selection(ranges,primIndex)}function simpleSelection(anchor,head){return new Selection([new Range(anchor,head||anchor)],0)}function clipLine(doc,n){return Math.max(doc.first,Math.min(n,doc.first+doc.size-1))}function clipPos(doc,pos){if(pos.line<doc.first)return Pos(doc.first,0);var last=doc.first+doc.size-1;return pos.line>last?Pos(last,getLine(doc,last).text.length):clipToLen(pos,getLine(doc,pos.line).text.length)}function clipToLen(pos,linelen){var ch=pos.ch;return null==ch||ch>linelen?Pos(pos.line,linelen):0>ch?Pos(pos.line,0):pos}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size}function clipPosArray(doc,array){for(var out=[],i=0;i<array.length;i++)out[i]=clipPos(doc,array[i]);return out}function extendRange(doc,range,head,other){if(doc.cm&&doc.cm.display.shift||doc.extend){var anchor=range.anchor;if(other){var posBefore=cmp(head,anchor)<0;posBefore!=cmp(other,anchor)<0?(anchor=head,head=other):posBefore!=cmp(head,other)<0&&(head=other)}return new Range(anchor,head)}return new Range(other||head,head)}function extendSelection(doc,head,other,options){setSelection(doc,new Selection([extendRange(doc,doc.sel.primary(),head,other)],0),options)}function extendSelections(doc,heads,options){for(var out=[],i=0;i<doc.sel.ranges.length;i++)out[i]=extendRange(doc,doc.sel.ranges[i],heads[i],null);var newSel=normalizeSelection(out,doc.sel.primIndex);setSelection(doc,newSel,options)}function replaceOneSelection(doc,i,range,options){var ranges=doc.sel.ranges.slice(0);ranges[i]=range,setSelection(doc,normalizeSelection(ranges,doc.sel.primIndex),options)}function setSimpleSelection(doc,anchor,head,options){setSelection(doc,simpleSelection(anchor,head),options)}function filterSelectionChange(doc,sel){var obj={ranges:sel.ranges,update:function(ranges){this.ranges=[];for(var i=0;i<ranges.length;i++)this.ranges[i]=new Range(clipPos(doc,ranges[i].anchor),clipPos(doc,ranges[i].head))}};return signal(doc,"beforeSelectionChange",doc,obj),doc.cm&&signal(doc.cm,"beforeSelectionChange",doc.cm,obj),obj.ranges!=sel.ranges?normalizeSelection(obj.ranges,obj.ranges.length-1):sel}function setSelectionReplaceHistory(doc,sel,options){var done=doc.history.done,last=lst(done);last&&last.ranges?(done[done.length-1]=sel,setSelectionNoUndo(doc,sel,options)):setSelection(doc,sel,options)}function setSelection(doc,sel,options){setSelectionNoUndo(doc,sel,options),addSelectionToHistory(doc,doc.sel,doc.cm?doc.cm.curOp.id:0/0,options)}function setSelectionNoUndo(doc,sel,options){(hasHandler(doc,"beforeSelectionChange")||doc.cm&&hasHandler(doc.cm,"beforeSelectionChange"))&&(sel=filterSelectionChange(doc,sel));var bias=options&&options.bias||(cmp(sel.primary().head,doc.sel.primary().head)<0?-1:1);setSelectionInner(doc,skipAtomicInSelection(doc,sel,bias,!0)),options&&options.scroll===!1||!doc.cm||ensureCursorVisible(doc.cm)}function setSelectionInner(doc,sel){sel.equals(doc.sel)||(doc.sel=sel,doc.cm&&(doc.cm.curOp.updateInput=doc.cm.curOp.selectionChanged=!0,signalCursorActivity(doc.cm)),signalLater(doc,"cursorActivity",doc))}function reCheckSelection(doc){setSelectionInner(doc,skipAtomicInSelection(doc,doc.sel,null,!1),sel_dontScroll)}function skipAtomicInSelection(doc,sel,bias,mayClear){for(var out,i=0;i<sel.ranges.length;i++){var range=sel.ranges[i],newAnchor=skipAtomic(doc,range.anchor,bias,mayClear),newHead=skipAtomic(doc,range.head,bias,mayClear);(out||newAnchor!=range.anchor||newHead!=range.head)&&(out||(out=sel.ranges.slice(0,i)),out[i]=new Range(newAnchor,newHead))}return out?normalizeSelection(out,sel.primIndex):sel}function skipAtomic(doc,pos,bias,mayClear){var flipped=!1,curPos=pos,dir=bias||1;doc.cantEdit=!1;search:for(;;){var line=getLine(doc,curPos.line);if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker;if((null==sp.from||(m.inclusiveLeft?sp.from<=curPos.ch:sp.from<curPos.ch))&&(null==sp.to||(m.inclusiveRight?sp.to>=curPos.ch:sp.to>curPos.ch))){if(mayClear&&(signal(m,"beforeCursorEnter"),m.explicitlyCleared)){if(line.markedSpans){--i;continue}break}if(!m.atomic)continue;var newPos=m.find(0>dir?-1:1);if(0==cmp(newPos,curPos)&&(newPos.ch+=dir,newPos.ch<0?newPos=newPos.line>doc.first?clipPos(doc,Pos(newPos.line-1)):null:newPos.ch>line.text.length&&(newPos=newPos.line<doc.first+doc.size-1?Pos(newPos.line+1,0):null),!newPos)){if(flipped)return mayClear?(doc.cantEdit=!0,Pos(doc.first,0)):skipAtomic(doc,pos,bias,!0);flipped=!0,newPos=pos,dir=-dir}curPos=newPos;continue search}}return curPos}}function updateSelection(cm){cm.display.input.showSelection(cm.display.input.prepareSelection())}function prepareSelection(cm,primary){for(var doc=cm.doc,result={},curFragment=result.cursors=document.createDocumentFragment(),selFragment=result.selection=document.createDocumentFragment(),i=0;i<doc.sel.ranges.length;i++)if(primary!==!1||i!=doc.sel.primIndex){var range=doc.sel.ranges[i],collapsed=range.empty();(collapsed||cm.options.showCursorWhenSelecting)&&drawSelectionCursor(cm,range.head,curFragment),collapsed||drawSelectionRange(cm,range,selFragment)}return result}function drawSelectionCursor(cm,head,output){var pos=cursorCoords(cm,head,"div",null,null,!cm.options.singleCursorHeightPerLine),cursor=output.appendChild(elt("div"," ","CodeMirror-cursor"));if(cursor.style.left=pos.left+"px",cursor.style.top=pos.top+"px",cursor.style.height=Math.max(0,pos.bottom-pos.top)*cm.options.cursorHeight+"px",pos.other){var otherCursor=output.appendChild(elt("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));otherCursor.style.display="",otherCursor.style.left=pos.other.left+"px",otherCursor.style.top=pos.other.top+"px",otherCursor.style.height=.85*(pos.other.bottom-pos.other.top)+"px"}}function drawSelectionRange(cm,range,output){function add(left,top,width,bottom){0>top&&(top=0),top=Math.round(top),bottom=Math.round(bottom),fragment.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+left+"px; top: "+top+"px; width: "+(null==width?rightSide-left:width)+"px; height: "+(bottom-top)+"px"))}function drawForLine(line,fromArg,toArg){function coords(ch,bias){return charCoords(cm,Pos(line,ch),"div",lineObj,bias)}var start,end,lineObj=getLine(doc,line),lineLen=lineObj.text.length;return iterateBidiSections(getOrder(lineObj),fromArg||0,null==toArg?lineLen:toArg,function(from,to,dir){var rightPos,left,right,leftPos=coords(from,"left");if(from==to)rightPos=leftPos,left=right=leftPos.left;else{if(rightPos=coords(to-1,"right"),"rtl"==dir){var tmp=leftPos;leftPos=rightPos,rightPos=tmp}left=leftPos.left,right=rightPos.right}null==fromArg&&0==from&&(left=leftSide),rightPos.top-leftPos.top>3&&(add(left,leftPos.top,null,leftPos.bottom),left=leftSide,leftPos.bottom<rightPos.top&&add(left,leftPos.bottom,null,rightPos.top)),null==toArg&&to==lineLen&&(right=rightSide),(!start||leftPos.top<start.top||leftPos.top==start.top&&leftPos.left<start.left)&&(start=leftPos),(!end||rightPos.bottom>end.bottom||rightPos.bottom==end.bottom&&rightPos.right>end.right)&&(end=rightPos),leftSide+1>left&&(left=leftSide),add(left,rightPos.top,right-left,rightPos.bottom)}),{start:start,end:end}}var display=cm.display,doc=cm.doc,fragment=document.createDocumentFragment(),padding=paddingH(cm.display),leftSide=padding.left,rightSide=Math.max(display.sizerWidth,displayWidth(cm)-display.sizer.offsetLeft)-padding.right,sFrom=range.from(),sTo=range.to();if(sFrom.line==sTo.line)drawForLine(sFrom.line,sFrom.ch,sTo.ch);else{var fromLine=getLine(doc,sFrom.line),toLine=getLine(doc,sTo.line),singleVLine=visualLine(fromLine)==visualLine(toLine),leftEnd=drawForLine(sFrom.line,sFrom.ch,singleVLine?fromLine.text.length+1:null).end,rightStart=drawForLine(sTo.line,singleVLine?0:null,sTo.ch).start;singleVLine&&(leftEnd.top<rightStart.top-2?(add(leftEnd.right,leftEnd.top,null,leftEnd.bottom),add(leftSide,rightStart.top,rightStart.left,rightStart.bottom)):add(leftEnd.right,leftEnd.top,rightStart.left-leftEnd.right,leftEnd.bottom)),leftEnd.bottom<rightStart.top&&add(leftSide,leftEnd.bottom,null,rightStart.top)}output.appendChild(fragment)}function restartBlink(cm){if(cm.state.focused){var display=cm.display;clearInterval(display.blinker);var on=!0;display.cursorDiv.style.visibility="",cm.options.cursorBlinkRate>0?display.blinker=setInterval(function(){display.cursorDiv.style.visibility=(on=!on)?"":"hidden"},cm.options.cursorBlinkRate):cm.options.cursorBlinkRate<0&&(display.cursorDiv.style.visibility="hidden")}}function startWorker(cm,time){cm.doc.mode.startState&&cm.doc.frontier<cm.display.viewTo&&cm.state.highlight.set(time,bind(highlightWorker,cm))}function highlightWorker(cm){var doc=cm.doc;if(doc.frontier<doc.first&&(doc.frontier=doc.first),!(doc.frontier>=cm.display.viewTo)){var end=+new Date+cm.options.workTime,state=copyState(doc.mode,getStateBefore(cm,doc.frontier)),changedLines=[];doc.iter(doc.frontier,Math.min(doc.first+doc.size,cm.display.viewTo+500),function(line){if(doc.frontier>=cm.display.viewFrom){var oldStyles=line.styles,tooLong=line.text.length>cm.options.maxHighlightLength,highlighted=highlightLine(cm,line,tooLong?copyState(doc.mode,state):state,!0);line.styles=highlighted.styles;var oldCls=line.styleClasses,newCls=highlighted.classes;newCls?line.styleClasses=newCls:oldCls&&(line.styleClasses=null);for(var ischange=!oldStyles||oldStyles.length!=line.styles.length||oldCls!=newCls&&(!oldCls||!newCls||oldCls.bgClass!=newCls.bgClass||oldCls.textClass!=newCls.textClass),i=0;!ischange&&i<oldStyles.length;++i)ischange=oldStyles[i]!=line.styles[i];ischange&&changedLines.push(doc.frontier),line.stateAfter=tooLong?state:copyState(doc.mode,state)}else line.text.length<=cm.options.maxHighlightLength&&processLine(cm,line.text,state),line.stateAfter=doc.frontier%5==0?copyState(doc.mode,state):null;return++doc.frontier,+new Date>end?(startWorker(cm,cm.options.workDelay),!0):void 0}),changedLines.length&&runInOp(cm,function(){for(var i=0;i<changedLines.length;i++)regLineChange(cm,changedLines[i],"text")})}}function findStartLine(cm,n,precise){for(var minindent,minline,doc=cm.doc,lim=precise?-1:n-(cm.doc.mode.innerMode?1e3:100),search=n;search>lim;--search){if(search<=doc.first)return doc.first;var line=getLine(doc,search-1);if(line.stateAfter&&(!precise||search<=doc.frontier))return search;var indented=countColumn(line.text,null,cm.options.tabSize);(null==minline||minindent>indented)&&(minline=search-1,minindent=indented)}return minline}function getStateBefore(cm,n,precise){var doc=cm.doc,display=cm.display;if(!doc.mode.startState)return!0;var pos=findStartLine(cm,n,precise),state=pos>doc.first&&getLine(doc,pos-1).stateAfter;return state=state?copyState(doc.mode,state):startState(doc.mode),doc.iter(pos,n,function(line){processLine(cm,line.text,state);var save=pos==n-1||pos%5==0||pos>=display.viewFrom&&pos<display.viewTo;line.stateAfter=save?copyState(doc.mode,state):null,++pos}),precise&&(doc.frontier=pos),state}function paddingTop(display){return display.lineSpace.offsetTop}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight}function paddingH(display){if(display.cachedPaddingH)return display.cachedPaddingH;var e=removeChildrenAndAdd(display.measure,elt("pre","x")),style=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,data={left:parseInt(style.paddingLeft),right:parseInt(style.paddingRight)};return isNaN(data.left)||isNaN(data.right)||(display.cachedPaddingH=data),data}function scrollGap(cm){return scrollerGap-cm.display.nativeBarWidth}function displayWidth(cm){return cm.display.scroller.clientWidth-scrollGap(cm)-cm.display.barWidth}function displayHeight(cm){return cm.display.scroller.clientHeight-scrollGap(cm)-cm.display.barHeight}function ensureLineHeights(cm,lineView,rect){var wrapping=cm.options.lineWrapping,curWidth=wrapping&&displayWidth(cm);if(!lineView.measure.heights||wrapping&&lineView.measure.width!=curWidth){var heights=lineView.measure.heights=[];if(wrapping){lineView.measure.width=curWidth;for(var rects=lineView.text.firstChild.getClientRects(),i=0;i<rects.length-1;i++){var cur=rects[i],next=rects[i+1];Math.abs(cur.bottom-next.bottom)>2&&heights.push((cur.bottom+next.top)/2-rect.top)}}heights.push(rect.bottom-rect.top)}}function mapFromLineView(lineView,line,lineN){if(lineView.line==line)return{map:lineView.measure.map,cache:lineView.measure.cache};for(var i=0;i<lineView.rest.length;i++)if(lineView.rest[i]==line)return{map:lineView.measure.maps[i],cache:lineView.measure.caches[i]};for(var i=0;i<lineView.rest.length;i++)if(lineNo(lineView.rest[i])>lineN)return{map:lineView.measure.maps[i],cache:lineView.measure.caches[i],before:!0}}function updateExternalMeasurement(cm,line){line=visualLine(line);var lineN=lineNo(line),view=cm.display.externalMeasured=new LineView(cm.doc,line,lineN);view.lineN=lineN;var built=view.built=buildLineContent(cm,view);return view.text=built.pre,removeChildrenAndAdd(cm.display.lineMeasure,built.pre),view}function measureChar(cm,line,ch,bias){return measureCharPrepared(cm,prepareMeasureForLine(cm,line),ch,bias)}function findViewForLine(cm,lineN){if(lineN>=cm.display.viewFrom&&lineN<cm.display.viewTo)return cm.display.view[findViewIndex(cm,lineN)];var ext=cm.display.externalMeasured;return ext&&lineN>=ext.lineN&&lineN<ext.lineN+ext.size?ext:void 0}function prepareMeasureForLine(cm,line){var lineN=lineNo(line),view=findViewForLine(cm,lineN);view&&!view.text?view=null:view&&view.changes&&(updateLineForChanges(cm,view,lineN,getDimensions(cm)),cm.curOp.forceUpdate=!0),view||(view=updateExternalMeasurement(cm,line));var info=mapFromLineView(view,line,lineN);return{line:line,view:view,rect:null,map:info.map,cache:info.cache,before:info.before,hasHeights:!1}}function measureCharPrepared(cm,prepared,ch,bias,varHeight){prepared.before&&(ch=-1);var found,key=ch+(bias||"");return prepared.cache.hasOwnProperty(key)?found=prepared.cache[key]:(prepared.rect||(prepared.rect=prepared.view.text.getBoundingClientRect()),prepared.hasHeights||(ensureLineHeights(cm,prepared.view,prepared.rect),prepared.hasHeights=!0),found=measureCharInner(cm,prepared,ch,bias),found.bogus||(prepared.cache[key]=found)),{left:found.left,right:found.right,top:varHeight?found.rtop:found.top,bottom:varHeight?found.rbottom:found.bottom}}function nodeAndOffsetInLineMap(map,ch,bias){for(var node,start,end,collapse,i=0;i<map.length;i+=3){var mStart=map[i],mEnd=map[i+1];if(mStart>ch?(start=0,end=1,collapse="left"):mEnd>ch?(start=ch-mStart,end=start+1):(i==map.length-3||ch==mEnd&&map[i+3]>ch)&&(end=mEnd-mStart,start=end-1,ch>=mEnd&&(collapse="right")),null!=start){if(node=map[i+2],mStart==mEnd&&bias==(node.insertLeft?"left":"right")&&(collapse=bias),"left"==bias&&0==start)for(;i&&map[i-2]==map[i-3]&&map[i-1].insertLeft;)node=map[(i-=3)+2],collapse="left";if("right"==bias&&start==mEnd-mStart)for(;i<map.length-3&&map[i+3]==map[i+4]&&!map[i+5].insertLeft;)node=map[(i+=3)+2],collapse="right";break}}return{node:node,start:start,end:end,collapse:collapse,coverStart:mStart,coverEnd:mEnd}}function measureCharInner(cm,prepared,ch,bias){var rect,place=nodeAndOffsetInLineMap(prepared.map,ch,bias),node=place.node,start=place.start,end=place.end,collapse=place.collapse;if(3==node.nodeType){for(var i=0;4>i;i++){for(;start&&isExtendingChar(prepared.line.text.charAt(place.coverStart+start));)--start;for(;place.coverStart+end<place.coverEnd&&isExtendingChar(prepared.line.text.charAt(place.coverStart+end));)++end;if(ie&&9>ie_version&&0==start&&end==place.coverEnd-place.coverStart)rect=node.parentNode.getBoundingClientRect();else if(ie&&cm.options.lineWrapping){var rects=range(node,start,end).getClientRects();rect=rects.length?rects["right"==bias?rects.length-1:0]:nullRect}else rect=range(node,start,end).getBoundingClientRect()||nullRect;if(rect.left||rect.right||0==start)break;end=start,start-=1,collapse="right"}ie&&11>ie_version&&(rect=maybeUpdateRectForZooming(cm.display.measure,rect))}else{start>0&&(collapse=bias="right");var rects;rect=cm.options.lineWrapping&&(rects=node.getClientRects()).length>1?rects["right"==bias?rects.length-1:0]:node.getBoundingClientRect()}if(ie&&9>ie_version&&!start&&(!rect||!rect.left&&!rect.right)){var rSpan=node.parentNode.getClientRects()[0];rect=rSpan?{left:rSpan.left,right:rSpan.left+charWidth(cm.display),top:rSpan.top,bottom:rSpan.bottom}:nullRect}for(var rtop=rect.top-prepared.rect.top,rbot=rect.bottom-prepared.rect.top,mid=(rtop+rbot)/2,heights=prepared.view.measure.heights,i=0;i<heights.length-1&&!(mid<heights[i]);i++);var top=i?heights[i-1]:0,bot=heights[i],result={left:("right"==collapse?rect.right:rect.left)-prepared.rect.left,right:("left"==collapse?rect.left:rect.right)-prepared.rect.left,top:top,bottom:bot};return rect.left||rect.right||(result.bogus=!0),cm.options.singleCursorHeightPerLine||(result.rtop=rtop,result.rbottom=rbot),result}function maybeUpdateRectForZooming(measure,rect){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!hasBadZoomedRects(measure))return rect;var scaleX=screen.logicalXDPI/screen.deviceXDPI,scaleY=screen.logicalYDPI/screen.deviceYDPI;return{left:rect.left*scaleX,right:rect.right*scaleX,top:rect.top*scaleY,bottom:rect.bottom*scaleY}}function clearLineMeasurementCacheFor(lineView){if(lineView.measure&&(lineView.measure.cache={},lineView.measure.heights=null,lineView.rest))for(var i=0;i<lineView.rest.length;i++)lineView.measure.caches[i]={}}function clearLineMeasurementCache(cm){cm.display.externalMeasure=null,removeChildren(cm.display.lineMeasure);for(var i=0;i<cm.display.view.length;i++)clearLineMeasurementCacheFor(cm.display.view[i])}function clearCaches(cm){clearLineMeasurementCache(cm),cm.display.cachedCharWidth=cm.display.cachedTextHeight=cm.display.cachedPaddingH=null,cm.options.lineWrapping||(cm.display.maxLineChanged=!0),cm.display.lineNumChars=null}function pageScrollX(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function pageScrollY(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function intoCoordSystem(cm,lineObj,rect,context){if(lineObj.widgets)for(var i=0;i<lineObj.widgets.length;++i)if(lineObj.widgets[i].above){var size=widgetHeight(lineObj.widgets[i]);rect.top+=size,rect.bottom+=size}if("line"==context)return rect;context||(context="local");var yOff=heightAtLine(lineObj);if("local"==context?yOff+=paddingTop(cm.display):yOff-=cm.display.viewOffset,"page"==context||"window"==context){var lOff=cm.display.lineSpace.getBoundingClientRect();yOff+=lOff.top+("window"==context?0:pageScrollY());var xOff=lOff.left+("window"==context?0:pageScrollX());rect.left+=xOff,rect.right+=xOff}return rect.top+=yOff,rect.bottom+=yOff,rect}function fromCoordSystem(cm,coords,context){if("div"==context)return coords;var left=coords.left,top=coords.top;if("page"==context)left-=pageScrollX(),top-=pageScrollY();else if("local"==context||!context){var localBox=cm.display.sizer.getBoundingClientRect();left+=localBox.left,top+=localBox.top}var lineSpaceBox=cm.display.lineSpace.getBoundingClientRect();return{left:left-lineSpaceBox.left,top:top-lineSpaceBox.top}}function charCoords(cm,pos,context,lineObj,bias){return lineObj||(lineObj=getLine(cm.doc,pos.line)),intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch,bias),context)}function cursorCoords(cm,pos,context,lineObj,preparedMeasure,varHeight){function get(ch,right){var m=measureCharPrepared(cm,preparedMeasure,ch,right?"right":"left",varHeight);return right?m.left=m.right:m.right=m.left,intoCoordSystem(cm,lineObj,m,context)}function getBidi(ch,partPos){var part=order[partPos],right=part.level%2;return ch==bidiLeft(part)&&partPos&&part.level<order[partPos-1].level?(part=order[--partPos],ch=bidiRight(part)-(part.level%2?0:1),right=!0):ch==bidiRight(part)&&partPos<order.length-1&&part.level<order[partPos+1].level&&(part=order[++partPos],ch=bidiLeft(part)-part.level%2,right=!1),right&&ch==part.to&&ch>part.from?get(ch-1):get(ch,right)}lineObj=lineObj||getLine(cm.doc,pos.line),preparedMeasure||(preparedMeasure=prepareMeasureForLine(cm,lineObj));var order=getOrder(lineObj),ch=pos.ch;if(!order)return get(ch);var partPos=getBidiPartAt(order,ch),val=getBidi(ch,partPos);return null!=bidiOther&&(val.other=getBidi(ch,bidiOther)),val}function estimateCoords(cm,pos){var left=0,pos=clipPos(cm.doc,pos);cm.options.lineWrapping||(left=charWidth(cm.display)*pos.ch);var lineObj=getLine(cm.doc,pos.line),top=heightAtLine(lineObj)+paddingTop(cm.display);return{left:left,right:left,top:top,bottom:top+lineObj.height}
}function PosWithInfo(line,ch,outside,xRel){var pos=Pos(line,ch);return pos.xRel=xRel,outside&&(pos.outside=!0),pos}function coordsChar(cm,x,y){var doc=cm.doc;if(y+=cm.display.viewOffset,0>y)return PosWithInfo(doc.first,0,!0,-1);var lineN=lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineN>last)return PosWithInfo(doc.first+doc.size-1,getLine(doc,last).text.length,!0,1);0>x&&(x=0);for(var lineObj=getLine(doc,lineN);;){var found=coordsCharInner(cm,lineObj,lineN,x,y),merged=collapsedSpanAtEnd(lineObj),mergedPos=merged&&merged.find(0,!0);if(!merged||!(found.ch>mergedPos.from.ch||found.ch==mergedPos.from.ch&&found.xRel>0))return found;lineN=lineNo(lineObj=mergedPos.to.line)}}function coordsCharInner(cm,lineObj,lineNo,x,y){function getX(ch){var sp=cursorCoords(cm,Pos(lineNo,ch),"line",lineObj,preparedMeasure);return wrongLine=!0,innerOff>sp.bottom?sp.left-adjust:innerOff<sp.top?sp.left+adjust:(wrongLine=!1,sp.left)}var innerOff=y-heightAtLine(lineObj),wrongLine=!1,adjust=2*cm.display.wrapper.clientWidth,preparedMeasure=prepareMeasureForLine(cm,lineObj),bidi=getOrder(lineObj),dist=lineObj.text.length,from=lineLeft(lineObj),to=lineRight(lineObj),fromX=getX(from),fromOutside=wrongLine,toX=getX(to),toOutside=wrongLine;if(x>toX)return PosWithInfo(lineNo,to,toOutside,1);for(;;){if(bidi?to==from||to==moveVisually(lineObj,from,1):1>=to-from){for(var ch=fromX>x||toX-x>=x-fromX?from:to,xDiff=x-(ch==from?fromX:toX);isExtendingChar(lineObj.text.charAt(ch));)++ch;var pos=PosWithInfo(lineNo,ch,ch==from?fromOutside:toOutside,-1>xDiff?-1:xDiff>1?1:0);return pos}var step=Math.ceil(dist/2),middle=from+step;if(bidi){middle=from;for(var i=0;step>i;++i)middle=moveVisually(lineObj,middle,1)}var middleX=getX(middle);middleX>x?(to=middle,toX=middleX,(toOutside=wrongLine)&&(toX+=1e3),dist=step):(from=middle,fromX=middleX,fromOutside=wrongLine,dist-=step)}}function textHeight(display){if(null!=display.cachedTextHeight)return display.cachedTextHeight;if(null==measureText){measureText=elt("pre");for(var i=0;49>i;++i)measureText.appendChild(document.createTextNode("x")),measureText.appendChild(elt("br"));measureText.appendChild(document.createTextNode("x"))}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;return height>3&&(display.cachedTextHeight=height),removeChildren(display.measure),height||1}function charWidth(display){if(null!=display.cachedCharWidth)return display.cachedCharWidth;var anchor=elt("span","xxxxxxxxxx"),pre=elt("pre",[anchor]);removeChildrenAndAdd(display.measure,pre);var rect=anchor.getBoundingClientRect(),width=(rect.right-rect.left)/10;return width>2&&(display.cachedCharWidth=width),width||10}function startOperation(cm){cm.curOp={cm:cm,viewChanged:!1,startHeight:cm.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++nextOpId},operationGroup?operationGroup.ops.push(cm.curOp):cm.curOp.ownsGroup=operationGroup={ops:[cm.curOp],delayedCallbacks:[]}}function fireCallbacksForOps(group){var callbacks=group.delayedCallbacks,i=0;do{for(;i<callbacks.length;i++)callbacks[i].call(null);for(var j=0;j<group.ops.length;j++){var op=group.ops[j];if(op.cursorActivityHandlers)for(;op.cursorActivityCalled<op.cursorActivityHandlers.length;)op.cursorActivityHandlers[op.cursorActivityCalled++].call(null,op.cm)}}while(i<callbacks.length)}function endOperation(cm){var op=cm.curOp,group=op.ownsGroup;if(group)try{fireCallbacksForOps(group)}finally{operationGroup=null;for(var i=0;i<group.ops.length;i++)group.ops[i].cm.curOp=null;endOperations(group)}}function endOperations(group){for(var ops=group.ops,i=0;i<ops.length;i++)endOperation_R1(ops[i]);for(var i=0;i<ops.length;i++)endOperation_W1(ops[i]);for(var i=0;i<ops.length;i++)endOperation_R2(ops[i]);for(var i=0;i<ops.length;i++)endOperation_W2(ops[i]);for(var i=0;i<ops.length;i++)endOperation_finish(ops[i])}function endOperation_R1(op){var cm=op.cm,display=cm.display;maybeClipScrollbars(cm),op.updateMaxLine&&findMaxLine(cm),op.mustUpdate=op.viewChanged||op.forceUpdate||null!=op.scrollTop||op.scrollToPos&&(op.scrollToPos.from.line<display.viewFrom||op.scrollToPos.to.line>=display.viewTo)||display.maxLineChanged&&cm.options.lineWrapping,op.update=op.mustUpdate&&new DisplayUpdate(cm,op.mustUpdate&&{top:op.scrollTop,ensure:op.scrollToPos},op.forceUpdate)}function endOperation_W1(op){op.updatedDisplay=op.mustUpdate&&updateDisplayIfNeeded(op.cm,op.update)}function endOperation_R2(op){var cm=op.cm,display=cm.display;op.updatedDisplay&&updateHeightsInViewport(cm),op.barMeasure=measureForScrollbars(cm),display.maxLineChanged&&!cm.options.lineWrapping&&(op.adjustWidthTo=measureChar(cm,display.maxLine,display.maxLine.text.length).left+3,cm.display.sizerWidth=op.adjustWidthTo,op.barMeasure.scrollWidth=Math.max(display.scroller.clientWidth,display.sizer.offsetLeft+op.adjustWidthTo+scrollGap(cm)+cm.display.barWidth),op.maxScrollLeft=Math.max(0,display.sizer.offsetLeft+op.adjustWidthTo-displayWidth(cm))),(op.updatedDisplay||op.selectionChanged)&&(op.preparedSelection=display.input.prepareSelection())}function endOperation_W2(op){var cm=op.cm;null!=op.adjustWidthTo&&(cm.display.sizer.style.minWidth=op.adjustWidthTo+"px",op.maxScrollLeft<cm.doc.scrollLeft&&setScrollLeft(cm,Math.min(cm.display.scroller.scrollLeft,op.maxScrollLeft),!0),cm.display.maxLineChanged=!1),op.preparedSelection&&cm.display.input.showSelection(op.preparedSelection),op.updatedDisplay&&setDocumentHeight(cm,op.barMeasure),(op.updatedDisplay||op.startHeight!=cm.doc.height)&&updateScrollbars(cm,op.barMeasure),op.selectionChanged&&restartBlink(cm),cm.state.focused&&op.updateInput&&cm.display.input.reset(op.typing),op.focus&&op.focus==activeElt()&&ensureFocus(op.cm)}function endOperation_finish(op){var cm=op.cm,display=cm.display,doc=cm.doc;if(op.updatedDisplay&&postUpdateDisplay(cm,op.update),null==display.wheelStartX||null==op.scrollTop&&null==op.scrollLeft&&!op.scrollToPos||(display.wheelStartX=display.wheelStartY=null),null==op.scrollTop||display.scroller.scrollTop==op.scrollTop&&!op.forceScroll||(doc.scrollTop=Math.max(0,Math.min(display.scroller.scrollHeight-display.scroller.clientHeight,op.scrollTop)),display.scrollbars.setScrollTop(doc.scrollTop),display.scroller.scrollTop=doc.scrollTop),null==op.scrollLeft||display.scroller.scrollLeft==op.scrollLeft&&!op.forceScroll||(doc.scrollLeft=Math.max(0,Math.min(display.scroller.scrollWidth-displayWidth(cm),op.scrollLeft)),display.scrollbars.setScrollLeft(doc.scrollLeft),display.scroller.scrollLeft=doc.scrollLeft,alignHorizontally(cm)),op.scrollToPos){var coords=scrollPosIntoView(cm,clipPos(doc,op.scrollToPos.from),clipPos(doc,op.scrollToPos.to),op.scrollToPos.margin);op.scrollToPos.isCursor&&cm.state.focused&&maybeScrollWindow(cm,coords)}var hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden)for(var i=0;i<hidden.length;++i)hidden[i].lines.length||signal(hidden[i],"hide");if(unhidden)for(var i=0;i<unhidden.length;++i)unhidden[i].lines.length&&signal(unhidden[i],"unhide");display.wrapper.offsetHeight&&(doc.scrollTop=cm.display.scroller.scrollTop),op.changeObjs&&signal(cm,"changes",cm,op.changeObjs),op.update&&op.update.finish()}function runInOp(cm,f){if(cm.curOp)return f();startOperation(cm);try{return f()}finally{endOperation(cm)}}function operation(cm,f){return function(){if(cm.curOp)return f.apply(cm,arguments);startOperation(cm);try{return f.apply(cm,arguments)}finally{endOperation(cm)}}}function methodOp(f){return function(){if(this.curOp)return f.apply(this,arguments);startOperation(this);try{return f.apply(this,arguments)}finally{endOperation(this)}}}function docMethodOp(f){return function(){var cm=this.cm;if(!cm||cm.curOp)return f.apply(this,arguments);startOperation(cm);try{return f.apply(this,arguments)}finally{endOperation(cm)}}}function LineView(doc,line,lineN){this.line=line,this.rest=visualLineContinued(line),this.size=this.rest?lineNo(lst(this.rest))-lineN+1:1,this.node=this.text=null,this.hidden=lineIsHidden(doc,line)}function buildViewArray(cm,from,to){for(var nextPos,array=[],pos=from;to>pos;pos=nextPos){var view=new LineView(cm.doc,getLine(cm.doc,pos),pos);nextPos=pos+view.size,array.push(view)}return array}function regChange(cm,from,to,lendiff){null==from&&(from=cm.doc.first),null==to&&(to=cm.doc.first+cm.doc.size),lendiff||(lendiff=0);var display=cm.display;if(lendiff&&to<display.viewTo&&(null==display.updateLineNumbers||display.updateLineNumbers>from)&&(display.updateLineNumbers=from),cm.curOp.viewChanged=!0,from>=display.viewTo)sawCollapsedSpans&&visualLineNo(cm.doc,from)<display.viewTo&&resetView(cm);else if(to<=display.viewFrom)sawCollapsedSpans&&visualLineEndNo(cm.doc,to+lendiff)>display.viewFrom?resetView(cm):(display.viewFrom+=lendiff,display.viewTo+=lendiff);else if(from<=display.viewFrom&&to>=display.viewTo)resetView(cm);else if(from<=display.viewFrom){var cut=viewCuttingPoint(cm,to,to+lendiff,1);cut?(display.view=display.view.slice(cut.index),display.viewFrom=cut.lineN,display.viewTo+=lendiff):resetView(cm)}else if(to>=display.viewTo){var cut=viewCuttingPoint(cm,from,from,-1);cut?(display.view=display.view.slice(0,cut.index),display.viewTo=cut.lineN):resetView(cm)}else{var cutTop=viewCuttingPoint(cm,from,from,-1),cutBot=viewCuttingPoint(cm,to,to+lendiff,1);cutTop&&cutBot?(display.view=display.view.slice(0,cutTop.index).concat(buildViewArray(cm,cutTop.lineN,cutBot.lineN)).concat(display.view.slice(cutBot.index)),display.viewTo+=lendiff):resetView(cm)}var ext=display.externalMeasured;ext&&(to<ext.lineN?ext.lineN+=lendiff:from<ext.lineN+ext.size&&(display.externalMeasured=null))}function regLineChange(cm,line,type){cm.curOp.viewChanged=!0;var display=cm.display,ext=cm.display.externalMeasured;if(ext&&line>=ext.lineN&&line<ext.lineN+ext.size&&(display.externalMeasured=null),!(line<display.viewFrom||line>=display.viewTo)){var lineView=display.view[findViewIndex(cm,line)];if(null!=lineView.node){var arr=lineView.changes||(lineView.changes=[]);-1==indexOf(arr,type)&&arr.push(type)}}}function resetView(cm){cm.display.viewFrom=cm.display.viewTo=cm.doc.first,cm.display.view=[],cm.display.viewOffset=0}function findViewIndex(cm,n){if(n>=cm.display.viewTo)return null;if(n-=cm.display.viewFrom,0>n)return null;for(var view=cm.display.view,i=0;i<view.length;i++)if(n-=view[i].size,0>n)return i}function viewCuttingPoint(cm,oldN,newN,dir){var diff,index=findViewIndex(cm,oldN),view=cm.display.view;if(!sawCollapsedSpans||newN==cm.doc.first+cm.doc.size)return{index:index,lineN:newN};for(var i=0,n=cm.display.viewFrom;index>i;i++)n+=view[i].size;if(n!=oldN){if(dir>0){if(index==view.length-1)return null;diff=n+view[index].size-oldN,index++}else diff=n-oldN;oldN+=diff,newN+=diff}for(;visualLineNo(cm.doc,newN)!=newN;){if(index==(0>dir?0:view.length-1))return null;newN+=dir*view[index-(0>dir?1:0)].size,index+=dir}return{index:index,lineN:newN}}function adjustView(cm,from,to){var display=cm.display,view=display.view;0==view.length||from>=display.viewTo||to<=display.viewFrom?(display.view=buildViewArray(cm,from,to),display.viewFrom=from):(display.viewFrom>from?display.view=buildViewArray(cm,from,display.viewFrom).concat(display.view):display.viewFrom<from&&(display.view=display.view.slice(findViewIndex(cm,from))),display.viewFrom=from,display.viewTo<to?display.view=display.view.concat(buildViewArray(cm,display.viewTo,to)):display.viewTo>to&&(display.view=display.view.slice(0,findViewIndex(cm,to)))),display.viewTo=to}function countDirtyView(cm){for(var view=cm.display.view,dirty=0,i=0;i<view.length;i++){var lineView=view[i];lineView.hidden||lineView.node&&!lineView.changes||++dirty}return dirty}function registerEventHandlers(cm){function finishTouch(){d.activeTouch&&(touchFinished=setTimeout(function(){d.activeTouch=null},1e3),prevTouch=d.activeTouch,prevTouch.end=+new Date)}function isMouseLikeTouchEvent(e){if(1!=e.touches.length)return!1;var touch=e.touches[0];return touch.radiusX<=1&&touch.radiusY<=1}function farAway(touch,other){if(null==other.left)return!0;var dx=other.left-touch.left,dy=other.top-touch.top;return dx*dx+dy*dy>400}var d=cm.display;on(d.scroller,"mousedown",operation(cm,onMouseDown)),ie&&11>ie_version?on(d.scroller,"dblclick",operation(cm,function(e){if(!signalDOMEvent(cm,e)){var pos=posFromMouse(cm,e);if(pos&&!clickInGutter(cm,e)&&!eventInWidget(cm.display,e)){e_preventDefault(e);var word=cm.findWordAt(pos);extendSelection(cm.doc,word.anchor,word.head)}}})):on(d.scroller,"dblclick",function(e){signalDOMEvent(cm,e)||e_preventDefault(e)}),captureRightClick||on(d.scroller,"contextmenu",function(e){onContextMenu(cm,e)});var touchFinished,prevTouch={end:0};on(d.scroller,"touchstart",function(e){if(!isMouseLikeTouchEvent(e)){clearTimeout(touchFinished);var now=+new Date;d.activeTouch={start:now,moved:!1,prev:now-prevTouch.end<=300?prevTouch:null},1==e.touches.length&&(d.activeTouch.left=e.touches[0].pageX,d.activeTouch.top=e.touches[0].pageY)}}),on(d.scroller,"touchmove",function(){d.activeTouch&&(d.activeTouch.moved=!0)}),on(d.scroller,"touchend",function(e){var touch=d.activeTouch;if(touch&&!eventInWidget(d,e)&&null!=touch.left&&!touch.moved&&new Date-touch.start<300){var range,pos=cm.coordsChar(d.activeTouch,"page");range=!touch.prev||farAway(touch,touch.prev)?new Range(pos,pos):!touch.prev.prev||farAway(touch,touch.prev.prev)?cm.findWordAt(pos):new Range(Pos(pos.line,0),clipPos(cm.doc,Pos(pos.line+1,0))),cm.setSelection(range.anchor,range.head),cm.focus(),e_preventDefault(e)}finishTouch()}),on(d.scroller,"touchcancel",finishTouch),on(d.scroller,"scroll",function(){d.scroller.clientHeight&&(setScrollTop(cm,d.scroller.scrollTop),setScrollLeft(cm,d.scroller.scrollLeft,!0),signal(cm,"scroll",cm))}),on(d.scroller,"mousewheel",function(e){onScrollWheel(cm,e)}),on(d.scroller,"DOMMouseScroll",function(e){onScrollWheel(cm,e)}),on(d.wrapper,"scroll",function(){d.wrapper.scrollTop=d.wrapper.scrollLeft=0}),d.dragFunctions={enter:function(e){signalDOMEvent(cm,e)||e_stop(e)},over:function(e){signalDOMEvent(cm,e)||(onDragOver(cm,e),e_stop(e))},start:function(e){onDragStart(cm,e)},drop:operation(cm,onDrop),leave:function(){clearDragCursor(cm)}};var inp=d.input.getField();on(inp,"keyup",function(e){onKeyUp.call(cm,e)}),on(inp,"keydown",operation(cm,onKeyDown)),on(inp,"keypress",operation(cm,onKeyPress)),on(inp,"focus",bind(onFocus,cm)),on(inp,"blur",bind(onBlur,cm))}function dragDropChanged(cm,value,old){var wasOn=old&&old!=CodeMirror.Init;if(!value!=!wasOn){var funcs=cm.display.dragFunctions,toggle=value?on:off;toggle(cm.display.scroller,"dragstart",funcs.start),toggle(cm.display.scroller,"dragenter",funcs.enter),toggle(cm.display.scroller,"dragover",funcs.over),toggle(cm.display.scroller,"dragleave",funcs.leave),toggle(cm.display.scroller,"drop",funcs.drop)}}function onResize(cm){var d=cm.display;(d.lastWrapHeight!=d.wrapper.clientHeight||d.lastWrapWidth!=d.wrapper.clientWidth)&&(d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null,d.scrollbarsClipped=!1,cm.setSize())}function eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==display.sizer&&n!=display.mover)return!0}function posFromMouse(cm,e,liberal,forRect){var display=cm.display;if(!liberal&&"true"==e_target(e).getAttribute("cm-not-content"))return null;var x,y,space=display.lineSpace.getBoundingClientRect();try{x=e.clientX-space.left,y=e.clientY-space.top}catch(e){return null}var line,coords=coordsChar(cm,x,y);if(forRect&&1==coords.xRel&&(line=getLine(cm.doc,coords.line).text).length==coords.ch){var colDiff=countColumn(line,line.length,cm.options.tabSize)-line.length;coords=Pos(coords.line,Math.max(0,Math.round((x-paddingH(cm.display).left)/charWidth(cm.display))-colDiff))}return coords}function onMouseDown(e){var cm=this,display=cm.display;if(!(display.activeTouch&&display.input.supportsTouch()||signalDOMEvent(cm,e))){if(display.shift=e.shiftKey,eventInWidget(display,e))return void(webkit||(display.scroller.draggable=!1,setTimeout(function(){display.scroller.draggable=!0},100)));if(!clickInGutter(cm,e)){var start=posFromMouse(cm,e);switch(window.focus(),e_button(e)){case 1:cm.state.selectingText?cm.state.selectingText(e):start?leftButtonDown(cm,e,start):e_target(e)==display.scroller&&e_preventDefault(e);break;case 2:webkit&&(cm.state.lastMiddleDown=+new Date),start&&extendSelection(cm.doc,start),setTimeout(function(){display.input.focus()},20),e_preventDefault(e);break;case 3:captureRightClick?onContextMenu(cm,e):delayBlurEvent(cm)}}}}function leftButtonDown(cm,e,start){ie?setTimeout(bind(ensureFocus,cm),0):cm.curOp.focus=activeElt();var type,now=+new Date;lastDoubleClick&&lastDoubleClick.time>now-400&&0==cmp(lastDoubleClick.pos,start)?type="triple":lastClick&&lastClick.time>now-400&&0==cmp(lastClick.pos,start)?(type="double",lastDoubleClick={time:now,pos:start}):(type="single",lastClick={time:now,pos:start});var contained,sel=cm.doc.sel,modifier=mac?e.metaKey:e.ctrlKey;cm.options.dragDrop&&dragAndDrop&&!isReadOnly(cm)&&"single"==type&&(contained=sel.contains(start))>-1&&(cmp((contained=sel.ranges[contained]).from(),start)<0||start.xRel>0)&&(cmp(contained.to(),start)>0||start.xRel<0)?leftButtonStartDrag(cm,e,start,modifier):leftButtonSelect(cm,e,start,type,modifier)}function leftButtonStartDrag(cm,e,start,modifier){var display=cm.display,startTime=+new Date,dragEnd=operation(cm,function(e2){webkit&&(display.scroller.draggable=!1),cm.state.draggingText=!1,off(document,"mouseup",dragEnd),off(display.scroller,"drop",dragEnd),Math.abs(e.clientX-e2.clientX)+Math.abs(e.clientY-e2.clientY)<10&&(e_preventDefault(e2),!modifier&&+new Date-200<startTime&&extendSelection(cm.doc,start),webkit||ie&&9==ie_version?setTimeout(function(){document.body.focus(),display.input.focus()},20):display.input.focus())});webkit&&(display.scroller.draggable=!0),cm.state.draggingText=dragEnd,display.scroller.dragDrop&&display.scroller.dragDrop(),on(document,"mouseup",dragEnd),on(display.scroller,"drop",dragEnd)}function leftButtonSelect(cm,e,start,type,addNew){function extendTo(pos){if(0!=cmp(lastPos,pos))if(lastPos=pos,"rect"==type){for(var ranges=[],tabSize=cm.options.tabSize,startCol=countColumn(getLine(doc,start.line).text,start.ch,tabSize),posCol=countColumn(getLine(doc,pos.line).text,pos.ch,tabSize),left=Math.min(startCol,posCol),right=Math.max(startCol,posCol),line=Math.min(start.line,pos.line),end=Math.min(cm.lastLine(),Math.max(start.line,pos.line));end>=line;line++){var text=getLine(doc,line).text,leftPos=findColumn(text,left,tabSize);left==right?ranges.push(new Range(Pos(line,leftPos),Pos(line,leftPos))):text.length>leftPos&&ranges.push(new Range(Pos(line,leftPos),Pos(line,findColumn(text,right,tabSize))))}ranges.length||ranges.push(new Range(start,start)),setSelection(doc,normalizeSelection(startSel.ranges.slice(0,ourIndex).concat(ranges),ourIndex),{origin:"*mouse",scroll:!1}),cm.scrollIntoView(pos)}else{var oldRange=ourRange,anchor=oldRange.anchor,head=pos;if("single"!=type){if("double"==type)var range=cm.findWordAt(pos);else var range=new Range(Pos(pos.line,0),clipPos(doc,Pos(pos.line+1,0)));cmp(range.anchor,anchor)>0?(head=range.head,anchor=minPos(oldRange.from(),range.anchor)):(head=range.anchor,anchor=maxPos(oldRange.to(),range.head))}var ranges=startSel.ranges.slice(0);ranges[ourIndex]=new Range(clipPos(doc,anchor),head),setSelection(doc,normalizeSelection(ranges,ourIndex),sel_mouse)}}function extend(e){var curCount=++counter,cur=posFromMouse(cm,e,!0,"rect"==type);if(cur)if(0!=cmp(cur,lastPos)){cm.curOp.focus=activeElt(),extendTo(cur);var visible=visibleLines(display,doc);(cur.line>=visible.to||cur.line<visible.from)&&setTimeout(operation(cm,function(){counter==curCount&&extend(e)}),150)}else{var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;outside&&setTimeout(operation(cm,function(){counter==curCount&&(display.scroller.scrollTop+=outside,extend(e))}),50)}}function done(e){cm.state.selectingText=!1,counter=1/0,e_preventDefault(e),display.input.focus(),off(document,"mousemove",move),off(document,"mouseup",up),doc.history.lastSelOrigin=null}var display=cm.display,doc=cm.doc;e_preventDefault(e);var ourRange,ourIndex,startSel=doc.sel,ranges=startSel.ranges;if(addNew&&!e.shiftKey?(ourIndex=doc.sel.contains(start),ourRange=ourIndex>-1?ranges[ourIndex]:new Range(start,start)):(ourRange=doc.sel.primary(),ourIndex=doc.sel.primIndex),e.altKey)type="rect",addNew||(ourRange=new Range(start,start)),start=posFromMouse(cm,e,!0,!0),ourIndex=-1;else if("double"==type){var word=cm.findWordAt(start);ourRange=cm.display.shift||doc.extend?extendRange(doc,ourRange,word.anchor,word.head):word}else if("triple"==type){var line=new Range(Pos(start.line,0),clipPos(doc,Pos(start.line+1,0)));ourRange=cm.display.shift||doc.extend?extendRange(doc,ourRange,line.anchor,line.head):line}else ourRange=extendRange(doc,ourRange,start);addNew?-1==ourIndex?(ourIndex=ranges.length,setSelection(doc,normalizeSelection(ranges.concat([ourRange]),ourIndex),{scroll:!1,origin:"*mouse"})):ranges.length>1&&ranges[ourIndex].empty()&&"single"==type&&!e.shiftKey?(setSelection(doc,normalizeSelection(ranges.slice(0,ourIndex).concat(ranges.slice(ourIndex+1)),0),{scroll:!1,origin:"*mouse"}),startSel=doc.sel):replaceOneSelection(doc,ourIndex,ourRange,sel_mouse):(ourIndex=0,setSelection(doc,new Selection([ourRange],0),sel_mouse),startSel=doc.sel);var lastPos=start,editorSize=display.wrapper.getBoundingClientRect(),counter=0,move=operation(cm,function(e){e_button(e)?extend(e):done(e)}),up=operation(cm,done);cm.state.selectingText=up,on(document,"mousemove",move),on(document,"mouseup",up)}function gutterEvent(cm,e,type,prevent,signalfn){try{var mX=e.clientX,mY=e.clientY}catch(e){return!1}if(mX>=Math.floor(cm.display.gutters.getBoundingClientRect().right))return!1;prevent&&e_preventDefault(e);var display=cm.display,lineBox=display.lineDiv.getBoundingClientRect();if(mY>lineBox.bottom||!hasHandler(cm,type))return e_defaultPrevented(e);mY-=lineBox.top-display.viewOffset;for(var i=0;i<cm.options.gutters.length;++i){var g=display.gutters.childNodes[i];if(g&&g.getBoundingClientRect().right>=mX){var line=lineAtHeight(cm.doc,mY),gutter=cm.options.gutters[i];return signalfn(cm,type,cm,line,gutter,e),e_defaultPrevented(e)}}}function clickInGutter(cm,e){return gutterEvent(cm,e,"gutterClick",!0,signalLater)}function onDrop(e){var cm=this;if(clearDragCursor(cm),!signalDOMEvent(cm,e)&&!eventInWidget(cm.display,e)){e_preventDefault(e),ie&&(lastDrop=+new Date);var pos=posFromMouse(cm,e,!0),files=e.dataTransfer.files;if(pos&&!isReadOnly(cm))if(files&&files.length&&window.FileReader&&window.File)for(var n=files.length,text=Array(n),read=0,loadFile=function(file,i){if(!cm.options.allowDropFileTypes||-1!=indexOf(cm.options.allowDropFileTypes,file.type)){var reader=new FileReader;reader.onload=operation(cm,function(){var content=reader.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(content)&&(content=""),text[i]=content,++read==n){pos=clipPos(cm.doc,pos);var change={from:pos,to:pos,text:cm.doc.splitLines(text.join(cm.doc.lineSeparator())),origin:"paste"};makeChange(cm.doc,change),setSelectionReplaceHistory(cm.doc,simpleSelection(pos,changeEnd(change)))}}),reader.readAsText(file)}},i=0;n>i;++i)loadFile(files[i],i);else{if(cm.state.draggingText&&cm.doc.sel.contains(pos)>-1)return cm.state.draggingText(e),void setTimeout(function(){cm.display.input.focus()},20);try{var text=e.dataTransfer.getData("Text");if(text){if(cm.state.draggingText&&!(mac?e.altKey:e.ctrlKey))var selected=cm.listSelections();if(setSelectionNoUndo(cm.doc,simpleSelection(pos,pos)),selected)for(var i=0;i<selected.length;++i)replaceRange(cm.doc,"",selected[i].anchor,selected[i].head,"drag");cm.replaceSelection(text,"around","paste"),cm.display.input.focus()}}catch(e){}}}}function onDragStart(cm,e){if(ie&&(!cm.state.draggingText||+new Date-lastDrop<100))return void e_stop(e);if(!signalDOMEvent(cm,e)&&!eventInWidget(cm.display,e)&&(e.dataTransfer.setData("Text",cm.getSelection()),e.dataTransfer.setDragImage&&!safari)){var img=elt("img",null,null,"position: fixed; left: 0; top: 0;");img.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",presto&&(img.width=img.height=1,cm.display.wrapper.appendChild(img),img._top=img.offsetTop),e.dataTransfer.setDragImage(img,0,0),presto&&img.parentNode.removeChild(img)}}function onDragOver(cm,e){var pos=posFromMouse(cm,e);if(pos){var frag=document.createDocumentFragment();drawSelectionCursor(cm,pos,frag),cm.display.dragCursor||(cm.display.dragCursor=elt("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),cm.display.lineSpace.insertBefore(cm.display.dragCursor,cm.display.cursorDiv)),removeChildrenAndAdd(cm.display.dragCursor,frag)}}function clearDragCursor(cm){cm.display.dragCursor&&(cm.display.lineSpace.removeChild(cm.display.dragCursor),cm.display.dragCursor=null)}function setScrollTop(cm,val){Math.abs(cm.doc.scrollTop-val)<2||(cm.doc.scrollTop=val,gecko||updateDisplaySimple(cm,{top:val}),cm.display.scroller.scrollTop!=val&&(cm.display.scroller.scrollTop=val),cm.display.scrollbars.setScrollTop(val),gecko&&updateDisplaySimple(cm),startWorker(cm,100))}function setScrollLeft(cm,val,isScroller){(isScroller?val==cm.doc.scrollLeft:Math.abs(cm.doc.scrollLeft-val)<2)||(val=Math.min(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth),cm.doc.scrollLeft=val,alignHorizontally(cm),cm.display.scroller.scrollLeft!=val&&(cm.display.scroller.scrollLeft=val),cm.display.scrollbars.setScrollLeft(val))}function onScrollWheel(cm,e){var delta=wheelEventDelta(e),dx=delta.x,dy=delta.y,display=cm.display,scroll=display.scroller,canScrollX=scroll.scrollWidth>scroll.clientWidth,canScrollY=scroll.scrollHeight>scroll.clientHeight;if(dx&&canScrollX||dy&&canScrollY){if(dy&&mac&&webkit)outer:for(var cur=e.target,view=display.view;cur!=scroll;cur=cur.parentNode)for(var i=0;i<view.length;i++)if(view[i].node==cur){cm.display.currentWheelTarget=cur;break outer}if(dx&&!gecko&&!presto&&null!=wheelPixelsPerUnit)return dy&&canScrollY&&setScrollTop(cm,Math.max(0,Math.min(scroll.scrollTop+dy*wheelPixelsPerUnit,scroll.scrollHeight-scroll.clientHeight))),setScrollLeft(cm,Math.max(0,Math.min(scroll.scrollLeft+dx*wheelPixelsPerUnit,scroll.scrollWidth-scroll.clientWidth))),(!dy||dy&&canScrollY)&&e_preventDefault(e),void(display.wheelStartX=null);if(dy&&null!=wheelPixelsPerUnit){var pixels=dy*wheelPixelsPerUnit,top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;0>pixels?top=Math.max(0,top+pixels-50):bot=Math.min(cm.doc.height,bot+pixels+50),updateDisplaySimple(cm,{top:top,bottom:bot})}20>wheelSamples&&(null==display.wheelStartX?(display.wheelStartX=scroll.scrollLeft,display.wheelStartY=scroll.scrollTop,display.wheelDX=dx,display.wheelDY=dy,setTimeout(function(){if(null!=display.wheelStartX){var movedX=scroll.scrollLeft-display.wheelStartX,movedY=scroll.scrollTop-display.wheelStartY,sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null,sample&&(wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1),++wheelSamples)}},200)):(display.wheelDX+=dx,display.wheelDY+=dy))}}function doHandleBinding(cm,bound,dropShift){if("string"==typeof bound&&(bound=commands[bound],!bound))return!1;cm.display.input.ensurePolled();var prevShift=cm.display.shift,done=!1;try{isReadOnly(cm)&&(cm.state.suppressEdits=!0),dropShift&&(cm.display.shift=!1),done=bound(cm)!=Pass}finally{cm.display.shift=prevShift,cm.state.suppressEdits=!1}return done}function lookupKeyForEditor(cm,name,handle){for(var i=0;i<cm.state.keyMaps.length;i++){var result=lookupKey(name,cm.state.keyMaps[i],handle,cm);if(result)return result}return cm.options.extraKeys&&lookupKey(name,cm.options.extraKeys,handle,cm)||lookupKey(name,cm.options.keyMap,handle,cm)}function dispatchKey(cm,name,e,handle){var seq=cm.state.keySeq;if(seq){if(isModifierKey(name))return"handled";stopSeq.set(50,function(){cm.state.keySeq==seq&&(cm.state.keySeq=null,cm.display.input.reset())}),name=seq+" "+name}var result=lookupKeyForEditor(cm,name,handle);return"multi"==result&&(cm.state.keySeq=name),"handled"==result&&signalLater(cm,"keyHandled",cm,name,e),("handled"==result||"multi"==result)&&(e_preventDefault(e),restartBlink(cm)),seq&&!result&&/\'$/.test(name)?(e_preventDefault(e),!0):!!result}function handleKeyBinding(cm,e){var name=keyName(e,!0);return name?e.shiftKey&&!cm.state.keySeq?dispatchKey(cm,"Shift-"+name,e,function(b){return doHandleBinding(cm,b,!0)})||dispatchKey(cm,name,e,function(b){return("string"==typeof b?/^go[A-Z]/.test(b):b.motion)?doHandleBinding(cm,b):void 0}):dispatchKey(cm,name,e,function(b){return doHandleBinding(cm,b)}):!1}function handleCharBinding(cm,e,ch){return dispatchKey(cm,"'"+ch+"'",e,function(b){return doHandleBinding(cm,b,!0)})}function onKeyDown(e){var cm=this;if(cm.curOp.focus=activeElt(),!signalDOMEvent(cm,e)){ie&&11>ie_version&&27==e.keyCode&&(e.returnValue=!1);var code=e.keyCode;cm.display.shift=16==code||e.shiftKey;var handled=handleKeyBinding(cm,e);presto&&(lastStoppedKey=handled?code:null,!handled&&88==code&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey)&&cm.replaceSelection("",null,"cut")),18!=code||/\bCodeMirror-crosshair\b/.test(cm.display.lineDiv.className)||showCrossHair(cm)}}function showCrossHair(cm){function up(e){18!=e.keyCode&&e.altKey||(rmClass(lineDiv,"CodeMirror-crosshair"),off(document,"keyup",up),off(document,"mouseover",up))}var lineDiv=cm.display.lineDiv;addClass(lineDiv,"CodeMirror-crosshair"),on(document,"keyup",up),on(document,"mouseover",up)}function onKeyUp(e){16==e.keyCode&&(this.doc.sel.shift=!1),signalDOMEvent(this,e)}function onKeyPress(e){var cm=this;if(!(eventInWidget(cm.display,e)||signalDOMEvent(cm,e)||e.ctrlKey&&!e.altKey||mac&&e.metaKey)){var keyCode=e.keyCode,charCode=e.charCode;if(presto&&keyCode==lastStoppedKey)return lastStoppedKey=null,void e_preventDefault(e);if(!presto||e.which&&!(e.which<10)||!handleKeyBinding(cm,e)){var ch=String.fromCharCode(null==charCode?keyCode:charCode);handleCharBinding(cm,e,ch)||cm.display.input.onKeyPress(e)}}}function delayBlurEvent(cm){cm.state.delayingBlurEvent=!0,setTimeout(function(){cm.state.delayingBlurEvent&&(cm.state.delayingBlurEvent=!1,onBlur(cm))},100)}function onFocus(cm){cm.state.delayingBlurEvent&&(cm.state.delayingBlurEvent=!1),"nocursor"!=cm.options.readOnly&&(cm.state.focused||(signal(cm,"focus",cm),cm.state.focused=!0,addClass(cm.display.wrapper,"CodeMirror-focused"),cm.curOp||cm.display.selForContextMenu==cm.doc.sel||(cm.display.input.reset(),webkit&&setTimeout(function(){cm.display.input.reset(!0)},20)),cm.display.input.receivedFocus()),restartBlink(cm))}function onBlur(cm){cm.state.delayingBlurEvent||(cm.state.focused&&(signal(cm,"blur",cm),cm.state.focused=!1,rmClass(cm.display.wrapper,"CodeMirror-focused")),clearInterval(cm.display.blinker),setTimeout(function(){cm.state.focused||(cm.display.shift=!1)},150))}function onContextMenu(cm,e){eventInWidget(cm.display,e)||contextMenuInGutter(cm,e)||signalDOMEvent(cm,e,"contextmenu")||cm.display.input.onContextMenu(e)}function contextMenuInGutter(cm,e){return hasHandler(cm,"gutterContextMenu")?gutterEvent(cm,e,"gutterContextMenu",!1,signal):!1}function adjustForChange(pos,change){if(cmp(pos,change.from)<0)return pos;if(cmp(pos,change.to)<=0)return changeEnd(change);var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;return pos.line==change.to.line&&(ch+=changeEnd(change).ch-change.to.ch),Pos(line,ch)}function computeSelAfterChange(doc,change){for(var out=[],i=0;i<doc.sel.ranges.length;i++){var range=doc.sel.ranges[i];out.push(new Range(adjustForChange(range.anchor,change),adjustForChange(range.head,change)))}return normalizeSelection(out,doc.sel.primIndex)}function offsetPos(pos,old,nw){return pos.line==old.line?Pos(nw.line,pos.ch-old.ch+nw.ch):Pos(nw.line+(pos.line-old.line),pos.ch)
}function computeReplacedSel(doc,changes,hint){for(var out=[],oldPrev=Pos(doc.first,0),newPrev=oldPrev,i=0;i<changes.length;i++){var change=changes[i],from=offsetPos(change.from,oldPrev,newPrev),to=offsetPos(changeEnd(change),oldPrev,newPrev);if(oldPrev=change.to,newPrev=to,"around"==hint){var range=doc.sel.ranges[i],inv=cmp(range.head,range.anchor)<0;out[i]=new Range(inv?to:from,inv?from:to)}else out[i]=new Range(from,from)}return new Selection(out,doc.sel.primIndex)}function filterChange(doc,change,update){var obj={canceled:!1,from:change.from,to:change.to,text:change.text,origin:change.origin,cancel:function(){this.canceled=!0}};return update&&(obj.update=function(from,to,text,origin){from&&(this.from=clipPos(doc,from)),to&&(this.to=clipPos(doc,to)),text&&(this.text=text),void 0!==origin&&(this.origin=origin)}),signal(doc,"beforeChange",doc,obj),doc.cm&&signal(doc.cm,"beforeChange",doc.cm,obj),obj.canceled?null:{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin}}function makeChange(doc,change,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp)return operation(doc.cm,makeChange)(doc,change,ignoreReadOnly);if(doc.cm.state.suppressEdits)return}if(!(hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange"))||(change=filterChange(doc,change,!0))){var split=sawReadOnlySpans&&!ignoreReadOnly&&removeReadOnlyRanges(doc,change.from,change.to);if(split)for(var i=split.length-1;i>=0;--i)makeChangeInner(doc,{from:split[i].from,to:split[i].to,text:i?[""]:change.text});else makeChangeInner(doc,change)}}function makeChangeInner(doc,change){if(1!=change.text.length||""!=change.text[0]||0!=cmp(change.from,change.to)){var selAfter=computeSelAfterChange(doc,change);addChangeToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:0/0),makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){sharedHist||-1!=indexOf(rebased,doc.history)||(rebaseHist(doc.history,change),rebased.push(doc.history)),makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change))})}}function makeChangeFromHistory(doc,type,allowSelectionOnly){if(!doc.cm||!doc.cm.state.suppressEdits){for(var event,hist=doc.history,selAfter=doc.sel,source="undo"==type?hist.done:hist.undone,dest="undo"==type?hist.undone:hist.done,i=0;i<source.length&&(event=source[i],allowSelectionOnly?!event.ranges||event.equals(doc.sel):event.ranges);i++);if(i!=source.length){for(hist.lastOrigin=hist.lastSelOrigin=null;event=source.pop(),event.ranges;){if(pushSelectionToHistory(event,dest),allowSelectionOnly&&!event.equals(doc.sel))return void setSelection(doc,event,{clearRedo:!1});selAfter=event}var antiChanges=[];pushSelectionToHistory(selAfter,dest),dest.push({changes:antiChanges,generation:hist.generation}),hist.generation=event.generation||++hist.maxGeneration;for(var filter=hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange"),i=event.changes.length-1;i>=0;--i){var change=event.changes[i];if(change.origin=type,filter&&!filterChange(doc,change,!1))return void(source.length=0);antiChanges.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change):lst(source);makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change)),!i&&doc.cm&&doc.cm.scrollIntoView({from:change.from,to:changeEnd(change)});var rebased=[];linkedDocs(doc,function(doc,sharedHist){sharedHist||-1!=indexOf(rebased,doc.history)||(rebaseHist(doc.history,change),rebased.push(doc.history)),makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change))})}}}}function shiftDoc(doc,distance){if(0!=distance&&(doc.first+=distance,doc.sel=new Selection(map(doc.sel.ranges,function(range){return new Range(Pos(range.anchor.line+distance,range.anchor.ch),Pos(range.head.line+distance,range.head.ch))}),doc.sel.primIndex),doc.cm)){regChange(doc.cm,doc.first,doc.first-distance,distance);for(var d=doc.cm.display,l=d.viewFrom;l<d.viewTo;l++)regLineChange(doc.cm,l,"gutter")}}function makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans);if(change.to.line<doc.first)return void shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line));if(!(change.from.line>doc.lastLine())){if(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift),change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin}}var last=doc.lastLine();change.to.line>last&&(change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin}),change.removed=getBetween(doc,change.from,change.to),selAfter||(selAfter=computeSelAfterChange(doc,change)),doc.cm?makeChangeSingleDocInEditor(doc.cm,change,spans):updateDoc(doc,change,spans),setSelectionNoUndo(doc,selAfter,sel_dontScroll)}}function makeChangeSingleDocInEditor(cm,change,spans){var doc=cm.doc,display=cm.display,from=change.from,to=change.to,recomputeMaxLength=!1,checkWidthStart=from.line;cm.options.lineWrapping||(checkWidthStart=lineNo(visualLine(getLine(doc,from.line))),doc.iter(checkWidthStart,to.line+1,function(line){return line==display.maxLine?(recomputeMaxLength=!0,!0):void 0})),doc.sel.contains(change.from,change.to)>-1&&signalCursorActivity(cm),updateDoc(doc,change,spans,estimateHeight(cm)),cm.options.lineWrapping||(doc.iter(checkWidthStart,from.line+change.text.length,function(line){var len=lineLength(line);len>display.maxLineLength&&(display.maxLine=line,display.maxLineLength=len,display.maxLineChanged=!0,recomputeMaxLength=!1)}),recomputeMaxLength&&(cm.curOp.updateMaxLine=!0)),doc.frontier=Math.min(doc.frontier,from.line),startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;change.full?regChange(cm):from.line!=to.line||1!=change.text.length||isWholeLineUpdate(cm.doc,change)?regChange(cm,from.line,to.line+1,lendiff):regLineChange(cm,from.line,"text");var changesHandler=hasHandler(cm,"changes"),changeHandler=hasHandler(cm,"change");if(changeHandler||changesHandler){var obj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};changeHandler&&signalLater(cm,"change",cm,obj),changesHandler&&(cm.curOp.changeObjs||(cm.curOp.changeObjs=[])).push(obj)}cm.display.selForContextMenu=null}function replaceRange(doc,code,from,to,origin){if(to||(to=from),cmp(to,from)<0){var tmp=to;to=from,from=tmp}"string"==typeof code&&(code=doc.splitLines(code)),makeChange(doc,{from:from,to:to,text:code,origin:origin})}function maybeScrollWindow(cm,coords){if(!signalDOMEvent(cm,"scrollCursorIntoView")){var display=cm.display,box=display.sizer.getBoundingClientRect(),doScroll=null;if(coords.top+box.top<0?doScroll=!0:coords.bottom+box.top>(window.innerHeight||document.documentElement.clientHeight)&&(doScroll=!1),null!=doScroll&&!phantom){var scrollNode=elt("div","​",null,"position: absolute; top: "+(coords.top-display.viewOffset-paddingTop(cm.display))+"px; height: "+(coords.bottom-coords.top+scrollGap(cm)+display.barHeight)+"px; left: "+coords.left+"px; width: 2px;");cm.display.lineSpace.appendChild(scrollNode),scrollNode.scrollIntoView(doScroll),cm.display.lineSpace.removeChild(scrollNode)}}}function scrollPosIntoView(cm,pos,end,margin){null==margin&&(margin=0);for(var limit=0;5>limit;limit++){var changed=!1,coords=cursorCoords(cm,pos),endCoords=end&&end!=pos?cursorCoords(cm,end):coords,scrollPos=calculateScrollPos(cm,Math.min(coords.left,endCoords.left),Math.min(coords.top,endCoords.top)-margin,Math.max(coords.left,endCoords.left),Math.max(coords.bottom,endCoords.bottom)+margin),startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(null!=scrollPos.scrollTop&&(setScrollTop(cm,scrollPos.scrollTop),Math.abs(cm.doc.scrollTop-startTop)>1&&(changed=!0)),null!=scrollPos.scrollLeft&&(setScrollLeft(cm,scrollPos.scrollLeft),Math.abs(cm.doc.scrollLeft-startLeft)>1&&(changed=!0)),!changed)break}return coords}function scrollIntoView(cm,x1,y1,x2,y2){var scrollPos=calculateScrollPos(cm,x1,y1,x2,y2);null!=scrollPos.scrollTop&&setScrollTop(cm,scrollPos.scrollTop),null!=scrollPos.scrollLeft&&setScrollLeft(cm,scrollPos.scrollLeft)}function calculateScrollPos(cm,x1,y1,x2,y2){var display=cm.display,snapMargin=textHeight(cm.display);0>y1&&(y1=0);var screentop=cm.curOp&&null!=cm.curOp.scrollTop?cm.curOp.scrollTop:display.scroller.scrollTop,screen=displayHeight(cm),result={};y2-y1>screen&&(y2=y1+screen);var docBottom=cm.doc.height+paddingVert(display),atTop=snapMargin>y1,atBottom=y2>docBottom-snapMargin;if(screentop>y1)result.scrollTop=atTop?0:y1;else if(y2>screentop+screen){var newTop=Math.min(y1,(atBottom?docBottom:y2)-screen);newTop!=screentop&&(result.scrollTop=newTop)}var screenleft=cm.curOp&&null!=cm.curOp.scrollLeft?cm.curOp.scrollLeft:display.scroller.scrollLeft,screenw=displayWidth(cm)-(cm.options.fixedGutter?display.gutters.offsetWidth:0),tooWide=x2-x1>screenw;return tooWide&&(x2=x1+screenw),10>x1?result.scrollLeft=0:screenleft>x1?result.scrollLeft=Math.max(0,x1-(tooWide?0:10)):x2>screenw+screenleft-3&&(result.scrollLeft=x2+(tooWide?0:10)-screenw),result}function addToScrollPos(cm,left,top){(null!=left||null!=top)&&resolveScrollToPos(cm),null!=left&&(cm.curOp.scrollLeft=(null==cm.curOp.scrollLeft?cm.doc.scrollLeft:cm.curOp.scrollLeft)+left),null!=top&&(cm.curOp.scrollTop=(null==cm.curOp.scrollTop?cm.doc.scrollTop:cm.curOp.scrollTop)+top)}function ensureCursorVisible(cm){resolveScrollToPos(cm);var cur=cm.getCursor(),from=cur,to=cur;cm.options.lineWrapping||(from=cur.ch?Pos(cur.line,cur.ch-1):cur,to=Pos(cur.line,cur.ch+1)),cm.curOp.scrollToPos={from:from,to:to,margin:cm.options.cursorScrollMargin,isCursor:!0}}function resolveScrollToPos(cm){var range=cm.curOp.scrollToPos;if(range){cm.curOp.scrollToPos=null;var from=estimateCoords(cm,range.from),to=estimateCoords(cm,range.to),sPos=calculateScrollPos(cm,Math.min(from.left,to.left),Math.min(from.top,to.top)-range.margin,Math.max(from.right,to.right),Math.max(from.bottom,to.bottom)+range.margin);cm.scrollTo(sPos.scrollLeft,sPos.scrollTop)}}function indentLine(cm,n,how,aggressive){var state,doc=cm.doc;null==how&&(how="add"),"smart"==how&&(doc.mode.indent?state=getStateBefore(cm,n):how="prev");var tabSize=cm.options.tabSize,line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize);line.stateAfter&&(line.stateAfter=null);var indentation,curSpaceString=line.text.match(/^\s*/)[0];if(aggressive||/\S/.test(line.text)){if("smart"==how&&(indentation=doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text),indentation==Pass||indentation>150)){if(!aggressive)return;how="prev"}}else indentation=0,how="not";"prev"==how?indentation=n>doc.first?countColumn(getLine(doc,n-1).text,null,tabSize):0:"add"==how?indentation=curSpace+cm.options.indentUnit:"subtract"==how?indentation=curSpace-cm.options.indentUnit:"number"==typeof how&&(indentation=curSpace+how),indentation=Math.max(0,indentation);var indentString="",pos=0;if(cm.options.indentWithTabs)for(var i=Math.floor(indentation/tabSize);i;--i)pos+=tabSize,indentString+="	";if(indentation>pos&&(indentString+=spaceStr(indentation-pos)),indentString!=curSpaceString)return replaceRange(doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),"+input"),line.stateAfter=null,!0;for(var i=0;i<doc.sel.ranges.length;i++){var range=doc.sel.ranges[i];if(range.head.line==n&&range.head.ch<curSpaceString.length){var pos=Pos(n,curSpaceString.length);replaceOneSelection(doc,i,new Range(pos,pos));break}}}function changeLine(doc,handle,changeType,op){var no=handle,line=handle;return"number"==typeof handle?line=getLine(doc,clipLine(doc,handle)):no=lineNo(handle),null==no?null:(op(line,no)&&doc.cm&&regLineChange(doc.cm,no,changeType),line)}function deleteNearSelection(cm,compute){for(var ranges=cm.doc.sel.ranges,kill=[],i=0;i<ranges.length;i++){for(var toKill=compute(ranges[i]);kill.length&&cmp(toKill.from,lst(kill).to)<=0;){var replaced=kill.pop();if(cmp(replaced.from,toKill.from)<0){toKill.from=replaced.from;break}}kill.push(toKill)}runInOp(cm,function(){for(var i=kill.length-1;i>=0;i--)replaceRange(cm.doc,"",kill[i].from,kill[i].to,"+delete");ensureCursorVisible(cm)})}function findPosH(doc,pos,dir,unit,visually){function findNextLine(){var l=line+dir;return l<doc.first||l>=doc.first+doc.size?possible=!1:(line=l,lineObj=getLine(doc,l))}function moveOnce(boundToLine){var next=(visually?moveVisually:moveLogically)(lineObj,ch,dir,!0);if(null==next){if(boundToLine||!findNextLine())return possible=!1;ch=visually?(0>dir?lineRight:lineLeft)(lineObj):0>dir?lineObj.text.length:0}else ch=next;return!0}var line=pos.line,ch=pos.ch,origDir=dir,lineObj=getLine(doc,line),possible=!0;if("char"==unit)moveOnce();else if("column"==unit)moveOnce(!0);else if("word"==unit||"group"==unit)for(var sawType=null,group="group"==unit,helper=doc.cm&&doc.cm.getHelper(pos,"wordChars"),first=!0;!(0>dir)||moveOnce(!first);first=!1){var cur=lineObj.text.charAt(ch)||"\n",type=isWordChar(cur,helper)?"w":group&&"\n"==cur?"n":!group||/\s/.test(cur)?null:"p";if(!group||first||type||(type="s"),sawType&&sawType!=type){0>dir&&(dir=1,moveOnce());break}if(type&&(sawType=type),dir>0&&!moveOnce(!first))break}var result=skipAtomic(doc,Pos(line,ch),origDir,!0);return possible||(result.hitSide=!0),result}function findPosV(cm,pos,dir,unit){var y,doc=cm.doc,x=pos.left;if("page"==unit){var pageSize=Math.min(cm.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);y=pos.top+dir*(pageSize-(0>dir?1.5:.5)*textHeight(cm.display))}else"line"==unit&&(y=dir>0?pos.bottom+3:pos.top-3);for(;;){var target=coordsChar(cm,x,y);if(!target.outside)break;if(0>dir?0>=y:y>=doc.height){target.hitSide=!0;break}y+=5*dir}return target}function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt,handle&&(optionHandlers[name]=notOnInit?function(cm,val,old){old!=Init&&handle(cm,val,old)}:handle)}function normalizeKeyName(name){for(var alt,ctrl,shift,cmd,parts=name.split(/-(?!$)/),name=parts[parts.length-1],i=0;i<parts.length-1;i++){var mod=parts[i];if(/^(cmd|meta|m)$/i.test(mod))cmd=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else{if(!/^s(hift)$/i.test(mod))throw new Error("Unrecognized modifier name: "+mod);shift=!0}}return alt&&(name="Alt-"+name),ctrl&&(name="Ctrl-"+name),cmd&&(name="Cmd-"+name),shift&&(name="Shift-"+name),name}function getKeyMap(val){return"string"==typeof val?keyMap[val]:val}function markText(doc,from,to,options,type){if(options&&options.shared)return markTextShared(doc,from,to,options,type);if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,markText)(doc,from,to,options,type);var marker=new TextMarker(doc,type),diff=cmp(from,to);if(options&&copyObj(options,marker,!1),diff>0||0==diff&&marker.clearWhenEmpty!==!1)return marker;if(marker.replacedWith&&(marker.collapsed=!0,marker.widgetNode=elt("span",[marker.replacedWith],"CodeMirror-widget"),options.handleMouseEvents||marker.widgetNode.setAttribute("cm-ignore-events","true"),options.insertLeft&&(marker.widgetNode.insertLeft=!0)),marker.collapsed){if(conflictingCollapsedRange(doc,from.line,from,to,marker)||from.line!=to.line&&conflictingCollapsedRange(doc,to.line,from,to,marker))throw new Error("Inserting collapsed marker partially overlapping an existing one");sawCollapsedSpans=!0}marker.addToHistory&&addChangeToHistory(doc,{from:from,to:to,origin:"markText"},doc.sel,0/0);var updateMaxLine,curLine=from.line,cm=doc.cm;if(doc.iter(curLine,to.line+1,function(line){cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(line)==cm.display.maxLine&&(updateMaxLine=!0),marker.collapsed&&curLine!=from.line&&updateLineHeight(line,0),addMarkedSpan(line,new MarkedSpan(marker,curLine==from.line?from.ch:null,curLine==to.line?to.ch:null)),++curLine}),marker.collapsed&&doc.iter(from.line,to.line+1,function(line){lineIsHidden(doc,line)&&updateLineHeight(line,0)}),marker.clearOnEnter&&on(marker,"beforeCursorEnter",function(){marker.clear()}),marker.readOnly&&(sawReadOnlySpans=!0,(doc.history.done.length||doc.history.undone.length)&&doc.clearHistory()),marker.collapsed&&(marker.id=++nextMarkerId,marker.atomic=!0),cm){if(updateMaxLine&&(cm.curOp.updateMaxLine=!0),marker.collapsed)regChange(cm,from.line,to.line+1);else if(marker.className||marker.title||marker.startStyle||marker.endStyle||marker.css)for(var i=from.line;i<=to.line;i++)regLineChange(cm,i,"text");marker.atomic&&reCheckSelection(cm.doc),signalLater(cm,"markerAdded",cm,marker)}return marker}function markTextShared(doc,from,to,options,type){options=copyObj(options),options.shared=!1;var markers=[markText(doc,from,to,options,type)],primary=markers[0],widget=options.widgetNode;return linkedDocs(doc,function(doc){widget&&(options.widgetNode=widget.cloneNode(!0)),markers.push(markText(doc,clipPos(doc,from),clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i)if(doc.linked[i].isParent)return;primary=lst(markers)}),new SharedTextMarker(markers,primary)}function findSharedMarkers(doc){return doc.findMarks(Pos(doc.first,0),doc.clipPos(Pos(doc.lastLine())),function(m){return m.parent})}function copySharedMarkers(doc,markers){for(var i=0;i<markers.length;i++){var marker=markers[i],pos=marker.find(),mFrom=doc.clipPos(pos.from),mTo=doc.clipPos(pos.to);if(cmp(mFrom,mTo)){var subMark=markText(doc,mFrom,mTo,marker.primary,marker.primary.type);marker.markers.push(subMark),subMark.parent=marker}}}function detachSharedMarkers(markers){for(var i=0;i<markers.length;i++){var marker=markers[i],linked=[marker.primary.doc];linkedDocs(marker.primary.doc,function(d){linked.push(d)});for(var j=0;j<marker.markers.length;j++){var subMarker=marker.markers[j];-1==indexOf(linked,subMarker.doc)&&(subMarker.parent=null,marker.markers.splice(j--,1))}}}function MarkedSpan(marker,from,to){this.marker=marker,this.from=from,this.to=to}function getMarkedSpanFor(spans,marker){if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if(span.marker==marker)return span}}function removeMarkedSpan(spans,span){for(var r,i=0;i<spans.length;++i)spans[i]!=span&&(r||(r=[])).push(spans[i]);return r}function addMarkedSpan(line,span){line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span],span.marker.attachLine(line)}function markedSpansBefore(old,startCh,isInsert){if(old)for(var nw,i=0;i<old.length;++i){var span=old[i],marker=span.marker,startsBefore=null==span.from||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh);if(startsBefore||span.from==startCh&&"bookmark"==marker.type&&(!isInsert||!span.marker.insertLeft)){var endsAfter=null==span.to||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);(nw||(nw=[])).push(new MarkedSpan(marker,span.from,endsAfter?null:span.to))}}return nw}function markedSpansAfter(old,endCh,isInsert){if(old)for(var nw,i=0;i<old.length;++i){var span=old[i],marker=span.marker,endsAfter=null==span.to||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||span.from==endCh&&"bookmark"==marker.type&&(!isInsert||span.marker.insertLeft)){var startsBefore=null==span.from||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push(new MarkedSpan(marker,startsBefore?null:span.from-endCh,null==span.to?null:span.to-endCh))}}return nw}function stretchSpansOverChange(doc,change){if(change.full)return null;var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans,oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast)return null;var startCh=change.from.ch,endCh=change.to.ch,isInsert=0==cmp(change.from,change.to),first=markedSpansBefore(oldFirst,startCh,isInsert),last=markedSpansAfter(oldLast,endCh,isInsert),sameLine=1==change.text.length,offset=lst(change.text).length+(sameLine?startCh:0);if(first)for(var i=0;i<first.length;++i){var span=first[i];if(null==span.to){var found=getMarkedSpanFor(last,span.marker);found?sameLine&&(span.to=null==found.to?null:found.to+offset):span.to=startCh}}if(last)for(var i=0;i<last.length;++i){var span=last[i];if(null!=span.to&&(span.to+=offset),null==span.from){var found=getMarkedSpanFor(first,span.marker);found||(span.from=offset,sameLine&&(first||(first=[])).push(span))}else span.from+=offset,sameLine&&(first||(first=[])).push(span)}first&&(first=clearEmptySpans(first)),last&&last!=first&&(last=clearEmptySpans(last));var newMarkers=[first];if(!sameLine){var gapMarkers,gap=change.text.length-2;if(gap>0&&first)for(var i=0;i<first.length;++i)null==first[i].to&&(gapMarkers||(gapMarkers=[])).push(new MarkedSpan(first[i].marker,null,null));for(var i=0;gap>i;++i)newMarkers.push(gapMarkers);newMarkers.push(last)}return newMarkers}function clearEmptySpans(spans){for(var i=0;i<spans.length;++i){var span=spans[i];null!=span.from&&span.from==span.to&&span.marker.clearWhenEmpty!==!1&&spans.splice(i--,1)}return spans.length?spans:null}function mergeOldSpans(doc,change){var old=getOldSpans(doc,change),stretched=stretchSpansOverChange(doc,change);if(!old)return stretched;if(!stretched)return old;for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur)spans:for(var j=0;j<stretchCur.length;++j){for(var span=stretchCur[j],k=0;k<oldCur.length;++k)if(oldCur[k].marker==span.marker)continue spans;oldCur.push(span)}else stretchCur&&(old[i]=stretchCur)}return old}function removeReadOnlyRanges(doc,from,to){var markers=null;if(doc.iter(from.line,to.line+1,function(line){if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var mark=line.markedSpans[i].marker;!mark.readOnly||markers&&-1!=indexOf(markers,mark)||(markers||(markers=[])).push(mark)}}),!markers)return null;for(var parts=[{from:from,to:to}],i=0;i<markers.length;++i)for(var mk=markers[i],m=mk.find(0),j=0;j<parts.length;++j){var p=parts[j];if(!(cmp(p.to,m.from)<0||cmp(p.from,m.to)>0)){var newParts=[j,1],dfrom=cmp(p.from,m.from),dto=cmp(p.to,m.to);(0>dfrom||!mk.inclusiveLeft&&!dfrom)&&newParts.push({from:p.from,to:m.from}),(dto>0||!mk.inclusiveRight&&!dto)&&newParts.push({from:m.to,to:p.to}),parts.splice.apply(parts,newParts),j+=newParts.length-1}}return parts}function detachMarkedSpans(line){var spans=line.markedSpans;if(spans){for(var i=0;i<spans.length;++i)spans[i].marker.detachLine(line);line.markedSpans=null}}function attachMarkedSpans(line,spans){if(spans){for(var i=0;i<spans.length;++i)spans[i].marker.attachLine(line);line.markedSpans=spans}}function extraLeft(marker){return marker.inclusiveLeft?-1:0}function extraRight(marker){return marker.inclusiveRight?1:0}function compareCollapsedMarkers(a,b){var lenDiff=a.lines.length-b.lines.length;if(0!=lenDiff)return lenDiff;var aPos=a.find(),bPos=b.find(),fromCmp=cmp(aPos.from,bPos.from)||extraLeft(a)-extraLeft(b);if(fromCmp)return-fromCmp;var toCmp=cmp(aPos.to,bPos.to)||extraRight(a)-extraRight(b);return toCmp?toCmp:b.id-a.id}function collapsedSpanAtSide(line,start){var found,sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp,i=0;i<sps.length;++i)sp=sps[i],sp.marker.collapsed&&null==(start?sp.from:sp.to)&&(!found||compareCollapsedMarkers(found,sp.marker)<0)&&(found=sp.marker);return found}function collapsedSpanAtStart(line){return collapsedSpanAtSide(line,!0)}function collapsedSpanAtEnd(line){return collapsedSpanAtSide(line,!1)}function conflictingCollapsedRange(doc,lineNo,from,to,marker){var line=getLine(doc,lineNo),sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var i=0;i<sps.length;++i){var sp=sps[i];if(sp.marker.collapsed){var found=sp.marker.find(0),fromCmp=cmp(found.from,from)||extraLeft(sp.marker)-extraLeft(marker),toCmp=cmp(found.to,to)||extraRight(sp.marker)-extraRight(marker);if(!(fromCmp>=0&&0>=toCmp||0>=fromCmp&&toCmp>=0)&&(0>=fromCmp&&(cmp(found.to,from)>0||sp.marker.inclusiveRight&&marker.inclusiveLeft)||fromCmp>=0&&(cmp(found.from,to)<0||sp.marker.inclusiveLeft&&marker.inclusiveRight)))return!0}}}function visualLine(line){for(var merged;merged=collapsedSpanAtStart(line);)line=merged.find(-1,!0).line;return line}function visualLineContinued(line){for(var merged,lines;merged=collapsedSpanAtEnd(line);)line=merged.find(1,!0).line,(lines||(lines=[])).push(line);return lines}function visualLineNo(doc,lineN){var line=getLine(doc,lineN),vis=visualLine(line);return line==vis?lineN:lineNo(vis)}function visualLineEndNo(doc,lineN){if(lineN>doc.lastLine())return lineN;var merged,line=getLine(doc,lineN);if(!lineIsHidden(doc,line))return lineN;for(;merged=collapsedSpanAtEnd(line);)line=merged.find(1,!0).line;return lineNo(line)+1}function lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp,i=0;i<sps.length;++i)if(sp=sps[i],sp.marker.collapsed){if(null==sp.from)return!0;if(!sp.marker.widgetNode&&0==sp.from&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp))return!0}}function lineIsHiddenInner(doc,line,span){if(null==span.to){var end=span.marker.find(1,!0);return lineIsHiddenInner(doc,end.line,getMarkedSpanFor(end.line.markedSpans,span.marker))}if(span.marker.inclusiveRight&&span.to==line.text.length)return!0;for(var sp,i=0;i<line.markedSpans.length;++i)if(sp=line.markedSpans[i],sp.marker.collapsed&&!sp.marker.widgetNode&&sp.from==span.to&&(null==sp.to||sp.to!=span.from)&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp))return!0}function adjustScrollWhenAboveVisible(cm,line,diff){heightAtLine(line)<(cm.curOp&&cm.curOp.scrollTop||cm.doc.scrollTop)&&addToScrollPos(cm,null,diff)}function widgetHeight(widget){if(null!=widget.height)return widget.height;var cm=widget.doc.cm;if(!cm)return 0;if(!contains(document.body,widget.node)){var parentStyle="position: relative;";widget.coverGutter&&(parentStyle+="margin-left: -"+cm.display.gutters.offsetWidth+"px;"),widget.noHScroll&&(parentStyle+="width: "+cm.display.wrapper.clientWidth+"px;"),removeChildrenAndAdd(cm.display.measure,elt("div",[widget.node],null,parentStyle))}return widget.height=widget.node.offsetHeight}function addLineWidget(doc,handle,node,options){var widget=new LineWidget(doc,node,options),cm=doc.cm;return cm&&widget.noHScroll&&(cm.display.alignWidgets=!0),changeLine(doc,handle,"widget",function(line){var widgets=line.widgets||(line.widgets=[]);if(null==widget.insertAt?widgets.push(widget):widgets.splice(Math.min(widgets.length-1,Math.max(0,widget.insertAt)),0,widget),widget.line=line,cm&&!lineIsHidden(doc,line)){var aboveVisible=heightAtLine(line)<doc.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget)),aboveVisible&&addToScrollPos(cm,null,widget.height),cm.curOp.forceUpdate=!0}return!0}),widget}function updateLine(line,text,markedSpans,estimateHeight){line.text=text,line.stateAfter&&(line.stateAfter=null),line.styles&&(line.styles=null),null!=line.order&&(line.order=null),detachMarkedSpans(line),attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;estHeight!=line.height&&updateLineHeight(line,estHeight)}function cleanUpLine(line){line.parent=null,detachMarkedSpans(line)}function extractLineClasses(type,output){if(type)for(;;){var lineClass=type.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!lineClass)break;type=type.slice(0,lineClass.index)+type.slice(lineClass.index+lineClass[0].length);var prop=lineClass[1]?"bgClass":"textClass";null==output[prop]?output[prop]=lineClass[2]:new RegExp("(?:^|s)"+lineClass[2]+"(?:$|s)").test(output[prop])||(output[prop]+=" "+lineClass[2])}return type}function callBlankLine(mode,state){if(mode.blankLine)return mode.blankLine(state);if(mode.innerMode){var inner=CodeMirror.innerMode(mode,state);return inner.mode.blankLine?inner.mode.blankLine(inner.state):void 0}}function readToken(mode,stream,state,inner){for(var i=0;10>i;i++){inner&&(inner[0]=CodeMirror.innerMode(mode,state).mode);var style=mode.token(stream,state);if(stream.pos>stream.start)return style}throw new Error("Mode "+mode.name+" failed to advance stream.")}function takeToken(cm,pos,precise,asArray){function getObj(copy){return{start:stream.start,end:stream.pos,string:stream.current(),type:style||null,state:copy?copyState(doc.mode,state):state}}var style,doc=cm.doc,mode=doc.mode;pos=clipPos(doc,pos);var tokens,line=getLine(doc,pos.line),state=getStateBefore(cm,pos.line,precise),stream=new StringStream(line.text,cm.options.tabSize);for(asArray&&(tokens=[]);(asArray||stream.pos<pos.ch)&&!stream.eol();)stream.start=stream.pos,style=readToken(mode,stream,state),asArray&&tokens.push(getObj(!0));return asArray?tokens:getObj()}function runMode(cm,text,mode,state,f,lineClasses,forceToEnd){var flattenSpans=mode.flattenSpans;null==flattenSpans&&(flattenSpans=cm.options.flattenSpans);var style,curStart=0,curStyle=null,stream=new StringStream(text,cm.options.tabSize),inner=cm.options.addModeClass&&[null];for(""==text&&extractLineClasses(callBlankLine(mode,state),lineClasses);!stream.eol();){if(stream.pos>cm.options.maxHighlightLength?(flattenSpans=!1,forceToEnd&&processLine(cm,text,state,stream.pos),stream.pos=text.length,style=null):style=extractLineClasses(readToken(mode,stream,state,inner),lineClasses),inner){var mName=inner[0].name;mName&&(style="m-"+(style?mName+" "+style:mName))}if(!flattenSpans||curStyle!=style){for(;curStart<stream.start;)curStart=Math.min(stream.start,curStart+5e4),f(curStart,curStyle);curStyle=style}stream.start=stream.pos}for(;curStart<stream.pos;){var pos=Math.min(stream.pos,curStart+5e4);f(pos,curStyle),curStart=pos}}function highlightLine(cm,line,state,forceToEnd){var st=[cm.state.modeGen],lineClasses={};runMode(cm,line.text,cm.doc.mode,state,function(end,style){st.push(end,style)},lineClasses,forceToEnd);for(var o=0;o<cm.state.overlays.length;++o){var overlay=cm.state.overlays[o],i=1,at=0;runMode(cm,line.text,overlay.mode,!0,function(end,style){for(var start=i;end>at;){var i_end=st[i];i_end>end&&st.splice(i,1,end,st[i+1],i_end),i+=2,at=Math.min(end,i_end)}if(style)if(overlay.opaque)st.splice(start,i-start,end,"cm-overlay "+style),i=start+2;else for(;i>start;start+=2){var cur=st[start+1];st[start+1]=(cur?cur+" ":"")+"cm-overlay "+style}},lineClasses)}return{styles:st,classes:lineClasses.bgClass||lineClasses.textClass?lineClasses:null}}function getLineStyles(cm,line,updateFrontier){if(!line.styles||line.styles[0]!=cm.state.modeGen){var state=getStateBefore(cm,lineNo(line)),result=highlightLine(cm,line,line.text.length>cm.options.maxHighlightLength?copyState(cm.doc.mode,state):state);line.stateAfter=state,line.styles=result.styles,result.classes?line.styleClasses=result.classes:line.styleClasses&&(line.styleClasses=null),updateFrontier===cm.doc.frontier&&cm.doc.frontier++}return line.styles}function processLine(cm,text,state,startAt){var mode=cm.doc.mode,stream=new StringStream(text,cm.options.tabSize);for(stream.start=stream.pos=startAt||0,""==text&&callBlankLine(mode,state);!stream.eol();)readToken(mode,stream,state),stream.start=stream.pos}function interpretTokenStyle(style,options){if(!style||/^\s*$/.test(style))return null;var cache=options.addModeClass?styleToClassCacheWithMode:styleToClassCache;return cache[style]||(cache[style]=style.replace(/\S+/g,"cm-$&"))}function buildLineContent(cm,lineView){var content=elt("span",null,null,webkit?"padding-right: .1px":null),builder={pre:elt("pre",[content],"CodeMirror-line"),content:content,col:0,pos:0,cm:cm,splitSpaces:(ie||webkit)&&cm.getOption("lineWrapping")};lineView.measure={};for(var i=0;i<=(lineView.rest?lineView.rest.length:0);i++){var order,line=i?lineView.rest[i-1]:lineView.line;builder.pos=0,builder.addToken=buildToken,hasBadBidiRects(cm.display.measure)&&(order=getOrder(line))&&(builder.addToken=buildTokenBadBidi(builder.addToken,order)),builder.map=[];var allowFrontierUpdate=lineView!=cm.display.externalMeasured&&lineNo(line);insertLineContent(line,builder,getLineStyles(cm,line,allowFrontierUpdate)),line.styleClasses&&(line.styleClasses.bgClass&&(builder.bgClass=joinClasses(line.styleClasses.bgClass,builder.bgClass||"")),line.styleClasses.textClass&&(builder.textClass=joinClasses(line.styleClasses.textClass,builder.textClass||""))),0==builder.map.length&&builder.map.push(0,0,builder.content.appendChild(zeroWidthElement(cm.display.measure))),0==i?(lineView.measure.map=builder.map,lineView.measure.cache={}):((lineView.measure.maps||(lineView.measure.maps=[])).push(builder.map),(lineView.measure.caches||(lineView.measure.caches=[])).push({}))
}return webkit&&/\bcm-tab\b/.test(builder.content.lastChild.className)&&(builder.content.className="cm-tab-wrap-hack"),signal(cm,"renderLine",cm,lineView.line,builder.pre),builder.pre.className&&(builder.textClass=joinClasses(builder.pre.className,builder.textClass||"")),builder}function defaultSpecialCharPlaceholder(ch){var token=elt("span","•","cm-invalidchar");return token.title="\\u"+ch.charCodeAt(0).toString(16),token.setAttribute("aria-label",token.title),token}function buildToken(builder,text,style,startStyle,endStyle,title,css){if(text){var displayText=builder.splitSpaces?text.replace(/ {3,}/g,splitSpaces):text,special=builder.cm.state.specialChars,mustWrap=!1;if(special.test(text))for(var content=document.createDocumentFragment(),pos=0;;){special.lastIndex=pos;var m=special.exec(text),skipped=m?m.index-pos:text.length-pos;if(skipped){var txt=document.createTextNode(displayText.slice(pos,pos+skipped));content.appendChild(ie&&9>ie_version?elt("span",[txt]):txt),builder.map.push(builder.pos,builder.pos+skipped,txt),builder.col+=skipped,builder.pos+=skipped}if(!m)break;if(pos+=skipped+1,"	"==m[0]){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize,txt=content.appendChild(elt("span",spaceStr(tabWidth),"cm-tab"));txt.setAttribute("role","presentation"),txt.setAttribute("cm-text","	"),builder.col+=tabWidth}else if("\r"==m[0]||"\n"==m[0]){var txt=content.appendChild(elt("span","\r"==m[0]?"␍":"␤","cm-invalidchar"));txt.setAttribute("cm-text",m[0]),builder.col+=1}else{var txt=builder.cm.options.specialCharPlaceholder(m[0]);txt.setAttribute("cm-text",m[0]),content.appendChild(ie&&9>ie_version?elt("span",[txt]):txt),builder.col+=1}builder.map.push(builder.pos,builder.pos+1,txt),builder.pos++}else{builder.col+=text.length;var content=document.createTextNode(displayText);builder.map.push(builder.pos,builder.pos+text.length,content),ie&&9>ie_version&&(mustWrap=!0),builder.pos+=text.length}if(style||startStyle||endStyle||mustWrap||css){var fullStyle=style||"";startStyle&&(fullStyle+=startStyle),endStyle&&(fullStyle+=endStyle);var token=elt("span",[content],fullStyle,css);return title&&(token.title=title),builder.content.appendChild(token)}builder.content.appendChild(content)}}function splitSpaces(old){for(var out=" ",i=0;i<old.length-2;++i)out+=i%2?" ":" ";return out+=" "}function buildTokenBadBidi(inner,order){return function(builder,text,style,startStyle,endStyle,title,css){style=style?style+" cm-force-border":"cm-force-border";for(var start=builder.pos,end=start+text.length;;){for(var i=0;i<order.length;i++){var part=order[i];if(part.to>start&&part.from<=start)break}if(part.to>=end)return inner(builder,text,style,startStyle,endStyle,title,css);inner(builder,text.slice(0,part.to-start),style,startStyle,null,title,css),startStyle=null,text=text.slice(part.to-start),start=part.to}}}function buildCollapsedSpan(builder,size,marker,ignoreWidget){var widget=!ignoreWidget&&marker.widgetNode;widget&&builder.map.push(builder.pos,builder.pos+size,widget),!ignoreWidget&&builder.cm.display.input.needsContentAttribute&&(widget||(widget=builder.content.appendChild(document.createElement("span"))),widget.setAttribute("cm-marker",marker.id)),widget&&(builder.cm.display.input.setUneditable(widget),builder.content.appendChild(widget)),builder.pos+=size}function insertLineContent(line,builder,styles){var spans=line.markedSpans,allText=line.text,at=0;if(spans)for(var style,css,spanStyle,spanEndStyle,spanStartStyle,title,collapsed,len=allText.length,pos=0,i=1,text="",nextChange=0;;){if(nextChange==pos){spanStyle=spanEndStyle=spanStartStyle=title=css="",collapsed=null,nextChange=1/0;for(var foundBookmarks=[],j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;"bookmark"==m.type&&sp.from==pos&&m.widgetNode?foundBookmarks.push(m):sp.from<=pos&&(null==sp.to||sp.to>pos||m.collapsed&&sp.to==pos&&sp.from==pos)?(null!=sp.to&&sp.to!=pos&&nextChange>sp.to&&(nextChange=sp.to,spanEndStyle=""),m.className&&(spanStyle+=" "+m.className),m.css&&(css=m.css),m.startStyle&&sp.from==pos&&(spanStartStyle+=" "+m.startStyle),m.endStyle&&sp.to==nextChange&&(spanEndStyle+=" "+m.endStyle),m.title&&!title&&(title=m.title),m.collapsed&&(!collapsed||compareCollapsedMarkers(collapsed.marker,m)<0)&&(collapsed=sp)):sp.from>pos&&nextChange>sp.from&&(nextChange=sp.from)}if(collapsed&&(collapsed.from||0)==pos){if(buildCollapsedSpan(builder,(null==collapsed.to?len+1:collapsed.to)-pos,collapsed.marker,null==collapsed.from),null==collapsed.to)return;collapsed.to==pos&&(collapsed=!1)}if(!collapsed&&foundBookmarks.length)for(var j=0;j<foundBookmarks.length;++j)buildCollapsedSpan(builder,0,foundBookmarks[j])}if(pos>=len)break;for(var upto=Math.min(len,nextChange);;){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:"",title,css)}if(end>=upto){text=text.slice(upto-pos),pos=upto;break}pos=end,spanStartStyle=""}text=allText.slice(at,at=styles[i++]),style=interpretTokenStyle(styles[i++],builder.cm.options)}}else for(var i=1;i<styles.length;i+=2)builder.addToken(builder,allText.slice(at,at=styles[i]),interpretTokenStyle(styles[i+1],builder.cm.options))}function isWholeLineUpdate(doc,change){return 0==change.from.ch&&0==change.to.ch&&""==lst(change.text)&&(!doc.cm||doc.cm.options.wholeLineUpdateBefore)}function updateDoc(doc,change,markedSpans,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null}function update(line,text,spans){updateLine(line,text,spans,estimateHeight),signalLater(line,"change",line,change)}function linesFor(start,end){for(var i=start,result=[];end>i;++i)result.push(new Line(text[i],spansFor(i),estimateHeight));return result}var from=change.from,to=change.to,text=change.text,firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line),lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;if(change.full)doc.insert(0,linesFor(0,text.length)),doc.remove(text.length,doc.size-text.length);else if(isWholeLineUpdate(doc,change)){var added=linesFor(0,text.length-1);update(lastLine,lastLine.text,lastSpans),nlines&&doc.remove(from.line,nlines),added.length&&doc.insert(from.line,added)}else if(firstLine==lastLine)if(1==text.length)update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans);else{var added=linesFor(1,text.length-1);added.push(new Line(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight)),update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0)),doc.insert(from.line+1,added)}else if(1==text.length)update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0)),doc.remove(from.line+1,nlines);else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0)),update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);var added=linesFor(1,text.length-1);nlines>1&&doc.remove(from.line+1,nlines-1),doc.insert(from.line+1,added)}signalLater(doc,"change",doc,change)}function LeafChunk(lines){this.lines=lines,this.parent=null;for(var i=0,height=0;i<lines.length;++i)lines[i].parent=this,height+=lines[i].height;this.height=height}function BranchChunk(children){this.children=children;for(var size=0,height=0,i=0;i<children.length;++i){var ch=children[i];size+=ch.chunkSize(),height+=ch.height,ch.parent=this}this.size=size,this.height=height,this.parent=null}function linkedDocs(doc,f,sharedHistOnly){function propagate(doc,skip,sharedHist){if(doc.linked)for(var i=0;i<doc.linked.length;++i){var rel=doc.linked[i];if(rel.doc!=skip){var shared=sharedHist&&rel.sharedHist;(!sharedHistOnly||shared)&&(f(rel.doc,shared),propagate(rel.doc,doc,shared))}}}propagate(doc,null,!0)}function attachDoc(cm,doc){if(doc.cm)throw new Error("This document is already in use.");cm.doc=doc,doc.cm=cm,estimateLineHeights(cm),loadMode(cm),cm.options.lineWrapping||findMaxLine(cm),cm.options.mode=doc.modeOption,regChange(cm)}function getLine(doc,n){if(n-=doc.first,0>n||n>=doc.size)throw new Error("There is no line "+(n+doc.first)+" in the document.");for(var chunk=doc;!chunk.lines;)for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(sz>n){chunk=child;break}n-=sz}return chunk.lines[n]}function getBetween(doc,start,end){var out=[],n=start.line;return doc.iter(start.line,end.line+1,function(line){var text=line.text;n==end.line&&(text=text.slice(0,end.ch)),n==start.line&&(text=text.slice(start.ch)),out.push(text),++n}),out}function getLines(doc,from,to){var out=[];return doc.iter(from,to,function(line){out.push(line.text)}),out}function updateLineHeight(line,height){var diff=height-line.height;if(diff)for(var n=line;n;n=n.parent)n.height+=diff}function lineNo(line){if(null==line.parent)return null;for(var cur=line.parent,no=indexOf(cur.lines,line),chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent)for(var i=0;chunk.children[i]!=cur;++i)no+=chunk.children[i].chunkSize();return no+cur.first}function lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i=0;i<chunk.children.length;++i){var child=chunk.children[i],ch=child.height;if(ch>h){chunk=child;continue outer}h-=ch,n+=child.chunkSize()}return n}while(!chunk.lines);for(var i=0;i<chunk.lines.length;++i){var line=chunk.lines[i],lh=line.height;if(lh>h)break;h-=lh}return n+i}function heightAtLine(lineObj){lineObj=visualLine(lineObj);for(var h=0,chunk=lineObj.parent,i=0;i<chunk.lines.length;++i){var line=chunk.lines[i];if(line==lineObj)break;h+=line.height}for(var p=chunk.parent;p;chunk=p,p=chunk.parent)for(var i=0;i<p.children.length;++i){var cur=p.children[i];if(cur==chunk)break;h+=cur.height}return h}function getOrder(line){var order=line.order;return null==order&&(order=line.order=bidiOrdering(line.text)),order}function History(startGen){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=startGen||1}function historyChangeFromChange(doc,change){var histChange={from:copyPos(change.from),to:changeEnd(change),text:getBetween(doc,change.from,change.to)};return attachLocalSpans(doc,histChange,change.from.line,change.to.line+1),linkedDocs(doc,function(doc){attachLocalSpans(doc,histChange,change.from.line,change.to.line+1)},!0),histChange}function clearSelectionEvents(array){for(;array.length;){var last=lst(array);if(!last.ranges)break;array.pop()}}function lastChangeEvent(hist,force){return force?(clearSelectionEvents(hist.done),lst(hist.done)):hist.done.length&&!lst(hist.done).ranges?lst(hist.done):hist.done.length>1&&!hist.done[hist.done.length-2].ranges?(hist.done.pop(),lst(hist.done)):void 0}function addChangeToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var cur,time=+new Date;if((hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&("+"==change.origin.charAt(0)&&doc.cm&&hist.lastModTime>time-doc.cm.options.historyEventDelay||"*"==change.origin.charAt(0)))&&(cur=lastChangeEvent(hist,hist.lastOp==opId))){var last=lst(cur.changes);0==cmp(change.from,change.to)&&0==cmp(change.from,last.to)?last.to=changeEnd(change):cur.changes.push(historyChangeFromChange(doc,change))}else{var before=lst(hist.done);for(before&&before.ranges||pushSelectionToHistory(doc.sel,hist.done),cur={changes:[historyChangeFromChange(doc,change)],generation:hist.generation},hist.done.push(cur);hist.done.length>hist.undoDepth;)hist.done.shift(),hist.done[0].ranges||hist.done.shift()}hist.done.push(selAfter),hist.generation=++hist.maxGeneration,hist.lastModTime=hist.lastSelTime=time,hist.lastOp=hist.lastSelOp=opId,hist.lastOrigin=hist.lastSelOrigin=change.origin,last||signal(doc,"historyAdded")}function selectionEventCanBeMerged(doc,origin,prev,sel){var ch=origin.charAt(0);return"*"==ch||"+"==ch&&prev.ranges.length==sel.ranges.length&&prev.somethingSelected()==sel.somethingSelected()&&new Date-doc.history.lastSelTime<=(doc.cm?doc.cm.options.historyEventDelay:500)}function addSelectionToHistory(doc,sel,opId,options){var hist=doc.history,origin=options&&options.origin;opId==hist.lastSelOp||origin&&hist.lastSelOrigin==origin&&(hist.lastModTime==hist.lastSelTime&&hist.lastOrigin==origin||selectionEventCanBeMerged(doc,origin,lst(hist.done),sel))?hist.done[hist.done.length-1]=sel:pushSelectionToHistory(sel,hist.done),hist.lastSelTime=+new Date,hist.lastSelOrigin=origin,hist.lastSelOp=opId,options&&options.clearRedo!==!1&&clearSelectionEvents(hist.undone)}function pushSelectionToHistory(sel,dest){var top=lst(dest);top&&top.ranges&&top.equals(sel)||dest.push(sel)}function attachLocalSpans(doc,change,from,to){var existing=change["spans_"+doc.id],n=0;doc.iter(Math.max(doc.first,from),Math.min(doc.first+doc.size,to),function(line){line.markedSpans&&((existing||(existing=change["spans_"+doc.id]={}))[n]=line.markedSpans),++n})}function removeClearedSpans(spans){if(!spans)return null;for(var out,i=0;i<spans.length;++i)spans[i].marker.explicitlyCleared?out||(out=spans.slice(0,i)):out&&out.push(spans[i]);return out?out.length?out:null:spans}function getOldSpans(doc,change){var found=change["spans_"+doc.id];if(!found)return null;for(var i=0,nw=[];i<change.text.length;++i)nw.push(removeClearedSpans(found[i]));return nw}function copyHistoryArray(events,newGroup,instantiateSel){for(var i=0,copy=[];i<events.length;++i){var event=events[i];if(event.ranges)copy.push(instantiateSel?Selection.prototype.deepCopy.call(event):event);else{var changes=event.changes,newChanges=[];copy.push({changes:newChanges});for(var j=0;j<changes.length;++j){var m,change=changes[j];if(newChanges.push({from:change.from,to:change.to,text:change.text}),newGroup)for(var prop in change)(m=prop.match(/^spans_(\d+)$/))&&indexOf(newGroup,Number(m[1]))>-1&&(lst(newChanges)[prop]=change[prop],delete change[prop])}}}return copy}function rebaseHistSelSingle(pos,from,to,diff){to<pos.line?pos.line+=diff:from<pos.line&&(pos.line=from,pos.ch=0)}function rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){var sub=array[i],ok=!0;if(sub.ranges){sub.copied||(sub=array[i]=sub.deepCopy(),sub.copied=!0);for(var j=0;j<sub.ranges.length;j++)rebaseHistSelSingle(sub.ranges[j].anchor,from,to,diff),rebaseHistSelSingle(sub.ranges[j].head,from,to,diff)}else{for(var j=0;j<sub.changes.length;++j){var cur=sub.changes[j];if(to<cur.from.line)cur.from=Pos(cur.from.line+diff,cur.from.ch),cur.to=Pos(cur.to.line+diff,cur.to.ch);else if(from<=cur.to.line){ok=!1;break}}ok||(array.splice(0,i+1),i=0)}}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff),rebaseHistArray(hist.undone,from,to,diff)}function e_defaultPrevented(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function e_target(e){return e.target||e.srcElement}function e_button(e){var b=e.which;return null==b&&(1&e.button?b=1:2&e.button?b=3:4&e.button&&(b=2)),mac&&e.ctrlKey&&1==b&&(b=3),b}function getHandlers(emitter,type,copy){var arr=emitter._handlers&&emitter._handlers[type];return copy?arr&&arr.length>0?arr.slice():noHandlers:arr||noHandlers}function signalLater(emitter,type){function bnd(f){return function(){f.apply(null,args)}}var arr=getHandlers(emitter,type,!1);if(arr.length){var list,args=Array.prototype.slice.call(arguments,2);operationGroup?list=operationGroup.delayedCallbacks:orphanDelayedCallbacks?list=orphanDelayedCallbacks:(list=orphanDelayedCallbacks=[],setTimeout(fireOrphanDelayed,0));for(var i=0;i<arr.length;++i)list.push(bnd(arr[i]))}}function fireOrphanDelayed(){var delayed=orphanDelayedCallbacks;orphanDelayedCallbacks=null;for(var i=0;i<delayed.length;++i)delayed[i]()}function signalDOMEvent(cm,e,override){return"string"==typeof e&&(e={type:e,preventDefault:function(){this.defaultPrevented=!0}}),signal(cm,override||e.type,cm,e),e_defaultPrevented(e)||e.codemirrorIgnore}function signalCursorActivity(cm){var arr=cm._handlers&&cm._handlers.cursorActivity;if(arr)for(var set=cm.curOp.cursorActivityHandlers||(cm.curOp.cursorActivityHandlers=[]),i=0;i<arr.length;++i)-1==indexOf(set,arr[i])&&set.push(arr[i])}function hasHandler(emitter,type){return getHandlers(emitter,type).length>0}function eventMixin(ctor){ctor.prototype.on=function(type,f){on(this,type,f)},ctor.prototype.off=function(type,f){off(this,type,f)}}function Delayed(){this.id=null}function spaceStr(n){for(;spaceStrs.length<=n;)spaceStrs.push(lst(spaceStrs)+" ");return spaceStrs[n]}function lst(arr){return arr[arr.length-1]}function indexOf(array,elt){for(var i=0;i<array.length;++i)if(array[i]==elt)return i;return-1}function map(array,f){for(var out=[],i=0;i<array.length;i++)out[i]=f(array[i],i);return out}function nothing(){}function createObj(base,props){var inst;return Object.create?inst=Object.create(base):(nothing.prototype=base,inst=new nothing),props&&copyObj(props,inst),inst}function copyObj(obj,target,overwrite){target||(target={});for(var prop in obj)!obj.hasOwnProperty(prop)||overwrite===!1&&target.hasOwnProperty(prop)||(target[prop]=obj[prop]);return target}function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}}function isWordChar(ch,helper){return helper?helper.source.indexOf("\\w")>-1&&isWordCharBasic(ch)?!0:helper.test(ch):isWordCharBasic(ch)}function isEmpty(obj){for(var n in obj)if(obj.hasOwnProperty(n)&&obj[n])return!1;return!0}function isExtendingChar(ch){return ch.charCodeAt(0)>=768&&extendingChars.test(ch)}function elt(tag,content,className,style){var e=document.createElement(tag);if(className&&(e.className=className),style&&(e.style.cssText=style),"string"==typeof content)e.appendChild(document.createTextNode(content));else if(content)for(var i=0;i<content.length;++i)e.appendChild(content[i]);return e}function removeChildren(e){for(var count=e.childNodes.length;count>0;--count)e.removeChild(e.firstChild);return e}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e)}function activeElt(){for(var activeElement=document.activeElement;activeElement&&activeElement.root&&activeElement.root.activeElement;)activeElement=activeElement.root.activeElement;return activeElement}function classTest(cls){return new RegExp("(^|\\s)"+cls+"(?:$|\\s)\\s*")}function joinClasses(a,b){for(var as=a.split(" "),i=0;i<as.length;i++)as[i]&&!classTest(as[i]).test(b)&&(b+=" "+as[i]);return b}function forEachCodeMirror(f){if(document.body.getElementsByClassName)for(var byClass=document.body.getElementsByClassName("CodeMirror"),i=0;i<byClass.length;i++){var cm=byClass[i].CodeMirror;cm&&f(cm)}}function ensureGlobalHandlers(){globalsRegistered||(registerGlobalHandlers(),globalsRegistered=!0)}function registerGlobalHandlers(){var resizeTimer;on(window,"resize",function(){null==resizeTimer&&(resizeTimer=setTimeout(function(){resizeTimer=null,forEachCodeMirror(onResize)},100))}),on(window,"blur",function(){forEachCodeMirror(onBlur)})}function zeroWidthElement(measure){if(null==zwspSupported){var test=elt("span","​");removeChildrenAndAdd(measure,elt("span",[test,document.createTextNode("x")])),0!=measure.firstChild.offsetHeight&&(zwspSupported=test.offsetWidth<=1&&test.offsetHeight>2&&!(ie&&8>ie_version))}var node=zwspSupported?elt("span","​"):elt("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return node.setAttribute("cm-text",""),node}function hasBadBidiRects(measure){if(null!=badBidiRects)return badBidiRects;var txt=removeChildrenAndAdd(measure,document.createTextNode("AخA")),r0=range(txt,0,1).getBoundingClientRect();if(!r0||r0.left==r0.right)return!1;var r1=range(txt,1,2).getBoundingClientRect();return badBidiRects=r1.right-r0.right<3}function hasBadZoomedRects(measure){if(null!=badZoomedRects)return badZoomedRects;var node=removeChildrenAndAdd(measure,elt("span","x")),normal=node.getBoundingClientRect(),fromRange=range(node,0,1).getBoundingClientRect();return badZoomedRects=Math.abs(normal.left-fromRange.left)>1}function iterateBidiSections(order,from,to,f){if(!order)return f(from,to,"ltr");for(var found=!1,i=0;i<order.length;++i){var part=order[i];(part.from<to&&part.to>from||from==to&&part.to==from)&&(f(Math.max(part.from,from),Math.min(part.to,to),1==part.level?"rtl":"ltr"),found=!0)}found||f(from,to,"ltr")}function bidiLeft(part){return part.level%2?part.to:part.from}function bidiRight(part){return part.level%2?part.from:part.to}function lineLeft(line){var order=getOrder(line);return order?bidiLeft(order[0]):0}function lineRight(line){var order=getOrder(line);return order?bidiRight(lst(order)):line.text.length}function lineStart(cm,lineN){var line=getLine(cm.doc,lineN),visual=visualLine(line);visual!=line&&(lineN=lineNo(visual));var order=getOrder(visual),ch=order?order[0].level%2?lineRight(visual):lineLeft(visual):0;return Pos(lineN,ch)}function lineEnd(cm,lineN){for(var merged,line=getLine(cm.doc,lineN);merged=collapsedSpanAtEnd(line);)line=merged.find(1,!0).line,lineN=null;var order=getOrder(line),ch=order?order[0].level%2?lineLeft(line):lineRight(line):line.text.length;return Pos(null==lineN?lineNo(line):lineN,ch)}function lineStartSmart(cm,pos){var start=lineStart(cm,pos.line),line=getLine(cm.doc,start.line),order=getOrder(line);if(!order||0==order[0].level){var firstNonWS=Math.max(0,line.text.search(/\S/)),inWS=pos.line==start.line&&pos.ch<=firstNonWS&&pos.ch;return Pos(start.line,inWS?0:firstNonWS)}return start}function compareBidiLevel(order,a,b){var linedir=order[0].level;return a==linedir?!0:b==linedir?!1:b>a}function getBidiPartAt(order,pos){bidiOther=null;for(var found,i=0;i<order.length;++i){var cur=order[i];if(cur.from<pos&&cur.to>pos)return i;if(cur.from==pos||cur.to==pos){if(null!=found)return compareBidiLevel(order,cur.level,order[found].level)?(cur.from!=cur.to&&(bidiOther=found),i):(cur.from!=cur.to&&(bidiOther=i),found);found=i}}return found}function moveInLine(line,pos,dir,byUnit){if(!byUnit)return pos+dir;do pos+=dir;while(pos>0&&isExtendingChar(line.text.charAt(pos)));return pos}function moveVisually(line,start,dir,byUnit){var bidi=getOrder(line);if(!bidi)return moveLogically(line,start,dir,byUnit);for(var pos=getBidiPartAt(bidi,start),part=bidi[pos],target=moveInLine(line,start,part.level%2?-dir:dir,byUnit);;){if(target>part.from&&target<part.to)return target;if(target==part.from||target==part.to)return getBidiPartAt(bidi,target)==pos?target:(part=bidi[pos+=dir],dir>0==part.level%2?part.to:part.from);if(part=bidi[pos+=dir],!part)return null;target=dir>0==part.level%2?moveInLine(line,part.to,-1,byUnit):moveInLine(line,part.from,1,byUnit)}}function moveLogically(line,start,dir,byUnit){var target=start+dir;if(byUnit)for(;target>0&&isExtendingChar(line.text.charAt(target));)target+=dir;return 0>target||target>line.text.length?null:target}var userAgent=navigator.userAgent,platform=navigator.platform,gecko=/gecko\/\d/i.test(userAgent),ie_upto10=/MSIE \d/.test(userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(userAgent),ie=ie_upto10||ie_11up,ie_version=ie&&(ie_upto10?document.documentMode||6:ie_11up[1]),webkit=/WebKit\//.test(userAgent),qtwebkit=webkit&&/Qt\/\d+\.\d+/.test(userAgent),chrome=/Chrome\//.test(userAgent),presto=/Opera\//.test(userAgent),safari=/Apple Computer/.test(navigator.vendor),mac_geMountainLion=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(userAgent),phantom=/PhantomJS/.test(userAgent),ios=/AppleWebKit/.test(userAgent)&&/Mobile\/\w+/.test(userAgent),mobile=ios||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent),mac=ios||/Mac/.test(platform),windows=/win/i.test(platform),presto_version=presto&&userAgent.match(/Version\/(\d*\.\d*)/);presto_version&&(presto_version=Number(presto_version[1])),presto_version&&presto_version>=15&&(presto=!1,webkit=!0);var flipCtrlCmd=mac&&(qtwebkit||presto&&(null==presto_version||12.11>presto_version)),captureRightClick=gecko||ie&&ie_version>=9,sawReadOnlySpans=!1,sawCollapsedSpans=!1;NativeScrollbars.prototype=copyObj({update:function(measure){var needsH=measure.scrollWidth>measure.clientWidth+1,needsV=measure.scrollHeight>measure.clientHeight+1,sWidth=measure.nativeBarWidth;if(needsV){this.vert.style.display="block",this.vert.style.bottom=needsH?sWidth+"px":"0";var totalHeight=measure.viewHeight-(needsH?sWidth:0);this.vert.firstChild.style.height=Math.max(0,measure.scrollHeight-measure.clientHeight+totalHeight)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(needsH){this.horiz.style.display="block",this.horiz.style.right=needsV?sWidth+"px":"0",this.horiz.style.left=measure.barLeft+"px";var totalWidth=measure.viewWidth-measure.barLeft-(needsV?sWidth:0);this.horiz.firstChild.style.width=measure.scrollWidth-measure.clientWidth+totalWidth+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedOverlay&&measure.clientHeight>0&&(0==sWidth&&this.overlayHack(),this.checkedOverlay=!0),{right:needsV?sWidth:0,bottom:needsH?sWidth:0}},setScrollLeft:function(pos){this.horiz.scrollLeft!=pos&&(this.horiz.scrollLeft=pos)},setScrollTop:function(pos){this.vert.scrollTop!=pos&&(this.vert.scrollTop=pos)},overlayHack:function(){var w=mac&&!mac_geMountainLion?"12px":"18px";this.horiz.style.minHeight=this.vert.style.minWidth=w;var self=this,barMouseDown=function(e){e_target(e)!=self.vert&&e_target(e)!=self.horiz&&operation(self.cm,onMouseDown)(e)};on(this.vert,"mousedown",barMouseDown),on(this.horiz,"mousedown",barMouseDown)},clear:function(){var parent=this.horiz.parentNode;parent.removeChild(this.horiz),parent.removeChild(this.vert)}},NativeScrollbars.prototype),NullScrollbars.prototype=copyObj({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},NullScrollbars.prototype),CodeMirror.scrollbarModel={"native":NativeScrollbars,"null":NullScrollbars},DisplayUpdate.prototype.signal=function(emitter,type){hasHandler(emitter,type)&&this.events.push(arguments)},DisplayUpdate.prototype.finish=function(){for(var i=0;i<this.events.length;i++)signal.apply(null,this.events[i])};var Pos=CodeMirror.Pos=function(line,ch){return this instanceof Pos?(this.line=line,void(this.ch=ch)):new Pos(line,ch)},cmp=CodeMirror.cmpPos=function(a,b){return a.line-b.line||a.ch-b.ch},lastCopied=null;TextareaInput.prototype=copyObj({init:function(display){function prepareCopyCut(e){if(cm.somethingSelected())lastCopied=cm.getSelections(),input.inaccurateSelection&&(input.prevInput="",input.inaccurateSelection=!1,te.value=lastCopied.join("\n"),selectInput(te));else{if(!cm.options.lineWiseCopyCut)return;var ranges=copyableRanges(cm);lastCopied=ranges.text,"cut"==e.type?cm.setSelections(ranges.ranges,null,sel_dontScroll):(input.prevInput="",te.value=ranges.text.join("\n"),selectInput(te))}"cut"==e.type&&(cm.state.cutIncoming=!0)}var input=this,cm=this.cm,div=this.wrapper=hiddenTextarea(),te=this.textarea=div.firstChild;display.wrapper.insertBefore(div,display.wrapper.firstChild),ios&&(te.style.width="0px"),on(te,"input",function(){ie&&ie_version>=9&&input.hasSelection&&(input.hasSelection=null),input.poll()}),on(te,"paste",function(e){return handlePaste(e,cm)?!0:(cm.state.pasteIncoming=!0,void input.fastPoll())}),on(te,"cut",prepareCopyCut),on(te,"copy",prepareCopyCut),on(display.scroller,"paste",function(e){eventInWidget(display,e)||(cm.state.pasteIncoming=!0,input.focus())}),on(display.lineSpace,"selectstart",function(e){eventInWidget(display,e)||e_preventDefault(e)}),on(te,"compositionstart",function(){var start=cm.getCursor("from");input.composing&&input.composing.range.clear(),input.composing={start:start,range:cm.markText(start,cm.getCursor("to"),{className:"CodeMirror-composing"})}}),on(te,"compositionend",function(){input.composing&&(input.poll(),input.composing.range.clear(),input.composing=null)})},prepareSelection:function(){var cm=this.cm,display=cm.display,doc=cm.doc,result=prepareSelection(cm);if(cm.options.moveInputWithCursor){var headPos=cursorCoords(cm,doc.sel.primary().head,"div"),wrapOff=display.wrapper.getBoundingClientRect(),lineOff=display.lineDiv.getBoundingClientRect();result.teTop=Math.max(0,Math.min(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top)),result.teLeft=Math.max(0,Math.min(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left))}return result},showSelection:function(drawn){var cm=this.cm,display=cm.display;removeChildrenAndAdd(display.cursorDiv,drawn.cursors),removeChildrenAndAdd(display.selectionDiv,drawn.selection),null!=drawn.teTop&&(this.wrapper.style.top=drawn.teTop+"px",this.wrapper.style.left=drawn.teLeft+"px")},reset:function(typing){if(!this.contextMenuPending){var minimal,selected,cm=this.cm,doc=cm.doc;if(cm.somethingSelected()){this.prevInput="";var range=doc.sel.primary();minimal=hasCopyEvent&&(range.to().line-range.from().line>100||(selected=cm.getSelection()).length>1e3);var content=minimal?"-":selected||cm.getSelection();this.textarea.value=content,cm.state.focused&&selectInput(this.textarea),ie&&ie_version>=9&&(this.hasSelection=content)}else typing||(this.prevInput=this.textarea.value="",ie&&ie_version>=9&&(this.hasSelection=null));this.inaccurateSelection=minimal}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!mobile||activeElt()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var input=this;input.pollingFast||input.polling.set(this.cm.options.pollInterval,function(){input.poll(),input.cm.state.focused&&input.slowPoll()})},fastPoll:function(){function p(){var changed=input.poll();changed||missed?(input.pollingFast=!1,input.slowPoll()):(missed=!0,input.polling.set(60,p))}var missed=!1,input=this;input.pollingFast=!0,input.polling.set(20,p)},poll:function(){var cm=this.cm,input=this.textarea,prevInput=this.prevInput;if(this.contextMenuPending||!cm.state.focused||hasSelection(input)&&!prevInput&&!this.composing||isReadOnly(cm)||cm.options.disableInput||cm.state.keySeq)return!1;var text=input.value;if(text==prevInput&&!cm.somethingSelected())return!1;if(ie&&ie_version>=9&&this.hasSelection===text||mac&&/[\uf700-\uf7ff]/.test(text))return cm.display.input.reset(),!1;if(cm.doc.sel==cm.display.selForContextMenu){var first=text.charCodeAt(0);if(8203!=first||prevInput||(prevInput="​"),8666==first)return this.reset(),this.cm.execCommand("undo")}for(var same=0,l=Math.min(prevInput.length,text.length);l>same&&prevInput.charCodeAt(same)==text.charCodeAt(same);)++same;var self=this;return runInOp(cm,function(){applyTextInput(cm,text.slice(same),prevInput.length-same,null,self.composing?"*compose":null),text.length>1e3||text.indexOf("\n")>-1?input.value=self.prevInput="":self.prevInput=text,self.composing&&(self.composing.range.clear(),self.composing.range=cm.markText(self.composing.start,cm.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){ie&&ie_version>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){function prepareSelectAllHack(){if(null!=te.selectionStart){var selected=cm.somethingSelected(),extval="​"+(selected?te.value:"");te.value="⇚",te.value=extval,input.prevInput=selected?"":"​",te.selectionStart=1,te.selectionEnd=extval.length,display.selForContextMenu=cm.doc.sel}}function rehide(){if(input.contextMenuPending=!1,input.wrapper.style.position="relative",te.style.cssText=oldCSS,ie&&9>ie_version&&display.scrollbars.setScrollTop(display.scroller.scrollTop=scrollPos),null!=te.selectionStart){(!ie||ie&&9>ie_version)&&prepareSelectAllHack();var i=0,poll=function(){display.selForContextMenu==cm.doc.sel&&0==te.selectionStart&&te.selectionEnd>0&&"​"==input.prevInput?operation(cm,commands.selectAll)(cm):i++<10?display.detectingSelectAll=setTimeout(poll,500):display.input.reset()
};display.detectingSelectAll=setTimeout(poll,200)}}var input=this,cm=input.cm,display=cm.display,te=input.textarea,pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(pos&&!presto){var reset=cm.options.resetSelectionOnContextMenu;reset&&-1==cm.doc.sel.contains(pos)&&operation(cm,setSelection)(cm.doc,simpleSelection(pos),sel_dontScroll);var oldCSS=te.style.cssText;if(input.wrapper.style.position="absolute",te.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: "+(ie?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",webkit)var oldScrollY=window.scrollY;if(display.input.focus(),webkit&&window.scrollTo(null,oldScrollY),display.input.reset(),cm.somethingSelected()||(te.value=input.prevInput=" "),input.contextMenuPending=!0,display.selForContextMenu=cm.doc.sel,clearTimeout(display.detectingSelectAll),ie&&ie_version>=9&&prepareSelectAllHack(),captureRightClick){e_stop(e);var mouseup=function(){off(window,"mouseup",mouseup),setTimeout(rehide,20)};on(window,"mouseup",mouseup)}else setTimeout(rehide,50)}},readOnlyChanged:function(val){val||this.reset()},setUneditable:nothing,needsContentAttribute:!1},TextareaInput.prototype),ContentEditableInput.prototype=copyObj({init:function(display){function onCopyCut(e){if(cm.somethingSelected())lastCopied=cm.getSelections(),"cut"==e.type&&cm.replaceSelection("",null,"cut");else{if(!cm.options.lineWiseCopyCut)return;var ranges=copyableRanges(cm);lastCopied=ranges.text,"cut"==e.type&&cm.operation(function(){cm.setSelections(ranges.ranges,0,sel_dontScroll),cm.replaceSelection("",null,"cut")})}if(e.clipboardData&&!ios)e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/plain",lastCopied.join("\n"));else{var kludge=hiddenTextarea(),te=kludge.firstChild;cm.display.lineSpace.insertBefore(kludge,cm.display.lineSpace.firstChild),te.value=lastCopied.join("\n");var hadFocus=document.activeElement;selectInput(te),setTimeout(function(){cm.display.lineSpace.removeChild(kludge),hadFocus.focus()},50)}}var input=this,cm=input.cm,div=input.div=display.lineDiv;disableBrowserMagic(div),on(div,"paste",function(e){handlePaste(e,cm)}),on(div,"compositionstart",function(e){var data=e.data;if(input.composing={sel:cm.doc.sel,data:data,startData:data},data){var prim=cm.doc.sel.primary(),line=cm.getLine(prim.head.line),found=line.indexOf(data,Math.max(0,prim.head.ch-data.length));found>-1&&found<=prim.head.ch&&(input.composing.sel=simpleSelection(Pos(prim.head.line,found),Pos(prim.head.line,found+data.length)))}}),on(div,"compositionupdate",function(e){input.composing.data=e.data}),on(div,"compositionend",function(e){var ours=input.composing;ours&&(e.data==ours.startData||/\u200b/.test(e.data)||(ours.data=e.data),setTimeout(function(){ours.handled||input.applyComposition(ours),input.composing==ours&&(input.composing=null)},50))}),on(div,"touchstart",function(){input.forceCompositionEnd()}),on(div,"input",function(){input.composing||(isReadOnly(cm)||!input.pollContent())&&runInOp(input.cm,function(){regChange(cm)})}),on(div,"copy",onCopyCut),on(div,"cut",onCopyCut)},prepareSelection:function(){var result=prepareSelection(this.cm,!1);return result.focus=this.cm.state.focused,result},showSelection:function(info){info&&this.cm.display.view.length&&(info.focus&&this.showPrimarySelection(),this.showMultipleSelections(info))},showPrimarySelection:function(){var sel=window.getSelection(),prim=this.cm.doc.sel.primary(),curAnchor=domToPos(this.cm,sel.anchorNode,sel.anchorOffset),curFocus=domToPos(this.cm,sel.focusNode,sel.focusOffset);if(!curAnchor||curAnchor.bad||!curFocus||curFocus.bad||0!=cmp(minPos(curAnchor,curFocus),prim.from())||0!=cmp(maxPos(curAnchor,curFocus),prim.to())){var start=posToDOM(this.cm,prim.from()),end=posToDOM(this.cm,prim.to());if(start||end){var view=this.cm.display.view,old=sel.rangeCount&&sel.getRangeAt(0);if(start){if(!end){var measure=view[view.length-1].measure,map=measure.maps?measure.maps[measure.maps.length-1]:measure.map;end={node:map[map.length-1],offset:map[map.length-2]-map[map.length-3]}}}else start={node:view[0].measure.map[2],offset:0};try{var rng=range(start.node,start.offset,end.offset,end.node)}catch(e){}rng&&(sel.removeAllRanges(),sel.addRange(rng),old&&null==sel.anchorNode?sel.addRange(old):gecko&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var input=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){input.gracePeriod=!1,input.selectionChanged()&&input.cm.operation(function(){input.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(info){removeChildrenAndAdd(this.cm.display.cursorDiv,info.cursors),removeChildrenAndAdd(this.cm.display.selectionDiv,info.selection)},rememberSelection:function(){var sel=window.getSelection();this.lastAnchorNode=sel.anchorNode,this.lastAnchorOffset=sel.anchorOffset,this.lastFocusNode=sel.focusNode,this.lastFocusOffset=sel.focusOffset},selectionInEditor:function(){var sel=window.getSelection();if(!sel.rangeCount)return!1;var node=sel.getRangeAt(0).commonAncestorContainer;return contains(this.div,node)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){function poll(){input.cm.state.focused&&(input.pollSelection(),input.polling.set(input.cm.options.pollInterval,poll))}var input=this;this.selectionInEditor()?this.pollSelection():runInOp(this.cm,function(){input.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,poll)},selectionChanged:function(){var sel=window.getSelection();return sel.anchorNode!=this.lastAnchorNode||sel.anchorOffset!=this.lastAnchorOffset||sel.focusNode!=this.lastFocusNode||sel.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var sel=window.getSelection(),cm=this.cm;this.rememberSelection();var anchor=domToPos(cm,sel.anchorNode,sel.anchorOffset),head=domToPos(cm,sel.focusNode,sel.focusOffset);anchor&&head&&runInOp(cm,function(){setSelection(cm.doc,simpleSelection(anchor,head),sel_dontScroll),(anchor.bad||head.bad)&&(cm.curOp.selectionChanged=!0)})}},pollContent:function(){var cm=this.cm,display=cm.display,sel=cm.doc.sel.primary(),from=sel.from(),to=sel.to();if(from.line<display.viewFrom||to.line>display.viewTo-1)return!1;var fromIndex;if(from.line==display.viewFrom||0==(fromIndex=findViewIndex(cm,from.line)))var fromLine=lineNo(display.view[0].line),fromNode=display.view[0].node;else var fromLine=lineNo(display.view[fromIndex].line),fromNode=display.view[fromIndex-1].node.nextSibling;var toIndex=findViewIndex(cm,to.line);if(toIndex==display.view.length-1)var toLine=display.viewTo-1,toNode=display.lineDiv.lastChild;else var toLine=lineNo(display.view[toIndex+1].line)-1,toNode=display.view[toIndex+1].node.previousSibling;for(var newText=cm.doc.splitLines(domTextBetween(cm,fromNode,toNode,fromLine,toLine)),oldText=getBetween(cm.doc,Pos(fromLine,0),Pos(toLine,getLine(cm.doc,toLine).text.length));newText.length>1&&oldText.length>1;)if(lst(newText)==lst(oldText))newText.pop(),oldText.pop(),toLine--;else{if(newText[0]!=oldText[0])break;newText.shift(),oldText.shift(),fromLine++}for(var cutFront=0,cutEnd=0,newTop=newText[0],oldTop=oldText[0],maxCutFront=Math.min(newTop.length,oldTop.length);maxCutFront>cutFront&&newTop.charCodeAt(cutFront)==oldTop.charCodeAt(cutFront);)++cutFront;for(var newBot=lst(newText),oldBot=lst(oldText),maxCutEnd=Math.min(newBot.length-(1==newText.length?cutFront:0),oldBot.length-(1==oldText.length?cutFront:0));maxCutEnd>cutEnd&&newBot.charCodeAt(newBot.length-cutEnd-1)==oldBot.charCodeAt(oldBot.length-cutEnd-1);)++cutEnd;newText[newText.length-1]=newBot.slice(0,newBot.length-cutEnd),newText[0]=newText[0].slice(cutFront);var chFrom=Pos(fromLine,cutFront),chTo=Pos(toLine,oldText.length?lst(oldText).length-cutEnd:0);return newText.length>1||newText[0]||cmp(chFrom,chTo)?(replaceRange(cm.doc,newText,chFrom,chTo,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(composing){isReadOnly(this.cm)?operation(this.cm,regChange)(this.cm):composing.data&&composing.data!=composing.startData&&operation(this.cm,applyTextInput)(this.cm,composing.data,0,composing.sel)},setUneditable:function(node){node.contentEditable="false"},onKeyPress:function(e){e.preventDefault(),isReadOnly(this.cm)||operation(this.cm,applyTextInput)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},readOnlyChanged:function(val){this.div.contentEditable=String("nocursor"!=val)},onContextMenu:nothing,resetPosition:nothing,needsContentAttribute:!0},ContentEditableInput.prototype),CodeMirror.inputStyles={textarea:TextareaInput,contenteditable:ContentEditableInput},Selection.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(other){if(other==this)return!0;if(other.primIndex!=this.primIndex||other.ranges.length!=this.ranges.length)return!1;for(var i=0;i<this.ranges.length;i++){var here=this.ranges[i],there=other.ranges[i];if(0!=cmp(here.anchor,there.anchor)||0!=cmp(here.head,there.head))return!1}return!0},deepCopy:function(){for(var out=[],i=0;i<this.ranges.length;i++)out[i]=new Range(copyPos(this.ranges[i].anchor),copyPos(this.ranges[i].head));return new Selection(out,this.primIndex)},somethingSelected:function(){for(var i=0;i<this.ranges.length;i++)if(!this.ranges[i].empty())return!0;return!1},contains:function(pos,end){end||(end=pos);for(var i=0;i<this.ranges.length;i++){var range=this.ranges[i];if(cmp(end,range.from())>=0&&cmp(pos,range.to())<=0)return i}return-1}},Range.prototype={from:function(){return minPos(this.anchor,this.head)},to:function(){return maxPos(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var measureText,lastClick,lastDoubleClick,nullRect={left:0,right:0,top:0,bottom:0},operationGroup=null,nextOpId=0,lastDrop=0,wheelSamples=0,wheelPixelsPerUnit=null;ie?wheelPixelsPerUnit=-.53:gecko?wheelPixelsPerUnit=15:chrome?wheelPixelsPerUnit=-.7:safari&&(wheelPixelsPerUnit=-1/3);var wheelEventDelta=function(e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;return null==dx&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(dx=e.detail),null==dy&&e.detail&&e.axis==e.VERTICAL_AXIS?dy=e.detail:null==dy&&(dy=e.wheelDelta),{x:dx,y:dy}};CodeMirror.wheelEventPixels=function(e){var delta=wheelEventDelta(e);return delta.x*=wheelPixelsPerUnit,delta.y*=wheelPixelsPerUnit,delta};var stopSeq=new Delayed,lastStoppedKey=null,changeEnd=CodeMirror.changeEnd=function(change){return change.text?Pos(change.from.line+change.text.length-1,lst(change.text).length+(1==change.text.length?change.from.ch:0)):change.to};CodeMirror.prototype={constructor:CodeMirror,focus:function(){window.focus(),this.display.input.focus()},setOption:function(option,value){var options=this.options,old=options[option];(options[option]!=value||"mode"==option)&&(options[option]=value,optionHandlers.hasOwnProperty(option)&&operation(this,optionHandlers[option])(this,value,old))},getOption:function(option){return this.options[option]},getDoc:function(){return this.doc},addKeyMap:function(map,bottom){this.state.keyMaps[bottom?"push":"unshift"](getKeyMap(map))},removeKeyMap:function(map){for(var maps=this.state.keyMaps,i=0;i<maps.length;++i)if(maps[i]==map||maps[i].name==map)return maps.splice(i,1),!0},addOverlay:methodOp(function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:mode,modeSpec:spec,opaque:options&&options.opaque}),this.state.modeGen++,regChange(this)}),removeOverlay:methodOp(function(spec){for(var overlays=this.state.overlays,i=0;i<overlays.length;++i){var cur=overlays[i].modeSpec;if(cur==spec||"string"==typeof spec&&cur.name==spec)return overlays.splice(i,1),this.state.modeGen++,void regChange(this)}}),indentLine:methodOp(function(n,dir,aggressive){"string"!=typeof dir&&"number"!=typeof dir&&(dir=null==dir?this.options.smartIndent?"smart":"prev":dir?"add":"subtract"),isLine(this.doc,n)&&indentLine(this,n,dir,aggressive)}),indentSelection:methodOp(function(how){for(var ranges=this.doc.sel.ranges,end=-1,i=0;i<ranges.length;i++){var range=ranges[i];if(range.empty())range.head.line>end&&(indentLine(this,range.head.line,how,!0),end=range.head.line,i==this.doc.sel.primIndex&&ensureCursorVisible(this));else{var from=range.from(),to=range.to(),start=Math.max(end,from.line);end=Math.min(this.lastLine(),to.line-(to.ch?0:1))+1;for(var j=start;end>j;++j)indentLine(this,j,how);var newRanges=this.doc.sel.ranges;0==from.ch&&ranges.length==newRanges.length&&newRanges[i].from().ch>0&&replaceOneSelection(this.doc,i,new Range(from,newRanges[i].to()),sel_dontScroll)}}}),getTokenAt:function(pos,precise){return takeToken(this,pos,precise)},getLineTokens:function(line,precise){return takeToken(this,Pos(line),precise,!0)},getTokenTypeAt:function(pos){pos=clipPos(this.doc,pos);var type,styles=getLineStyles(this,getLine(this.doc,pos.line)),before=0,after=(styles.length-1)/2,ch=pos.ch;if(0==ch)type=styles[2];else for(;;){var mid=before+after>>1;if((mid?styles[2*mid-1]:0)>=ch)after=mid;else{if(!(styles[2*mid+1]<ch)){type=styles[2*mid+2];break}before=mid+1}}var cut=type?type.indexOf("cm-overlay "):-1;return 0>cut?type:0==cut?null:type.slice(0,cut-1)},getModeAt:function(pos){var mode=this.doc.mode;return mode.innerMode?CodeMirror.innerMode(mode,this.getTokenAt(pos).state).mode:mode},getHelper:function(pos,type){return this.getHelpers(pos,type)[0]},getHelpers:function(pos,type){var found=[];if(!helpers.hasOwnProperty(type))return found;var help=helpers[type],mode=this.getModeAt(pos);if("string"==typeof mode[type])help[mode[type]]&&found.push(help[mode[type]]);else if(mode[type])for(var i=0;i<mode[type].length;i++){var val=help[mode[type][i]];val&&found.push(val)}else mode.helperType&&help[mode.helperType]?found.push(help[mode.helperType]):help[mode.name]&&found.push(help[mode.name]);for(var i=0;i<help._global.length;i++){var cur=help._global[i];cur.pred(mode,this)&&-1==indexOf(found,cur.val)&&found.push(cur.val)}return found},getStateAfter:function(line,precise){var doc=this.doc;return line=clipLine(doc,null==line?doc.first+doc.size-1:line),getStateBefore(this,line+1,precise)},cursorCoords:function(start,mode){var pos,range=this.doc.sel.primary();return pos=null==start?range.head:"object"==typeof start?clipPos(this.doc,start):start?range.from():range.to(),cursorCoords(this,pos,mode||"page")},charCoords:function(pos,mode){return charCoords(this,clipPos(this.doc,pos),mode||"page")},coordsChar:function(coords,mode){return coords=fromCoordSystem(this,coords,mode||"page"),coordsChar(this,coords.left,coords.top)},lineAtHeight:function(height,mode){return height=fromCoordSystem(this,{top:height,left:0},mode||"page").top,lineAtHeight(this.doc,height+this.display.viewOffset)},heightAtLine:function(line,mode){var lineObj,end=!1;if("number"==typeof line){var last=this.doc.first+this.doc.size-1;line<this.doc.first?line=this.doc.first:line>last&&(line=last,end=!0),lineObj=getLine(this.doc,line)}else lineObj=line;return intoCoordSystem(this,lineObj,{top:0,left:0},mode||"page").top+(end?this.doc.height-heightAtLine(lineObj):0)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},setGutterMarker:methodOp(function(line,gutterID,value){return changeLine(this.doc,line,"gutter",function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});return markers[gutterID]=value,!value&&isEmpty(markers)&&(line.gutterMarkers=null),!0})}),clearGutter:methodOp(function(gutterID){var cm=this,doc=cm.doc,i=doc.first;doc.iter(function(line){line.gutterMarkers&&line.gutterMarkers[gutterID]&&(line.gutterMarkers[gutterID]=null,regLineChange(cm,i,"gutter"),isEmpty(line.gutterMarkers)&&(line.gutterMarkers=null)),++i})}),lineInfo:function(line){if("number"==typeof line){if(!isLine(this.doc,line))return null;var n=line;if(line=getLine(this.doc,line),!line)return null}else{var n=lineNo(line);if(null==n)return null}return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(pos,node,scroll,vert,horiz){var display=this.display;pos=cursorCoords(this,clipPos(this.doc,pos));var top=pos.bottom,left=pos.left;if(node.style.position="absolute",node.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(node),display.sizer.appendChild(node),"over"==vert)top=pos.top;else if("above"==vert||"near"==vert){var vspace=Math.max(display.wrapper.clientHeight,this.doc.height),hspace=Math.max(display.sizer.clientWidth,display.lineSpace.clientWidth);("above"==vert||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight?top=pos.top-node.offsetHeight:pos.bottom+node.offsetHeight<=vspace&&(top=pos.bottom),left+node.offsetWidth>hspace&&(left=hspace-node.offsetWidth)}node.style.top=top+"px",node.style.left=node.style.right="","right"==horiz?(left=display.sizer.clientWidth-node.offsetWidth,node.style.right="0px"):("left"==horiz?left=0:"middle"==horiz&&(left=(display.sizer.clientWidth-node.offsetWidth)/2),node.style.left=left+"px"),scroll&&scrollIntoView(this,left,top,left+node.offsetWidth,top+node.offsetHeight)},triggerOnKeyDown:methodOp(onKeyDown),triggerOnKeyPress:methodOp(onKeyPress),triggerOnKeyUp:onKeyUp,execCommand:function(cmd){return commands.hasOwnProperty(cmd)?commands[cmd].call(null,this):void 0},triggerElectric:methodOp(function(text){triggerElectric(this,text)}),findPosH:function(from,amount,unit,visually){var dir=1;0>amount&&(dir=-1,amount=-amount);for(var i=0,cur=clipPos(this.doc,from);amount>i&&(cur=findPosH(this.doc,cur,dir,unit,visually),!cur.hitSide);++i);return cur},moveH:methodOp(function(dir,unit){var cm=this;cm.extendSelectionsBy(function(range){return cm.display.shift||cm.doc.extend||range.empty()?findPosH(cm.doc,range.head,dir,unit,cm.options.rtlMoveVisually):0>dir?range.from():range.to()},sel_move)}),deleteH:methodOp(function(dir,unit){var sel=this.doc.sel,doc=this.doc;sel.somethingSelected()?doc.replaceSelection("",null,"+delete"):deleteNearSelection(this,function(range){var other=findPosH(doc,range.head,dir,unit,!1);return 0>dir?{from:other,to:range.head}:{from:range.head,to:other}})}),findPosV:function(from,amount,unit,goalColumn){var dir=1,x=goalColumn;0>amount&&(dir=-1,amount=-amount);for(var i=0,cur=clipPos(this.doc,from);amount>i;++i){var coords=cursorCoords(this,cur,"div");if(null==x?x=coords.left:coords.left=x,cur=findPosV(this,coords,dir,unit),cur.hitSide)break}return cur},moveV:methodOp(function(dir,unit){var cm=this,doc=this.doc,goals=[],collapse=!cm.display.shift&&!doc.extend&&doc.sel.somethingSelected();if(doc.extendSelectionsBy(function(range){if(collapse)return 0>dir?range.from():range.to();var headPos=cursorCoords(cm,range.head,"div");null!=range.goalColumn&&(headPos.left=range.goalColumn),goals.push(headPos.left);var pos=findPosV(cm,headPos,dir,unit);return"page"==unit&&range==doc.sel.primary()&&addToScrollPos(cm,null,charCoords(cm,pos,"div").top-headPos.top),pos},sel_move),goals.length)for(var i=0;i<doc.sel.ranges.length;i++)doc.sel.ranges[i].goalColumn=goals[i]}),findWordAt:function(pos){var doc=this.doc,line=getLine(doc,pos.line).text,start=pos.ch,end=pos.ch;if(line){var helper=this.getHelper(pos,"wordChars");(pos.xRel<0||end==line.length)&&start?--start:++end;for(var startChar=line.charAt(start),check=isWordChar(startChar,helper)?function(ch){return isWordChar(ch,helper)}:/\s/.test(startChar)?function(ch){return/\s/.test(ch)}:function(ch){return!/\s/.test(ch)&&!isWordChar(ch)};start>0&&check(line.charAt(start-1));)--start;for(;end<line.length&&check(line.charAt(end));)++end}return new Range(Pos(pos.line,start),Pos(pos.line,end))},toggleOverwrite:function(value){(null==value||value!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?addClass(this.display.cursorDiv,"CodeMirror-overwrite"):rmClass(this.display.cursorDiv,"CodeMirror-overwrite"),signal(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==activeElt()},scrollTo:methodOp(function(x,y){(null!=x||null!=y)&&resolveScrollToPos(this),null!=x&&(this.curOp.scrollLeft=x),null!=y&&(this.curOp.scrollTop=y)}),getScrollInfo:function(){var scroller=this.display.scroller;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-scrollGap(this)-this.display.barHeight,width:scroller.scrollWidth-scrollGap(this)-this.display.barWidth,clientHeight:displayHeight(this),clientWidth:displayWidth(this)}},scrollIntoView:methodOp(function(range,margin){if(null==range?(range={from:this.doc.sel.primary().head,to:null},null==margin&&(margin=this.options.cursorScrollMargin)):"number"==typeof range?range={from:Pos(range,0),to:null}:null==range.from&&(range={from:range,to:null}),range.to||(range.to=range.from),range.margin=margin||0,null!=range.from.line)resolveScrollToPos(this),this.curOp.scrollToPos=range;else{var sPos=calculateScrollPos(this,Math.min(range.from.left,range.to.left),Math.min(range.from.top,range.to.top)-range.margin,Math.max(range.from.right,range.to.right),Math.max(range.from.bottom,range.to.bottom)+range.margin);this.scrollTo(sPos.scrollLeft,sPos.scrollTop)}}),setSize:methodOp(function(width,height){function interpret(val){return"number"==typeof val||/^\d+$/.test(String(val))?val+"px":val}var cm=this;null!=width&&(cm.display.wrapper.style.width=interpret(width)),null!=height&&(cm.display.wrapper.style.height=interpret(height)),cm.options.lineWrapping&&clearLineMeasurementCache(this);var lineNo=cm.display.viewFrom;cm.doc.iter(lineNo,cm.display.viewTo,function(line){if(line.widgets)for(var i=0;i<line.widgets.length;i++)if(line.widgets[i].noHScroll){regLineChange(cm,lineNo,"widget");break}++lineNo}),cm.curOp.forceUpdate=!0,signal(cm,"refresh",this)}),operation:function(f){return runInOp(this,f)},refresh:methodOp(function(){var oldHeight=this.display.cachedTextHeight;regChange(this),this.curOp.forceUpdate=!0,clearCaches(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),updateGutterSpace(this),(null==oldHeight||Math.abs(oldHeight-textHeight(this.display))>.5)&&estimateLineHeights(this),signal(this,"refresh",this)}),swapDoc:methodOp(function(doc){var old=this.doc;return old.cm=null,attachDoc(this,doc),clearCaches(this),this.display.input.reset(),this.scrollTo(doc.scrollLeft,doc.scrollTop),this.curOp.forceScroll=!0,signalLater(this,"swapDoc",this,old),old}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},eventMixin(CodeMirror);var defaults=CodeMirror.defaults={},optionHandlers=CodeMirror.optionHandlers={},Init=CodeMirror.Init={toString:function(){return"CodeMirror.Init"}};option("value","",function(cm,val){cm.setValue(val)},!0),option("mode",null,function(cm,val){cm.doc.modeOption=val,loadMode(cm)},!0),option("indentUnit",2,loadMode,!0),option("indentWithTabs",!1),option("smartIndent",!0),option("tabSize",4,function(cm){resetModeState(cm),clearCaches(cm),regChange(cm)},!0),option("lineSeparator",null,function(cm,val){if(cm.doc.lineSep=val,val){var newBreaks=[],lineNo=cm.doc.first;cm.doc.iter(function(line){for(var pos=0;;){var found=line.text.indexOf(val,pos);if(-1==found)break;pos=found+val.length,newBreaks.push(Pos(lineNo,found))}lineNo++});for(var i=newBreaks.length-1;i>=0;i--)replaceRange(cm.doc,val,newBreaks[i],Pos(newBreaks[i].line,newBreaks[i].ch+val.length))}}),option("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(cm,val,old){cm.state.specialChars=new RegExp(val.source+(val.test("	")?"":"|	"),"g"),old!=CodeMirror.Init&&cm.refresh()}),option("specialCharPlaceholder",defaultSpecialCharPlaceholder,function(cm){cm.refresh()},!0),option("electricChars",!0),option("inputStyle",mobile?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),option("rtlMoveVisually",!windows),option("wholeLineUpdateBefore",!0),option("theme","default",function(cm){themeChanged(cm),guttersChanged(cm)},!0),option("keyMap","default",function(cm,val,old){var next=getKeyMap(val),prev=old!=CodeMirror.Init&&getKeyMap(old);prev&&prev.detach&&prev.detach(cm,next),next.attach&&next.attach(cm,prev||null)}),option("extraKeys",null),option("lineWrapping",!1,wrappingChanged,!0),option("gutters",[],function(cm){setGuttersForLineNumbers(cm.options),guttersChanged(cm)},!0),option("fixedGutter",!0,function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+"px":"0",cm.refresh()},!0),option("coverGutterNextToScrollbar",!1,function(cm){updateScrollbars(cm)},!0),option("scrollbarStyle","native",function(cm){initScrollbars(cm),updateScrollbars(cm),cm.display.scrollbars.setScrollTop(cm.doc.scrollTop),cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft)},!0),option("lineNumbers",!1,function(cm){setGuttersForLineNumbers(cm.options),guttersChanged(cm)},!0),option("firstLineNumber",1,guttersChanged,!0),option("lineNumberFormatter",function(integer){return integer},guttersChanged,!0),option("showCursorWhenSelecting",!1,updateSelection,!0),option("resetSelectionOnContextMenu",!0),option("lineWiseCopyCut",!0),option("readOnly",!1,function(cm,val){"nocursor"==val?(onBlur(cm),cm.display.input.blur(),cm.display.disabled=!0):cm.display.disabled=!1,cm.display.input.readOnlyChanged(val)}),option("disableInput",!1,function(cm,val){val||cm.display.input.reset()},!0),option("dragDrop",!0,dragDropChanged),option("allowDropFileTypes",null),option("cursorBlinkRate",530),option("cursorScrollMargin",0),option("cursorHeight",1,updateSelection,!0),option("singleCursorHeightPerLine",!0,updateSelection,!0),option("workTime",100),option("workDelay",100),option("flattenSpans",!0,resetModeState,!0),option("addModeClass",!1,resetModeState,!0),option("pollInterval",100),option("undoDepth",200,function(cm,val){cm.doc.history.undoDepth=val}),option("historyEventDelay",1250),option("viewportMargin",10,function(cm){cm.refresh()},!0),option("maxHighlightLength",1e4,resetModeState,!0),option("moveInputWithCursor",!0,function(cm,val){val||cm.display.input.resetPosition()}),option("tabindex",null,function(cm,val){cm.display.input.getField().tabIndex=val||""}),option("autofocus",null);var modes=CodeMirror.modes={},mimeModes=CodeMirror.mimeModes={};CodeMirror.defineMode=function(name,mode){CodeMirror.defaults.mode||"null"==name||(CodeMirror.defaults.mode=name),arguments.length>2&&(mode.dependencies=Array.prototype.slice.call(arguments,2)),modes[name]=mode},CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec},CodeMirror.resolveMode=function(spec){if("string"==typeof spec&&mimeModes.hasOwnProperty(spec))spec=mimeModes[spec];else if(spec&&"string"==typeof spec.name&&mimeModes.hasOwnProperty(spec.name)){var found=mimeModes[spec.name];"string"==typeof found&&(found={name:found}),spec=createObj(found,spec),spec.name=found.name}else if("string"==typeof spec&&/^[\w\-]+\/[\w\-]+\+xml$/.test(spec))return CodeMirror.resolveMode("application/xml");return"string"==typeof spec?{name:spec}:spec||{name:"null"}},CodeMirror.getMode=function(options,spec){var spec=CodeMirror.resolveMode(spec),mfactory=modes[spec.name];if(!mfactory)return CodeMirror.getMode(options,"text/plain");var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts)exts.hasOwnProperty(prop)&&(modeObj.hasOwnProperty(prop)&&(modeObj["_"+prop]=modeObj[prop]),modeObj[prop]=exts[prop])}if(modeObj.name=spec.name,spec.helperType&&(modeObj.helperType=spec.helperType),spec.modeProps)for(var prop in spec.modeProps)modeObj[prop]=spec.modeProps[prop];return modeObj},CodeMirror.defineMode("null",function(){return{token:function(stream){stream.skipToEnd()}}}),CodeMirror.defineMIME("text/plain","null");var modeExtensions=CodeMirror.modeExtensions={};CodeMirror.extendMode=function(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};copyObj(properties,exts)},CodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func},CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func},CodeMirror.defineOption=option;var initHooks=[];CodeMirror.defineInitHook=function(f){initHooks.push(f)};var helpers=CodeMirror.helpers={};CodeMirror.registerHelper=function(type,name,value){helpers.hasOwnProperty(type)||(helpers[type]=CodeMirror[type]={_global:[]}),helpers[type][name]=value},CodeMirror.registerGlobalHelper=function(type,name,predicate,value){CodeMirror.registerHelper(type,name,value),helpers[type]._global.push({pred:predicate,val:value})};var copyState=CodeMirror.copyState=function(mode,state){if(state===!0)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];val instanceof Array&&(val=val.concat([])),nstate[n]=val}return nstate},startState=CodeMirror.startState=function(mode,a1,a2){return mode.startState?mode.startState(a1,a2):!0};CodeMirror.innerMode=function(mode,state){for(;mode.innerMode;){var info=mode.innerMode(state);if(!info||info.mode==mode)break;state=info.state,mode=info.mode}return info||{mode:mode,state:state}};var commands=CodeMirror.commands={selectAll:function(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()),sel_dontScroll)},singleSelection:function(cm){cm.setSelection(cm.getCursor("anchor"),cm.getCursor("head"),sel_dontScroll)},killLine:function(cm){deleteNearSelection(cm,function(range){if(range.empty()){var len=getLine(cm.doc,range.head.line).text.length;return range.head.ch==len&&range.head.line<cm.lastLine()?{from:range.head,to:Pos(range.head.line+1,0)}:{from:range.head,to:Pos(range.head.line,len)}}return{from:range.from(),to:range.to()}})},deleteLine:function(cm){deleteNearSelection(cm,function(range){return{from:Pos(range.from().line,0),to:clipPos(cm.doc,Pos(range.to().line+1,0))}})},delLineLeft:function(cm){deleteNearSelection(cm,function(range){return{from:Pos(range.from().line,0),to:range.from()}})},delWrappedLineLeft:function(cm){deleteNearSelection(cm,function(range){var top=cm.charCoords(range.head,"div").top+5,leftPos=cm.coordsChar({left:0,top:top},"div");return{from:leftPos,to:range.from()}})},delWrappedLineRight:function(cm){deleteNearSelection(cm,function(range){var top=cm.charCoords(range.head,"div").top+5,rightPos=cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div");return{from:range.from(),to:rightPos}})},undo:function(cm){cm.undo()},redo:function(cm){cm.redo()},undoSelection:function(cm){cm.undoSelection()},redoSelection:function(cm){cm.redoSelection()},goDocStart:function(cm){cm.extendSelection(Pos(cm.firstLine(),0))},goDocEnd:function(cm){cm.extendSelection(Pos(cm.lastLine()))},goLineStart:function(cm){cm.extendSelectionsBy(function(range){return lineStart(cm,range.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(cm){cm.extendSelectionsBy(function(range){return lineStartSmart(cm,range.head)},{origin:"+move",bias:1})},goLineEnd:function(cm){cm.extendSelectionsBy(function(range){return lineEnd(cm,range.head.line)},{origin:"+move",bias:-1})},goLineRight:function(cm){cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;
return cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div")},sel_move)},goLineLeft:function(cm){cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5;return cm.coordsChar({left:0,top:top},"div")},sel_move)},goLineLeftSmart:function(cm){cm.extendSelectionsBy(function(range){var top=cm.charCoords(range.head,"div").top+5,pos=cm.coordsChar({left:0,top:top},"div");return pos.ch<cm.getLine(pos.line).search(/\S/)?lineStartSmart(cm,range.head):pos},sel_move)},goLineUp:function(cm){cm.moveV(-1,"line")},goLineDown:function(cm){cm.moveV(1,"line")},goPageUp:function(cm){cm.moveV(-1,"page")},goPageDown:function(cm){cm.moveV(1,"page")},goCharLeft:function(cm){cm.moveH(-1,"char")},goCharRight:function(cm){cm.moveH(1,"char")},goColumnLeft:function(cm){cm.moveH(-1,"column")},goColumnRight:function(cm){cm.moveH(1,"column")},goWordLeft:function(cm){cm.moveH(-1,"word")},goGroupRight:function(cm){cm.moveH(1,"group")},goGroupLeft:function(cm){cm.moveH(-1,"group")},goWordRight:function(cm){cm.moveH(1,"word")},delCharBefore:function(cm){cm.deleteH(-1,"char")},delCharAfter:function(cm){cm.deleteH(1,"char")},delWordBefore:function(cm){cm.deleteH(-1,"word")},delWordAfter:function(cm){cm.deleteH(1,"word")},delGroupBefore:function(cm){cm.deleteH(-1,"group")},delGroupAfter:function(cm){cm.deleteH(1,"group")},indentAuto:function(cm){cm.indentSelection("smart")},indentMore:function(cm){cm.indentSelection("add")},indentLess:function(cm){cm.indentSelection("subtract")},insertTab:function(cm){cm.replaceSelection("	")},insertSoftTab:function(cm){for(var spaces=[],ranges=cm.listSelections(),tabSize=cm.options.tabSize,i=0;i<ranges.length;i++){var pos=ranges[i].from(),col=countColumn(cm.getLine(pos.line),pos.ch,tabSize);spaces.push(new Array(tabSize-col%tabSize+1).join(" "))}cm.replaceSelections(spaces)},defaultTab:function(cm){cm.somethingSelected()?cm.indentSelection("add"):cm.execCommand("insertTab")},transposeChars:function(cm){runInOp(cm,function(){for(var ranges=cm.listSelections(),newSel=[],i=0;i<ranges.length;i++){var cur=ranges[i].head,line=getLine(cm.doc,cur.line).text;if(line)if(cur.ch==line.length&&(cur=new Pos(cur.line,cur.ch-1)),cur.ch>0)cur=new Pos(cur.line,cur.ch+1),cm.replaceRange(line.charAt(cur.ch-1)+line.charAt(cur.ch-2),Pos(cur.line,cur.ch-2),cur,"+transpose");else if(cur.line>cm.doc.first){var prev=getLine(cm.doc,cur.line-1).text;prev&&cm.replaceRange(line.charAt(0)+cm.doc.lineSeparator()+prev.charAt(prev.length-1),Pos(cur.line-1,prev.length-1),Pos(cur.line,1),"+transpose")}newSel.push(new Range(cur,cur))}cm.setSelections(newSel)})},newlineAndIndent:function(cm){runInOp(cm,function(){for(var len=cm.listSelections().length,i=0;len>i;i++){var range=cm.listSelections()[i];cm.replaceRange(cm.doc.lineSeparator(),range.anchor,range.head,"+input"),cm.indentLine(range.from().line+1,null,!0)}ensureCursorVisible(cm)})},toggleOverwrite:function(cm){cm.toggleOverwrite()}},keyMap=CodeMirror.keyMap={};keyMap.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},keyMap.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},keyMap.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},keyMap.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},keyMap["default"]=mac?keyMap.macDefault:keyMap.pcDefault,CodeMirror.normalizeKeyMap=function(keymap){var copy={};for(var keyname in keymap)if(keymap.hasOwnProperty(keyname)){var value=keymap[keyname];if(/^(name|fallthrough|(de|at)tach)$/.test(keyname))continue;if("..."==value){delete keymap[keyname];continue}for(var keys=map(keyname.split(" "),normalizeKeyName),i=0;i<keys.length;i++){var val,name;i==keys.length-1?(name=keys.join(" "),val=value):(name=keys.slice(0,i+1).join(" "),val="...");var prev=copy[name];if(prev){if(prev!=val)throw new Error("Inconsistent bindings for "+name)}else copy[name]=val}delete keymap[keyname]}for(var prop in copy)keymap[prop]=copy[prop];return keymap};var lookupKey=CodeMirror.lookupKey=function(key,map,handle,context){map=getKeyMap(map);var found=map.call?map.call(key,context):map[key];if(found===!1)return"nothing";if("..."===found)return"multi";if(null!=found&&handle(found))return"handled";if(map.fallthrough){if("[object Array]"!=Object.prototype.toString.call(map.fallthrough))return lookupKey(key,map.fallthrough,handle,context);for(var i=0;i<map.fallthrough.length;i++){var result=lookupKey(key,map.fallthrough[i],handle,context);if(result)return result}}},isModifierKey=CodeMirror.isModifierKey=function(value){var name="string"==typeof value?value:keyNames[value.keyCode];return"Ctrl"==name||"Alt"==name||"Shift"==name||"Mod"==name},keyName=CodeMirror.keyName=function(event,noShift){if(presto&&34==event.keyCode&&event["char"])return!1;var base=keyNames[event.keyCode],name=base;return null==name||event.altGraphKey?!1:(event.altKey&&"Alt"!=base&&(name="Alt-"+name),(flipCtrlCmd?event.metaKey:event.ctrlKey)&&"Ctrl"!=base&&(name="Ctrl-"+name),(flipCtrlCmd?event.ctrlKey:event.metaKey)&&"Cmd"!=base&&(name="Cmd-"+name),!noShift&&event.shiftKey&&"Shift"!=base&&(name="Shift-"+name),name)};CodeMirror.fromTextArea=function(textarea,options){function save(){textarea.value=cm.getValue()}if(options=options?copyObj(options):{},options.value=textarea.value,!options.tabindex&&textarea.tabIndex&&(options.tabindex=textarea.tabIndex),!options.placeholder&&textarea.placeholder&&(options.placeholder=textarea.placeholder),null==options.autofocus){var hasFocus=activeElt();options.autofocus=hasFocus==textarea||null!=textarea.getAttribute("autofocus")&&hasFocus==document.body}if(textarea.form&&(on(textarea.form,"submit",save),!options.leaveSubmitMethodAlone)){var form=textarea.form,realSubmit=form.submit;try{var wrappedSubmit=form.submit=function(){save(),form.submit=realSubmit,form.submit(),form.submit=wrappedSubmit}}catch(e){}}options.finishInit=function(cm){cm.save=save,cm.getTextArea=function(){return textarea},cm.toTextArea=function(){cm.toTextArea=isNaN,save(),textarea.parentNode.removeChild(cm.getWrapperElement()),textarea.style.display="",textarea.form&&(off(textarea.form,"submit",save),"function"==typeof textarea.form.submit&&(textarea.form.submit=realSubmit))}},textarea.style.display="none";var cm=CodeMirror(function(node){textarea.parentNode.insertBefore(node,textarea.nextSibling)},options);return cm};var StringStream=CodeMirror.StringStream=function(string,tabSize){this.pos=this.start=0,this.string=string,this.tabSize=tabSize||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};StringStream.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(match){var ch=this.string.charAt(this.pos);if("string"==typeof match)var ok=ch==match;else var ok=ch&&(match.test?match.test(ch):match(ch));return ok?(++this.pos,ch):void 0},eatWhile:function(match){for(var start=this.pos;this.eat(match););return this.pos>start},eatSpace:function(){for(var start=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>start},skipToEnd:function(){this.pos=this.string.length},skipTo:function(ch){var found=this.string.indexOf(ch,this.pos);return found>-1?(this.pos=found,!0):void 0},backUp:function(n){this.pos-=n},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},match:function(pattern,consume,caseInsensitive){if("string"!=typeof pattern){var match=this.string.slice(this.pos).match(pattern);return match&&match.index>0?null:(match&&consume!==!1&&(this.pos+=match[0].length),match)}var cased=function(str){return caseInsensitive?str.toLowerCase():str},substr=this.string.substr(this.pos,pattern.length);return cased(substr)==cased(pattern)?(consume!==!1&&(this.pos+=pattern.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(n,inner){this.lineStart+=n;try{return inner()}finally{this.lineStart-=n}}};var nextMarkerId=0,TextMarker=CodeMirror.TextMarker=function(doc,type){this.lines=[],this.type=type,this.doc=doc,this.id=++nextMarkerId};eventMixin(TextMarker),TextMarker.prototype.clear=function(){if(!this.explicitlyCleared){var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp&&startOperation(cm),hasHandler(this,"clear")){var found=this.find();found&&signalLater(this,"clear",found.from,found.to)}for(var min=null,max=null,i=0;i<this.lines.length;++i){var line=this.lines[i],span=getMarkedSpanFor(line.markedSpans,this);cm&&!this.collapsed?regLineChange(cm,lineNo(line),"text"):cm&&(null!=span.to&&(max=lineNo(line)),null!=span.from&&(min=lineNo(line))),line.markedSpans=removeMarkedSpan(line.markedSpans,span),null==span.from&&this.collapsed&&!lineIsHidden(this.doc,line)&&cm&&updateLineHeight(line,textHeight(cm.display))}if(cm&&this.collapsed&&!cm.options.lineWrapping)for(var i=0;i<this.lines.length;++i){var visual=visualLine(this.lines[i]),len=lineLength(visual);len>cm.display.maxLineLength&&(cm.display.maxLine=visual,cm.display.maxLineLength=len,cm.display.maxLineChanged=!0)}null!=min&&cm&&this.collapsed&&regChange(cm,min,max+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,cm&&reCheckSelection(cm.doc)),cm&&signalLater(cm,"markerCleared",cm,this),withOp&&endOperation(cm),this.parent&&this.parent.clear()}},TextMarker.prototype.find=function(side,lineObj){null==side&&"bookmark"==this.type&&(side=1);for(var from,to,i=0;i<this.lines.length;++i){var line=this.lines[i],span=getMarkedSpanFor(line.markedSpans,this);if(null!=span.from&&(from=Pos(lineObj?line:lineNo(line),span.from),-1==side))return from;if(null!=span.to&&(to=Pos(lineObj?line:lineNo(line),span.to),1==side))return to}return from&&{from:from,to:to}},TextMarker.prototype.changed=function(){var pos=this.find(-1,!0),widget=this,cm=this.doc.cm;pos&&cm&&runInOp(cm,function(){var line=pos.line,lineN=lineNo(pos.line),view=findViewForLine(cm,lineN);if(view&&(clearLineMeasurementCacheFor(view),cm.curOp.selectionChanged=cm.curOp.forceUpdate=!0),cm.curOp.updateMaxLine=!0,!lineIsHidden(widget.doc,line)&&null!=widget.height){var oldHeight=widget.height;widget.height=null;var dHeight=widgetHeight(widget)-oldHeight;dHeight&&updateLineHeight(line,line.height+dHeight)}})},TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;op.maybeHiddenMarkers&&-1!=indexOf(op.maybeHiddenMarkers,this)||(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(line)},TextMarker.prototype.detachLine=function(line){if(this.lines.splice(indexOf(this.lines,line),1),!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this)}};var nextMarkerId=0,SharedTextMarker=CodeMirror.SharedTextMarker=function(markers,primary){this.markers=markers,this.primary=primary;for(var i=0;i<markers.length;++i)markers[i].parent=this};eventMixin(SharedTextMarker),SharedTextMarker.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var i=0;i<this.markers.length;++i)this.markers[i].clear();signalLater(this,"clear")}},SharedTextMarker.prototype.find=function(side,lineObj){return this.primary.find(side,lineObj)};var LineWidget=CodeMirror.LineWidget=function(doc,node,options){if(options)for(var opt in options)options.hasOwnProperty(opt)&&(this[opt]=options[opt]);this.doc=doc,this.node=node};eventMixin(LineWidget),LineWidget.prototype.clear=function(){var cm=this.doc.cm,ws=this.line.widgets,line=this.line,no=lineNo(line);if(null!=no&&ws){for(var i=0;i<ws.length;++i)ws[i]==this&&ws.splice(i--,1);ws.length||(line.widgets=null);var height=widgetHeight(this);updateLineHeight(line,Math.max(0,line.height-height)),cm&&runInOp(cm,function(){adjustScrollWhenAboveVisible(cm,line,-height),regLineChange(cm,no,"widget")})}},LineWidget.prototype.changed=function(){var oldH=this.height,cm=this.doc.cm,line=this.line;this.height=null;var diff=widgetHeight(this)-oldH;diff&&(updateLineHeight(line,line.height+diff),cm&&runInOp(cm,function(){cm.curOp.forceUpdate=!0,adjustScrollWhenAboveVisible(cm,line,diff)}))};var Line=CodeMirror.Line=function(text,markedSpans,estimateHeight){this.text=text,attachMarkedSpans(this,markedSpans),this.height=estimateHeight?estimateHeight(this):1};eventMixin(Line),Line.prototype.lineNo=function(){return lineNo(this)};var styleToClassCache={},styleToClassCacheWithMode={};LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(at,n){for(var i=at,e=at+n;e>i;++i){var line=this.lines[i];this.height-=line.height,cleanUpLine(line),signalLater(line,"delete")}this.lines.splice(at,n)},collapse:function(lines){lines.push.apply(lines,this.lines)},insertInner:function(at,lines,height){this.height+=height,this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0;i<lines.length;++i)lines[i].parent=this},iterN:function(at,n,op){for(var e=at+n;e>at;++at)if(op(this.lines[at]))return!0}},BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(at,n){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(sz>at){var rm=Math.min(n,sz-at),oldHeight=child.height;if(child.removeInner(at,rm),this.height-=oldHeight-child.height,sz==rm&&(this.children.splice(i--,1),child.parent=null),0==(n-=rm))break;at=0}else at-=sz}if(this.size-n<25&&(this.children.length>1||!(this.children[0]instanceof LeafChunk))){var lines=[];this.collapse(lines),this.children=[new LeafChunk(lines)],this.children[0].parent=this}},collapse:function(lines){for(var i=0;i<this.children.length;++i)this.children[i].collapse(lines)},insertInner:function(at,lines,height){this.size+=lines.length,this.height+=height;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(sz>=at){if(child.insertInner(at,lines,height),child.lines&&child.lines.length>50){for(;child.lines.length>50;){var spilled=child.lines.splice(child.lines.length-25,25),newleaf=new LeafChunk(spilled);child.height-=newleaf.height,this.children.splice(i+1,0,newleaf),newleaf.parent=this}this.maybeSpill()}break}at-=sz}},maybeSpill:function(){if(!(this.children.length<=10)){var me=this;do{var spilled=me.children.splice(me.children.length-5,5),sibling=new BranchChunk(spilled);if(me.parent){me.size-=sibling.size,me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling)}else{var copy=new BranchChunk(me.children);copy.parent=me,me.children=[copy,sibling],me=copy}sibling.parent=me.parent}while(me.children.length>10);me.parent.maybeSpill()}},iterN:function(at,n,op){for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(sz>at){var used=Math.min(n,sz-at);if(child.iterN(at,used,op))return!0;if(0==(n-=used))break;at=0}else at-=sz}}};var nextDocId=0,Doc=CodeMirror.Doc=function(text,mode,firstLine,lineSep){if(!(this instanceof Doc))return new Doc(text,mode,firstLine,lineSep);null==firstLine&&(firstLine=0),BranchChunk.call(this,[new LeafChunk([new Line("",null)])]),this.first=firstLine,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=firstLine;var start=Pos(firstLine,0);this.sel=simpleSelection(start),this.history=new History(null),this.id=++nextDocId,this.modeOption=mode,this.lineSep=lineSep,"string"==typeof text&&(text=this.splitLines(text)),updateDoc(this,{from:start,to:start,text:text}),setSelection(this,simpleSelection(start),sel_dontScroll)};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,iter:function(from,to,op){op?this.iterN(from-this.first,to-from,op):this.iterN(this.first,this.first+this.size,from)},insert:function(at,lines){for(var height=0,i=0;i<lines.length;++i)height+=lines[i].height;this.insertInner(at-this.first,lines,height)},remove:function(at,n){this.removeInner(at-this.first,n)},getValue:function(lineSep){var lines=getLines(this,this.first,this.first+this.size);return lineSep===!1?lines:lines.join(lineSep||this.lineSeparator())},setValue:docMethodOp(function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:this.splitLines(code),origin:"setValue",full:!0},!0),setSelection(this,simpleSelection(top))}),replaceRange:function(code,from,to,origin){from=clipPos(this,from),to=to?clipPos(this,to):from,replaceRange(this,code,from,to,origin)},getRange:function(from,to,lineSep){var lines=getBetween(this,clipPos(this,from),clipPos(this,to));return lineSep===!1?lines:lines.join(lineSep||this.lineSeparator())},getLine:function(line){var l=this.getLineHandle(line);return l&&l.text},getLineHandle:function(line){return isLine(this,line)?getLine(this,line):void 0},getLineNumber:function(line){return lineNo(line)},getLineHandleVisualStart:function(line){return"number"==typeof line&&(line=getLine(this,line)),visualLine(line)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(pos){return clipPos(this,pos)},getCursor:function(start){var pos,range=this.sel.primary();return pos=null==start||"head"==start?range.head:"anchor"==start?range.anchor:"end"==start||"to"==start||start===!1?range.to():range.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:docMethodOp(function(line,ch,options){setSimpleSelection(this,clipPos(this,"number"==typeof line?Pos(line,ch||0):line),null,options)}),setSelection:docMethodOp(function(anchor,head,options){setSimpleSelection(this,clipPos(this,anchor),clipPos(this,head||anchor),options)}),extendSelection:docMethodOp(function(head,other,options){extendSelection(this,clipPos(this,head),other&&clipPos(this,other),options)}),extendSelections:docMethodOp(function(heads,options){extendSelections(this,clipPosArray(this,heads,options))}),extendSelectionsBy:docMethodOp(function(f,options){extendSelections(this,map(this.sel.ranges,f),options)}),setSelections:docMethodOp(function(ranges,primary,options){if(ranges.length){for(var i=0,out=[];i<ranges.length;i++)out[i]=new Range(clipPos(this,ranges[i].anchor),clipPos(this,ranges[i].head));null==primary&&(primary=Math.min(ranges.length-1,this.sel.primIndex)),setSelection(this,normalizeSelection(out,primary),options)}}),addSelection:docMethodOp(function(anchor,head,options){var ranges=this.sel.ranges.slice(0);ranges.push(new Range(clipPos(this,anchor),clipPos(this,head||anchor))),setSelection(this,normalizeSelection(ranges,ranges.length-1),options)}),getSelection:function(lineSep){for(var lines,ranges=this.sel.ranges,i=0;i<ranges.length;i++){var sel=getBetween(this,ranges[i].from(),ranges[i].to());lines=lines?lines.concat(sel):sel}return lineSep===!1?lines:lines.join(lineSep||this.lineSeparator())},getSelections:function(lineSep){for(var parts=[],ranges=this.sel.ranges,i=0;i<ranges.length;i++){var sel=getBetween(this,ranges[i].from(),ranges[i].to());lineSep!==!1&&(sel=sel.join(lineSep||this.lineSeparator())),parts[i]=sel}return parts},replaceSelection:function(code,collapse,origin){for(var dup=[],i=0;i<this.sel.ranges.length;i++)dup[i]=code;this.replaceSelections(dup,collapse,origin||"+input")},replaceSelections:docMethodOp(function(code,collapse,origin){for(var changes=[],sel=this.sel,i=0;i<sel.ranges.length;i++){var range=sel.ranges[i];changes[i]={from:range.from(),to:range.to(),text:this.splitLines(code[i]),origin:origin}}for(var newSel=collapse&&"end"!=collapse&&computeReplacedSel(this,changes,collapse),i=changes.length-1;i>=0;i--)makeChange(this,changes[i]);newSel?setSelectionReplaceHistory(this,newSel):this.cm&&ensureCursorVisible(this.cm)}),undo:docMethodOp(function(){makeChangeFromHistory(this,"undo")}),redo:docMethodOp(function(){makeChangeFromHistory(this,"redo")}),undoSelection:docMethodOp(function(){makeChangeFromHistory(this,"undo",!0)}),redoSelection:docMethodOp(function(){makeChangeFromHistory(this,"redo",!0)}),setExtending:function(val){this.extend=val},getExtending:function(){return this.extend},historySize:function(){for(var hist=this.history,done=0,undone=0,i=0;i<hist.done.length;i++)hist.done[i].ranges||++done;for(var i=0;i<hist.undone.length;i++)hist.undone[i].ranges||++undone;return{undo:done,redo:undone}},clearHistory:function(){this.history=new History(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(forceSplit){return forceSplit&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(gen){return this.history.generation==(gen||this.cleanGeneration)},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(histData){var hist=this.history=new History(this.history.maxGeneration);hist.done=copyHistoryArray(histData.done.slice(0),null,!0),hist.undone=copyHistoryArray(histData.undone.slice(0),null,!0)},addLineClass:docMethodOp(function(handle,where,cls){return changeLine(this,handle,"gutter"==where?"gutter":"class",function(line){var prop="text"==where?"textClass":"background"==where?"bgClass":"gutter"==where?"gutterClass":"wrapClass";if(line[prop]){if(classTest(cls).test(line[prop]))return!1;line[prop]+=" "+cls}else line[prop]=cls;return!0})}),removeLineClass:docMethodOp(function(handle,where,cls){return changeLine(this,handle,"gutter"==where?"gutter":"class",function(line){var prop="text"==where?"textClass":"background"==where?"bgClass":"gutter"==where?"gutterClass":"wrapClass",cur=line[prop];if(!cur)return!1;if(null==cls)line[prop]=null;else{var found=cur.match(classTest(cls));if(!found)return!1;var end=found.index+found[0].length;line[prop]=cur.slice(0,found.index)+(found.index&&end!=cur.length?" ":"")+cur.slice(end)||null}return!0})}),addLineWidget:docMethodOp(function(handle,node,options){return addLineWidget(this,handle,node,options)}),removeLineWidget:function(widget){widget.clear()},markText:function(from,to,options){return markText(this,clipPos(this,from),clipPos(this,to),options,options&&options.type||"range")},setBookmark:function(pos,options){var realOpts={replacedWith:options&&(null==options.nodeType?options.widget:options),insertLeft:options&&options.insertLeft,clearWhenEmpty:!1,shared:options&&options.shared,handleMouseEvents:options&&options.handleMouseEvents};return pos=clipPos(this,pos),markText(this,pos,pos,realOpts,"bookmark")},findMarksAt:function(pos){pos=clipPos(this,pos);var markers=[],spans=getLine(this,pos.line).markedSpans;if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];(null==span.from||span.from<=pos.ch)&&(null==span.to||span.to>=pos.ch)&&markers.push(span.marker.parent||span.marker)}return markers},findMarks:function(from,to,filter){from=clipPos(this,from),to=clipPos(this,to);var found=[],lineNo=from.line;return this.iter(from.line,to.line+1,function(line){var spans=line.markedSpans;if(spans)for(var i=0;i<spans.length;i++){var span=spans[i];lineNo==from.line&&from.ch>span.to||null==span.from&&lineNo!=from.line||lineNo==to.line&&span.from>to.ch||filter&&!filter(span.marker)||found.push(span.marker.parent||span.marker)}++lineNo}),found},getAllMarks:function(){var markers=[];return this.iter(function(line){var sps=line.markedSpans;if(sps)for(var i=0;i<sps.length;++i)null!=sps[i].from&&markers.push(sps[i].marker)}),markers},posFromIndex:function(off){var ch,lineNo=this.first;return this.iter(function(line){var sz=line.text.length+1;return sz>off?(ch=off,!0):(off-=sz,void++lineNo)}),clipPos(this,Pos(lineNo,ch))},indexFromPos:function(coords){coords=clipPos(this,coords);var index=coords.ch;return coords.line<this.first||coords.ch<0?0:(this.iter(this.first,coords.line,function(line){index+=line.text.length+1}),index)},copy:function(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return doc.scrollTop=this.scrollTop,doc.scrollLeft=this.scrollLeft,doc.sel=this.sel,doc.extend=!1,copyHistory&&(doc.history.undoDepth=this.history.undoDepth,doc.setHistory(this.getHistory())),doc},linkedDoc:function(options){options||(options={});var from=this.first,to=this.first+this.size;null!=options.from&&options.from>from&&(from=options.from),null!=options.to&&options.to<to&&(to=options.to);var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from,this.lineSep);return options.sharedHist&&(copy.history=this.history),(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist}),copy.linked=[{doc:this,isParent:!0,sharedHist:options.sharedHist}],copySharedMarkers(copy,findSharedMarkers(this)),copy},unlinkDoc:function(other){if(other instanceof CodeMirror&&(other=other.doc),this.linked)for(var i=0;i<this.linked.length;++i){var link=this.linked[i];if(link.doc==other){this.linked.splice(i,1),other.unlinkDoc(this),detachSharedMarkers(findSharedMarkers(this));break}}if(other.history==this.history){var splitIds=[other.id];linkedDocs(other,function(doc){splitIds.push(doc.id)},!0),other.history=new History(null),other.history.done=copyHistoryArray(this.history.done,splitIds),other.history.undone=copyHistoryArray(this.history.undone,splitIds)}},iterLinkedDocs:function(f){linkedDocs(this,f)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(str){return this.lineSep?str.split(this.lineSep):splitLinesAuto(str)},lineSeparator:function(){return this.lineSep||"\n"}}),Doc.prototype.eachLine=Doc.prototype.iter;var dontDelegate="iter insert remove copy getEditor constructor".split(" ");for(var prop in Doc.prototype)Doc.prototype.hasOwnProperty(prop)&&indexOf(dontDelegate,prop)<0&&(CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments)}}(Doc.prototype[prop]));eventMixin(Doc);var e_preventDefault=CodeMirror.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},e_stopPropagation=CodeMirror.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e_stop=CodeMirror.e_stop=function(e){e_preventDefault(e),e_stopPropagation(e)},on=CodeMirror.on=function(emitter,type,f){if(emitter.addEventListener)emitter.addEventListener(type,f,!1);else if(emitter.attachEvent)emitter.attachEvent("on"+type,f);else{var map=emitter._handlers||(emitter._handlers={}),arr=map[type]||(map[type]=[]);arr.push(f)}},noHandlers=[],off=CodeMirror.off=function(emitter,type,f){if(emitter.removeEventListener)emitter.removeEventListener(type,f,!1);else if(emitter.detachEvent)emitter.detachEvent("on"+type,f);else for(var handlers=getHandlers(emitter,type,!1),i=0;i<handlers.length;++i)if(handlers[i]==f){handlers.splice(i,1);break}},signal=CodeMirror.signal=function(emitter,type){var handlers=getHandlers(emitter,type,!0);if(handlers.length)for(var args=Array.prototype.slice.call(arguments,2),i=0;i<handlers.length;++i)handlers[i].apply(null,args)},orphanDelayedCallbacks=null,scrollerGap=30,Pass=CodeMirror.Pass={toString:function(){return"CodeMirror.Pass"}},sel_dontScroll={scroll:!1},sel_mouse={origin:"*mouse"},sel_move={origin:"+move"};Delayed.prototype.set=function(ms,f){clearTimeout(this.id),this.id=setTimeout(f,ms)};var countColumn=CodeMirror.countColumn=function(string,end,tabSize,startIndex,startValue){null==end&&(end=string.search(/[^\s\u00a0]/),-1==end&&(end=string.length));for(var i=startIndex||0,n=startValue||0;;){var nextTab=string.indexOf("	",i);if(0>nextTab||nextTab>=end)return n+(end-i);n+=nextTab-i,n+=tabSize-n%tabSize,i=nextTab+1}},findColumn=CodeMirror.findColumn=function(string,goal,tabSize){for(var pos=0,col=0;;){var nextTab=string.indexOf("	",pos);-1==nextTab&&(nextTab=string.length);var skipped=nextTab-pos;if(nextTab==string.length||col+skipped>=goal)return pos+Math.min(skipped,goal-col);if(col+=nextTab-pos,col+=tabSize-col%tabSize,pos=nextTab+1,col>=goal)return pos}},spaceStrs=[""],selectInput=function(node){node.select()};ios?selectInput=function(node){node.selectionStart=0,node.selectionEnd=node.value.length}:ie&&(selectInput=function(node){try{node.select()}catch(_e){}});var range,nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,isWordCharBasic=CodeMirror.isWordChar=function(ch){return/\w/.test(ch)||ch>""&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch))},extendingChars=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;
range=document.createRange?function(node,start,end,endNode){var r=document.createRange();return r.setEnd(endNode||node,end),r.setStart(node,start),r}:function(node,start,end){var r=document.body.createTextRange();try{r.moveToElementText(node.parentNode)}catch(e){return r}return r.collapse(!0),r.moveEnd("character",end),r.moveStart("character",start),r};var contains=CodeMirror.contains=function(parent,child){if(3==child.nodeType&&(child=child.parentNode),parent.contains)return parent.contains(child);do if(11==child.nodeType&&(child=child.host),child==parent)return!0;while(child=child.parentNode)};ie&&11>ie_version&&(activeElt=function(){try{return document.activeElement}catch(e){return document.body}});var zwspSupported,badBidiRects,rmClass=CodeMirror.rmClass=function(node,cls){var current=node.className,match=classTest(cls).exec(current);if(match){var after=current.slice(match.index+match[0].length);node.className=current.slice(0,match.index)+(after?match[1]+after:"")}},addClass=CodeMirror.addClass=function(node,cls){var current=node.className;classTest(cls).test(current)||(node.className+=(current?" ":"")+cls)},globalsRegistered=!1,dragAndDrop=function(){if(ie&&9>ie_version)return!1;var div=elt("div");return"draggable"in div||"dragDrop"in div}(),splitLinesAuto=CodeMirror.splitLines=3!="\n\nb".split(/\n/).length?function(string){for(var pos=0,result=[],l=string.length;l>=pos;){var nl=string.indexOf("\n",pos);-1==nl&&(nl=string.length);var line=string.slice(pos,"\r"==string.charAt(nl-1)?nl-1:nl),rt=line.indexOf("\r");-1!=rt?(result.push(line.slice(0,rt)),pos+=rt+1):(result.push(line),pos=nl+1)}return result}:function(string){return string.split(/\r\n?|\n/)},hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd}catch(e){return!1}}:function(te){try{var range=te.ownerDocument.selection.createRange()}catch(e){}return range&&range.parentElement()==te?0!=range.compareEndPoints("StartToEnd",range):!1},hasCopyEvent=function(){var e=elt("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),badZoomedRects=null,keyNames=CodeMirror.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};!function(){for(var i=0;10>i;i++)keyNames[i+48]=keyNames[i+96]=String(i);for(var i=65;90>=i;i++)keyNames[i]=String.fromCharCode(i);for(var i=1;12>=i;i++)keyNames[i+111]=keyNames[i+63235]="F"+i}();var bidiOther,bidiOrdering=function(){function charType(code){return 247>=code?lowTypes.charAt(code):code>=1424&&1524>=code?"R":code>=1536&&1773>=code?arabicTypes.charAt(code-1536):code>=1774&&2220>=code?"r":code>=8192&&8203>=code?"w":8204==code?"b":"L"}function BidiSpan(level,from,to){this.level=level,this.from=from,this.to=to}var lowTypes="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",arabicTypes="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",bidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/,outerType="L";return function(str){if(!bidiRE.test(str))return!1;for(var type,len=str.length,types=[],i=0;len>i;++i)types.push(type=charType(str.charCodeAt(i)));for(var i=0,prev=outerType;len>i;++i){var type=types[i];"m"==type?types[i]=prev:prev=type}for(var i=0,cur=outerType;len>i;++i){var type=types[i];"1"==type&&"r"==cur?types[i]="n":isStrong.test(type)&&(cur=type,"r"==type&&(types[i]="R"))}for(var i=1,prev=types[0];len-1>i;++i){var type=types[i];"+"==type&&"1"==prev&&"1"==types[i+1]?types[i]="1":","!=type||prev!=types[i+1]||"1"!=prev&&"n"!=prev||(types[i]=prev),prev=type}for(var i=0;len>i;++i){var type=types[i];if(","==type)types[i]="N";else if("%"==type){for(var end=i+1;len>end&&"%"==types[end];++end);for(var replace=i&&"!"==types[i-1]||len>end&&"1"==types[end]?"1":"N",j=i;end>j;++j)types[j]=replace;i=end-1}}for(var i=0,cur=outerType;len>i;++i){var type=types[i];"L"==cur&&"1"==type?types[i]="L":isStrong.test(type)&&(cur=type)}for(var i=0;len>i;++i)if(isNeutral.test(types[i])){for(var end=i+1;len>end&&isNeutral.test(types[end]);++end);for(var before="L"==(i?types[i-1]:outerType),after="L"==(len>end?types[end]:outerType),replace=before||after?"L":"R",j=i;end>j;++j)types[j]=replace;i=end-1}for(var m,order=[],i=0;len>i;)if(countsAsLeft.test(types[i])){var start=i;for(++i;len>i&&countsAsLeft.test(types[i]);++i);order.push(new BidiSpan(0,start,i))}else{var pos=i,at=order.length;for(++i;len>i&&"L"!=types[i];++i);for(var j=pos;i>j;)if(countsAsNum.test(types[j])){j>pos&&order.splice(at,0,new BidiSpan(1,pos,j));var nstart=j;for(++j;i>j&&countsAsNum.test(types[j]);++j);order.splice(at,0,new BidiSpan(2,nstart,j)),pos=j}else++j;i>pos&&order.splice(at,0,new BidiSpan(1,pos,i))}return 1==order[0].level&&(m=str.match(/^\s+/))&&(order[0].from=m[0].length,order.unshift(new BidiSpan(0,0,m[0].length))),1==lst(order).level&&(m=str.match(/\s+$/))&&(lst(order).to-=m[0].length,order.push(new BidiSpan(0,len-m[0].length,len))),2==order[0].level&&order.unshift(new BidiSpan(1,order[0].to,order[0].to)),order[0].level!=lst(order).level&&order.push(new BidiSpan(order[0].level,len,len)),order}}();return CodeMirror.version="5.8.0",CodeMirror}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){function clearPlaceholder(cm){cm.state.placeholder&&(cm.state.placeholder.parentNode.removeChild(cm.state.placeholder),cm.state.placeholder=null)}function setPlaceholder(cm){clearPlaceholder(cm);var elt=cm.state.placeholder=document.createElement("pre");elt.style.cssText="height: 0; overflow: visible",elt.className="CodeMirror-placeholder";var placeHolder=cm.getOption("placeholder");"string"==typeof placeHolder&&(placeHolder=document.createTextNode(placeHolder)),elt.appendChild(placeHolder),cm.display.lineSpace.insertBefore(elt,cm.display.lineSpace.firstChild)}function onBlur(cm){isEmpty(cm)&&setPlaceholder(cm)}function onChange(cm){var wrapper=cm.getWrapperElement(),empty=isEmpty(cm);wrapper.className=wrapper.className.replace(" CodeMirror-empty","")+(empty?" CodeMirror-empty":""),empty?setPlaceholder(cm):clearPlaceholder(cm)}function isEmpty(cm){return 1===cm.lineCount()&&""===cm.getLine(0)}CodeMirror.defineOption("placeholder","",function(cm,val,old){var prev=old&&old!=CodeMirror.Init;if(val&&!prev)cm.on("blur",onBlur),cm.on("change",onChange),onChange(cm);else if(!val&&prev){cm.off("blur",onBlur),cm.off("change",onChange),clearPlaceholder(cm);var wrapper=cm.getWrapperElement();wrapper.className=wrapper.className.replace(" CodeMirror-empty","")}val&&!cm.hasFocus()&&onBlur(cm)})}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror"),require("../xml/xml"),require("../meta")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../meta"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.defineMode("markdown",function(cmCfg,modeCfg){function getMode(name){if(CodeMirror.findModeByName){var found=CodeMirror.findModeByName(name);found&&(name=found.mime||found.mimes[0])}var mode=CodeMirror.getMode(cmCfg,name);return"null"==mode.name?null:mode}function switchInline(stream,state,f){return state.f=state.inline=f,f(stream,state)}function switchBlock(stream,state,f){return state.f=state.block=f,f(stream,state)}function lineIsEmpty(line){return!line||!/\S/.test(line.string)}function blankLine(state){return state.linkTitle=!1,state.em=!1,state.strong=!1,state.strikethrough=!1,state.quote=0,state.indentedCode=!1,htmlFound||state.f!=htmlBlock||(state.f=inlineNormal,state.block=blockNormal),state.trailingSpace=0,state.trailingSpaceNewLine=!1,state.prevLine=state.thisLine,state.thisLine=null,null}function blockNormal(stream,state){var sol=stream.sol(),prevLineIsList=state.list!==!1,prevLineIsIndentedCode=state.indentedCode;state.indentedCode=!1,prevLineIsList&&(state.indentationDiff>=0?(state.indentationDiff<4&&(state.indentation-=state.indentationDiff),state.list=null):state.indentation>0?(state.list=null,state.listDepth=Math.floor(state.indentation/4)):(state.list=!1,state.listDepth=0));var match=null;if(state.indentationDiff>=4)return stream.skipToEnd(),prevLineIsIndentedCode||lineIsEmpty(state.prevLine)?(state.indentation-=4,state.indentedCode=!0,tokenTypes.code):null;if(stream.eatSpace())return null;if((match=stream.match(atxHeaderRE))&&match[1].length<=6)return state.header=match[1].length,modeCfg.highlightFormatting&&(state.formatting="header"),state.f=state.inline,getType(state);if(!(lineIsEmpty(state.prevLine)||state.quote||prevLineIsList||prevLineIsIndentedCode)&&(match=stream.match(setextHeaderRE)))return state.header="="==match[0].charAt(0)?1:2,modeCfg.highlightFormatting&&(state.formatting="header"),state.f=state.inline,getType(state);if(stream.eat(">"))return state.quote=sol?1:state.quote+1,modeCfg.highlightFormatting&&(state.formatting="quote"),stream.eatSpace(),getType(state);if("["===stream.peek())return switchInline(stream,state,footnoteLink);if(stream.match(hrRE,!0))return state.hr=!0,tokenTypes.hr;if((lineIsEmpty(state.prevLine)||prevLineIsList)&&(stream.match(ulRE,!1)||stream.match(olRE,!1))){var listType=null;return stream.match(ulRE,!0)?listType="ul":(stream.match(olRE,!0),listType="ol"),state.indentation=stream.column()+stream.current().length,state.list=!0,state.listDepth++,modeCfg.taskLists&&stream.match(taskListRE,!1)&&(state.taskList=!0),state.f=state.inline,modeCfg.highlightFormatting&&(state.formatting=["list","list-"+listType]),getType(state)}return modeCfg.fencedCodeBlocks&&(match=stream.match(fencedCodeRE,!0))?(state.fencedChars=match[1],state.localMode=getMode(match[2]),state.localMode&&(state.localState=state.localMode.startState()),state.f=state.block=local,modeCfg.highlightFormatting&&(state.formatting="code-block"),state.code=!0,getType(state)):switchInline(stream,state,state.inline)}function htmlBlock(stream,state){var style=htmlMode.token(stream,state.htmlState);return(htmlFound&&null===state.htmlState.tagStart&&!state.htmlState.context&&state.htmlState.tokenize.isInText||state.md_inside&&stream.current().indexOf(">")>-1)&&(state.f=inlineNormal,state.block=blockNormal,state.htmlState=null),style}function local(stream,state){return stream.sol()&&state.fencedChars&&stream.match(state.fencedChars,!1)?(state.localMode=state.localState=null,state.f=state.block=leavingLocal,null):state.localMode?state.localMode.token(stream,state.localState):(stream.skipToEnd(),tokenTypes.code)}function leavingLocal(stream,state){stream.match(state.fencedChars),state.block=blockNormal,state.f=inlineNormal,state.fencedChars=null,modeCfg.highlightFormatting&&(state.formatting="code-block"),state.code=!0;var returnType=getType(state);return state.code=!1,returnType}function getType(state){var styles=[];if(state.formatting){styles.push(tokenTypes.formatting),"string"==typeof state.formatting&&(state.formatting=[state.formatting]);for(var i=0;i<state.formatting.length;i++)styles.push(tokenTypes.formatting+"-"+state.formatting[i]),"header"===state.formatting[i]&&styles.push(tokenTypes.formatting+"-"+state.formatting[i]+"-"+state.header),"quote"===state.formatting[i]&&styles.push(!modeCfg.maxBlockquoteDepth||modeCfg.maxBlockquoteDepth>=state.quote?tokenTypes.formatting+"-"+state.formatting[i]+"-"+state.quote:"error")}if(state.taskOpen)return styles.push("meta"),styles.length?styles.join(" "):null;if(state.taskClosed)return styles.push("property"),styles.length?styles.join(" "):null;if(state.linkHref?styles.push(tokenTypes.linkHref,"url"):(state.strong&&styles.push(tokenTypes.strong),state.em&&styles.push(tokenTypes.em),state.strikethrough&&styles.push(tokenTypes.strikethrough),state.linkText&&styles.push(tokenTypes.linkText),state.code&&styles.push(tokenTypes.code)),state.header&&styles.push(tokenTypes.header,tokenTypes.header+"-"+state.header),state.quote&&(styles.push(tokenTypes.quote),styles.push(!modeCfg.maxBlockquoteDepth||modeCfg.maxBlockquoteDepth>=state.quote?tokenTypes.quote+"-"+state.quote:tokenTypes.quote+"-"+modeCfg.maxBlockquoteDepth)),state.list!==!1){var listMod=(state.listDepth-1)%3;styles.push(listMod?1===listMod?tokenTypes.list2:tokenTypes.list3:tokenTypes.list1)}return state.trailingSpaceNewLine?styles.push("trailing-space-new-line"):state.trailingSpace&&styles.push("trailing-space-"+(state.trailingSpace%2?"a":"b")),styles.length?styles.join(" "):null}function handleText(stream,state){return stream.match(textRE,!0)?getType(state):void 0}function inlineNormal(stream,state){var style=state.text(stream,state);if("undefined"!=typeof style)return style;if(state.list)return state.list=null,getType(state);if(state.taskList){var taskOpen="x"!==stream.match(taskListRE,!0)[1];return taskOpen?state.taskOpen=!0:state.taskClosed=!0,modeCfg.highlightFormatting&&(state.formatting="task"),state.taskList=!1,getType(state)}if(state.taskOpen=!1,state.taskClosed=!1,state.header&&stream.match(/^#+$/,!0))return modeCfg.highlightFormatting&&(state.formatting="header"),getType(state);var sol=stream.sol(),ch=stream.next();if("\\"===ch&&(stream.next(),modeCfg.highlightFormatting)){var type=getType(state),formattingEscape=tokenTypes.formatting+"-escape";return type?type+" "+formattingEscape:formattingEscape}if(state.linkTitle){state.linkTitle=!1;var matchCh=ch;"("===ch&&(matchCh=")"),matchCh=(matchCh+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var regex="^\\s*(?:[^"+matchCh+"\\\\]+|\\\\\\\\|\\\\.)"+matchCh;if(stream.match(new RegExp(regex),!0))return tokenTypes.linkHref}if("`"===ch){var previousFormatting=state.formatting;modeCfg.highlightFormatting&&(state.formatting="code");var t=getType(state),before=stream.pos;stream.eatWhile("`");var difference=1+stream.pos-before;return state.code?difference===codeDepth?(state.code=!1,t):(state.formatting=previousFormatting,getType(state)):(codeDepth=difference,state.code=!0,getType(state))}if(state.code)return getType(state);if("!"===ch&&stream.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return stream.match(/\[[^\]]*\]/),state.inline=state.f=linkHref,tokenTypes.image;if("["===ch&&stream.match(/.*\](\(.*\)| ?\[.*\])/,!1))return state.linkText=!0,modeCfg.highlightFormatting&&(state.formatting="link"),getType(state);if("]"===ch&&state.linkText&&stream.match(/\(.*\)| ?\[.*\]/,!1)){modeCfg.highlightFormatting&&(state.formatting="link");var type=getType(state);return state.linkText=!1,state.inline=state.f=linkHref,type}if("<"===ch&&stream.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1)){state.f=state.inline=linkInline,modeCfg.highlightFormatting&&(state.formatting="link");var type=getType(state);return type?type+=" ":type="",type+tokenTypes.linkInline}if("<"===ch&&stream.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1)){state.f=state.inline=linkInline,modeCfg.highlightFormatting&&(state.formatting="link");var type=getType(state);return type?type+=" ":type="",type+tokenTypes.linkEmail}if("<"===ch&&stream.match(/^(!--|\w)/,!1)){var end=stream.string.indexOf(">",stream.pos);if(-1!=end){var atts=stream.string.substring(stream.start,end);/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(atts)&&(state.md_inside=!0)}return stream.backUp(1),state.htmlState=CodeMirror.startState(htmlMode),switchBlock(stream,state,htmlBlock)}if("<"===ch&&stream.match(/^\/\w*?>/))return state.md_inside=!1,"tag";var ignoreUnderscore=!1;if(!modeCfg.underscoresBreakWords&&"_"===ch&&"_"!==stream.peek()&&stream.match(/(\w)/,!1)){var prevPos=stream.pos-2;if(prevPos>=0){var prevCh=stream.string.charAt(prevPos);"_"!==prevCh&&prevCh.match(/(\w)/,!1)&&(ignoreUnderscore=!0)}}if("*"===ch||"_"===ch&&!ignoreUnderscore)if(sol&&" "===stream.peek());else{if(state.strong===ch&&stream.eat(ch)){modeCfg.highlightFormatting&&(state.formatting="strong");var t=getType(state);return state.strong=!1,t}if(!state.strong&&stream.eat(ch))return state.strong=ch,modeCfg.highlightFormatting&&(state.formatting="strong"),getType(state);if(state.em===ch){modeCfg.highlightFormatting&&(state.formatting="em");var t=getType(state);return state.em=!1,t}if(!state.em)return state.em=ch,modeCfg.highlightFormatting&&(state.formatting="em"),getType(state)}else if(" "===ch&&(stream.eat("*")||stream.eat("_"))){if(" "===stream.peek())return getType(state);stream.backUp(1)}if(modeCfg.strikethrough)if("~"===ch&&stream.eatWhile(ch)){if(state.strikethrough){modeCfg.highlightFormatting&&(state.formatting="strikethrough");var t=getType(state);return state.strikethrough=!1,t}if(stream.match(/^[^\s]/,!1))return state.strikethrough=!0,modeCfg.highlightFormatting&&(state.formatting="strikethrough"),getType(state)}else if(" "===ch&&stream.match(/^~~/,!0)){if(" "===stream.peek())return getType(state);stream.backUp(2)}return" "===ch&&(stream.match(/ +$/,!1)?state.trailingSpace++:state.trailingSpace&&(state.trailingSpaceNewLine=!0)),getType(state)}function linkInline(stream,state){var ch=stream.next();if(">"===ch){state.f=state.inline=inlineNormal,modeCfg.highlightFormatting&&(state.formatting="link");var type=getType(state);return type?type+=" ":type="",type+tokenTypes.linkInline}return stream.match(/^[^>]+/,!0),tokenTypes.linkInline}function linkHref(stream,state){if(stream.eatSpace())return null;var ch=stream.next();return"("===ch||"["===ch?(state.f=state.inline=getLinkHrefInside("("===ch?")":"]"),modeCfg.highlightFormatting&&(state.formatting="link-string"),state.linkHref=!0,getType(state)):"error"}function getLinkHrefInside(endChar){return function(stream,state){var ch=stream.next();if(ch===endChar){state.f=state.inline=inlineNormal,modeCfg.highlightFormatting&&(state.formatting="link-string");var returnState=getType(state);return state.linkHref=!1,returnState}return stream.match(inlineRE(endChar),!0)&&stream.backUp(1),state.linkHref=!0,getType(state)}}function footnoteLink(stream,state){return stream.match(/^[^\]]*\]:/,!1)?(state.f=footnoteLinkInside,stream.next(),modeCfg.highlightFormatting&&(state.formatting="link"),state.linkText=!0,getType(state)):switchInline(stream,state,inlineNormal)}function footnoteLinkInside(stream,state){if(stream.match(/^\]:/,!0)){state.f=state.inline=footnoteUrl,modeCfg.highlightFormatting&&(state.formatting="link");var returnType=getType(state);return state.linkText=!1,returnType}return stream.match(/^[^\]]+/,!0),tokenTypes.linkText}function footnoteUrl(stream,state){return stream.eatSpace()?null:(stream.match(/^[^\s]+/,!0),void 0===stream.peek()?state.linkTitle=!0:stream.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),state.f=state.inline=inlineNormal,tokenTypes.linkHref+" url")}function inlineRE(endChar){return savedInlineRE[endChar]||(endChar=(endChar+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),savedInlineRE[endChar]=new RegExp("^(?:[^\\\\]|\\\\.)*?("+endChar+")")),savedInlineRE[endChar]}var htmlFound=CodeMirror.modes.hasOwnProperty("xml"),htmlMode=CodeMirror.getMode(cmCfg,htmlFound?{name:"xml",htmlMode:!0}:"text/plain");void 0===modeCfg.highlightFormatting&&(modeCfg.highlightFormatting=!1),void 0===modeCfg.maxBlockquoteDepth&&(modeCfg.maxBlockquoteDepth=0),void 0===modeCfg.underscoresBreakWords&&(modeCfg.underscoresBreakWords=!0),void 0===modeCfg.taskLists&&(modeCfg.taskLists=!1),void 0===modeCfg.strikethrough&&(modeCfg.strikethrough=!1),void 0===modeCfg.tokenTypeOverrides&&(modeCfg.tokenTypeOverrides={});var codeDepth=0,tokenTypes={header:"header",code:"comment",quote:"quote",list1:"variable-2",list2:"variable-3",list3:"keyword",hr:"hr",image:"tag",formatting:"formatting",linkInline:"link",linkEmail:"link",linkText:"link",linkHref:"string",em:"em",strong:"strong",strikethrough:"strikethrough"};for(var tokenType in tokenTypes)tokenTypes.hasOwnProperty(tokenType)&&modeCfg.tokenTypeOverrides[tokenType]&&(tokenTypes[tokenType]=modeCfg.tokenTypeOverrides[tokenType]);var hrRE=/^([*\-_])(?:\s*\1){2,}\s*$/,ulRE=/^[*\-+]\s+/,olRE=/^[0-9]+([.)])\s+/,taskListRE=/^\[(x| )\](?=\s)/,atxHeaderRE=modeCfg.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,setextHeaderRE=/^ *(?:\={1,}|-{1,})\s*$/,textRE=/^[^#!\[\]*_\\<>` "'(~]+/,fencedCodeRE=new RegExp("^("+(modeCfg.fencedCodeBlocks===!0?"~~~+|```+":modeCfg.fencedCodeBlocks)+")[ \\t]*([\\w+#]*)"),savedInlineRE=[],mode={startState:function(){return{f:blockNormal,prevLine:null,thisLine:null,block:blockNormal,htmlState:null,indentation:0,inline:inlineNormal,text:handleText,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,em:!1,strong:!1,header:0,hr:!1,taskList:!1,list:!1,listDepth:0,quote:0,trailingSpace:0,trailingSpaceNewLine:!1,strikethrough:!1,fencedChars:null}},copyState:function(s){return{f:s.f,prevLine:s.prevLine,thisLine:s.this,block:s.block,htmlState:s.htmlState&&CodeMirror.copyState(htmlMode,s.htmlState),indentation:s.indentation,localMode:s.localMode,localState:s.localMode?CodeMirror.copyState(s.localMode,s.localState):null,inline:s.inline,text:s.text,formatting:!1,linkTitle:s.linkTitle,code:s.code,em:s.em,strong:s.strong,strikethrough:s.strikethrough,header:s.header,hr:s.hr,taskList:s.taskList,list:s.list,listDepth:s.listDepth,quote:s.quote,indentedCode:s.indentedCode,trailingSpace:s.trailingSpace,trailingSpaceNewLine:s.trailingSpaceNewLine,md_inside:s.md_inside,fencedChars:s.fencedChars}},token:function(stream,state){if(state.formatting=!1,stream!=state.thisLine){var forceBlankLine=state.header||state.hr;if(state.header=0,state.hr=!1,stream.match(/^\s*$/,!0)||forceBlankLine){if(blankLine(state),!forceBlankLine)return null;state.prevLine=null}state.prevLine=state.thisLine,state.thisLine=stream,state.taskList=!1,state.trailingSpace=0,state.trailingSpaceNewLine=!1,state.f=state.block;var indentation=stream.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,difference=4*Math.floor((indentation-state.indentation)/4);difference>4&&(difference=4);var adjustedIndentation=state.indentation+difference;if(state.indentationDiff=adjustedIndentation-state.indentation,state.indentation=adjustedIndentation,indentation>0)return null}return state.f(stream,state)},innerMode:function(state){return state.block==htmlBlock?{state:state.htmlState,mode:htmlMode}:state.localState?{state:state.localState,mode:state.localMode}:{state:state,mode:mode}},blankLine:blankLine,getType:getType,fold:"markdown"};return mode},"xml"),CodeMirror.defineMIME("text/x-markdown","markdown")}),angular.module("ui.codemirror",[]).constant("uiCodemirrorConfig",{}).directive("uiCodemirror",uiCodemirrorDirective),uiCodemirrorDirective.$inject=["$timeout","uiCodemirrorConfig"],function(){function getDefaultOpts(simple){"use strict";var defaultOptions={omitExtraWLInCodeBlocks:{"default":!1,describe:"Omit the default extra whiteline added to code blocks",type:"boolean"},noHeaderId:{"default":!1,describe:"Turn on/off generated header id",type:"boolean"},prefixHeaderId:{"default":!1,describe:"Specify a prefix to generated header ids",type:"string"},headerLevelStart:{"default":!1,describe:"The header blocks level start",type:"integer"},parseImgDimensions:{"default":!1,describe:"Turn on/off image dimension parsing",type:"boolean"},simplifiedAutoLink:{"default":!1,describe:"Turn on/off GFM autolink style",type:"boolean"},literalMidWordUnderscores:{"default":!1,describe:"Parse midword underscores as literal underscores",type:"boolean"},strikethrough:{"default":!1,describe:"Turn on/off strikethrough support",type:"boolean"},tables:{"default":!1,describe:"Turn on/off tables support",type:"boolean"},tablesHeaderId:{"default":!1,describe:"Add an id to table headers",type:"boolean"},ghCodeBlocks:{"default":!0,describe:"Turn on/off GFM fenced code blocks support",type:"boolean"},tasklists:{"default":!1,describe:"Turn on/off GFM tasklist support",type:"boolean"},smoothLivePreview:{"default":!1,describe:"Prevents weird effects in live previews due to incomplete input",type:"boolean"}};if(simple===!1)return JSON.parse(JSON.stringify(defaultOptions));var ret={};for(var opt in defaultOptions)defaultOptions.hasOwnProperty(opt)&&(ret[opt]=defaultOptions[opt].default);return ret}function validate(extension,name){"use strict";var errMsg=name?"Error in "+name+" extension->":"Error in unnamed extension",ret={valid:!0,error:""};showdown.helper.isArray(extension)||(extension=[extension]);for(var i=0;i<extension.length;++i){var baseMsg=errMsg+" sub-extension "+i+": ",ext=extension[i];if("object"!=typeof ext)return ret.valid=!1,ret.error=baseMsg+"must be an object, but "+typeof ext+" given",ret;if(!showdown.helper.isString(ext.type))return ret.valid=!1,ret.error=baseMsg+'property "type" must be a string, but '+typeof ext.type+" given",ret;var type=ext.type=ext.type.toLowerCase();if("language"===type&&(type=ext.type="lang"),"html"===type&&(type=ext.type="output"),"lang"!==type&&"output"!==type)return ret.valid=!1,ret.error=baseMsg+"type "+type+' is not recognized. Valid values: "lang" or "output"',ret;if(ext.filter){if("function"!=typeof ext.filter)return ret.valid=!1,ret.error=baseMsg+'"filter" must be a function, but '+typeof ext.filter+" given",ret}else{if(!ext.regex)return ret.valid=!1,ret.error=baseMsg+'extensions must define either a "regex" property or a "filter" method',ret;if(showdown.helper.isString(ext.regex)&&(ext.regex=new RegExp(ext.regex,"g")),!ext.regex instanceof RegExp)return ret.valid=!1,ret.error=baseMsg+'"regex" property must either be a string or a RegExp object, but '+typeof ext.regex+" given",ret;if(showdown.helper.isUndefined(ext.replace))return ret.valid=!1,ret.error=baseMsg+'"regex" extensions must implement a replace string or function',ret}if(showdown.helper.isUndefined(ext.filter)&&showdown.helper.isUndefined(ext.regex))return ret.valid=!1,ret.error=baseMsg+"output extensions must define a filter property",ret}return ret}function escapeCharactersCallback(wholeMatch,m1){"use strict";var charCodeToEscape=m1.charCodeAt(0);return"~E"+charCodeToEscape+"E"}var showdown={},parsers={},extensions={},globalOptions=getDefaultOpts(!0),flavor={github:{omitExtraWLInCodeBlocks:!0,prefixHeaderId:"user-content-",simplifiedAutoLink:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0},vanilla:getDefaultOpts(!0)};showdown.helper={},showdown.extensions={},showdown.setOption=function(key,value){"use strict";return globalOptions[key]=value,this},showdown.getOption=function(key){"use strict";return globalOptions[key]},showdown.getOptions=function(){"use strict";return globalOptions},showdown.resetOptions=function(){"use strict";globalOptions=getDefaultOpts(!0)},showdown.setFlavor=function(name){"use strict";if(flavor.hasOwnProperty(name)){var preset=flavor[name];for(var option in preset)preset.hasOwnProperty(option)&&(globalOptions[option]=preset[option])}},showdown.getDefaultOptions=function(simple){"use strict";return getDefaultOpts(simple)},showdown.subParser=function(name,func){"use strict";if(showdown.helper.isString(name)){if("undefined"==typeof func){if(parsers.hasOwnProperty(name))return parsers[name];throw Error("SubParser named "+name+" not registered!")}parsers[name]=func}},showdown.extension=function(name,ext){"use strict";if(!showdown.helper.isString(name))throw Error("Extension 'name' must be a string");if(name=showdown.helper.stdExtName(name),showdown.helper.isUndefined(ext)){if(!extensions.hasOwnProperty(name))throw Error("Extension named "+name+" is not registered!");return extensions[name]}"function"==typeof ext&&(ext=ext()),showdown.helper.isArray(ext)||(ext=[ext]);var validExtension=validate(ext,name);if(!validExtension.valid)throw Error(validExtension.error);extensions[name]=ext},showdown.getAllExtensions=function(){"use strict";return extensions},showdown.removeExtension=function(name){"use strict";delete extensions[name]},showdown.resetExtensions=function(){"use strict";extensions={}},showdown.validateExtension=function(ext){"use strict";var validateExtension=validate(ext,null);return validateExtension.valid?!0:(console.warn(validateExtension.error),!1)},showdown.hasOwnProperty("helper")||(showdown.helper={}),showdown.helper.isString=function(a){"use strict";return"string"==typeof a||a instanceof String},showdown.helper.forEach=function(obj,callback){"use strict";if("function"==typeof obj.forEach)obj.forEach(callback);else for(var i=0;i<obj.length;i++)callback(obj[i],i,obj)},showdown.helper.isArray=function(a){"use strict";return a.constructor===Array},showdown.helper.isUndefined=function(value){"use strict";return"undefined"==typeof value},showdown.helper.stdExtName=function(s){"use strict";return s.replace(/[_-]||\s/g,"").toLowerCase()},showdown.helper.escapeCharactersCallback=escapeCharactersCallback,showdown.helper.escapeCharacters=function(text,charsToEscape,afterBackslash){"use strict";var regexString="(["+charsToEscape.replace(/([\[\]\\])/g,"\\$1")+"])";afterBackslash&&(regexString="\\\\"+regexString);var regex=new RegExp(regexString,"g");return text=text.replace(regex,escapeCharactersCallback)},showdown.helper.isUndefined(console)&&(console={warn:function(msg){"use strict";alert(msg)},log:function(msg){"use strict";alert(msg)}}),showdown.Converter=function(converterOptions){"use strict";function _constructor(){converterOptions=converterOptions||{};for(var gOpt in globalOptions)globalOptions.hasOwnProperty(gOpt)&&(options[gOpt]=globalOptions[gOpt]);if("object"!=typeof converterOptions)throw Error("Converter expects the passed parameter to be an object, but "+typeof converterOptions+" was passed instead.");for(var opt in converterOptions)converterOptions.hasOwnProperty(opt)&&(options[opt]=converterOptions[opt]);options.extensions&&showdown.helper.forEach(options.extensions,_parseExtension)}function _parseExtension(ext,name){if(name=name||null,showdown.helper.isString(ext)){if(ext=showdown.helper.stdExtName(ext),name=ext,showdown.extensions[ext])return console.warn("DEPRECATION WARNING: "+ext+" is an old extension that uses a deprecated loading method.Please inform the developer that the extension should be updated!"),void legacyExtensionLoading(showdown.extensions[ext],ext);if(showdown.helper.isUndefined(extensions[ext]))throw Error('Extension "'+ext+'" could not be loaded. It was either not found or is not a valid extension.');ext=extensions[ext]}"function"==typeof ext&&(ext=ext()),showdown.helper.isArray(ext)||(ext=[ext]);var validExt=validate(ext,name);if(!validExt.valid)throw Error(validExt.error);for(var i=0;i<ext.length;++i)switch(ext[i].type){case"lang":langExtensions.push(ext[i]);break;case"output":outputModifiers.push(ext[i]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}function legacyExtensionLoading(ext,name){"function"==typeof ext&&(ext=ext(new showdown.Converter)),showdown.helper.isArray(ext)||(ext=[ext]);var valid=validate(ext,name);if(!valid.valid)throw Error(valid.error);for(var i=0;i<ext.length;++i)switch(ext[i].type){case"lang":langExtensions.push(ext[i]);break;case"output":outputModifiers.push(ext[i]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}var options={},langExtensions=[],outputModifiers=[],parserOrder=["githubCodeBlocks","hashHTMLBlocks","stripLinkDefinitions","blockGamut","unescapeSpecialChars"];_constructor(),this.makeHtml=function(text){if(!text)return text;
var globals={gHtmlBlocks:[],gUrls:{},gTitles:{},gDimensions:{},gListLevel:0,hashLinkCounts:{},langExtensions:langExtensions,outputModifiers:outputModifiers,converter:this};text=text.replace(/~/g,"~T"),text=text.replace(/\$/g,"~D"),text=text.replace(/\r\n/g,"\n"),text=text.replace(/\r/g,"\n"),text="\n\n"+text+"\n\n",text=showdown.subParser("detab")(text,options,globals),text=showdown.subParser("stripBlankLines")(text,options,globals),showdown.helper.forEach(langExtensions,function(ext){text=showdown.subParser("runExtension")(ext,text,options,globals)});for(var i=0;i<parserOrder.length;++i){var name=parserOrder[i];text=parsers[name](text,options,globals)}return text=text.replace(/~D/g,"$$"),text=text.replace(/~T/g,"~"),showdown.helper.forEach(outputModifiers,function(ext){text=showdown.subParser("runExtension")(ext,text,options,globals)}),text},this.setOption=function(key,value){options[key]=value},this.getOption=function(key){return options[key]},this.getOptions=function(){return options},this.addExtension=function(extension,name){name=name||null,_parseExtension(extension,name)},this.useExtension=function(extensionName){_parseExtension(extensionName)},this.setFlavor=function(name){if(flavor.hasOwnProperty(name)){var preset=flavor[name];for(var option in preset)preset.hasOwnProperty(option)&&(options[option]=preset[option])}},this.removeExtension=function(extension){showdown.helper.isArray(extension)||(extension=[extension]);for(var a=0;a<extension.length;++a){for(var ext=extension[a],i=0;i<langExtensions.length;++i)langExtensions[i]===ext&&langExtensions[i].splice(i,1);for(var ii=0;ii<outputModifiers.length;++i)outputModifiers[ii]===ext&&outputModifiers[ii].splice(i,1)}},this.getAllExtensions=function(){return{language:langExtensions,output:outputModifiers}}},showdown.subParser("anchors",function(text,config,globals){"use strict";var writeAnchorTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){showdown.helper.isUndefined(m7)&&(m7=""),wholeMatch=m1;var linkText=m2,linkId=m3.toLowerCase(),url=m4,title=m7;if(!url)if(linkId||(linkId=linkText.toLowerCase().replace(/ ?\n/g," ")),url="#"+linkId,showdown.helper.isUndefined(globals.gUrls[linkId])){if(!(wholeMatch.search(/\(\s*\)$/m)>-1))return wholeMatch;url=""}else url=globals.gUrls[linkId],showdown.helper.isUndefined(globals.gTitles[linkId])||(title=globals.gTitles[linkId]);url=showdown.helper.escapeCharacters(url,"*_",!1);var result='<a href="'+url+'"';return""!==title&&null!==title&&(title=title.replace(/"/g,"&quot;"),title=showdown.helper.escapeCharacters(title,"*_",!1),result+=' title="'+title+'"'),result+=">"+linkText+"</a>"};return text=text.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,writeAnchorTag),text=text.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?(?:\(.*?\).*?)?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,writeAnchorTag),text=text.replace(/(\[([^\[\]]+)\])()()()()()/g,writeAnchorTag)}),showdown.subParser("autoLinks",function(text,options){"use strict";function replaceMail(wholeMatch,m1){var unescapedStr=showdown.subParser("unescapeSpecialChars")(m1);return showdown.subParser("encodeEmailAddress")(unescapedStr)}var simpleURLRegex=/\b(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s]+)(?=\s|$)(?!["<>])/gi,delimUrlRegex=/<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)>/gi,simpleMailRegex=/\b(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)\b/gi,delimMailRegex=/<(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi;return text=text.replace(delimUrlRegex,'<a href="$1">$1</a>'),text=text.replace(delimMailRegex,replaceMail),options.simplifiedAutoLink&&(text=text.replace(simpleURLRegex,'<a href="$1">$1</a>'),text=text.replace(simpleMailRegex,replaceMail)),text}),showdown.subParser("blockGamut",function(text,options,globals){"use strict";text=showdown.subParser("blockQuotes")(text,options,globals),text=showdown.subParser("headers")(text,options,globals);var key=showdown.subParser("hashBlock")("<hr />",options,globals);return text=text.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,key),text=text.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,key),text=text.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,key),text=showdown.subParser("lists")(text,options,globals),text=showdown.subParser("codeBlocks")(text,options,globals),text=showdown.subParser("tables")(text,options,globals),text=showdown.subParser("hashHTMLBlocks")(text,options,globals),text=showdown.subParser("paragraphs")(text,options,globals)}),showdown.subParser("blockQuotes",function(text,options,globals){"use strict";return text=text.replace(/((^[ \t]{0,3}>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(wholeMatch,m1){var bq=m1;return bq=bq.replace(/^[ \t]*>[ \t]?/gm,"~0"),bq=bq.replace(/~0/g,""),bq=bq.replace(/^[ \t]+$/gm,""),bq=showdown.subParser("githubCodeBlocks")(bq,options,globals),bq=showdown.subParser("blockGamut")(bq,options,globals),bq=bq.replace(/(^|\n)/g,"$1  "),bq=bq.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(wholeMatch,m1){var pre=m1;return pre=pre.replace(/^  /gm,"~0"),pre=pre.replace(/~0/g,"")}),showdown.subParser("hashBlock")("<blockquote>\n"+bq+"\n</blockquote>",options,globals)})}),showdown.subParser("codeBlocks",function(text,options,globals){"use strict";text+="~0";var pattern=/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g;return text=text.replace(pattern,function(wholeMatch,m1,m2){var codeblock=m1,nextChar=m2,end="\n";return codeblock=showdown.subParser("outdent")(codeblock),codeblock=showdown.subParser("encodeCode")(codeblock),codeblock=showdown.subParser("detab")(codeblock),codeblock=codeblock.replace(/^\n+/g,""),codeblock=codeblock.replace(/\n+$/g,""),options.omitExtraWLInCodeBlocks&&(end=""),codeblock="<pre><code>"+codeblock+end+"</code></pre>",showdown.subParser("hashBlock")(codeblock,options,globals)+nextChar}),text=text.replace(/~0/,"")}),showdown.subParser("codeSpans",function(text){"use strict";return text=text.replace(/(<code[^><]*?>)([^]*?)<\/code>/g,function(wholeMatch,tag,c){return c=c.replace(/^([ \t]*)/g,""),c=c.replace(/[ \t]*$/g,""),c=showdown.subParser("encodeCode")(c),tag+c+"</code>"}),text=text.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(wholeMatch,m1,m2,m3){var c=m3;return c=c.replace(/^([ \t]*)/g,""),c=c.replace(/[ \t]*$/g,""),c=showdown.subParser("encodeCode")(c),m1+"<code>"+c+"</code>"})}),showdown.subParser("detab",function(text){"use strict";return text=text.replace(/\t(?=\t)/g,"    "),text=text.replace(/\t/g,"~A~B"),text=text.replace(/~B(.+?)~A/g,function(wholeMatch,m1){for(var leadingText=m1,numSpaces=4-leadingText.length%4,i=0;numSpaces>i;i++)leadingText+=" ";return leadingText}),text=text.replace(/~A/g,"    "),text=text.replace(/~B/g,"")}),showdown.subParser("encodeAmpsAndAngles",function(text){"use strict";return text=text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),text=text.replace(/<(?![a-z\/?\$!])/gi,"&lt;")}),showdown.subParser("encodeBackslashEscapes",function(text){"use strict";return text=text.replace(/\\(\\)/g,showdown.helper.escapeCharactersCallback),text=text.replace(/\\([`*_{}\[\]()>#+-.!])/g,showdown.helper.escapeCharactersCallback)}),showdown.subParser("encodeCode",function(text){"use strict";return text=text.replace(/&/g,"&amp;"),text=text.replace(/</g,"&lt;"),text=text.replace(/>/g,"&gt;"),text=showdown.helper.escapeCharacters(text,"*_{}[]\\",!1)}),showdown.subParser("encodeEmailAddress",function(addr){"use strict";var encode=[function(ch){return"&#"+ch.charCodeAt(0)+";"},function(ch){return"&#x"+ch.charCodeAt(0).toString(16)+";"},function(ch){return ch}];return addr="mailto:"+addr,addr=addr.replace(/./g,function(ch){if("@"===ch)ch=encode[Math.floor(2*Math.random())](ch);else if(":"!==ch){var r=Math.random();ch=r>.9?encode[2](ch):r>.45?encode[1](ch):encode[0](ch)}return ch}),addr='<a href="'+addr+'">'+addr+"</a>",addr=addr.replace(/">.+:/g,'">')}),showdown.subParser("escapeSpecialCharsWithinTagAttributes",function(text){"use strict";var regex=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi;return text=text.replace(regex,function(wholeMatch){var tag=wholeMatch.replace(/(.)<\/?code>(?=.)/g,"$1`");return tag=showdown.helper.escapeCharacters(tag,"\\`*_",!1)})}),showdown.subParser("githubCodeBlocks",function(text,options,globals){"use strict";return options.ghCodeBlocks?(text+="~0",text=text.replace(/(?:^|\n)```(.*)\n([\s\S]*?)\n```/g,function(wholeMatch,language,codeblock){var end=options.omitExtraWLInCodeBlocks?"":"\n";return codeblock=showdown.subParser("encodeCode")(codeblock),codeblock=showdown.subParser("detab")(codeblock),codeblock=codeblock.replace(/^\n+/g,""),codeblock=codeblock.replace(/\n+$/g,""),codeblock="<pre><code"+(language?' class="'+language+" language-"+language+'"':"")+">"+codeblock+end+"</code></pre>",showdown.subParser("hashBlock")(codeblock,options,globals)}),text=text.replace(/~0/,"")):text}),showdown.subParser("hashBlock",function(text,options,globals){"use strict";return text=text.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(globals.gHtmlBlocks.push(text)-1)+"K\n\n"}),showdown.subParser("hashElement",function(text,options,globals){"use strict";return function(wholeMatch,m1){var blockText=m1;return blockText=blockText.replace(/\n\n/g,"\n"),blockText=blockText.replace(/^\n/,""),blockText=blockText.replace(/\n+$/g,""),blockText="\n\n~K"+(globals.gHtmlBlocks.push(blockText)-1)+"K\n\n"}}),showdown.subParser("hashHTMLBlocks",function(text,options,globals){"use strict";return text=text.replace(/\n/g,"\n\n"),text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,showdown.subParser("hashElement")(text,options,globals)),text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|style|section|header|footer|nav|article|aside|address|audio|canvas|figure|hgroup|output|video)\b[^\r]*?<\/\2>[ \t]*(?=\n+)\n)/gm,showdown.subParser("hashElement")(text,options,globals)),text=text.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,showdown.subParser("hashElement")(text,options,globals)),text=text.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,showdown.subParser("hashElement")(text,options,globals)),text=text.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,showdown.subParser("hashElement")(text,options,globals)),text=text.replace(/\n\n/g,"\n")}),showdown.subParser("headers",function(text,options,globals){"use strict";function headerId(m){var title,escapedId=m.replace(/[^\w]/g,"").toLowerCase();return globals.hashLinkCounts[escapedId]?title=escapedId+"-"+globals.hashLinkCounts[escapedId]++:(title=escapedId,globals.hashLinkCounts[escapedId]=1),prefixHeader===!0&&(prefixHeader="section"),showdown.helper.isString(prefixHeader)?prefixHeader+title:title}var prefixHeader=options.prefixHeaderId,headerLevelStart=isNaN(parseInt(options.headerLevelStart))?1:parseInt(options.headerLevelStart),setextRegexH1=options.smoothLivePreview?/^(.+)[ \t]*\n={2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n=+[ \t]*\n+/gm,setextRegexH2=options.smoothLivePreview?/^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n-+[ \t]*\n+/gm;return text=text.replace(setextRegexH1,function(wholeMatch,m1){var spanGamut=showdown.subParser("spanGamut")(m1,options,globals),hID=options.noHeaderId?"":' id="'+headerId(m1)+'"',hLevel=headerLevelStart,hashBlock="<h"+hLevel+hID+">"+spanGamut+"</h"+hLevel+">";return showdown.subParser("hashBlock")(hashBlock,options,globals)}),text=text.replace(setextRegexH2,function(matchFound,m1){var spanGamut=showdown.subParser("spanGamut")(m1,options,globals),hID=options.noHeaderId?"":' id="'+headerId(m1)+'"',hLevel=headerLevelStart+1,hashBlock="<h"+hLevel+hID+">"+spanGamut+"</h"+hLevel+">";return showdown.subParser("hashBlock")(hashBlock,options,globals)}),text=text.replace(/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm,function(wholeMatch,m1,m2){var span=showdown.subParser("spanGamut")(m2,options,globals),hID=options.noHeaderId?"":' id="'+headerId(m2)+'"',hLevel=headerLevelStart-1+m1.length,header="<h"+hLevel+hID+">"+span+"</h"+hLevel+">";return showdown.subParser("hashBlock")(header,options,globals)})}),showdown.subParser("images",function(text,options,globals){"use strict";function writeImageTag(wholeMatch,altText,linkId,url,width,height,m5,title){var gUrls=globals.gUrls,gTitles=globals.gTitles,gDims=globals.gDimensions;if(linkId=linkId.toLowerCase(),title||(title=""),""===url||null===url){if((""===linkId||null===linkId)&&(linkId=altText.toLowerCase().replace(/ ?\n/g," ")),url="#"+linkId,showdown.helper.isUndefined(gUrls[linkId]))return wholeMatch;url=gUrls[linkId],showdown.helper.isUndefined(gTitles[linkId])||(title=gTitles[linkId]),showdown.helper.isUndefined(gDims[linkId])||(width=gDims[linkId].width,height=gDims[linkId].height)}altText=altText.replace(/"/g,"&quot;"),altText=showdown.helper.escapeCharacters(altText,"*_",!1),url=showdown.helper.escapeCharacters(url,"*_",!1);var result='<img src="'+url+'" alt="'+altText+'"';return title&&(title=title.replace(/"/g,"&quot;"),title=showdown.helper.escapeCharacters(title,"*_",!1),result+=' title="'+title+'"'),width&&height&&(width="*"===width?"auto":width,height="*"===height?"auto":height,result+=' width="'+width+'"',result+=' height="'+height+'"'),result+=" />"}var inlineRegExp=/!\[(.*?)]\s?\([ \t]*()<?(\S+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(['"])(.*?)\6[ \t]*)?\)/g,referenceRegExp=/!\[(.*?)][ ]?(?:\n[ ]*)?\[(.*?)]()()()()()/g;return text=text.replace(referenceRegExp,writeImageTag),text=text.replace(inlineRegExp,writeImageTag)}),showdown.subParser("italicsAndBold",function(text,options){"use strict";return options.literalMidWordUnderscores?(text=text.replace(/(^|\s|>|\b)__(?=\S)([^]+?)__(?=\b|<|\s|$)/gm,"$1<strong>$2</strong>"),text=text.replace(/(^|\s|>|\b)_(?=\S)([^]+?)_(?=\b|<|\s|$)/gm,"$1<em>$2</em>"),text=text.replace(/\*\*(?=\S)([^]+?)\*\*/g,"<strong>$1</strong>"),text=text.replace(/\*(?=\S)([^]+?)\*/g,"<em>$1</em>")):(text=text.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>"),text=text.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>")),text}),showdown.subParser("lists",function(text,options,globals){"use strict";function processListItems(listStr,trimTrailing){globals.gListLevel++,listStr=listStr.replace(/\n{2,}$/,"\n"),listStr+="~0";var rgx=/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+((\[(x| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,isParagraphed=/\n[ \t]*\n(?!~0)/.test(listStr);return listStr=listStr.replace(rgx,function(wholeMatch,m1,m2,m3,m4,taskbtn,checked){checked=checked&&""!==checked.trim();var item=showdown.subParser("outdent")(m4,options,globals),bulletStyle="";return taskbtn&&options.tasklists&&(bulletStyle=' class="task-list-item" style="list-style-type: none;"',item=item.replace(/^[ \t]*\[(x| )?]/m,function(){var otp='<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';return checked&&(otp+=" checked"),otp+=">"})),m1||item.search(/\n{2,}/)>-1?(item=showdown.subParser("githubCodeBlocks")(item,options,globals),item=showdown.subParser("blockGamut")(item,options,globals)):(item=showdown.subParser("lists")(item,options,globals),item=item.replace(/\n$/,""),item=isParagraphed?showdown.subParser("paragraphs")(item,options,globals):showdown.subParser("spanGamut")(item,options,globals)),item="\n<li"+bulletStyle+">"+item+"</li>\n"}),listStr=listStr.replace(/~0/g,""),globals.gListLevel--,trimTrailing&&(listStr=listStr.replace(/\s+$/,"")),listStr}function parseConsecutiveLists(list,listType,trimTrailing){var counterRxg="ul"===listType?/^ {0,2}\d+\.[ \t]/gm:/^ {0,2}[*+-][ \t]/gm,subLists=[],result="";if(-1!==list.search(counterRxg)){!function parseCL(txt){var pos=txt.search(counterRxg);-1!==pos?(result+="\n\n<"+listType+">"+processListItems(txt.slice(0,pos),!!trimTrailing)+"</"+listType+">\n\n",listType="ul"===listType?"ol":"ul",counterRxg="ul"===listType?/^ {0,2}\d+\.[ \t]/gm:/^ {0,2}[*+-][ \t]/gm,parseCL(txt.slice(pos))):result+="\n\n<"+listType+">"+processListItems(txt,!!trimTrailing)+"</"+listType+">\n\n"}(list);for(var i=0;i<subLists.length;++i);}else result="\n\n<"+listType+">"+processListItems(list,!!trimTrailing)+"</"+listType+">\n\n";return result}text+="~0";var wholeList=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return globals.gListLevel?text=text.replace(wholeList,function(wholeMatch,list,m2){var listType=m2.search(/[*+-]/g)>-1?"ul":"ol";return parseConsecutiveLists(list,listType,!0)}):(wholeList=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,text=text.replace(wholeList,function(wholeMatch,m1,list,m3){var listType=m3.search(/[*+-]/g)>-1?"ul":"ol";return parseConsecutiveLists(list,listType)})),text=text.replace(/~0/,"")}),showdown.subParser("outdent",function(text){"use strict";return text=text.replace(/^(\t|[ ]{1,4})/gm,"~0"),text=text.replace(/~0/g,"")}),showdown.subParser("paragraphs",function(text,options,globals){"use strict";text=text.replace(/^\n+/g,""),text=text.replace(/\n+$/g,"");for(var grafs=text.split(/\n{2,}/g),grafsOut=[],end=grafs.length,i=0;end>i;i++){var str=grafs[i];str.search(/~K(\d+)K/g)>=0?grafsOut.push(str):str.search(/\S/)>=0&&(str=showdown.subParser("spanGamut")(str,options,globals),str=str.replace(/^([ \t]*)/g,"<p>"),str+="</p>",grafsOut.push(str))}for(end=grafsOut.length,i=0;end>i;i++)for(;grafsOut[i].search(/~K(\d+)K/)>=0;){var blockText=globals.gHtmlBlocks[RegExp.$1];blockText=blockText.replace(/\$/g,"$$$$"),grafsOut[i]=grafsOut[i].replace(/~K\d+K/,blockText)}return grafsOut.join("\n\n")}),showdown.subParser("runExtension",function(ext,text,options,globals){"use strict";if(ext.filter)text=ext.filter(text,globals.converter,options);else if(ext.regex){var re=ext.regex;!re instanceof RegExp&&(re=new RegExp(re,"g")),text=text.replace(re,ext.replace)}return text}),showdown.subParser("spanGamut",function(text,options,globals){"use strict";return text=showdown.subParser("codeSpans")(text,options,globals),text=showdown.subParser("escapeSpecialCharsWithinTagAttributes")(text,options,globals),text=showdown.subParser("encodeBackslashEscapes")(text,options,globals),text=showdown.subParser("images")(text,options,globals),text=showdown.subParser("anchors")(text,options,globals),text=showdown.subParser("autoLinks")(text,options,globals),text=showdown.subParser("encodeAmpsAndAngles")(text,options,globals),text=showdown.subParser("italicsAndBold")(text,options,globals),text=showdown.subParser("strikethrough")(text,options,globals),text=text.replace(/  +\n/g," <br />\n")}),showdown.subParser("strikethrough",function(text,options){"use strict";return options.strikethrough&&(text=text.replace(/(?:~T){2}([^~]+)(?:~T){2}/g,"<del>$1</del>")),text}),showdown.subParser("stripBlankLines",function(text){"use strict";return text.replace(/^[ \t]+$/gm,"")}),showdown.subParser("stripLinkDefinitions",function(text,options,globals){"use strict";var regex=/^ {0,3}\[(.+)]:[ \t]*\n?[ \t]*<?(\S+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=~0))/gm;return text+="~0",text=text.replace(regex,function(wholeMatch,linkId,url,width,height,blankLines,title){return linkId=linkId.toLowerCase(),globals.gUrls[linkId]=showdown.subParser("encodeAmpsAndAngles")(url),blankLines?blankLines+title:(title&&(globals.gTitles[linkId]=title.replace(/"|'/g,"&quot;")),options.parseImgDimensions&&width&&height&&(globals.gDimensions[linkId]={width:width,height:height}),"")}),text=text.replace(/~0/,"")}),showdown.subParser("tables",function(text,options,globals){"use strict";var table=function(){var filter,tables={};return tables.th=function(header,style){var id="";return header=header.trim(),""===header?"":(options.tableHeaderId&&(id=' id="'+header.replace(/ /g,"_").toLowerCase()+'"'),header=showdown.subParser("spanGamut")(header,options,globals),style=style&&""!==style.trim()?' style="'+style+'"':"","<th"+id+style+">"+header+"</th>")},tables.td=function(cell,style){var subText=showdown.subParser("spanGamut")(cell.trim(),options,globals);return style=style&&""!==style.trim()?' style="'+style+'"':"","<td"+style+">"+subText+"</td>"},tables.ths=function(){var out="",i=0,hs=[].slice.apply(arguments[0]),style=[].slice.apply(arguments[1]);for(i;i<hs.length;i+=1)out+=tables.th(hs[i],style[i])+"\n";return out},tables.tds=function(){var out="",i=0,ds=[].slice.apply(arguments[0]),style=[].slice.apply(arguments[1]);for(i;i<ds.length;i+=1)out+=tables.td(ds[i],style[i])+"\n";return out},tables.thead=function(){var out,hs=[].slice.apply(arguments[0]),style=[].slice.apply(arguments[1]);return out="<thead>\n",out+="<tr>\n",out+=tables.ths.apply(this,[hs,style]),out+="</tr>\n",out+="</thead>\n"},tables.tr=function(){var out,cs=[].slice.apply(arguments[0]),style=[].slice.apply(arguments[1]);return out="<tr>\n",out+=tables.tds.apply(this,[cs,style]),out+="</tr>\n"},filter=function(text){var line,hs,i=0,lines=text.split("\n"),out=[];for(i;i<lines.length;i+=1){if(line=lines[i],line.trim().match(/^[|].*[|]$/)){line=line.trim();var tbl=[],align=lines[i+1].trim(),styles=[],j=0;if(align.match(/^[|][-=|: ]+[|]$/))for(styles=align.substring(1,align.length-1).split("|"),j=0;j<styles.length;++j)styles[j]=styles[j].trim(),styles[j]=styles[j].match(/^[:][-=| ]+[:]$/)?"text-align:center;":styles[j].match(/^[-=| ]+[:]$/)?"text-align:right;":styles[j].match(/^[:][-=| ]+$/)?"text-align:left;":"";if(tbl.push("<table>"),hs=line.substring(1,line.length-1).split("|"),0===styles.length)for(j=0;j<hs.length;++j)styles.push("text-align:left");if(tbl.push(tables.thead.apply(this,[hs,styles])),line=lines[++i],line.trim().match(/^[|][-=|: ]+[|]$/)){for(line=lines[++i],tbl.push("<tbody>");line.trim().match(/^[|].*[|]$/);)line=line.trim(),tbl.push(tables.tr.apply(this,[line.substring(1,line.length-1).split("|"),styles])),line=lines[++i];tbl.push("</tbody>"),tbl.push("</table>"),out.push(tbl.join("\n"));continue}line=lines[--i]}out.push(line)}return out.join("\n")},{parse:filter}};if(options.tables){var tableParser=table();return tableParser.parse(text)}return text}),showdown.subParser("unescapeSpecialChars",function(text){"use strict";return text=text.replace(/~E(\d+)E/g,function(wholeMatch,m1){var charCodeToReplace=parseInt(m1);return String.fromCharCode(charCodeToReplace)})});var root=this;"undefined"!=typeof module&&module.exports?module.exports=showdown:"function"==typeof define&&define.amd?define("showdown",function(){"use strict";return showdown}):root.showdown=showdown}.call(this),angular.module("markdown",[]).provider("markdown",[function(){var opts={};return{config:function(newOpts){opts=newOpts},$get:function(){return new window.showdown.Converter(opts)}}}]).filter("markdown",["markdown",function(markdown){return function(text){return markdown.makeHtml(text||"")}}]),function(){"use strict";var KEY={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,COMMAND:91,MAP:{91:"COMMAND",8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",17:"CTRL",18:"ALT",19:"PAUSEBREAK",20:"CAPSLOCK",27:"ESC",32:"SPACE",33:"PAGE_UP",34:"PAGE_DOWN",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",43:"+",44:"PRINTSCREEN",45:"INSERT",46:"DELETE",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NUMLOCK",145:"SCROLLLOCK",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},isControl:function(e){var k=e.which;switch(k){case KEY.COMMAND:case KEY.SHIFT:case KEY.CTRL:case KEY.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(k){return k=k.which?k.which:k,k>=112&&123>=k},isVerticalMovement:function(k){return~[KEY.UP,KEY.DOWN].indexOf(k)},isHorizontalMovement:function(k){return~[KEY.LEFT,KEY.RIGHT,KEY.BACKSPACE,KEY.DELETE].indexOf(k)}};void 0===angular.element.prototype.querySelectorAll&&(angular.element.prototype.querySelectorAll=function(selector){return angular.element(this[0].querySelectorAll(selector))}),void 0===angular.element.prototype.closest&&(angular.element.prototype.closest=function(selector){for(var elem=this[0],matchesSelector=elem.matches||elem.webkitMatchesSelector||elem.mozMatchesSelector||elem.msMatchesSelector;elem;){if(matchesSelector.bind(elem)(selector))return elem;elem=elem.parentElement}return!1});var latestId=0,uis=angular.module("ui.select",[]).constant("uiSelectConfig",{theme:"bootstrap",searchEnabled:!0,sortable:!1,placeholder:"",refreshDelay:1e3,closeOnSelect:!0,dropdownPosition:"auto",generateId:function(){return latestId++},appendToBody:!1}).service("uiSelectMinErr",function(){var minErr=angular.$$minErr("ui.select");return function(){var error=minErr.apply(this,arguments),message=error.message.replace(new RegExp("\nhttp://errors.angularjs.org/.*"),"");return new Error(message)}}).directive("uisTranscludeAppend",function(){return{link:function(scope,element,attrs,ctrl,transclude){transclude(scope,function(clone){element.append(clone)})}}}).filter("highlight",function(){function escapeRegexp(queryToEscape){return queryToEscape.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(matchItem,query){return query&&matchItem?matchItem.replace(new RegExp(escapeRegexp(query),"gi"),'<span class="ui-select-highlight">$&</span>'):matchItem}}).factory("uisOffset",["$document","$window",function($document,$window){return function(element){var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||$document[0].documentElement.scrollTop),left:boundingClientRect.left+($window.pageXOffset||$document[0].documentElement.scrollLeft)}}}]);uis.directive("uiSelectChoices",["uiSelectConfig","uisRepeatParser","uiSelectMinErr","$compile",function(uiSelectConfig,RepeatParser,uiSelectMinErr,$compile){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(tElement){var theme=tElement.parent().attr("theme")||uiSelectConfig.theme;return theme+"/choices.tpl.html"},compile:function(tElement,tAttrs){if(!tAttrs.repeat)throw uiSelectMinErr("repeat","Expected 'repeat' expression.");return function(scope,element,attrs,$select,transcludeFn){var groupByExp=attrs.groupBy,groupFilterExp=attrs.groupFilter;if($select.parseRepeatAttr(attrs.repeat,groupByExp,groupFilterExp),$select.disableChoiceExpression=attrs.uiDisableChoice,$select.onHighlightCallback=attrs.onHighlight,$select.dropdownPosition=attrs.position?attrs.position.toLowerCase():uiSelectConfig.dropdownPosition,groupByExp){var groups=element.querySelectorAll(".ui-select-choices-group");if(1!==groups.length)throw uiSelectMinErr("rows","Expected 1 .ui-select-choices-group but got '{0}'.",groups.length);groups.attr("ng-repeat",RepeatParser.getGroupNgRepeatExpression())}var choices=element.querySelectorAll(".ui-select-choices-row");if(1!==choices.length)throw uiSelectMinErr("rows","Expected 1 .ui-select-choices-row but got '{0}'.",choices.length);choices.attr("ng-repeat",$select.parserResult.repeatExpression(groupByExp)).attr("ng-if","$select.open").attr("ng-click","$select.select("+$select.parserResult.itemName+",false,$event)");var rowsInner=element.querySelectorAll(".ui-select-choices-row-inner");if(1!==rowsInner.length)throw uiSelectMinErr("rows","Expected 1 .ui-select-choices-row-inner but got '{0}'.",rowsInner.length);rowsInner.attr("uis-transclude-append",""),$compile(element,transcludeFn)(scope),scope.$watch("$select.search",function(newValue){newValue&&!$select.open&&$select.multiple&&$select.activate(!1,!0),$select.activeIndex=$select.tagging.isActivated?-1:0,$select.refresh(attrs.refresh)}),attrs.$observe("refreshDelay",function(){var refreshDelay=scope.$eval(attrs.refreshDelay);$select.refreshDelay=void 0!==refreshDelay?refreshDelay:uiSelectConfig.refreshDelay})}}}}]),uis.controller("uiSelectCtrl",["$scope","$element","$timeout","$filter","uisRepeatParser","uiSelectMinErr","uiSelectConfig","$parse",function($scope,$element,$timeout,$filter,RepeatParser,uiSelectMinErr,uiSelectConfig,$parse){function _resetSearchInput(){(ctrl.resetSearchInput||void 0===ctrl.resetSearchInput&&uiSelectConfig.resetSearchInput)&&(ctrl.search=EMPTY_SEARCH,ctrl.selected&&ctrl.items.length&&!ctrl.multiple&&(ctrl.activeIndex=ctrl.items.indexOf(ctrl.selected)))}function _groupsFilter(groups,groupNames){var i,j,result=[];for(i=0;i<groupNames.length;i++)for(j=0;j<groups.length;j++)groups[j].name==[groupNames[i]]&&result.push(groups[j]);return result}function _handleDropDownSelection(key){var processed=!0;switch(key){case KEY.DOWN:!ctrl.open&&ctrl.multiple?ctrl.activate(!1,!0):ctrl.activeIndex<ctrl.items.length-1&&ctrl.activeIndex++;break;case KEY.UP:!ctrl.open&&ctrl.multiple?ctrl.activate(!1,!0):(ctrl.activeIndex>0||0===ctrl.search.length&&ctrl.tagging.isActivated&&ctrl.activeIndex>-1)&&ctrl.activeIndex--;break;case KEY.TAB:(!ctrl.multiple||ctrl.open)&&ctrl.select(ctrl.items[ctrl.activeIndex],!0);break;case KEY.ENTER:ctrl.open&&(ctrl.tagging.isActivated||ctrl.activeIndex>=0)?ctrl.select(ctrl.items[ctrl.activeIndex]):ctrl.activate(!1,!0);break;case KEY.ESC:ctrl.close();break;default:processed=!1}return processed}function _ensureHighlightVisible(){var container=$element.querySelectorAll(".ui-select-choices-content"),choices=container.querySelectorAll(".ui-select-choices-row");if(choices.length<1)throw uiSelectMinErr("choices","Expected multiple .ui-select-choices-row but got '{0}'.",choices.length);if(!(ctrl.activeIndex<0)){var highlighted=choices[ctrl.activeIndex],posY=highlighted.offsetTop+highlighted.clientHeight-container[0].scrollTop,height=container[0].offsetHeight;posY>height?container[0].scrollTop+=posY-height:posY<highlighted.clientHeight&&(ctrl.isGrouped&&0===ctrl.activeIndex?container[0].scrollTop=0:container[0].scrollTop-=highlighted.clientHeight-posY)}}var ctrl=this,EMPTY_SEARCH="";if(ctrl.placeholder=uiSelectConfig.placeholder,ctrl.searchEnabled=uiSelectConfig.searchEnabled,ctrl.sortable=uiSelectConfig.sortable,ctrl.refreshDelay=uiSelectConfig.refreshDelay,ctrl.removeSelected=!1,ctrl.closeOnSelect=!0,ctrl.search=EMPTY_SEARCH,ctrl.activeIndex=0,ctrl.items=[],ctrl.open=!1,ctrl.focus=!1,ctrl.disabled=!1,ctrl.selected=void 0,ctrl.dropdownPosition="auto",ctrl.focusser=void 0,ctrl.resetSearchInput=!0,ctrl.multiple=void 0,ctrl.disableChoiceExpression=void 0,ctrl.tagging={isActivated:!1,fct:void 0},ctrl.taggingTokens={isActivated:!1,tokens:void 0},ctrl.lockChoiceExpression=void 0,ctrl.clickTriggeredSelect=!1,ctrl.$filter=$filter,ctrl.searchInput=$element.querySelectorAll("input.ui-select-search"),1!==ctrl.searchInput.length)throw uiSelectMinErr("searchInput","Expected 1 input.ui-select-search but got '{0}'.",ctrl.searchInput.length);ctrl.isEmpty=function(){return angular.isUndefined(ctrl.selected)||null===ctrl.selected||""===ctrl.selected},ctrl.activate=function(initSearchValue,avoidReset){ctrl.disabled||ctrl.open||(avoidReset||_resetSearchInput(),$scope.$broadcast("uis:activate"),ctrl.open=!0,ctrl.activeIndex=ctrl.activeIndex>=ctrl.items.length?0:ctrl.activeIndex,-1===ctrl.activeIndex&&ctrl.taggingLabel!==!1&&(ctrl.activeIndex=0),$timeout(function(){ctrl.search=initSearchValue||ctrl.search,ctrl.searchInput[0].focus(),!ctrl.tagging.isActivated&&ctrl.items.length>1&&_ensureHighlightVisible()}))},ctrl.findGroupByName=function(name){return ctrl.groups&&ctrl.groups.filter(function(group){return group.name===name})[0]},ctrl.parseRepeatAttr=function(repeatAttr,groupByExp,groupFilterExp){function updateGroups(items){var groupFn=$scope.$eval(groupByExp);
if(ctrl.groups=[],angular.forEach(items,function(item){var groupName=angular.isFunction(groupFn)?groupFn(item):item[groupFn],group=ctrl.findGroupByName(groupName);group?group.items.push(item):ctrl.groups.push({name:groupName,items:[item]})}),groupFilterExp){var groupFilterFn=$scope.$eval(groupFilterExp);angular.isFunction(groupFilterFn)?ctrl.groups=groupFilterFn(ctrl.groups):angular.isArray(groupFilterFn)&&(ctrl.groups=_groupsFilter(ctrl.groups,groupFilterFn))}ctrl.items=[],ctrl.groups.forEach(function(group){ctrl.items=ctrl.items.concat(group.items)})}function setPlainItems(items){ctrl.items=items}ctrl.setItemsFn=groupByExp?updateGroups:setPlainItems,ctrl.parserResult=RepeatParser.parse(repeatAttr),ctrl.isGrouped=!!groupByExp,ctrl.itemProperty=ctrl.parserResult.itemName;var originalSource=ctrl.parserResult.source,createArrayFromObject=function(){var origSrc=originalSource($scope);$scope.$uisSource=Object.keys(origSrc).map(function(v){var result={};return result[ctrl.parserResult.keyName]=v,result.value=origSrc[v],result})};ctrl.parserResult.keyName&&(createArrayFromObject(),ctrl.parserResult.source=$parse("$uisSource"+ctrl.parserResult.filters),$scope.$watch(originalSource,function(newVal,oldVal){newVal!==oldVal&&createArrayFromObject()},!0)),ctrl.refreshItems=function(data){data=data||ctrl.parserResult.source($scope);var selectedItems=ctrl.selected;if(ctrl.isEmpty()||angular.isArray(selectedItems)&&!selectedItems.length||!ctrl.removeSelected)ctrl.setItemsFn(data);else if(void 0!==data){var filteredItems=data.filter(function(i){return selectedItems&&selectedItems.indexOf(i)<0});ctrl.setItemsFn(filteredItems)}("auto"===ctrl.dropdownPosition||"up"===ctrl.dropdownPosition)&&$scope.calculateDropdownPos()},$scope.$watchCollection(ctrl.parserResult.source,function(items){if(void 0===items||null===items)ctrl.items=[];else{if(!angular.isArray(items))throw uiSelectMinErr("items","Expected an array but got '{0}'.",items);ctrl.refreshItems(items),ctrl.ngModel.$modelValue=null}})};var _refreshDelayPromise;ctrl.refresh=function(refreshAttr){void 0!==refreshAttr&&(_refreshDelayPromise&&$timeout.cancel(_refreshDelayPromise),_refreshDelayPromise=$timeout(function(){$scope.$eval(refreshAttr)},ctrl.refreshDelay))},ctrl.isActive=function(itemScope){if(!ctrl.open)return!1;var itemIndex=ctrl.items.indexOf(itemScope[ctrl.itemProperty]),isActive=itemIndex===ctrl.activeIndex;return!isActive||0>itemIndex&&ctrl.taggingLabel!==!1||0>itemIndex&&ctrl.taggingLabel===!1?!1:(isActive&&!angular.isUndefined(ctrl.onHighlightCallback)&&itemScope.$eval(ctrl.onHighlightCallback),isActive)},ctrl.isDisabled=function(itemScope){if(ctrl.open){var item,itemIndex=ctrl.items.indexOf(itemScope[ctrl.itemProperty]),isDisabled=!1;return itemIndex>=0&&!angular.isUndefined(ctrl.disableChoiceExpression)&&(item=ctrl.items[itemIndex],isDisabled=!!itemScope.$eval(ctrl.disableChoiceExpression),item._uiSelectChoiceDisabled=isDisabled),isDisabled}},ctrl.select=function(item,skipFocusser,$event){if(void 0===item||!item._uiSelectChoiceDisabled){if(!ctrl.items&&!ctrl.search)return;if(!item||!item._uiSelectChoiceDisabled){if(ctrl.tagging.isActivated){if(ctrl.taggingLabel===!1)if(ctrl.activeIndex<0){if(item=void 0!==ctrl.tagging.fct?ctrl.tagging.fct(ctrl.search):ctrl.search,!item||angular.equals(ctrl.items[0],item))return}else item=ctrl.items[ctrl.activeIndex];else if(0===ctrl.activeIndex){if(void 0===item)return;if(void 0!==ctrl.tagging.fct&&"string"==typeof item){if(item=ctrl.tagging.fct(ctrl.search),!item)return}else"string"==typeof item&&(item=item.replace(ctrl.taggingLabel,"").trim())}if(ctrl.selected&&angular.isArray(ctrl.selected)&&ctrl.selected.filter(function(selection){return angular.equals(selection,item)}).length>0)return void ctrl.close(skipFocusser)}$scope.$broadcast("uis:select",item);var locals={};locals[ctrl.parserResult.itemName]=item,$timeout(function(){ctrl.onSelectCallback($scope,{$item:item,$model:ctrl.parserResult.modelMapper($scope,locals)})}),ctrl.closeOnSelect&&ctrl.close(skipFocusser),$event&&"click"===$event.type&&(ctrl.clickTriggeredSelect=!0)}}},ctrl.close=function(skipFocusser){ctrl.open&&(ctrl.ngModel&&ctrl.ngModel.$setTouched&&ctrl.ngModel.$setTouched(),_resetSearchInput(),ctrl.open=!1,$scope.$broadcast("uis:close",skipFocusser))},ctrl.setFocus=function(){ctrl.focus||ctrl.focusInput[0].focus()},ctrl.clear=function($event){ctrl.select(void 0),$event.stopPropagation(),$timeout(function(){ctrl.focusser[0].focus()},0,!1)},ctrl.toggle=function(e){ctrl.open?(ctrl.close(),e.preventDefault(),e.stopPropagation()):ctrl.activate()},ctrl.isLocked=function(itemScope,itemIndex){var isLocked,item=ctrl.selected[itemIndex];return item&&!angular.isUndefined(ctrl.lockChoiceExpression)&&(isLocked=!!itemScope.$eval(ctrl.lockChoiceExpression),item._uiSelectChoiceLocked=isLocked),isLocked};var sizeWatch=null;ctrl.sizeSearchInput=function(){var input=ctrl.searchInput[0],container=ctrl.searchInput.parent().parent()[0],calculateContainerWidth=function(){return container.clientWidth*!!input.offsetParent},updateIfVisible=function(containerWidth){if(0===containerWidth)return!1;var inputWidth=containerWidth-input.offsetLeft-10;return 50>inputWidth&&(inputWidth=containerWidth),ctrl.searchInput.css("width",inputWidth+"px"),!0};ctrl.searchInput.css("width","10px"),$timeout(function(){null!==sizeWatch||updateIfVisible(calculateContainerWidth())||(sizeWatch=$scope.$watch(calculateContainerWidth,function(containerWidth){updateIfVisible(containerWidth)&&(sizeWatch(),sizeWatch=null)}))})},ctrl.searchInput.on("keydown",function(e){var key=e.which;$scope.$apply(function(){var tagged=!1;if((ctrl.items.length>0||ctrl.tagging.isActivated)&&(_handleDropDownSelection(key),ctrl.taggingTokens.isActivated)){for(var i=0;i<ctrl.taggingTokens.tokens.length;i++)ctrl.taggingTokens.tokens[i]===KEY.MAP[e.keyCode]&&ctrl.search.length>0&&(tagged=!0);tagged&&$timeout(function(){ctrl.searchInput.triggerHandler("tagged");var newItem=ctrl.search.replace(KEY.MAP[e.keyCode],"").trim();ctrl.tagging.fct&&(newItem=ctrl.tagging.fct(newItem)),newItem&&ctrl.select(newItem,!0)})}}),KEY.isVerticalMovement(key)&&ctrl.items.length>0&&_ensureHighlightVisible(),(key===KEY.ENTER||key===KEY.ESC)&&(e.preventDefault(),e.stopPropagation())}),ctrl.searchInput.on("paste",function(e){var data=e.originalEvent.clipboardData.getData("text/plain");if(data&&data.length>0&&ctrl.taggingTokens.isActivated&&ctrl.tagging.fct){var items=data.split(ctrl.taggingTokens.tokens[0]);items&&items.length>0&&(angular.forEach(items,function(item){var newItem=ctrl.tagging.fct(item);newItem&&ctrl.select(newItem,!0)}),e.preventDefault(),e.stopPropagation())}}),ctrl.searchInput.on("tagged",function(){$timeout(function(){_resetSearchInput()})}),$scope.$on("$destroy",function(){ctrl.searchInput.off("keyup keydown tagged blur paste")})}]),uis.directive("uiSelect",["$document","uiSelectConfig","uiSelectMinErr","uisOffset","$compile","$parse","$timeout",function($document,uiSelectConfig,uiSelectMinErr,uisOffset,$compile,$parse,$timeout){return{restrict:"EA",templateUrl:function(tElement,tAttrs){var theme=tAttrs.theme||uiSelectConfig.theme;return theme+(angular.isDefined(tAttrs.multiple)?"/select-multiple.tpl.html":"/select.tpl.html")},replace:!0,transclude:!0,require:["uiSelect","^ngModel"],scope:!0,controller:"uiSelectCtrl",controllerAs:"$select",compile:function(tElement,tAttrs){return angular.isDefined(tAttrs.multiple)?tElement.append("<ui-select-multiple/>").removeAttr("multiple"):tElement.append("<ui-select-single/>"),tAttrs.inputId&&(tElement.querySelectorAll("input.ui-select-search")[0].id=tAttrs.inputId),function(scope,element,attrs,ctrls,transcludeFn){function onDocumentClick(e){if($select.open){var contains=!1;if(contains=window.jQuery?window.jQuery.contains(element[0],e.target):element[0].contains(e.target),!contains&&!$select.clickTriggeredSelect){var focusableControls=["input","button","textarea"],targetController=angular.element(e.target).controller("uiSelect"),skipFocusser=targetController&&targetController!==$select;skipFocusser||(skipFocusser=~focusableControls.indexOf(e.target.tagName.toLowerCase())),$select.close(skipFocusser),scope.$digest()}$select.clickTriggeredSelect=!1}}function positionDropdown(){var offset=uisOffset(element);placeholder=angular.element('<div class="ui-select-placeholder"></div>'),placeholder[0].style.width=offset.width+"px",placeholder[0].style.height=offset.height+"px",element.after(placeholder),originalWidth=element[0].style.width,$document.find("body").append(element),element[0].style.position="absolute",element[0].style.left=offset.left+"px",element[0].style.top=offset.top+"px",element[0].style.width=offset.width+"px"}function resetDropdown(){null!==placeholder&&(placeholder.replaceWith(element),placeholder=null,element[0].style.position="",element[0].style.left="",element[0].style.top="",element[0].style.width=originalWidth)}var $select=ctrls[0],ngModel=ctrls[1];$select.generatedId=uiSelectConfig.generateId(),$select.baseTitle=attrs.title||"Select box",$select.focusserTitle=$select.baseTitle+" focus",$select.focusserId="focusser-"+$select.generatedId,$select.closeOnSelect=function(){return angular.isDefined(attrs.closeOnSelect)?$parse(attrs.closeOnSelect)():uiSelectConfig.closeOnSelect}(),$select.onSelectCallback=$parse(attrs.onSelect),$select.onRemoveCallback=$parse(attrs.onRemove),$select.limit=angular.isDefined(attrs.limit)?parseInt(attrs.limit,10):void 0,$select.ngModel=ngModel,$select.choiceGrouped=function(group){return $select.isGrouped&&group&&group.name},attrs.tabindex&&attrs.$observe("tabindex",function(value){$select.focusInput.attr("tabindex",value),element.removeAttr("tabindex")}),scope.$watch("searchEnabled",function(){var searchEnabled=scope.$eval(attrs.searchEnabled);$select.searchEnabled=void 0!==searchEnabled?searchEnabled:uiSelectConfig.searchEnabled}),scope.$watch("sortable",function(){var sortable=scope.$eval(attrs.sortable);$select.sortable=void 0!==sortable?sortable:uiSelectConfig.sortable}),attrs.$observe("disabled",function(){$select.disabled=void 0!==attrs.disabled?attrs.disabled:!1}),attrs.$observe("resetSearchInput",function(){var resetSearchInput=scope.$eval(attrs.resetSearchInput);$select.resetSearchInput=void 0!==resetSearchInput?resetSearchInput:!0}),attrs.$observe("tagging",function(){if(void 0!==attrs.tagging){var taggingEval=scope.$eval(attrs.tagging);$select.tagging={isActivated:!0,fct:taggingEval!==!0?taggingEval:void 0}}else $select.tagging={isActivated:!1,fct:void 0}}),attrs.$observe("taggingLabel",function(){void 0!==attrs.tagging&&($select.taggingLabel="false"===attrs.taggingLabel?!1:void 0!==attrs.taggingLabel?attrs.taggingLabel:"(new)")}),attrs.$observe("taggingTokens",function(){if(void 0!==attrs.tagging){var tokens=void 0!==attrs.taggingTokens?attrs.taggingTokens.split("|"):[",","ENTER"];$select.taggingTokens={isActivated:!0,tokens:tokens}}}),angular.isDefined(attrs.autofocus)&&$timeout(function(){$select.setFocus()}),angular.isDefined(attrs.focusOn)&&scope.$on(attrs.focusOn,function(){$timeout(function(){$select.setFocus()})}),$document.on("click",onDocumentClick),scope.$on("$destroy",function(){$document.off("click",onDocumentClick)}),transcludeFn(scope,function(clone){var transcluded=angular.element("<div>").append(clone),transcludedMatch=transcluded.querySelectorAll(".ui-select-match");if(transcludedMatch.removeAttr("ui-select-match"),transcludedMatch.removeAttr("data-ui-select-match"),1!==transcludedMatch.length)throw uiSelectMinErr("transcluded","Expected 1 .ui-select-match but got '{0}'.",transcludedMatch.length);element.querySelectorAll(".ui-select-match").replaceWith(transcludedMatch);var transcludedChoices=transcluded.querySelectorAll(".ui-select-choices");if(transcludedChoices.removeAttr("ui-select-choices"),transcludedChoices.removeAttr("data-ui-select-choices"),1!==transcludedChoices.length)throw uiSelectMinErr("transcluded","Expected 1 .ui-select-choices but got '{0}'.",transcludedChoices.length);element.querySelectorAll(".ui-select-choices").replaceWith(transcludedChoices)});var appendToBody=scope.$eval(attrs.appendToBody);(void 0!==appendToBody?appendToBody:uiSelectConfig.appendToBody)&&(scope.$watch("$select.open",function(isOpen){isOpen?positionDropdown():resetDropdown()}),scope.$on("$destroy",function(){resetDropdown()}));var placeholder=null,originalWidth="",dropdown=null,directionUpClassName="direction-up";scope.$watch("$select.open",function(){("auto"===$select.dropdownPosition||"up"===$select.dropdownPosition)&&scope.calculateDropdownPos()});var setDropdownPosUp=function(offset,offsetDropdown){offset=offset||uisOffset(element),offsetDropdown=offsetDropdown||uisOffset(dropdown),dropdown[0].style.position="absolute",dropdown[0].style.top=-1*offsetDropdown.height+"px",element.addClass(directionUpClassName)},setDropdownPosDown=function(offset,offsetDropdown){element.removeClass(directionUpClassName),offset=offset||uisOffset(element),offsetDropdown=offsetDropdown||uisOffset(dropdown),dropdown[0].style.position="",dropdown[0].style.top=""};scope.calculateDropdownPos=function(){if($select.open){if(dropdown=angular.element(element).querySelectorAll(".ui-select-dropdown"),0===dropdown.length)return;dropdown[0].style.opacity=0,$timeout(function(){if("up"===$select.dropdownPosition)setDropdownPosUp(offset,offsetDropdown);else{element.removeClass(directionUpClassName);var offset=uisOffset(element),offsetDropdown=uisOffset(dropdown),scrollTop=$document[0].documentElement.scrollTop||$document[0].body.scrollTop;offset.top+offset.height+offsetDropdown.height>scrollTop+$document[0].documentElement.clientHeight?setDropdownPosUp(offset,offsetDropdown):setDropdownPosDown(offset,offsetDropdown)}dropdown[0].style.opacity=1})}else{if(null===dropdown||0===dropdown.length)return;dropdown[0].style.position="",dropdown[0].style.top="",element.removeClass(directionUpClassName)}}}}}}]),uis.directive("uiSelectMatch",["uiSelectConfig",function(uiSelectConfig){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(tElement){var theme=tElement.parent().attr("theme")||uiSelectConfig.theme,multi=tElement.parent().attr("multiple");return theme+(multi?"/match-multiple.tpl.html":"/match.tpl.html")},link:function(scope,element,attrs,$select){function setAllowClear(allow){$select.allowClear=angular.isDefined(allow)?""===allow?!0:"true"===allow.toLowerCase():!1}$select.lockChoiceExpression=attrs.uiLockChoice,attrs.$observe("placeholder",function(placeholder){$select.placeholder=void 0!==placeholder?placeholder:uiSelectConfig.placeholder}),attrs.$observe("allowClear",setAllowClear),setAllowClear(attrs.allowClear),$select.multiple&&$select.sizeSearchInput()}}}]),uis.directive("uiSelectMultiple",["uiSelectMinErr","$timeout",function(uiSelectMinErr,$timeout){return{restrict:"EA",require:["^uiSelect","^ngModel"],controller:["$scope","$timeout",function($scope,$timeout){var ngModel,ctrl=this,$select=$scope.$select;$scope.$evalAsync(function(){ngModel=$scope.ngModel}),ctrl.activeMatchIndex=-1,ctrl.updateModel=function(){ngModel.$setViewValue(Date.now()),ctrl.refreshComponent()},ctrl.refreshComponent=function(){$select.refreshItems(),$select.sizeSearchInput()},ctrl.removeChoice=function(index){var removedChoice=$select.selected[index];if(!removedChoice._uiSelectChoiceLocked){var locals={};locals[$select.parserResult.itemName]=removedChoice,$select.selected.splice(index,1),ctrl.activeMatchIndex=-1,$select.sizeSearchInput(),$timeout(function(){$select.onRemoveCallback($scope,{$item:removedChoice,$model:$select.parserResult.modelMapper($scope,locals)})}),ctrl.updateModel()}},ctrl.getPlaceholder=function(){return $select.selected&&$select.selected.length?void 0:$select.placeholder}}],controllerAs:"$selectMultiple",link:function(scope,element,attrs,ctrls){function _getCaretPosition(el){return angular.isNumber(el.selectionStart)?el.selectionStart:el.value.length}function _handleMatchSelection(key){function getNewActiveMatchIndex(){switch(key){case KEY.LEFT:return~$selectMultiple.activeMatchIndex?prev:last;case KEY.RIGHT:return~$selectMultiple.activeMatchIndex&&curr!==last?next:($select.activate(),!1);case KEY.BACKSPACE:return~$selectMultiple.activeMatchIndex?($selectMultiple.removeChoice(curr),prev):last;case KEY.DELETE:return~$selectMultiple.activeMatchIndex?($selectMultiple.removeChoice($selectMultiple.activeMatchIndex),curr):!1}}var caretPosition=_getCaretPosition($select.searchInput[0]),length=$select.selected.length,first=0,last=length-1,curr=$selectMultiple.activeMatchIndex,next=$selectMultiple.activeMatchIndex+1,prev=$selectMultiple.activeMatchIndex-1,newIndex=curr;return caretPosition>0||$select.search.length&&key==KEY.RIGHT?!1:($select.close(),newIndex=getNewActiveMatchIndex(),$selectMultiple.activeMatchIndex=$select.selected.length&&newIndex!==!1?Math.min(last,Math.max(first,newIndex)):-1,!0)}function _findCaseInsensitiveDupe(arr){if(void 0===arr||void 0===$select.search)return!1;var hasDupe=arr.filter(function(origItem){return void 0===$select.search.toUpperCase()||void 0===origItem?!1:origItem.toUpperCase()===$select.search.toUpperCase()}).length>0;return hasDupe}function _findApproxDupe(haystack,needle){var dupeIndex=-1;if(angular.isArray(haystack))for(var tempArr=angular.copy(haystack),i=0;i<tempArr.length;i++)if(void 0===$select.tagging.fct)tempArr[i]+" "+$select.taggingLabel===needle&&(dupeIndex=i);else{var mockObj=tempArr[i];mockObj.isTag=!0,angular.equals(mockObj,needle)&&(dupeIndex=i)}return dupeIndex}var $select=ctrls[0],ngModel=scope.ngModel=ctrls[1],$selectMultiple=scope.$selectMultiple;$select.multiple=!0,$select.removeSelected=!0,$select.focusInput=$select.searchInput,ngModel.$parsers.unshift(function(){for(var result,locals={},resultMultiple=[],j=$select.selected.length-1;j>=0;j--)locals={},locals[$select.parserResult.itemName]=$select.selected[j],result=$select.parserResult.modelMapper(scope,locals),resultMultiple.unshift(result);return resultMultiple}),ngModel.$formatters.unshift(function(inputValue){var result,data=$select.parserResult.source(scope,{$select:{search:""}}),locals={};if(!data)return inputValue;var resultMultiple=[],checkFnMultiple=function(list,value){if(list&&list.length){for(var p=list.length-1;p>=0;p--){if(locals[$select.parserResult.itemName]=list[p],result=$select.parserResult.modelMapper(scope,locals),$select.parserResult.trackByExp){var matches=/\.(.+)/.exec($select.parserResult.trackByExp);if(matches.length>0&&result[matches[1]]==value[matches[1]])return resultMultiple.unshift(list[p]),!0}if(angular.equals(result,value))return resultMultiple.unshift(list[p]),!0}return!1}};if(!inputValue)return resultMultiple;for(var k=inputValue.length-1;k>=0;k--)checkFnMultiple($select.selected,inputValue[k])||checkFnMultiple(data,inputValue[k])||resultMultiple.unshift(inputValue[k]);return resultMultiple}),scope.$watchCollection(function(){return ngModel.$modelValue},function(newValue,oldValue){oldValue!=newValue&&(ngModel.$modelValue=null,$selectMultiple.refreshComponent())}),ngModel.$render=function(){if(!angular.isArray(ngModel.$viewValue)){if(!angular.isUndefined(ngModel.$viewValue)&&null!==ngModel.$viewValue)throw uiSelectMinErr("multiarr","Expected model value to be array but got '{0}'",ngModel.$viewValue);$select.selected=[]}$select.selected=ngModel.$viewValue,scope.$evalAsync()},scope.$on("uis:select",function(event,item){$select.selected.length>=$select.limit||($select.selected.push(item),$selectMultiple.updateModel())}),scope.$on("uis:activate",function(){$selectMultiple.activeMatchIndex=-1}),scope.$watch("$select.disabled",function(newValue,oldValue){oldValue&&!newValue&&$select.sizeSearchInput()}),$select.searchInput.on("keydown",function(e){var key=e.which;scope.$apply(function(){var processed=!1;KEY.isHorizontalMovement(key)&&(processed=_handleMatchSelection(key)),processed&&key!=KEY.TAB&&(e.preventDefault(),e.stopPropagation())})}),$select.searchInput.on("keyup",function(e){if(KEY.isVerticalMovement(e.which)||scope.$evalAsync(function(){$select.activeIndex=$select.taggingLabel===!1?-1:0}),$select.tagging.isActivated&&$select.search.length>0){if(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC||KEY.isVerticalMovement(e.which))return;if($select.activeIndex=$select.taggingLabel===!1?-1:0,$select.taggingLabel===!1)return;var newItem,item,tagItems,tagItem,items=angular.copy($select.items),stashArr=angular.copy($select.items),hasTag=!1,dupeIndex=-1;if(void 0!==$select.tagging.fct){if(tagItems=$select.$filter("filter")(items,{isTag:!0}),tagItems.length>0&&(tagItem=tagItems[0]),items.length>0&&tagItem&&(hasTag=!0,items=items.slice(1,items.length),stashArr=stashArr.slice(1,stashArr.length)),newItem=$select.tagging.fct($select.search),newItem.isTag=!0,stashArr.filter(function(origItem){return angular.equals(origItem,$select.tagging.fct($select.search))}).length>0)return;newItem.isTag=!0}else{if(tagItems=$select.$filter("filter")(items,function(item){return item.match($select.taggingLabel)}),tagItems.length>0&&(tagItem=tagItems[0]),item=items[0],void 0!==item&&items.length>0&&tagItem&&(hasTag=!0,items=items.slice(1,items.length),stashArr=stashArr.slice(1,stashArr.length)),newItem=$select.search+" "+$select.taggingLabel,_findApproxDupe($select.selected,$select.search)>-1)return;if(_findCaseInsensitiveDupe(stashArr.concat($select.selected)))return void(hasTag&&(items=stashArr,scope.$evalAsync(function(){$select.activeIndex=0,$select.items=items})));if(_findCaseInsensitiveDupe(stashArr))return void(hasTag&&($select.items=stashArr.slice(1,stashArr.length)))}hasTag&&(dupeIndex=_findApproxDupe($select.selected,newItem)),dupeIndex>-1?items=items.slice(dupeIndex+1,items.length-1):(items=[],items.push(newItem),items=items.concat(stashArr)),scope.$evalAsync(function(){$select.activeIndex=0,$select.items=items})}}),$select.searchInput.on("blur",function(){$timeout(function(){$selectMultiple.activeMatchIndex=-1})})}}}]),uis.directive("uiSelectSingle",["$timeout","$compile",function($timeout,$compile){return{restrict:"EA",require:["^uiSelect","^ngModel"],link:function(scope,element,attrs,ctrls){var $select=ctrls[0],ngModel=ctrls[1];ngModel.$parsers.unshift(function(inputValue){var result,locals={};return locals[$select.parserResult.itemName]=inputValue,result=$select.parserResult.modelMapper(scope,locals)}),ngModel.$formatters.unshift(function(inputValue){var result,data=$select.parserResult.source(scope,{$select:{search:""}}),locals={};if(data){var checkFnSingle=function(d){return locals[$select.parserResult.itemName]=d,result=$select.parserResult.modelMapper(scope,locals),result==inputValue};if($select.selected&&checkFnSingle($select.selected))return $select.selected;for(var i=data.length-1;i>=0;i--)if(checkFnSingle(data[i]))return data[i]}return inputValue}),scope.$watch("$select.selected",function(newValue){ngModel.$viewValue!==newValue&&ngModel.$setViewValue(newValue)}),ngModel.$render=function(){$select.selected=ngModel.$viewValue},scope.$on("uis:select",function(event,item){$select.selected=item}),scope.$on("uis:close",function(event,skipFocusser){$timeout(function(){$select.focusser.prop("disabled",!1),skipFocusser||$select.focusser[0].focus()},0,!1)}),scope.$on("uis:activate",function(){focusser.prop("disabled",!0)});var focusser=angular.element("<input ng-disabled='$select.disabled' class='ui-select-focusser ui-select-offscreen' type='text' id='{{ $select.focusserId }}' aria-label='{{ $select.focusserTitle }}' aria-haspopup='true' role='button' />");$compile(focusser)(scope),$select.focusser=focusser,$select.focusInput=focusser,element.parent().append(focusser),focusser.bind("focus",function(){scope.$evalAsync(function(){$select.focus=!0})}),focusser.bind("blur",function(){scope.$evalAsync(function(){$select.focus=!1})}),focusser.bind("keydown",function(e){return e.which===KEY.BACKSPACE?(e.preventDefault(),e.stopPropagation(),$select.select(void 0),void scope.$apply()):void(e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC||((e.which==KEY.DOWN||e.which==KEY.UP||e.which==KEY.ENTER||e.which==KEY.SPACE)&&(e.preventDefault(),e.stopPropagation(),$select.activate()),scope.$digest()))}),focusser.bind("keyup input",function(e){e.which===KEY.TAB||KEY.isControl(e)||KEY.isFunctionKey(e)||e.which===KEY.ESC||e.which==KEY.ENTER||e.which===KEY.BACKSPACE||($select.activate(focusser.val()),focusser.val(""),scope.$digest())})}}}]),uis.directive("uiSelectSort",["$timeout","uiSelectConfig","uiSelectMinErr",function($timeout,uiSelectConfig,uiSelectMinErr){return{require:"^uiSelect",link:function(scope,element,attrs,$select){if(null===scope[attrs.uiSelectSort])throw uiSelectMinErr("sort","Expected a list to sort");var options=angular.extend({axis:"horizontal"},scope.$eval(attrs.uiSelectSortOptions)),axis=options.axis,draggingClassName="dragging",droppingClassName="dropping",droppingBeforeClassName="dropping-before",droppingAfterClassName="dropping-after";scope.$watch(function(){return $select.sortable},function(n){n?element.attr("draggable",!0):element.removeAttr("draggable")}),element.on("dragstart",function(e){element.addClass(draggingClassName),(e.dataTransfer||e.originalEvent.dataTransfer).setData("text/plain",scope.$index)}),element.on("dragend",function(){element.removeClass(draggingClassName)});var dropTimeout,move=function(from,to){this.splice(to,0,this.splice(from,1)[0])},dragOverHandler=function(e){e.preventDefault();var offset="vertical"===axis?e.offsetY||e.layerY||(e.originalEvent?e.originalEvent.offsetY:0):e.offsetX||e.layerX||(e.originalEvent?e.originalEvent.offsetX:0);offset<this["vertical"===axis?"offsetHeight":"offsetWidth"]/2?(element.removeClass(droppingAfterClassName),element.addClass(droppingBeforeClassName)):(element.removeClass(droppingBeforeClassName),element.addClass(droppingAfterClassName))},dropHandler=function(e){e.preventDefault();var droppedItemIndex=parseInt((e.dataTransfer||e.originalEvent.dataTransfer).getData("text/plain"),10);$timeout.cancel(dropTimeout),dropTimeout=$timeout(function(){_dropHandler(droppedItemIndex)},20)},_dropHandler=function(droppedItemIndex){var theList=scope.$eval(attrs.uiSelectSort),itemToMove=theList[droppedItemIndex],newIndex=null;newIndex=element.hasClass(droppingBeforeClassName)?droppedItemIndex<scope.$index?scope.$index-1:scope.$index:droppedItemIndex<scope.$index?scope.$index:scope.$index+1,move.apply(theList,[droppedItemIndex,newIndex]),scope.$apply(function(){scope.$emit("uiSelectSort:change",{array:theList,item:itemToMove,from:droppedItemIndex,to:newIndex})}),element.removeClass(droppingClassName),element.removeClass(droppingBeforeClassName),element.removeClass(droppingAfterClassName),element.off("drop",dropHandler)};element.on("dragenter",function(){element.hasClass(draggingClassName)||(element.addClass(droppingClassName),element.on("dragover",dragOverHandler),element.on("drop",dropHandler))}),element.on("dragleave",function(e){e.target==element&&(element.removeClass(droppingClassName),element.removeClass(droppingBeforeClassName),element.removeClass(droppingAfterClassName),element.off("dragover",dragOverHandler),element.off("drop",dropHandler))})}}}]),uis.service("uisRepeatParser",["uiSelectMinErr","$parse",function(uiSelectMinErr,$parse){var self=this;self.parse=function(expression){var match,isObjectCollection=/\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)/.test(expression);if(match=expression.match(/^\s*(?:([\s\S]+?)\s+as\s+)?(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(([\w\.]+)?\s*(|\s*[\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),!match)throw uiSelectMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);if(!match[6]&&isObjectCollection)throw uiSelectMinErr("iexp","Expected expression in form of '_item_ as (_key_, _item_) in _ObjCollection_ [ track by _id_]' but got '{0}'.",expression);return{itemName:match[4]||match[2],keyName:match[3],source:$parse(match[3]?match[6]:match[5]),sourceName:match[6],filters:match[7],trackByExp:match[8],modelMapper:$parse(match[1]||match[4]||match[2]),repeatExpression:function(grouped){var expression=this.itemName+" in "+(grouped?"$group.items":"$select.items");return this.trackByExp&&(expression+=" track by "+this.trackByExp),expression}}},self.getGroupNgRepeatExpression=function(){return"$group in $select.groups"}}])}(),angular.module("ui.select").run(["$templateCache",function($templateCache){$templateCache.put("bootstrap/choices.tpl.html",'<ul class="ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu" role="listbox" ng-show="$select.items.length > 0"><li class="ui-select-choices-group" id="ui-select-choices-{{ $select.generatedId }}"><div class="divider" ng-show="$select.isGrouped && $index > 0"></div><div ng-show="$select.isGrouped" class="ui-select-choices-group-label dropdown-header" ng-bind="$group.name"></div><div id="ui-select-choices-row-{{ $select.generatedId }}-{{$index}}" class="ui-select-choices-row" ng-class="{active: $select.isActive(this), disabled: $select.isDisabled(this)}" role="option"><a href="javascript:void(0)" class="ui-select-choices-row-inner"></a></div></li></ul>'),$templateCache.put("bootstrap/match-multiple.tpl.html",'<span class="ui-select-match"><span ng-repeat="$item in $select.selected"><span class="ui-select-match-item btn btn-default btn-xs" tabindex="-1" type="button" ng-disabled="$select.disabled" ng-click="$selectMultiple.activeMatchIndex = $index;" ng-class="{\'btn-primary\':$selectMultiple.activeMatchIndex === $index, \'select-locked\':$select.isLocked(this, $index)}" ui-select-sort="$select.selected"><span class="close ui-select-match-close" ng-hide="$select.disabled" ng-click="$selectMultiple.removeChoice($index)">&nbsp;&times;</span> <span uis-transclude-append=""></span></span></span></span>'),$templateCache.put("bootstrap/match.tpl.html",'<div class="ui-select-match" ng-hide="$select.open" ng-disabled="$select.disabled" ng-class="{\'btn-default-focus\':$select.focus}"><span tabindex="-1" class="btn btn-default form-control ui-select-toggle" aria-label="{{ $select.baseTitle }} activate" ng-disabled="$select.disabled" ng-click="$select.activate()" style="outline: 0;"><span ng-show="$select.isEmpty()" class="ui-select-placeholder text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="ui-select-match-text pull-left" ng-class="{\'ui-select-allow-clear\': $select.allowClear && !$select.isEmpty()}" ng-transclude=""></span> <i class="caret pull-right" ng-click="$select.toggle($event)"></i> <a ng-show="$select.allowClear && !$select.isEmpty()" aria-label="{{ $select.baseTitle }} clear" style="margin-right: 10px" ng-click="$select.clear($event)" class="btn btn-xs btn-link pull-right"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></a></span></div>'),$templateCache.put("bootstrap/select-multiple.tpl.html",'<div class="ui-select-container ui-select-multiple ui-select-bootstrap dropdown form-control" ng-class="{open: $select.open}"><div><div class="ui-select-match"></div><input type="text" autocomplete="false" autocorrect="off" autocapitalize="off" spellcheck="false" class="ui-select-search input-xs" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-disabled="$select.disabled" ng-hide="$select.disabled" ng-click="$select.activate()" ng-model="$select.search" role="combobox" aria-label="{{ $select.baseTitle }}" ondrop="return false;"></div><div class="ui-select-choices"></div></div>'),$templateCache.put("bootstrap/select.tpl.html",'<div class="ui-select-container ui-select-bootstrap dropdown" ng-class="{open: $select.open}"><div class="ui-select-match"></div><input type="text" autocomplete="false" tabindex="-1" aria-expanded="true" aria-label="{{ $select.baseTitle }}" aria-owns="ui-select-choices-{{ $select.generatedId }}" aria-activedescendant="ui-select-choices-row-{{ $select.generatedId }}-{{ $select.activeIndex }}" class="form-control ui-select-search" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-show="$select.searchEnabled && $select.open"><div class="ui-select-choices"></div></div>'),$templateCache.put("selectize/choices.tpl.html",'<div ng-show="$select.open" class="ui-select-choices ui-select-dropdown selectize-dropdown single"><div class="ui-select-choices-content selectize-dropdown-content"><div class="ui-select-choices-group optgroup" role="listbox"><div ng-show="$select.isGrouped" class="ui-select-choices-group-label optgroup-header" ng-bind="$group.name"></div><div role="option" class="ui-select-choices-row" ng-class="{active: $select.isActive(this), disabled: $select.isDisabled(this)}"><div class="option ui-select-choices-row-inner" data-selectable=""></div></div></div></div></div>'),$templateCache.put("selectize/match.tpl.html",'<div ng-hide="($select.open || $select.isEmpty())" class="ui-select-match" ng-transclude=""></div>'),$templateCache.put("selectize/select.tpl.html",'<div class="ui-select-container selectize-control single" ng-class="{\'open\': $select.open}"><div class="selectize-input" ng-class="{\'focus\': $select.open, \'disabled\': $select.disabled, \'selectize-focus\' : $select.focus}" ng-click="$select.activate()"><div class="ui-select-match"></div><input type="text" autocomplete="false" tabindex="-1" class="ui-select-search ui-select-toggle" ng-click="$select.toggle($event)" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-hide="!$select.searchEnabled || ($select.selected && !$select.open)" ng-disabled="$select.disabled" aria-label="{{ $select.baseTitle }}"></div><div class="ui-select-choices"></div></div>'),$templateCache.put("select2/choices.tpl.html",'<ul class="ui-select-choices ui-select-choices-content select2-results"><li class="ui-select-choices-group" ng-class="{\'select2-result-with-children\': $select.choiceGrouped($group) }"><div ng-show="$select.choiceGrouped($group)" class="ui-select-choices-group-label select2-result-label" ng-bind="$group.name"></div><ul role="listbox" id="ui-select-choices-{{ $select.generatedId }}" ng-class="{\'select2-result-sub\': $select.choiceGrouped($group), \'select2-result-single\': !$select.choiceGrouped($group) }"><li role="option" id="ui-select-choices-row-{{ $select.generatedId }}-{{$index}}" class="ui-select-choices-row" ng-class="{\'select2-highlighted\': $select.isActive(this), \'select2-disabled\': $select.isDisabled(this)}"><div class="select2-result-label ui-select-choices-row-inner"></div></li></ul></li></ul>'),$templateCache.put("select2/match-multiple.tpl.html",'<span class="ui-select-match"><li class="ui-select-match-item select2-search-choice" ng-repeat="$item in $select.selected" ng-class="{\'select2-search-choice-focus\':$selectMultiple.activeMatchIndex === $index, \'select2-locked\':$select.isLocked(this, $index)}" ui-select-sort="$select.selected"><span uis-transclude-append=""></span> <a href="javascript:;" class="ui-select-match-close select2-search-choice-close" ng-click="$selectMultiple.removeChoice($index)" tabindex="-1"></a></li></span>'),$templateCache.put("select2/match.tpl.html",'<a class="select2-choice ui-select-match" ng-class="{\'select2-default\': $select.isEmpty()}" ng-click="$select.toggle($event)" aria-label="{{ $select.baseTitle }} select"><span ng-show="$select.isEmpty()" class="select2-chosen">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="select2-chosen" ng-transclude=""></span> <abbr ng-if="$select.allowClear && !$select.isEmpty()" class="select2-search-choice-close" ng-click="$select.clear($event)"></abbr> <span class="select2-arrow ui-select-toggle"><b></b></span></a>'),$templateCache.put("select2/select-multiple.tpl.html",'<div class="ui-select-container ui-select-multiple select2 select2-container select2-container-multi" ng-class="{\'select2-container-active select2-dropdown-open open\': $select.open, \'select2-container-disabled\': $select.disabled}"><ul class="select2-choices"><span class="ui-select-match"></span><li class="select2-search-field"><input type="text" autocomplete="false" autocorrect="off" autocapitalize="off" spellcheck="false" role="combobox" aria-expanded="true" aria-owns="ui-select-choices-{{ $select.generatedId }}" aria-label="{{ $select.baseTitle }}" aria-activedescendant="ui-select-choices-row-{{ $select.generatedId }}-{{ $select.activeIndex }}" class="select2-input ui-select-search" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-disabled="$select.disabled" ng-hide="$select.disabled" ng-model="$select.search" ng-click="$select.activate()" style="width: 34px;" ondrop="return false;"></li></ul><div class="ui-select-dropdown select2-drop select2-with-searchbox select2-drop-active" ng-class="{\'select2-display-none\': !$select.open}"><div class="ui-select-choices"></div></div></div>'),$templateCache.put("select2/select.tpl.html",'<div class="ui-select-container select2 select2-container" ng-class="{\'select2-container-active select2-dropdown-open open\': $select.open, \'select2-container-disabled\': $select.disabled, \'select2-container-active\': $select.focus, \'select2-allowclear\': $select.allowClear && !$select.isEmpty()}"><div class="ui-select-match"></div><div class="ui-select-dropdown select2-drop select2-with-searchbox select2-drop-active" ng-class="{\'select2-display-none\': !$select.open}"><div class="select2-search" ng-show="$select.searchEnabled"><input type="text" autocomplete="false" autocorrect="false" autocapitalize="off" spellcheck="false" role="combobox" aria-expanded="true" aria-owns="ui-select-choices-{{ $select.generatedId }}" aria-label="{{ $select.baseTitle }}" aria-activedescendant="ui-select-choices-row-{{ $select.generatedId }}-{{ $select.activeIndex }}" class="ui-select-search select2-input" ng-model="$select.search"></div><div class="ui-select-choices"></div></div></div>')
}]),!function(a){"use strict";function c(){function b(a){return function(){j.waitForVendorCount&&(k[a]||(k[a]=[]),k[a].push(arguments))}}function c(b,c){return l[b]||(l[b]=[]),l[b].push(c),function(){var c=arguments;a.forEach(l[b],function(a){a.apply(this,c)},this)}}function d(a,b){b?setTimeout(a,b):a()}function e(b,e){m[b]=c(b,e);var f=h[b],g=f?f.bufferFlushDelay:null,i=null!==g?g:h.bufferFlushDelay;a.forEach(k[b],function(a,b){d(function(){e.apply(this,a)},b*i)})}function f(a){return a.replace(/^./,function(a){return a.toUpperCase()})}function g(a){var d="register"+f(a);n[d]=function(b){e(a,b)},m[a]=c(a,b(a))}var h={pageTracking:{autoTrackFirstPage:!0,autoTrackVirtualPages:!0,trackRelativePath:!1,autoBasePath:!1,basePath:"",excludedRoutes:[]},eventTracking:{},bufferFlushDelay:1e3,developerMode:!1},i=["pageTrack","eventTrack","exceptionTrack","setAlias","setUsername","setUserProperties","setUserPropertiesOnce","setSuperProperties","setSuperPropertiesOnce","userTimings"],k={},l={},m={settings:h},n={$get:function(){return m},api:m,settings:h,virtualPageviews:function(a){this.settings.pageTracking.autoTrackVirtualPages=a},excludeRoutes:function(a){this.settings.pageTracking.excludedRoutes=a},firstPageview:function(a){this.settings.pageTracking.autoTrackFirstPage=a},withBase:function(b){this.settings.pageTracking.basePath=b?a.element(document).find("base").attr("href"):""},withAutoBase:function(a){this.settings.pageTracking.autoBasePath=a},developerMode:function(a){this.settings.developerMode=a}};return a.forEach(i,g),n}function d(b,c,d,e){function f(a){for(var b=0;b<d.settings.pageTracking.excludedRoutes.length;b++){var c=d.settings.pageTracking.excludedRoutes[b];if(c instanceof RegExp&&c.test(a)||a.indexOf(c)>-1)return!0}return!1}function g(a,b){f(a)||d.pageTrack(a,b)}d.settings.pageTracking.autoTrackFirstPage&&e.invoke(["$location",function(a){var b=!0;if(e.has("$route")){var f=e.get("$route");for(var h in f.routes){b=!1;break}}else if(e.has("$state")){var i=e.get("$state");for(var j in i.get()){b=!1;break}}if(b)if(d.settings.pageTracking.autoBasePath&&(d.settings.pageTracking.basePath=c.location.pathname),d.settings.pageTracking.trackRelativePath){var k=d.settings.pageTracking.basePath+a.url();g(k,a)}else g(a.absUrl(),a)}]),d.settings.pageTracking.autoTrackVirtualPages&&e.invoke(["$location",function(a){d.settings.pageTracking.autoBasePath&&(d.settings.pageTracking.basePath=c.location.pathname+"#");var f=!0;if(e.has("$route")){var h=e.get("$route");for(var i in h.routes){f=!1;break}b.$on("$routeChangeSuccess",function(b,c){if(!c||!(c.$$route||c).redirectTo){var e=d.settings.pageTracking.basePath+a.url();g(e,a)}})}e.has("$state")&&(f=!1,b.$on("$stateChangeSuccess",function(){var e=d.settings.pageTracking.basePath+a.url();g(e,a)})),f&&b.$on("$locationChangeSuccess",function(b,c){if(!c||!(c.$$route||c).redirectTo)if(d.settings.pageTracking.trackRelativePath){var e=d.settings.pageTracking.basePath+a.url();g(e,a)}else g(a.absUrl(),a)})}]),d.settings.developerMode&&a.forEach(d,function(a,b){"function"==typeof a&&(d[b]=function(){})})}function e(b){return{restrict:"A",link:function(c,d,e){var f=e.analyticsOn||"click",j={};a.forEach(e.$attr,function(a,b){h(b)&&(j[i(b)]=e[b],e.$observe(b,function(a){j[i(b)]=a}))}),a.element(d[0]).bind(f,function(f){var h=e.analyticsEvent||g(d[0]);j.eventType=f.type,(!e.analyticsIf||c.$eval(e.analyticsIf))&&(e.analyticsProperties&&a.extend(j,c.$eval(e.analyticsProperties)),b.eventTrack(h,j))})}}}function f(a){return["a:","button:","button:button","button:submit","input:button","input:submit"].indexOf(a.tagName.toLowerCase()+":"+(a.type||""))>=0}function g(a){return f(a)?a.innerText||a.value:a.id||a.name||a.tagName}function h(a){return"analytics"===a.substr(0,9)&&-1===["On","Event","If","Properties","EventType"].indexOf(a.substr(9))}function i(a){var b=a.slice(9);return"undefined"!=typeof b&&null!==b&&b.length>0?b.substring(0,1).toLowerCase()+b.substring(1):b}var j=window.angulartics||(window.angulartics={});j.waitForVendorCount=0,j.waitForVendorApi=function(a,b,c,d,e){e||j.waitForVendorCount++,d||(d=c,c=void 0),!Object.prototype.hasOwnProperty.call(window,a)||void 0!==c&&void 0===window[a][c]?setTimeout(function(){j.waitForVendorApi(a,b,c,d,!0)},b):(j.waitForVendorCount--,d(window[a]))},a.module("angulartics",[]).provider("$analytics",c).run(["$rootScope","$window","$analytics","$injector",d]).directive("analyticsOn",["$analytics",e])}(angular),function(window,angular,undefined){"use strict";angular.module("angulartics.google.analytics",["angulartics"]).config(["$analyticsProvider",function($analyticsProvider){function setDimensionsAndMetrics(properties){if(window.ga)for(var idx=1;200>=idx;idx++)properties["dimension"+idx.toString()]&&ga("set","dimension"+idx.toString(),properties["dimension"+idx.toString()]),properties["metric"+idx.toString()]&&ga("set","metric"+idx.toString(),properties["metric"+idx.toString()])}$analyticsProvider.settings.pageTracking.trackRelativePath=!0,$analyticsProvider.settings.ga={additionalAccountNames:undefined,userId:null},$analyticsProvider.registerPageTrack(function(path){window._gaq&&(_gaq.push(["_trackPageview",path]),angular.forEach($analyticsProvider.settings.ga.additionalAccountNames,function(accountName){_gaq.push([accountName+"._trackPageview",path])})),window.ga&&($analyticsProvider.settings.ga.userId&&ga("set","&uid",$analyticsProvider.settings.ga.userId),ga("send","pageview",path),angular.forEach($analyticsProvider.settings.ga.additionalAccountNames,function(accountName){ga(accountName+".send","pageview",path)}))}),$analyticsProvider.registerEventTrack(function(action,properties){if(properties&&properties.category||(properties=properties||{},properties.category="Event"),properties.value){var parsed=parseInt(properties.value,10);properties.value=isNaN(parsed)?0:parsed}if(window.ga){var eventOptions={eventCategory:properties.category,eventAction:action,eventLabel:properties.label,eventValue:properties.value,nonInteraction:properties.noninteraction,page:properties.page||window.location.hash.substring(1)||window.location.pathname,userId:$analyticsProvider.settings.ga.userId};setDimensionsAndMetrics(properties),$analyticsProvider.settings.ga.transport?ga("send","event",eventOptions,{transport:$analyticsProvider.settings.ga.transport}):ga("send","event",eventOptions),angular.forEach($analyticsProvider.settings.ga.additionalAccountNames,function(accountName){ga(accountName+".send","event",eventOptions)})}else window._gaq&&_gaq.push(["_trackEvent",properties.category,action,properties.label,properties.value,properties.noninteraction])}),$analyticsProvider.registerExceptionTrack(function(properties){return properties&&properties.appId&&properties.appName&&properties.appVersion?(properties.fatal===undefined&&(console.log('No "fatal" provided, sending with fatal=true'),properties.exFatal=!0),properties.exDescription=properties.description,void ga("send","exception",properties)):void console.error("Must be setted appId, appName and appVersion.")}),$analyticsProvider.registerSetUsername(function(userId){$analyticsProvider.settings.ga.userId=userId}),$analyticsProvider.registerSetUserProperties(function(properties){setDimensionsAndMetrics(properties)}),$analyticsProvider.registerUserTimings(function(properties){return properties&&properties.timingCategory&&properties.timingVar&&properties.timingValue?void(window.ga&&ga("send","timing",properties)):void console.error("Properties timingCategory, timingVar, and timingValue are required to be set.")})}])}(window,window.angular),function(window,angular,undefined){angular.module("doubtfire.api.api-url",[]).constant("api","https://doubtfire.ict.swin.edu.au/api"),angular.module("doubtfire.api",["doubtfire.api.api-url","doubtfire.api.resource-plus","doubtfire.api.models"]),angular.module("doubtfire.api.models.convenor",[]).factory("Convenor",["resourcePlus",function(resourcePlus){return resourcePlus("/users/convenors")}]),angular.module("doubtfire.api.models.group-member",[]).factory("GroupMember",["resourcePlus",function(resourcePlus){return resourcePlus("/units/:unit_id/group_sets/:group_set_id/groups/:group_id/members/:id",{id:"@id",group_id:"@group_id",group_set_id:"@group_set_id",unit_id:"@unit_id"})}]),angular.module("doubtfire.api.models.group-set",[]).factory("GroupSet",["resourcePlus","api","currentUser","$window",function(resourcePlus,api,currentUser,$window){var GroupSet;return GroupSet=resourcePlus("/units/:unit_id/group_sets/:id",{id:"@id",unit_id:"@unit_id"}),GroupSet.groupCSVUploadUrl=function(unit,group_set){return""+api+"/units/"+unit.id+"/group_sets/"+group_set.id+"/groups/csv.json?auth_token="+currentUser.authenticationToken},GroupSet.downloadCSV=function(unit,group_set){return $window.open(""+api+"/units/"+unit.id+"/group_sets/"+group_set.id+"/groups/csv.json?auth_token="+currentUser.authenticationToken,"_blank")},GroupSet}]),angular.module("doubtfire.api.models.group",[]).factory("Group",["resourcePlus",function(resourcePlus){return resourcePlus("/units/:unit_id/group_sets/:group_set_id/groups/:id",{id:"@id",group_set_id:"@group_set_id",unit_id:"@unit_id"})}]),angular.module("doubtfire.api.models.intended-learning-outcome",[]).factory("IntendedLearningOutcome",["resourcePlus","api","currentUser",function(resourcePlus,api,currentUser){var IntendedLearningOutcome;return IntendedLearningOutcome=resourcePlus("/units/:unit_id/outcomes/:id",{id:"@id",unit_id:"@unit_id"}),IntendedLearningOutcome.getOutcomeBatchUploadUrl=function(unit){return""+api+"/units/"+unit.id+"/outcomes/csv?auth_token="+currentUser.authenticationToken},IntendedLearningOutcome}]),angular.module("doubtfire.api.models.learning-alignments",[]).factory("LearningAlignments",["resourcePlus",function(resourcePlus){return resourcePlus("/units/:unit_id/learning_alignments/:id",{id:"@id",unit_id:"@unit_id"})}]),angular.module("doubtfire.api.models",["doubtfire.api.models.project","doubtfire.api.models.unit","doubtfire.api.models.unit-role","doubtfire.api.models.user-role","doubtfire.api.models.convenor","doubtfire.api.models.tutor","doubtfire.api.models.tutorial","doubtfire.api.models.learning-alignments","doubtfire.api.models.intended-learning-outcome","doubtfire.api.models.task","doubtfire.api.models.task-comment","doubtfire.api.models.task-definition","doubtfire.api.models.group-member","doubtfire.api.models.group","doubtfire.api.models.group-set","doubtfire.api.models.task-alignment","doubtfire.api.models.task-feedback","doubtfire.api.models.task-similarity","doubtfire.api.models.students","doubtfire.api.models.user","doubtfire.api.models.task-completion-csv","doubtfire.api.models.portfolio-submission"]);var __indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};angular.module("doubtfire.api.models.portfolio-submission",["ngFileUpload"]).service("PortfolioSubmission",["api","$window","FileUploader","currentUser","alertService","resourcePlus",function(api,$window,FileUploader,currentUser,alertService,resourcePlus){return this.getPortfolioUrl=function(project){return""+api+"/submission/project/"+project.project_id+"/portfolio?auth_token="+currentUser.authenticationToken},this.openPortfolio=function(){return $window.open(this.getTaskUrl(task),"_blank")},this.fileUploader=function(scope,project){var extWhitelist,fileFilter,fileUploader,uploadUrl;return uploadUrl=""+api+"/submission/project/"+project.project_id+"/portfolio?auth_token="+currentUser.authenticationToken,fileUploader=new FileUploader({scope:scope,url:uploadUrl,method:"POST",queueLimit:1}),fileUploader.project=project,extWhitelist=function(name,exts){var ext,parts;return parts=name.toLowerCase().split("."),0===parts.length?!1:(ext=parts.pop(),__indexOf.call(exts,ext)>=0)},fileFilter=function(acceptList,type,item){var valid;return valid=extWhitelist(item.name,acceptList),valid||alertService.add("info",""+item.name+" is not a valid "+type+" file (accepts <code>"+_.flatten(acceptList)+"</code>)",6e3),valid},fileUploader.filters.push({name:"is_code",fn:function(item){return fileFilter(["pas","cpp","c","cs","h","java"],"code",item)}}),fileUploader.filters.push({name:"is_document",fn:function(item){return fileFilter(["pdf"],"document",item)}}),fileUploader.filters.push({name:"is_image",fn:function(item){return fileFilter(["png","gif","bmp","tiff","tif","jpeg","jpg"],"image",item)}}),fileUploader.onBeforeUploadItem=function(item){return item.formData=fileUploader.formData},fileUploader.uploadPortfolioPart=function(name,kind){return fileUploader.formData=[{name:name},{kind:kind}],fileUploader.uploadAll()},fileUploader.onSuccessItem=function(item,response){return alertService.add("success","File uploaded successfully!",2e3),_.find(fileUploader.project.portfolio_files,response)||fileUploader.project.portfolio_files.push(response),fileUploader.clearQueue()},fileUploader.onErrorItem=function(response){return alertService.add("danger","File Upload Failed: "+response.error),fileUploader.clearQueue()},fileUploader.api=resourcePlus("/submission/project/:id/portfolio",{id:"@id"}),fileUploader},this}]),angular.module("doubtfire.api.models.project",[]).factory("Project",["resourcePlus",function(resourcePlus){return resourcePlus("/projects/:id",{id:"@id"})}]),angular.module("doubtfire.api.models.students",[]).factory("Students",["resourcePlus",function(resourcePlus){return resourcePlus("/students")}]),angular.module("doubtfire.api.models.task-alignment",[]).factory("TaskAlignment",["resourcePlus","api","currentUser","$window",function(resourcePlus,api,currentUser,$window){var TaskAlignment;return TaskAlignment={},TaskAlignment.taskAlignmentCSVUploadUrl=function(unit,project_id){return null!=project_id?""+api+"/units/"+unit.id+"/learning_alignments/csv.json?project_id="+project_id+"&auth_token="+currentUser.authenticationToken:""+api+"/units/"+unit.id+"/learning_alignments/csv.json?auth_token="+currentUser.authenticationToken},TaskAlignment.downloadCSV=function(unit,project_id){return null!=project_id?$window.open(""+api+"/units/"+unit.id+"/learning_alignments/csv.json?project_id="+project_id+"&auth_token="+currentUser.authenticationToken,"_blank"):$window.open(""+api+"/units/"+unit.id+"/learning_alignments/csv.json?auth_token="+currentUser.authenticationToken,"_blank")},TaskAlignment}]),angular.module("doubtfire.api.models.task-comment",[]).factory("TaskComment",["resourcePlus",function(resourcePlus){return resourcePlus("/projects/:project_id/task_def_id/:task_definition_id/comments/:id",{id:"@id",project_id:"@project_id",task_definition_id:"@task_definition_id"})}]),angular.module("doubtfire.api.models.task-completion-csv",[]).service("TaskCompletionCsv",["api","$window","currentUser",function(api,$window,currentUser){return this.downloadFile=function(unit){return $window.open(""+api+"/csv/units/"+unit.id+"/task_completion.json?auth_token="+currentUser.authenticationToken,"_blank")},this}]),angular.module("doubtfire.api.models.task-definition",[]).factory("TaskDefinition",["resourcePlus",function(resourcePlus){var TaskDefinition;return TaskDefinition=resourcePlus("/task_definitions/:id",{id:"@id"})}]),angular.module("doubtfire.api.models.task-feedback",[]).factory("TaskFeedback",["api","currentUser","$window","resourcePlus",function(api,currentUser,$window,resourcePlus){var TaskFeedback;return TaskFeedback=resourcePlus("/projects/:project_id/task_def_id/:task_definition_id/submission",{task_definition_id:"@task_definition_id",project_id:"@project_id"}),TaskFeedback.getTaskUrl=function(task){return""+api+"/projects/"+task.project().project_id+"/task_def_id/"+task.definition.id+"/submission?auth_token="+currentUser.authenticationToken},TaskFeedback.openFeedback=function(task){return $window.open(TaskFeedback.getTaskUrl(task),"_blank")},TaskFeedback}]),angular.module("doubtfire.api.models.task-similarity",[]).factory("TaskSimilarity",["$http","api","currentUser",function($http,api){return{get:function(task,match,callback){var url;return url=""+api+"/tasks/"+task.id+"/similarity/"+match,$http.get(url).success(function(data){return callback(data)})}}}]),angular.module("doubtfire.api.models.task",[]).factory("Task",["resourcePlus","api","currentUser",function(resourcePlus,api,currentUser){var Task;return Task=resourcePlus("/projects/:project_id/task_def_id/:task_definition_id",{project_id:"@project_id",task_definition_id:"@task_definition_id"}),Task.SubmissionDetails=resourcePlus("/projects/:id/task_def_id/:task_definition_id/submission_details"),Task.summaryData=resourcePlus("/tasks/:id",{id:"@id"}),Task.generateSubmissionUrl=function(project,task){return""+api+"/projects/"+project.project_id+"/task_def_id/"+task.definition.id+"/submission?auth_token="+currentUser.authenticationToken},Task.getTaskPDFUrl=function(unit,task_def){return""+api+"/units/"+unit.id+"/task_definitions/"+task_def.id+"/task_pdf.json?auth_token="+currentUser.authenticationToken},Task.getTaskResourcesUrl=function(unit,task_def){return""+api+"/units/"+unit.id+"/task_definitions/"+task_def.id+"/task_resources.json?auth_token="+currentUser.authenticationToken},Task.getTaskDefinitionBatchUploadUrl=function(unit){return""+api+"/csv/task_definitions?auth_token="+currentUser.authenticationToken+"&unit_id="+unit.id},Task.getTaskMarkingUrl=function(unit){return""+api+"/submission/assess.json?unit_id="+unit.id+"&auth_token="+currentUser.authenticationToken},Task.generateMarkingSubmissionUrl=function(){},Task}]),angular.module("doubtfire.api.models.tutor",[]).factory("Tutor",["resourcePlus",function(resourcePlus){return resourcePlus("/users/tutors")}]),angular.module("doubtfire.api.models.tutorial",[]).factory("Tutorial",["resourcePlus",function(resourcePlus){return resourcePlus("/tutorials/:id",{id:"@id"})}]),angular.module("doubtfire.api.models.unit-role",[]).factory("UnitRole",["resourcePlus",function(resourcePlus){return resourcePlus("/unit_roles/:id",{id:"@id"})}]),angular.module("doubtfire.api.models.unit",[]).factory("Unit",["resourcePlus","currentUser","$window","api",function(resourcePlus,currentUser,$window,api){var Unit;return Unit=resourcePlus("/units/:id",{id:"@id"}),Unit.getPortfoliosUrl=function(unit){return""+api+"/submission/unit/"+(null!=unit?unit.id:void 0)+"/portfolio?auth_token="+currentUser.authenticationToken},Unit.taskUploadUrl=function(unit){return""+api+"/units/"+unit.id+"/task_definitions/task_pdfs?auth_token="+currentUser.authenticationToken},Unit.taskSheetUploadUrl=function(unit,taskDefinition){return""+api+"/units/"+unit.id+"/task_definitions/"+taskDefinition.id+"/task_sheet?auth_token="+currentUser.authenticationToken},Unit.taskResourcesUploadUrl=function(unit,taskDefinition){return""+api+"/units/"+unit.id+"/task_definitions/"+taskDefinition.id+"/task_resources?auth_token="+currentUser.authenticationToken},Unit.allResourcesDownloadUrl=function(unit){return""+api+"/units/"+unit.id+"/all_resources?auth_token="+currentUser.authenticationToken},Unit.enrolStudentsCSVUrl=function(unit){return""+api+"/csv/units/"+unit.id+"?auth_token="+currentUser.authenticationToken},Unit.withdrawStudentsCSVUrl=function(unit){return""+api+"/csv/units/"+unit.id+"/withdraw?auth_token="+currentUser.authenticationToken},Unit.learningProgressClassStats=resourcePlus("/units/:id/learning_alignments/class_stats",{id:"@id"}),Unit.learningProgressClassDetails=resourcePlus("/units/:id/learning_alignments/class_details",{id:"@id"}),Unit.tasksRequiringFeedback=resourcePlus("/units/:id/feedback",{id:"@id"}),Unit.tasksForDefinition=resourcePlus("/units/:id/task_definitions/:task_def_id/tasks",{id:"@id",task_def_id:"@task_def_id"}),Unit.taskStatusCountByTutorial=resourcePlus("/units/:id/stats/task_status_pct",{id:"@id"}),Unit.targetGradeStats=resourcePlus("/units/:id/stats/student_target_grade",{id:"@id"}),Unit.taskCompletionStats=resourcePlus("/units/:id/stats/task_completion_stats",{id:"@id"}),Unit}]),angular.module("doubtfire.api.models.user-role",[]).factory("UserRole",["resourcePlus",function(resourcePlus){return resourcePlus("/user_roles/:id",{id:"@id"})}]),angular.module("doubtfire.api.models.user",[]).factory("User",["resourcePlus","currentUser","api",function(resourcePlus,currentUser,api){var User;return User=resourcePlus("/users/:id",{id:"@id"}),User.csvUrl=function(){return""+api+"/csv/users?auth_token="+currentUser.authenticationToken},User}]),angular.module("doubtfire.api.resource-plus",["ngResource"]).factory("resourcePlus",["$resource","api","currentUser",function($resource,api){return function(url,paramDefaults,actions){var resource;return url=api+url,actions=angular.extend({},actions,{create:{method:"POST"},update:{method:"PUT"}}),resource=$resource(url,paramDefaults,actions),delete resource.save,angular.extend(resource.prototype,{$save:function(){return this[null!=this.id?"$update":"$create"].apply(this,arguments)}}),resource}}]),angular.module("doubtfire",["doubtfire.config","doubtfire.api","doubtfire.sessions","doubtfire.common","doubtfire.errors","doubtfire.home","doubtfire.units","doubtfire.tasks","doubtfire.projects","doubtfire.users","doubtfire.groups","doubtfire.visualisations"]),angular.module("doubtfire.common.alert-list",[]).directive("alertList",function(){return{restrict:"E",templateUrl:"common/alert-list/alert-list.tpl.html",replace:!0,controller:["$scope",function(){}]}}),angular.module("doubtfire.common",["doubtfire.common.services","doubtfire.common.filters","doubtfire.common.modals","doubtfire.common.header","doubtfire.common.file-uploader","doubtfire.common.pdf-panel-viewer","doubtfire.common.grade-icon","doubtfire.common.status-icon","doubtfire.common.markdown-editor","doubtfire.common.alert-list"]),angular.module("doubtfire.common.file-uploader",[]).directive("fileUploader",function(){return{restrict:"E",replace:!0,templateUrl:"common/file-uploader/file-uploader.tpl.html",scope:{files:"=",url:"=",method:"@",payload:"=?",onBeforeUpload:"=?",onSuccess:"=?",onFailure:"=?",onComplete:"=?",isUploading:"=?",isReady:"=?"},controller:["$scope","$timeout",function($scope,$timeout){var ACCEPTED_TYPES,updateUploadZones,_ref;if(ACCEPTED_TYPES={document:{extensions:["pdf","ps"],icon:"fa-file-pdf-o",name:"PDF"},csv:{extensions:["csv"],icon:"fa-file-excel-o",name:"CSV"},code:{extensions:["pas","cpp","c","cs","h","java","py","js","html","coffee","rb","css","scss","yaml","yml","xml","json","ts"],icon:"fa-file-code-o",name:"code"},image:{extensions:["png","gif","bmp","tiff","tif","jpeg","jpg"],name:"image",icon:"fa-file-image-o"},zip:{extensions:["zip","tar.gz","tar"],name:"archive",icon:"fa-file-zip-o"}},0===(null!=(_ref=$scope.files)?_ref.length:void 0))throw Error("No files provided to uploader");return $scope.clearEnqueuedUpload=function(upload){return upload.model=null},$scope.checkForError=function(upload){var _ref1;return(null!=(_ref1=upload.rejects)?_ref1.length:void 0)>0?(upload.display.error=!0,upload.rejects=null,$timeout(function(){return upload.display.error=!1},4e3)):void 0},$scope.dropSupported=!0,updateUploadZones=function(files){return _.map(files,function(uploadData,uploadName){var type,typeData,zone;if(type=uploadData.type,typeData=ACCEPTED_TYPES[type],null==typeData)throw Error("Invalid type provided to File Uploader "+type);return zone={name:uploadName,model:null,accept:"'."+typeData.extensions.join(",.")+"'",rejects:null,display:{name:uploadData.name,icon:typeData.icon,type:typeData.name,error:!1}}})},$scope.uploadZones=updateUploadZones($scope.files),$scope.$watch("files",function(files){return $scope.uploadZones=updateUploadZones(files)}),$scope.readyToUpload=function(){var upload;return $scope.isReady=_.compact(_.flatten(function(){var _i,_len,_ref1,_results;for(_ref1=$scope.uploadZones,_results=[],_i=0,_len=_ref1.length;_len>_i;_i++)upload=_ref1[_i],_results.push(upload.model);return _results}())).length===_.keys($scope.files).length},$scope.resetUploader=function(){var upload,_i,_len,_ref1,_results;for($scope.uploadingInfo=null,$scope.isUploading=!1,_ref1=$scope.uploadZones,_results=[],_i=0,_len=_ref1.length;_len>_i;_i++)upload=_ref1[_i],_results.push($scope.clearEnqueuedUpload(upload));return _results},$scope.resetUploader(),$scope.initiateUpload=function(){var file,files,form,k,payload,payloadItem,v,xhr,zone,_i,_j,_len,_len1;for("function"==typeof $scope.onBeforeUpload&&$scope.onBeforeUpload(),xhr=new XMLHttpRequest,form=new FormData,files=function(){var _i,_len,_ref1,_results;for(_ref1=$scope.uploadZones,_results=[],_i=0,_len=_ref1.length;_len>_i;_i++)zone=_ref1[_i],_results.push({name:zone.name,data:zone.model[0]});return _results}(),_i=0,_len=files.length;_len>_i;_i++)file=files[_i],form.append(file.name,file.data);for(payload=function(){var _ref1,_results;_ref1=$scope.payload,_results=[];for(k in _ref1)v=_ref1[k],_results.push({key:k,value:v});return _results}(),_j=0,_len1=payload.length;_len1>_j;_j++)payloadItem=payload[_j],form.append(payloadItem.key,JSON.stringify(payloadItem.value));return $scope.uploadingInfo={progress:5,success:null,error:null,complete:!1},$scope.isUploading=!0,xhr.onreadystatechange=function(){return 4===xhr.readyState?$timeout(function(){var e,response;$scope.uploadingInfo.complete=!0,response=null;try{response=JSON.parse(xhr.responseText)}catch(_error){e=_error,response=xhr.responseText}return xhr.status>=200&&xhr.status<300?("function"==typeof $scope.onSuccess&&$scope.onSuccess(response),$scope.uploadingInfo.success=!0,$timeout(function(){return"function"==typeof $scope.onComplete&&$scope.onComplete(),$scope.resetUploader()},2500)):("function"==typeof $scope.onFailure&&$scope.onFailure(response),0===xhr.status&&(response.error="Could not connect to the Doubtfire server"),$scope.uploadingInfo.success=!1,$scope.uploadingInfo.error=response.error||"Unknown error"),$scope.$apply()},2e3):void 0},xhr.upload.onprogress=function(event){return $scope.uploadingInfo.progress=parseInt(100*event.position/event.totalSize),$scope.$apply()},null==$scope.method&&($scope.method="POST"),xhr.open($scope.method,$scope.url,!0),xhr.send(form)}}]}}),angular.module("doubtfire.common.filters",[]).filter("startFrom",function(){return function(input,start){return start=+start,input?input.slice(start):input}}).filter("showStudents",function(){return function(input,kind,tutorName){return input&&"myStudents"===kind?_.filter(input,{tutorial:{tutor_name:tutorName}}):input}}).filter("showTasks",function(){return function(input,kind,tutorName){return input&&"myStudents"===kind?_.filter(input,function(t){return null!=t&&t.project().tutorName()===tutorName}):input}}).filter("orderObjectBy",function(){return function(items,field,reverse){var filtered;return filtered=[],angular.forEach(items,function(item){return filtered.push(item)}),filtered.sort(function(a,b){var _ref;return null!=(_ref=a[field]>b[field])?_ref:{1:-1}}),reverse&&filtered.reverse(),filtered}}).filter("byGrade",function(){return function(input,grade){return input?_.filter(input,function(task){return null!=task&&task.definition.target_grade<=grade}):input}}).filter("studentsWithPlagiarism",function(){return function(input){return input?_.filter(input,function(student){return null!=student&&student.max_pct_copy>0}):input}}).filter("studentsWithPortfolio",function(){return function(input){return input?_.filter(input,function(student){return null!=student&&student.has_portfolio>0}):input}}).filter("studentsWithTargetGrade",function(){return function(input,grade){return input?_.filter(input,function(student){return null!=student&&student.target_grade===grade}):input}}).filter("taskWithPlagiarism",function(){return function(input){return input?_.filter(input,function(task){return null!=task&&task.pct_similar>0}):input}}).filter("studentsForGroup",function(){return function(input,gs,grp,members){return input?gs.keep_groups_in_same_class?_.filter(input,function(student){return null!=student&&student.tutorial_id===grp.tutorial_id&&!_.find(members,function(mbr){return student.project_id===mbr.project_id})}):_.filter(input,function(student){return null!=student&&!_.find(members,function(mbr){return student.project_id===mbr.project_id})}):input}}).filter("groupFilter",function(){return function(input,unit,gs,project,assessingUnitRole,kind){return input?assessingUnitRole&&!project?"mine"===kind?_.filter(input,function(grp){return unit.tutorialFromId(grp.tutorial_id).tutor_name===assessingUnitRole.name}):input:gs.keep_groups_in_same_class?_.filter(input,function(grp){return null!=project.tutorial&&grp.tutorial_id===project.tutorial.id}):input:input}}).filter("outcomeFilter",function(){return function(input,outcomeId){return input&&outcomeId?_.filter(input,function(item){return item.learning_outcome_id===outcomeId}):input}}).filter("taskFilter",function(){return function(input,taskDefId){return input&&taskDefId?_.filter(input,function(item){return item.task_definition_id===taskDefId}):input}}).filter("truncatedMarkdown",["$filter",function($filter){return function(input,truncateTo){return truncateTo=truncateTo||128,input=$filter("markdown")(input),input=$filter("stripTags")(input),$filter("truncate")(input,truncateTo,"...")}}]).filter("statusFilter",function(){return function(input,statusKind){return input&&statusKind?_.filter(input,function(task){return"discuss"===statusKind?task.status===statusKind||"demonstrate"===task.status:task.status===statusKind}):input}}).filter("taskFilter",function(){return function(input,text){var matchText;return matchText=text.toLowerCase(),input?_.filter(input,function(task){var project;return null!=task?(project=task.project(),task.definition.abbreviation.toLowerCase().indexOf(matchText)>=0||task.definition.name.toLowerCase().indexOf(matchText)>=0||null!=project&&(project.student_id.indexOf(matchText)>=0||project.name.toLowerCase().indexOf(matchText)>=0||null!=project.tutorial&&(project.tutorial.abbreviation.toLowerCase().indexOf(matchText)>=0||project.tutorName().toLowerCase().indexOf(matchText)>=0))):!1}):input}}).filter("projectFilter",function(){return function(input,text){var matchText;return matchText=text.toLowerCase(),input?_.filter(input,function(project){return null!=project&&(project.student_id.indexOf(matchText)>=0||project.name.toLowerCase().indexOf(matchText)>=0||null!=project.tutorial&&(project.tutorial.abbreviation.toLowerCase().indexOf(matchText)>=0||project.tutorName().toLowerCase().indexOf(matchText)>=0))}):input}}).filter("taskForPortfolio",["taskService",function(taskService){return function(input,apply){return apply&&input?_.filter(input,function(task){return null!=task?!_.includes(taskService.toBeWorkedOn,task.status):!1}):input}}]),angular.module("doubtfire.common.grade-icon",[]).directive("gradeIcon",function(){return{restrict:"E",replace:!0,templateUrl:"common/grade-icon/grade-icon.tpl.html",scope:{inputGrade:"=?grade"},controller:["$scope","gradeService",function($scope,gradeService){return $scope.$watch("inputGrade",function(newGrade){return null!=newGrade?($scope.grade=_.isString($scope.inputGrade)?gradeService.grades.indexOf($scope.inputGrade):$scope.inputGrade,$scope.gradeText=function(){return null!=$scope.grade?gradeService.grades[$scope.grade]||"Grade":void 0},$scope.gradeLetter=function(grade){return gradeService.gradeAcronyms[$scope.gradeText(grade)]||"G"}):void 0})}]}}),angular.module("doubtfire.common.header",[]).controller("BasicHeaderCtrl",["$scope","$state","$modal","User","AboutDoubtfireModal","UserNotificationSettingsModal","UserSettingsModal","currentUser","headerService","unitService","projectService","dateService",function($scope,$state,$modal,User,AboutDoubtfireModal,UserNotificationSettingsModal,UserSettingsModal,currentUser,headerService,unitService,projectService,dateService){return $scope.menus=headerService.getMenus(),$scope.currentUser=currentUser.profile,$scope.showDate=dateService.showDate,unitService.getUnitRoles(function(roles){return $scope.unitRoles=roles}),projectService.getProjects(function(projects){return $scope.projects=projects}),$scope.isUniqueUnitRole=function(unit){var item,units;
return units=function(){var _i,_len,_ref,_results;for(_ref=$scope.unitRoles,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],item.unit_id===unit.unit_id&&_results.push(item);return _results}(),1===units.length||"Tutor"===unit.role},$scope.openUserSettings=function(){return UserSettingsModal.show($scope.currentUser)},$scope.openNotificationSettings=function(){return UserNotificationSettingsModal.show($scope.currentUser)},$scope.openAboutModal=function(){return AboutDoubtfireModal.show()}}]).controller("ErrorHeaderCtrl",["$scope","$state","$modal","currentUser","headerService",function($scope,$state,$modal,currentUser,headerService){return $scope.menus=headerService.getMenus(),$scope.currentUser=currentUser.profile}]),angular.module("doubtfire.common.markdown-editor",[]).directive("markdownEditor",function(){return{restrict:"E",replace:!0,templateUrl:"common/markdown-editor/markdown-editor.tpl.html",scope:{markdownText:"=ngModel",height:"@",placeholder:"@",autofocus:"=?"},controller:["$scope","$timeout",function($scope,$timeout){var DEFAULT_HEIGHT;return DEFAULT_HEIGHT=300,$scope.isEditing=!0,$scope.height=$scope.height||DEFAULT_HEIGHT,$scope.codemirrorLoaded=function(editor){return editor.setSize("100%",$scope.height),$scope.autofocus?$timeout(function(){var doc,lastChar,lineCount,_ref;return editor.focus(),doc=editor.getDoc(),(null!=(_ref=$scope.markdownText)?_ref.length:void 0)>0&&doc.setValue($scope.markdownText),lineCount=doc.lineCount(),lastChar=doc.getLine(lineCount-1).length,doc.setCursor({line:lineCount,ch:lastChar})}):void 0},$scope.heightStyle=function(){return"height:  "+($scope.height||DEFAULT_HEIGHT)+"px"},$scope.editorOpts={lineWrapping:!0,mode:"markdown",theme:"xq-light",placeholder:$scope.placeholder}}]}}),angular.module("doubtfire.common.modals.about-doubtfire-modal",[]).factory("AboutDoubtfireModal",["$modal",function($modal){var AboutDoubtfireModal;return AboutDoubtfireModal={},AboutDoubtfireModal.show=function(){return $modal.open({templateUrl:"common/modals/about-doubtfire-modal/about-doubtfire-modal.tpl.html",controller:"AboutDoubtfireModalCtrl",size:"lg"})},AboutDoubtfireModal}]).controller("AboutDoubtfireModalCtrl",["$scope","DoubtfireContributors","$modalInstance","$http","$q",function($scope,DoubtfireContributors,$modalInstance,$http){var contributors,handler,index,_i,_len,_results;for(contributors=DoubtfireContributors,$scope.contributors=_.map(contributors,function(c){return{avatar:"/assets/images/person-unknown.gif",handler:c}}),$scope.close=function(){return $modalInstance.dismiss()},_results=[],index=_i=0,_len=contributors.length;_len>_i;index=++_i)handler=contributors[index],_results.push(function(handler,index){return $http.get("https://api.github.com/users/"+handler).then(function(response){var data;return data=response.data,data.blog&&(data.blog.match(/^[a-zA-Z]+:\/\//)||(data.blog="http://"+data.blog)),$scope.contributors[index]={name:data.name,avatar:data.avatar_url||"/assets/images/person-unknown.gif",website:data.blog||data.html_url,github:data.html_url,handler:handler}})}(handler,index));return _results}]),angular.module("doubtfire.common.modals.confirmation-modal",[]).factory("ConfirmationModal",["$modal",function($modal){var ConfirmationModal;return ConfirmationModal={},ConfirmationModal.show=function(title,message,action){var modalInstance;return modalInstance=$modal.open({templateUrl:"common/modals/confirmation-modal/confirmation-modal.tpl.html",controller:"ConfirmationModalCtrl",resolve:{title:function(){return title},message:function(){return message},action:function(){return action}}})},ConfirmationModal}]).controller("ConfirmationModalCtrl",["$scope","$modalInstance","title","message","action","alertService",function($scope,$modalInstance,title,message,action,alertService){return $scope.title=title,$scope.message=message,$scope.confirmAction=function(){return action(),$modalInstance.dismiss()},$scope.cancelAction=function(){return alertService.add("info",""+title+" action cancelled",3e3),$modalInstance.dismiss()}}]),angular.module("doubtfire.common.modals.csv-result-modal",[]).factory("CsvResultModal",["$modal","alertService",function($modal,alertService){var CsvResultModal;return CsvResultModal={},CsvResultModal.show=function(title,response){return 0===response.errors.length?alertService.add("success","CSV uploaded. Success with "+response.success.length+" rows.",2e3):response.success.length>0?alertService.add("warning","CSV uploaded, success with "+response.success.length+" rows, but "+response.errors.length+" errors.",6e3):alertService.add("danger","CSV uploaded but "+response.errors.length+" errors",6e3),$modal.open({templateUrl:"common/modals/csv-result-modal/csv-result-modal.tpl.html",controller:"CsvResultModalCtrl",resolve:{title:function(){return title},response:function(){return response}}})},CsvResultModal}]).controller("CsvResultModalCtrl",["$scope","$modalInstance","title","response",function($scope,$modalInstance,title,response){return $scope.title=title,$scope.response=response,$scope.currentPage=1,$scope.maxSize=5,$scope.pageSize=5,$scope.activeCsvResponseSelection=response.errors.length>0?"errors":response.success.length>0?"success":"ignored",$scope.itemData=function(selector){return $scope.response[selector]},$scope.close=function(){return $modalInstance.dismiss()}}]),angular.module("doubtfire.common.modals",["doubtfire.common.modals.about-doubtfire-modal","doubtfire.common.modals.csv-result-modal","doubtfire.common.modals.progress-modal","doubtfire.common.modals.confirmation-modal"]),angular.module("doubtfire.common.modals.progress-modal",[]).factory("ProgressModal",["$modal","$rootScope",function($modal){var ProgressModal;return ProgressModal={},ProgressModal.show=function(title,message,promise){var modalInstance;return modalInstance=$modal.open({templateUrl:"common/modals/progress-modal/progress-modal.tpl.html",controller:"ProgressModalCtrl",resolve:{title:function(){return title},message:function(){return message}}}),null!=promise?promise["finally"](function(){return modalInstance.close()}):void 0},ProgressModal}]).controller("ProgressModalCtrl",["$scope","$modalInstance","title","message",function($scope,$modalInstance,title,message){return $scope.title=title,$scope.message=message,$scope.close=function(){return $modalInstance.dismiss()}}]),angular.module("doubtfire.common.pdf-panel-viewer",[]).directive("pdfPanelViewer",function(){return{restrict:"E",templateUrl:"common/pdf-panel-viewer/pdf-panel-viewer.tpl.html",replace:!0,scope:{pdfUrl:"=",footerText:"@",resourcesUrl:"=",hideFooter:"=?"},controller:["$scope","$sce","$timeout","analyticsService",function($scope,$sce,$timeout,analyticsService){return $scope.downloadEvent=function(type){return analyticsService.event("Task Sheet","Downloaded "+type)},$scope.shouldShowIframe=!0,$scope.$watch("pdfUrl",function(newUrl){return null!=newUrl?($scope.shouldShowIframe=!1,$timeout(function(){return $scope.shouldShowIframe=!0}),$scope.googleDocsUrl=$sce.trustAsResourceUrl("https://docs.google.com/gview?url="+newUrl+"&embedded=true")):void 0})}]}}),angular.module("doubtfire.common.services.alerts",[]).factory("alertService",["$rootScope","$timeout","$sce",function($rootScope,$timeout,$sce){var alertService;return $rootScope.alerts=[],alertService={},alertService.add=function(type,msg,timeout){var alertData,closeThisAlertFunc;return closeThisAlertFunc=function(){return alertService.closeAlert(this)},alertData={type:type,msg:$sce.trustAsHtml(msg),close:closeThisAlertFunc},$rootScope.alerts.push(alertData),_.isNumber(timeout)&&timeout>0?$timeout(closeThisAlertFunc,timeout):void 0},alertService.closeAlert=function(alert){return this.closeAlertIdx($rootScope.alerts.indexOf(alert))},alertService.closeAlertIdx=function(index){return $rootScope.alerts.splice(index,1)},alertService.clearAll=function(){return $rootScope.alerts=[]},alertService}]),angular.module("doubtfire.common.services.analytics",[]).factory("analyticsService",["$analytics","currentUser",function($analytics,currentUser){var analyticsService;return analyticsService={},analyticsService.event=function(category,eventName,label,value){if(currentUser.profile.opt_in_to_research){if(null!=value&&"Number"!=typeof value&&0>value)throw new Error("Value needs to be a positive number");return $analytics.eventTrack(eventName,{category:category,label:label,value:value})}},analyticsService.watchEvent=function(scope,toWatch,category,label){return scope.$watch(toWatch,function(newVal,oldVal){return null!=newVal&&newVal!==oldVal?_.isFunction(label)?analyticsService.event(category,"Changed "+toWatch,label(newVal)):_.isInteger(newVal)?analyticsService.event(category,"Changed "+toWatch,label,newVal):analyticsService.event(category,"Changed "+toWatch,newVal):void 0})},analyticsService}]),angular.module("doubtfire.common.services.dates",[]).factory("dateService",function(){var dateService,monthNames;return dateService={},monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dateService.showDate=function(dateValue){var date;return date=new Date(dateValue),""+monthNames[date.getMonth()]+" "+date.getFullYear()},dateService}),angular.module("doubtfire.common.services.grades",[]).factory("gradeService",function(){var gradeService;return gradeService={},gradeService.gradeValues=[0,1,2,3],gradeService.grades=["Pass","Credit","Distinction","High Distinction"],gradeService.gradeNumbers={P:0,C:1,D:2,HD:3},gradeService.gradeAcronyms={Pass:"P",Credit:"C",Distinction:"D","High Distinction":"HD"},gradeService.gradeColors={0:"#FF0000",P:"#FF0000",1:"#FF8000",C:"#FF8000",2:"#0080FF",D:"#0080FF",3:"#80FF00",HD:"#80FF00"},gradeService.gradeFor=function(project){return gradeService.grades[project.target_grade]},gradeService}),angular.module("doubtfire.common.services.group-service",[]).factory("groupService",function(){var groupService;return groupService={},groupService.groupContributionSum=function(members,member,value){return _.reduce(members,function(memo,mbr){return member===mbr?memo+value:memo+mbr.rating},0)},groupService.isGroupTask=function(task){return null!=task.definition.group_set},groupService.groupSetName=function(id,unit){var gs;return gs=_.find(unit.group_sets,function(gs){return gs.id===parseInt(id)}),gs?gs.name:"Individual Work"},groupService}),angular.module("doubtfire.common.services.header",[]).provider("headerService",["$stateProvider",function($stateProvider){var headerServiceProvider;return headerServiceProvider={},headerServiceProvider.$get=function($rootScope){var headerService;return $rootScope.headerMenuData=[],$rootScope.showHeader=!0,headerService={},headerService.getMenus=function(){return $rootScope.headerMenuData},headerService.clearMenus=function(){return $rootScope.headerMenuData=[]},headerService.setMenus=function(newMenus){return $rootScope.headerMenuData=newMenus},headerService.pushMenu=function(newMenu){return _.find($rootScope.headerMenuData,void 0==={name:newMenu.name})?void 0:$rootScope.headerMenuData.push(newMenu)},headerService.showHeader=function(){return $rootScope.showHeader=!0},headerService.hideHeader=function(){return $rootScope.showHeader=!1},headerService},headerServiceProvider.state=function(stateName,stateData,controller){var state;if(null==controller&&(controller="BasicHeaderCtrl"),null==stateData.views)throw new Error("stateData must have at least one view or have a parent");return stateData.views.header={controller:controller,templateUrl:"common/header/header.tpl.html"},state=$stateProvider.state(stateName,stateData)},headerServiceProvider}]),angular.module("doubtfire.common.services.outcome-service",[]).factory("outcomeService",["gradeService","projectService","taskService",function(gradeService,projectService,taskService){var outcomeService;return outcomeService={},outcomeService.unitTaskStatusFactor=function(){return function(){return 1}},outcomeService.projectTaskStatusFactor=function(project){return function(task_definition_id){var task;return task=projectService.taskFromTaskDefId(project,task_definition_id),null!=task?taskService.learningWeight[task.status]:0}},outcomeService.individualTaskStatusFactor=function(project,task){return function(task_definition_id){return task.definition.id===task_definition_id?taskService.learningWeight[projectService.taskFromTaskDefId(project,task_definition_id).status]:0}},outcomeService.individualTaskPotentialFactor=function(project,task){return function(task_definition_id){return task.definition.id===task_definition_id?1:0}},outcomeService.calculateTargets=function(unit,source,taskStatusFactor){var outcomes;return outcomes={},_.each(unit.ilos,function(outcome){return outcomes[outcome.id]={0:[],1:[],2:[],3:[]}}),_.each(source.task_outcome_alignments,function(align){var td;return td=unit.taskDef(align.task_definition_id),outcomes[align.learning_outcome_id][td.target_grade].push(align.rating*taskStatusFactor(td.id))}),_.each(outcomes,function(outcome){return _.each(outcome,function(tmp,key1){var scale;return scale=Math.pow(2,parseInt(key1,10)),outcome[key1]=_.reduce(tmp,function(memo,num){return memo+num},0)*scale})}),outcomes},outcomeService.calculateTaskContribution=function(unit,project,task){var outcome_set;return outcome_set=[],outcome_set[0]=outcomeService.calculateTargets(unit,unit,outcomeService.individualTaskStatusFactor(project,task)),_.each(outcome_set[0],function(outcome,key){return outcome_set[0][key]=_.reduce(outcome,function(memo,num){return memo+num},0)}),outcome_set[0].title="Current Task Contribution",outcome_set},outcomeService.calculateTaskPotentialContribution=function(unit,project,task){var outcomes;return outcomes=outcomeService.calculateTargets(unit,unit,outcomeService.individualTaskPotentialFactor(project,task)),_.each(outcomes,function(outcome,key){return outcomes[key]=_.reduce(outcome,function(memo,num){return memo+num},0)}),outcomes.title="Potential Task Contribution",outcomes},outcomeService.calculateProgress=function(unit,project){var outcome_set;return outcome_set=[],outcome_set[0]=outcomeService.calculateTargets(unit,unit,outcomeService.projectTaskStatusFactor(project)),_.each(outcome_set,function(outcomes){return _.each(outcomes,function(outcome,key){return outcomes[key]=_.reduce(outcome,function(memo,num){return memo+num},0)})}),outcome_set[0].title="Your Progress",outcome_set},outcomeService.targetsByGrade=function(unit,source){var outcomes,result,values;return result=[],outcomes=outcomeService.calculateTargets(unit,source,outcomeService.unitTaskStatusFactor()),values={0:[],1:[],2:[],3:[]},_.each(outcomes,function(outcome,key){return _.each(outcome,function(tmp,key1){return values[key1].push({label:unit.outcome(parseInt(key,10)).abbreviation,value:tmp})})}),_.each(values,function(vals,idx){return result.push({key:gradeService.grades[idx],values:vals})}),result},outcomeService}]),angular.module("doubtfire.common.services.projects",[]).factory("projectService",["$filter","taskService","Project","$rootScope","alertService","Task",function($filter,taskService,Project,$rootScope,alertService,Task){var projectService;return projectService={},projectService.loadedProjects=null,projectService.taskStatIndex={fail:0,not_started:1,do_not_resubmit:2,redo:3,need_help:4,working_on_it:5,fix_and_resubmit:6,ready_to_mark:7,discuss:8,demonstrate:9,complete:10},$rootScope.$on("signOut",function(){return projectService.loadedProjects=null}),projectService.getProjects=function(callback){return null==projectService.loadedProjects&&(projectService.loadedProjects=[],Project.query(function(projects){return Array.prototype.push.apply(projectService.loadedProjects,projects)},function(response){var msg;return 419!==(null!=response?response.status:void 0)?(msg=null==response?response.error:"",alertService.add("danger","Failed to connect to Doubtfire server. "+msg,6e3)):void 0})),_.isFunction(callback)&&callback(projectService.loadedProjects),projectService.loadedProjects},projectService.updateTaskStats=function(project,new_stats_str){var i,new_stats,value,_ref;new_stats=project.task_stats,_ref=new_stats_str.split("|");for(i in _ref){if(value=_ref[i],!(i<new_stats.length))break;new_stats[i].value=Math.round(100*value)}return project.task_stats=new_stats},projectService.mapTask=function(task,unit,project){var projTask,td;if(td=unit.taskDef(task.task_definition_id),projTask=project.findTaskForDefinition(td.id),null!=projTask){if(_.extend(projTask,task),null!=projTask.definition)return projTask;task=projTask}return task.definition=td,task.project=function(){return project},task.status_txt=function(){return taskService.statusLabels[task.status]},task.statusSeq=function(){return taskService.statusSeq[task.status]},task.updateTaskStatus=function(project,new_stats){return projectService.updateTaskStats(project,new_stats)},task.needsSubmissionDetails=function(){return null===task.has_pdf||void 0===task.has_pdf},task.getSubmissionDetails=function(success,failure){return task.needsSubmissionDetails()?Task.SubmissionDetails.get({id:project.project_id,task_definition_id:task.definition.id},function(response){return task.has_pdf=response.has_pdf,task.processing_pdf=response.processing_pdf,_.isFunction(success)?success(task,response):void 0},function(response){return _.isFunction(failure)?failure(task,response):void 0}):_.isFunction(success)?success(task,{}):void 0},task},projectService.addTaskDetailsToProject=function(project,unit){var base;return(null==project.tasks||project.tasks.length<unit.task_definitions.length)&&(base=unit.task_definitions.map(function(td){return{id:null,status:"not_started",task_definition_id:td.id,include_in_portfolio:!0,pct_similar:0,similar_to_count:0,times_assessed:0}}),base=_.filter(base,function(task){return!_.find(project.tasks,function(pt){return pt.task_definition_id===task.task_definition_id})}),null==project.tasks&&(project.tasks=[]),Array.prototype.push.apply(project.tasks,base)),project.tasks=project.tasks.map(function(task){return projectService.mapTask(task,unit,project)}),project.tasks=_.sortBy(project.tasks,function(t){return t.definition.abbreviation}).reverse(),project},projectService.addProjectMethods=function(project,unit){return project.updateBurndownChart=function(){return Project.get({id:project.project_id},function(response){return project.burndown_chart_data=response.burndown_chart_data})},project.incorporateTask=function(newTask){var currentTask;return null==project.tasks&&(project.tasks=[]),currentTask=_.find(project.tasks,function(t){return t.task_definition_id===newTask.task_definition_id}),null!=currentTask?currentTask=_.extend(currentTask,newTask):(project.tasks.push(projectService.mapTask(newTask,unit,project)),currentTask=newTask),currentTask},project.refresh=function(unit_obj){return Project.get({id:project.project_id},function(response){return _.extend(project,response),unit_obj?projectService.addTaskDetailsToProject(project,unit_obj):void 0})}},projectService.fetchDetailsForProject=function(project,unit,callback){return null!=project.burndown_chart_data?callback(project):Project.get({id:project.project_id},function(project_response){return _.extend(project,project_response),projectService.addProjectMethods(project,unit),unit&&projectService.addTaskDetailsToProject(project,unit),callback(project)})},projectService.updateGroups=function(project){return null!=project.groups?Project.get({id:project.project_id},function(response){return project.groups=response.groups}):void 0},projectService.getGroupForTask=function(project,task){return task.definition.group_set?_.find(project.groups,function(grp){return grp.group_set_id===task.definition.group_set.id}):null},projectService.taskFromTaskDefId=function(project,task_definition_id){return project.findTaskForDefinition(task_definition_id)},projectService.tasksInTargetGrade=function(project){return $filter("byGrade")(project.tasks,project.target_grade)},projectService.tasksByStatus=function(project,statusKey){var tasksToConsider;return tasksToConsider=projectService.tasksInTargetGrade(project),_.filter(tasksToConsider,{status:statusKey})},projectService}]),angular.module("doubtfire.common.services.redirect",[]).factory("redirectService",["$state","$stateParams",function($state,$stateParams){var deserialize,redirectService;return redirectService={},deserialize=function(str){var attr,i,k,kv,parts,result,v;result={},parts=str.split("&");for(i in parts)attr=parts[i],kv=attr.split("="),k=kv[0],v=kv[1],result[k]=v;return result},redirectService.redirect=function(defaultState,defaultParams){var destParams,destState;return destState=defaultState,destParams=defaultParams,$stateParams.dest&&(destState=$stateParams.dest,destParams=deserialize($stateParams.params)),$state.go(destState,destParams)},redirectService}]),angular.module("doubtfire.common.services",["doubtfire.common.services.alerts","doubtfire.common.services.grades","doubtfire.common.services.header","doubtfire.common.services.projects","doubtfire.common.services.redirect","doubtfire.common.services.tasks","doubtfire.common.services.units","doubtfire.common.services.group-service","doubtfire.common.services.outcome-service","doubtfire.common.services.analytics","doubtfire.common.services.dates"]);var __indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};angular.module("doubtfire.common.services.tasks",[]).factory("taskService",["TaskFeedback","TaskComment","Task","TaskDefinition","alertService","$rootScope","analyticsService","GradeTaskModal","gradeService",function(TaskFeedback,TaskComment,Task,TaskDefinition,alertService,$rootScope,analyticsService,GradeTaskModal,gradeService){var taskService;return taskService={},taskService.statusKeys=["not_started","do_not_resubmit","redo","need_help","working_on_it","fix_and_resubmit","ready_to_mark","discuss","demonstrate","complete","fail"],taskService.validTopTask=["not_started","redo","need_help","working_on_it","fix_and_resubmit","demonstrate","discuss"],taskService.toBeWorkedOn=["not_started","redo","need_help","working_on_it"],taskService.statusToDiscuss=["need_help","demonstrate","discuss"],taskService.gradeableStatuses=["discuss","demonstrate","complete"],taskService.acronymKey={RTM:"ready_to_mark",NOS:"not_started",WRK:"working_on_it",HLP:"need_help",RDO:"redo",DNR:"do_not_resubmit",FIX:"fix_and_resubmit",DIS:"discuss",DEM:"demonstrate",COM:"complete",FAL:"fail"},taskService.learningWeight={fail:0,not_started:0,working_on_it:0,need_help:0,redo:.1,do_not_resubmit:.1,fix_and_resubmit:.3,ready_to_mark:.5,discuss:.8,demonstrate:.8,complete:1},taskService.statusAcronym={ready_to_mark:"RTM",not_started:"NOS",working_on_it:"WRK",need_help:"HLP",redo:"RDO",do_not_resubmit:"DNR",fix_and_resubmit:"FIX",discuss:"DIS",demonstrate:"DEM",complete:"COM",fail:"FAL"},taskService.statusLabels={ready_to_mark:"Ready to Mark",not_started:"Not Started",working_on_it:"Working On It",need_help:"Need Help",redo:"Redo",do_not_resubmit:"Don't Resubmit",fix_and_resubmit:"Resubmit",discuss:"Discuss",demonstrate:"Demonstrate",complete:"Complete",fail:"Fail"},taskService.statusIcons={ready_to_mark:"fa fa-thumbs-o-up",not_started:"fa fa-pause",working_on_it:"fa fa-bolt",need_help:"fa fa-question-circle",redo:"fa fa-refresh",do_not_resubmit:"fa fa-book",fix_and_resubmit:"fa fa-wrench",discuss:"fa fa-commenting",demonstrate:"fa fa-commenting",complete:"fa fa-check",fail:"fa fa-times"},taskService.statusColors={ready_to_mark:"#0079D8",not_started:"#CCCCCC",working_on_it:"#EB8F06",need_help:"#a48fce",fix_and_resubmit:"#f2d85c",do_not_resubmit:"#d46b54",redo:"#804000",discuss:"#31b0d5",demonstrate:"#428bca",complete:"#5BB75B",fail:"#d93713"},taskService.statusSeq={not_started:1,fail:2,do_not_resubmit:3,redo:4,need_help:5,working_on_it:6,ready_to_mark:7,fix_and_resubmit:8,discuss:9,demonstrate:10,complete:11},taskService.helpTextDesc={ready_to_mark:"You have completed the Task, and uploaded it for your tutor to assess.",not_started:"You have not yet started the Task.",working_on_it:"You are working on the task, but it is not yet ready to assess.",need_help:"You are working on the task but would like some help to get it complete.",redo:"Your tutor wants you to start this task from scratch.",do_not_resubmit:"Your tutor wants you to stop submitting this task and include it fixed in your portfolio.",fix_and_resubmit:"Your tutor wants you to fix something and resubmit it for review again.",discuss:"Your tutor is happy with your work. To mark as complete, attend class and discuss it with your tutor.",demonstrate:"Your work looks good. Attend class and demonstrate the task to your tutor to have it marked as Complete.",complete:"Your tutor is happy with your work and it has been discussed with them.",fail:"You have not successfully demonstrated the required learning for this task."},taskService.switchableStates={student:["not_started","working_on_it","need_help","ready_to_mark"],tutor:["complete","discuss","demonstrate","fix_and_resubmit","redo","do_not_resubmit","fail"]},taskService.statusClass=function(status){return _.trim(_.dasherize(status))},taskService.statusText=function(status){return taskService.statusLabels[status]},taskService.helpText=function(status){return taskService.helpTextDesc[status]},taskService.taskDefinitionFn=function(unit){return function(task){return unit.taskDef(task.task_definition_id)}},taskService.statusData=function(task){return{icon:taskService.statusIcons[task.status],label:taskService.statusLabels[task.status],"class":taskService.statusClass(task.status),helpText:taskService.helpText(task.status)}},taskService.daysFromTarget=function(task){var diffDays,diffTime,dueDate,now;return dueDate=new Date(task.definition.target_date),now=new Date,diffTime=now.getTime()-dueDate.getTime(),diffDays=Math.floor(diffTime/864e5)},taskService.daysOverdue=function(task){var diffDays;return"complete"===task.status?!1:(diffDays=taskService.daysFromTarget(task),0>=diffDays?!1:diffDays)},taskService.deleteTask=function(task,unit,callback){return null==callback&&(callback=null),TaskDefinition["delete"]({id:task.id}).$promise.then(function(response){return unit.task_definitions=_.without(unit.task_definitions,task),alertService.add("success","Task Deleted",2e3),"function"==typeof callback&&callback(response),analyticsService.event("Task Service","Deleted Task Definition")},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):alertService.add("danger","Unexpected error connecting to Doubtfire.",6e3),analyticsService.event("Task Service","Failed to Delete Task Definition")})},taskService.indexOf=function(status){return _.indexOf(taskService.statusKeys,status)},taskService.allStatusData=function(){var result;return result=[],angular.forEach(taskService.statusKeys,function(sk){return result.push({icon:taskService.statusIcons[sk],label:taskService.statusLabels[sk],"class":taskService.statusClass(sk)})}),result},taskService.processTaskStatusChange=function(unit,project,task,status,response){return task.id=response.id,task.status=response.status,task.times_assessed=response.times_assessed,task.submisson_date=response.submisson_date,task.updateTaskStatus(project,response.new_stats),task.processing_pdf=response.processing_pdf,task.grade=response.grade,response.status!==status?alertService.add("info","Status change was not changed.",4e3):($rootScope.$broadcast("UpdateAlignmentChart"),null!=project.updateBurndownChart&&project.updateBurndownChart(),alertService.add("success","Status saved.",2e3),$rootScope.$broadcast("TaskStatusUpdated",{status:response.status}),null!=response.other_projects?_.each(response.other_projects,function(details){var other_task,proj;return proj=unit.findStudent(details.id),null!=proj&&(task.updateTaskStatus(proj,details.new_stats),other_task=proj.findTaskForDefinition(task.definition.id),null!=other_task)?(other_task.grade=response.grade,other_task.status=response.status):void 0}):void 0)},taskService.updateTaskStatus=function(unit,project,task,status){var oldStatus,updateFunc;return oldStatus=task.status,updateFunc=function(){return Task.update({project_id:project.project_id,task_definition_id:task.definition.id,trigger:status,grade:task.grade},function(value){return taskService.processTaskStatusChange(unit,project,task,status,value),analyticsService.event("Task Service","Updated Task Status",status),analyticsService.event("Task Service","Updated Task Grade",gradeService.grades[value.grade])},function(value){return task.status=oldStatus,alertService.add("danger",value.data.error,6e3),analyticsService.event("Task Service","Failed to Update Task Status",status)})},task.definition.is_graded&&__indexOf.call(taskService.gradeableStatuses,status)>=0?GradeTaskModal.show(task).result.then(function(selectedGrade){return task.grade=selectedGrade,updateFunc()},function(){return task.status=oldStatus,alertService.add("info","No grade was specified to a graded task - status reverted",6e3)}):updateFunc()},taskService.recreatePDF=function(task,success){return TaskFeedback.update({task_definition_id:task.definition.id,project_id:task.project().project_id},function(value){return"false"===value.result?(alertService.add("danger","Request failed, cannot recreate PDF at this time.",2e3),analyticsService.event("Task Service","Failed to Recreate PDF")):(task.processing_pdf=!0,alertService.add("info","Task PDF will be recreated.",2e3),analyticsService.event("Task Service","Recreated PDF"),success?success():void 0)},function(){return alertService.add("danger","Request failed, cannot recreate PDF at this time.",2e3),analyticsService.event("Task Service","Failed to Recreate PDF")})},taskService.taskIsGraded=function(task){return null!=task&&task.definition.is_graded&&null!=task.grade},taskService.addComment=function(task,textString,success,failure){return TaskComment.create({project_id:task.project().project_id,task_definition_id:task.task_definition_id,comment:textString},function(response){return task.comments||(task.comments=[]),task.comments.unshift(response),null!=success&&_.isFunction(success)&&success(response),analyticsService.event("View Task Comments","Added new comment")},function(response){return null!=failure&&_.isFunction(failure)?failure(response):void 0})},taskService}]),angular.module("doubtfire.common.services.units",[]).factory("unitService",["Unit","UnitRole","Students","Group","projectService","taskService","$rootScope","analyticsService","PortfolioSubmission","alertService","Project",function(Unit,UnitRole,Students,Group,projectService,taskService,$rootScope,analyticsService,PortfolioSubmission,alertService,Project){var unitService;return unitService={},unitService.loadedUnits={},unitService.loadedUnitRoles=null,$rootScope.$on("signOut",function(){return unitService.loadedUnits={},unitService.loadedUnitRoles=null}),unitService.getUnitRoles=function(callback){return null==unitService.loadedUnitRoles&&(unitService.loadedUnitRoles=[],UnitRole.query(function(roles){return Array.prototype.push.apply(unitService.loadedUnitRoles,roles)})),_.isFunction(callback)&&callback(unitService.loadedUnitRoles),unitService.loadedUnitRoles},unitService.getUnit=function(unitId,loadStudents,allStudents,callback){var result,unit;return(result=unitService.loadedUnits[unitId])?void callback(result):(unit={allStudents:allStudents,loadStudents:loadStudents,analytics:{}},unit.refresh=function(refresh_callback){return Unit.get({id:unitId},function(new_unit){return _.extend(unit,new_unit),_.each(unit.task_definitions,function(td,index){return td.seq=index,td.group_set_id&&(td.group_set=_.find(unit.group_sets,function(gs){return td.group_set_id===gs.id})),td.hasPlagiarismCheck=function(){return td.plagiarism_checks.length>0}}),unit.loadStudents&&unit.refreshStudents(),null!=refresh_callback?refresh_callback(unit):void 0})},unit.taskDef=function(taskDef){return"number"!=typeof taskDef&&(taskDef=taskDef.task_definition_id),result=_.find(unit.task_definitions,{id:taskDef})
},unit.outcome=function(outcomeId){return result=_.find(unit.ilos,{id:outcomeId})},unit.tutorialFromId=function(tuteId){return _.find(unit.tutorials,{id:+tuteId})},unit.taskCount=function(){return unit.task_definitions.length},unit.refreshStudents=function(){return Students.query({unit_id:unit.id,all:unit.allStudents},function(students){var new_students;return new_students=students.map(function(student){return unit.extendStudent(student),student}),unit.students=new_students})},unit.studentEnrolled=function(id){var student;return student=unit.findStudent(id),null!=student?student.enrolled:void 0},unit.findStudent=function(id){return _.find(unit.students,function(s){return s.project_id===id})},unit.addStudent=function(student){var foundStudent,studentExists;return analyticsService.event("Unit Service","Added Student"),foundStudent=unit.findStudent(student.project_id),studentExists=null!=foundStudent,studentExists?student=_.extend(foundStudent,student):unit.students.push(student),unit.extendStudent(student)},unit.active_students=function(){return _.filter(unit.students,function(student){return student.enrolled})},unit.extendStudent=function(student){return null!=student.name?student:(student.open=!1,student.findTaskForDefinition=function(taskDefId){return _.find(student.tasks,function(task){return task.task_definition_id===taskDefId})},student.unit=function(){return unit},student.switchToLab=function(tutorial){var newId;return newId=tutorial?tutorial.id:-1,analyticsService.event("Teacher View - Students Tab","Changed Student Tutorial"),Project.update({id:student.project_id,tutorial_id:newId},function(project){return student.tutorial_id=project.tutorial_id,student.tutorial=student.unit().tutorialFromId(student.tutorial_id)},function(response){var _ref;return alertService.add("danger","Failed to change tutorial. "+(null!=response&&null!=(_ref=response.data)?_ref.error:void 0),8e3)})},student.name=student.first_name+" "+student.last_name,student.portfolio_status=student.has_portfolio?1:student.compile_portfolio?.5:0,student.activeTasks=function(){return _.filter(student.tasks,function(task){return task.definition.target_grade<=student.target_grade})},student.tutorial=unit.tutorialFromId(student.tutorial_id),student.tutorName=function(){return null!=student.tutorial?student.tutorial.tutor_name:""},student.task_stats=[{value:0,type:_.trim(_.dasherize(taskService.statusKeys[10]))},{value:0,type:_.trim(_.dasherize(taskService.statusKeys[0]))},{value:0,type:_.trim(_.dasherize(taskService.statusKeys[1]))},{value:0,type:_.trim(_.dasherize(taskService.statusKeys[2]))},{value:0,type:_.trim(_.dasherize(taskService.statusKeys[3]))},{value:0,type:_.trim(_.dasherize(taskService.statusKeys[4]))},{value:0,type:_.trim(_.dasherize(taskService.statusKeys[5]))},{value:0,type:_.trim(_.dasherize(taskService.statusKeys[6]))},{value:0,type:_.trim(_.dasherize(taskService.statusKeys[7]))},{value:0,type:_.trim(_.dasherize(taskService.statusKeys[8]))},{value:0,type:_.trim(_.dasherize(taskService.statusKeys[9]))}],student.taskStatValue=function(key){return student.task_stats[projectService.taskStatIndex[key]].value},student.progressSortOrder=function(){return 20*student.taskStatValue("complete")+15*(student.taskStatValue("discuss")+student.taskStatValue("demonstrate"))+10*student.taskStatValue("ready_to_mark")+5*student.taskStatValue("fix_and_resubmit")+2*student.taskStatValue("working_on_it")+1*student.taskStatValue("need_help")},student.portfolioUrl=function(){return PortfolioSubmission.getPortfolioUrl(student)},student.assignGrade=function(score,rationale){return Project.update({id:student.project_id,grade:score,old_grade:student.grade,grade_rationale:rationale},function(project){return student.grade=project.grade,student.grade_rationale=project.grade_rationale,alertService.add("success","Grade updated.",2e3)},function(response){return alertService.add("danger","Grade was not updated: "+response.data.error,8e3)})},projectService.updateTaskStats(student,student.stats),projectService.addTaskDetailsToProject(student,unit))},unit.getGroups=function(group_set,group_callback){return group_set?Group.query({unit_id:unit.id,group_set_id:group_set.id},function(groups){return null!=group_callback?group_callback(groups):void 0}):void 0},unit.hasGroupwork=function(){return null!=unit.group_sets&&unit.group_sets.length>0},unit.incorporateTasks=function(tasks){return _.map(tasks,function(t){var project;return project=unit.findStudent(t.project_id),null!=project?(null==project.incorporateTask&&(projectService.mapTask(t,unit,project),projectService.addProjectMethods(project,unit)),project.incorporateTask(t)):void 0})},unit.fillWithUnStartedTasks=function(tasks,task_def){var projs;return projs=_.filter(unit.students,function(s){return s.target_grade>=task_def.target_grade}),_.map(projs,function(p){var t;return t=_.find(tasks,function(t){return t.project_id===p.project_id&&t.task_definition_id===task_def.id}),null==t?_.find(p.tasks,function(t){return t.task_definition_id===task_def.id}):t})},unit.refresh(callback),unit)},unitService.unitTypeAheadData=function(unit){var result;return result=[],angular.forEach(unit.tutorials,function(tute){return result.push(tute.abbreviation),result.push(tute.tutor_name)}),angular.forEach(unit.students,function(student){return result.push(student.name),result.push(student.student_id)}),result=_.uniq(result,function(item){return item})},unitService}]),angular.module("doubtfire.common.status-icon",[]).directive("statusIcon",function(){return{restrict:"E",templateUrl:"common/status-icon/status-icon.tpl.html",scope:{status:"="},controller:["$scope","taskService",function($scope,taskService){return $scope.statusIcon=function(status){return taskService.statusIcons[status]},$scope.statusLabel=function(status){return taskService.statusLabels[status]},$scope.statusClass=function(status){return taskService.statusClass(status)}}]}}),angular.module("doubtfire.config.analytics",[]).config(["$analyticsProvider",function($analyticsProvider){return $analyticsProvider.virtualPageviews(!1)}]),angular.module("doubtfire.config",["doubtfire.config.vendor-dependencies","doubtfire.config.contributors","doubtfire.config.local-storage","doubtfire.config.routing","doubtfire.config.analytics","doubtfire.config.runtime","doubtfire.config.root-controller","doubtfire.config.debug"]),angular.module("doubtfire.config.contributors",[]).constant("DoubtfireContributors",["macite","alexcu","apj","jakerenzella","reubsinit","hellola","AvDongle","joostfunkekupper","rohanliston","lukehorvat"]);var scope;angular.module("doubtfire.config.debug",[]),scope=function($0){if(null==$0)throw new Error("Select a DOM element using 'Inspect Element' first, then call using scope($0)");return angular.element($0).scope()},angular.module("doubtfire.config.local-storage",[]).config(["localStorageServiceProvider",function(localStorageServiceProvider){return localStorageServiceProvider.setPrefix("doubtfire")}]),angular.module("doubtfire.config.root-controller",[]).controller("AppCtrl",["$rootScope","$state","$document","$filter",function($rootScope,$state,$document,$filter){var setPageTitle,suffix;return suffix=$document.prop("title"),setPageTitle=function(state){return $document.prop("title",$filter("i18n")(state.data.pageTitle)+" | "+suffix)}}]),angular.module("doubtfire.config.routing",[]).config(["$urlRouterProvider","$httpProvider",function($urlRouterProvider){return $urlRouterProvider.otherwise("/not_found"),$urlRouterProvider.when("","/"),$urlRouterProvider.when("/","/home")}]),angular.module("doubtfire.config.runtime",[]).run(["$rootScope","$state","$filter","$location","auth","editableOptions",function($rootScope,$state,$filter,$location,auth,editableOptions){var handleTokenTimeout,handleUnauthorised,handleUnauthorisedDest,serialize;return editableOptions.theme="bs3",serialize=function(obj,prefix){var k,p,str,v;str=[];for(p in obj)v=obj[p],k=prefix?prefix+"["+p+"]":p,str.push("object"==typeof v?serialize(v,k):encodeURIComponent(k)+"="+encodeURIComponent(v));return str.join("&")},handleUnauthorisedDest=function(toState,toParams){return auth.isAuthenticated()?$state.go("unauthorised"):"sign_in"!==$state.current.name?$state.go("sign_in",{dest:toState.name,params:serialize(toParams)}):void 0},handleTokenTimeout=function(){return"timeout"!==$state.current.name?$state.go("timeout",{dest:$state.current.name,params:serialize($state.params)}):void 0},handleUnauthorised=function(){return handleUnauthorisedDest($state.current,$state.params)},$rootScope.$on("$stateChangeStart",function(evt,toState,toParams){return auth.isAuthorised(toState.data.roleWhitelist)?void 0:(evt.preventDefault(),handleUnauthorisedDest(toState,toParams))}),$rootScope.$on("unauthorisedRequestIntercepted",handleUnauthorised),$rootScope.$on("tokenTimeout",handleTokenTimeout),_.mixin(_.string.exports())}]),angular.module("doubtfire.config.vendor-dependencies",["ngCookies","ngCsv","ngSanitize","templates-app","templates-common","ui.router","ui.bootstrap","ui.codemirror","angularFileUpload","angular.filter","localization","markdown","nvd3","xeditable","LocalStorageModule","angulartics","angulartics.google.analytics"]),angular.module("doubtfire.errors",["doubtfire.errors.states"]),angular.module("doubtfire.errors.states.not-found",[]).config(["headerServiceProvider",function(headerServiceProvider){var stateData;return stateData={url:"/not_found",views:{main:{controller:"NotFoundCtrl",templateUrl:"errors/states/not-found/not-found.tpl.html"}},data:{pageTitle:"_Not Found_"}},headerServiceProvider.state("not_found",stateData)}]).controller("NotFoundCtrl",["$scope",function(){}]),angular.module("doubtfire.errors.states",["doubtfire.errors.states.not-found","doubtfire.errors.states.timeout","doubtfire.errors.states.unauthorised"]),angular.module("doubtfire.errors.states.timeout",[]).config(["headerServiceProvider",function(headerServiceProvider){var stateData;return stateData={url:"/timeout?dest&params",views:{main:{controller:"TimeoutCtrl",templateUrl:"errors/states/timeout/timeout.tpl.html"}},data:{pageTitle:"_Timeout_"}},headerServiceProvider.state("timeout",stateData,"ErrorHeaderCtrl")}]).controller("TimeoutCtrl",["$scope","$timeout","api","auth","redirectService","currentUser",function($scope,$timeout,api,auth,redirectService,currentUser){var doRedirect;return doRedirect=function(){return redirectService.redirect("home",{})},auth.isAuthenticated()?(auth.signOut(api+"/auth/"+currentUser.authenticationToken+".json"),$timeout(doRedirect,2e3)):void 0}]),angular.module("doubtfire.errors.states.unauthorised",[]).config(["headerServiceProvider",function(headerServiceProvider){var stateData;return stateData={url:"/unauthorised",views:{main:{controller:"UnauthorisedCtrl",templateUrl:"errors/states/unauthorised/unauthorised.tpl.html"}},data:{pageTitle:"_Unauthorised_"}},headerServiceProvider.state("unauthorised",stateData)}]).controller("UnauthorisedCtrl",["$scope",function(){}]),angular.module("doubtfire.groups.group-member-contribution-assigner",[]).directive("groupMemberContributionAssigner",function(){return{restrict:"E",templateUrl:"groups/group-member-contribution-assigner/group-member-contribution-assigner.tpl.html",replace:!0,scope:{task:"=",project:"=",team:"="},controller:["$scope","gradeService","projectService","groupService","GroupMember",function($scope,gradeService,projectService,groupService,GroupMember){return $scope.selectedGroupset=$scope.task.definition.group_set,$scope.selectedGroup=projectService.getGroupForTask($scope.project,$scope.task),$scope.memberSortOrder="student_name",$scope.team.members=[],$scope.numStars=5,$scope.initialStars=3,$scope.dangerPct=0,$scope.warnPct=25,$scope.infoPct=50,$scope.successPct=100,$scope.checkClearRating=function(member){return 1===member.confRating&&1===member.overStar&&1===member.rating?(member.rating=0,member.percent=0):1===member.confRating&&1===member.overStar&&0===member.rating&&(member.rating=1),member.confRating=member.rating},$scope.hoveringOver=function(member,value){return member.overStar=value,member.percent=(100*(value/groupService.groupContributionSum($scope.team.members,member,value))).toFixed()},$scope.gradeFor=gradeService.gradeFor,$scope.selectedGroup&&$scope.selectedGroupset?GroupMember.query({unit_id:$scope.project.unit_id,group_set_id:$scope.selectedGroupset.id,group_id:$scope.selectedGroup.id},function(members){return $scope.team.members=members,$scope.warnPct=(25/members.length).toFixed(),$scope.infoPct=(50/members.length).toFixed(),$scope.successPct=(95/members.length).toFixed()}):$scope.team.members=[]}]}}),angular.module("doubtfire.groups.group-member-list",[]).directive("groupMemberList",function(){return{restrict:"E",templateUrl:"groups/group-member-list/group-member-list.tpl.html",controller:["$scope","GroupMember","gradeService",function($scope,GroupMember){return $scope.memberSortOrder="student_name",$scope.members=[],$scope.$watch("selectedGroupset",function(newValue){return newValue&&$scope.selectedGroup&&$scope.selectedGroupset?$scope.selectedGroupset.id!==$scope.selectedGroup.group_set_id?($scope.members=[],$scope.selectedGroup=null):$scope.refreshGroupMembers():void 0}),$scope.refreshGroupMembers=function(){return $scope.selectedGroup&&$scope.selectedGroupset?$scope.selectedGroupset.id===$scope.selectedGroup.group_set_id?GroupMember.query({unit_id:$scope.unit.id,group_set_id:$scope.selectedGroupset.id,group_id:$scope.selectedGroup.id},function(members){return $scope.members=members}):($scope.members=[],$scope.selectedGroup=null):$scope.members=[]},$scope.$watch("selectedGroup",function(newValue,oldValue){return newValue!==oldValue?$scope.refreshGroupMembers():void 0})}]}}),angular.module("doubtfire.groups.group-selector",[]).directive("groupSelector",function(){return{restrict:"E",templateUrl:"groups/group-selector/group-selector.tpl.html",replace:!0,controller:["$scope","alertService","Group","currentUser",function($scope,alertService,Group,currentUser){return $scope.currentPage=1,$scope.maxSize=5,$scope.pageSize=5,$scope.groupSortOrder="name",$scope.addGroup=function(name){var tutorName,tutorial_id;return 0===$scope.unit.tutorials.length&&alertService.add("danger","Please ensure there is at least one tutorial before groups are created",6e3),$scope.project?tutorial_id=$scope.project.tutorial.id:(tutorName=null!=$scope.assessingUnitRole?$scope.assessingUnitRole.name:currentUser.profile.name,tutorial_id=_.find($scope.unit.tutorials,function(tutorial){return tutorial.tutor_name===tutorName}),tutorial_id?tutorial_id=tutorial_id.id:(tutorial_id=$scope.unit.tutorials[0].id,$scope.staffFilter="all")),Group.create({unit_id:$scope.unit.id,group_set_id:$scope.selectedGroupset.id,group:{name:name,tutorial_id:tutorial_id}},function(grp){return $scope.groups.push(grp),null===$scope.selectedGroup&&$scope.selectGroup(grp),alertService.add("success",""+grp.name+" was created!",3e3),addGroupForm.reset()},function(response){return alertService.add("danger",response.data.error,6e3)})},$scope.saveGroup=function(grp,id){return Group.update({unit_id:$scope.unit.id,group_set_id:$scope.selectedGroupset.id,id:id,group:{name:grp.name,tutorial_id:grp.tutorial_id}},function(){return alertService.add("info",""+grp.name+" was updated",3e3)},function(response){return alertService.add("danger",response.data.error,6e3)})},$scope.removeGroup=function(grp){return grp===$scope.selectedGroup&&$scope.selectGroup(null),Group["delete"]({unit_id:$scope.unit.id,group_set_id:$scope.selectedGroupset.id,id:grp.id},function(){return $scope.groups=_.filter($scope.groups,function(grp1){return grp.id!==grp1.id}),alertService.add("info",""+grp.name+" was deleted",3e3)},function(response){return alertService.add("danger",response.data.error,3e3)})},$scope.selectGroup=function(grp){return $scope.selectedGroup=grp?grp:null,$scope.onSelectGroup&&$scope.onSelectGroup(grp),$scope.$digest},$scope.selectedGroupset&&$scope.unit.getGroups($scope.selectedGroupset,function(groups){return $scope.groups=groups}),$scope.selectTutorial=function(id){return _.find($scope.unit.tutorials,function(t){return t.id===id})},$scope.$watch("selectedGroupset",function(newValue){return $scope.unit.getGroups(newValue,function(groups){return $scope.groups=groups})})}]}}),angular.module("doubtfire.groups",["doubtfire.groups.group-member-contribution-assigner","doubtfire.groups.group-member-list","doubtfire.groups.group-selector","doubtfire.groups.groupset-group-manager","doubtfire.groups.groupset-selector","doubtfire.groups.student-group-manager","doubtfire.groups.tutor-group-manager"]),angular.module("doubtfire.groups.groupset-group-manager",[]).directive("groupsetGroupManager",function(){return{restrict:"E",templateUrl:"groups/groupset-group-manager/groupset-group-manager.tpl.html",replace:!0,controller:["$scope","GroupSet","Group","GroupMember","gradeService","alertService","projectService",function($scope,GroupSet,Group,GroupMember,gradeService,alertService){return $scope.staffFilter="mine",$scope.removeGroupMember=function(member){return GroupMember["delete"]({unit_id:$scope.unit.id,group_set_id:$scope.selectedGroupset.id,group_id:$scope.selectedGroup.id,id:member.project_id},function(){return $scope.members=_.filter($scope.members,function(member1){return member.project_id!==member1.project_id})},function(response){return alertService.add("danger",response.data.error,6e3)})},$scope.addSelectedStudent=function(student){return GroupMember.create({unit_id:$scope.unit.id,group_set_id:$scope.selectedGroupset.id,group_id:$scope.selectedGroup.id,project_id:student.project_id},function(member){return $scope.members.push(member),addStudentForm.reset()},function(response){return alertService.add("danger",response.data.error,6e3)})},$scope.studentDetails=function(student){return student&&student.student_id&&student.name?""+student.student_id+" "+student.name:"Select Student"},$scope.$watch("groups",function(){var _ref;return $scope.selectGroup((null!=(_ref=$scope.groups)?_ref.length:void 0)>0?$scope.groups[0]:null)})}]}}),angular.module("doubtfire.groups.groupset-selector",[]).directive("groupsetSelector",function(){return{restrict:"E",templateUrl:"groups/groupset-selector/groupset-selector.tpl.html",replace:!0,controller:["$scope",function($scope){return $scope.selectGroupSet=function(gs){return $scope.selectedGroupset=gs,$scope.$digest},$scope.unit.group_sets.length>0?$scope.selectGroupSet($scope.unit.group_sets[0]):void 0}]}}),angular.module("doubtfire.groups.student-group-manager",[]).directive("studentGroupManager",function(){return{restrict:"E",templateUrl:"groups/student-group-manager/student-group-manager.tpl.html",replace:!0,controller:["$scope","Group","alertService","GroupMember","projectService",function($scope,Group,alertService,GroupMember,projectService){return $scope.selectedGroup=null,$scope.groupForSet=function(gs){return gs?_.find($scope.project.groups,function(grp){return grp.group_set_id===gs.id}):void 0},$scope.updateGroup=function(data){return Group.update({unit_id:$scope.unit.id,group_set_id:$scope.selectedGroupset.id,id:$scope.selectedGroup.id,group:{name:data}},function(){return alertService.add("success","Group name changed",2e3)},function(response){return alertService.add("danger",response.data.error,6e3)})},$scope.onSelectGroup=function(grp){return GroupMember.create({unit_id:$scope.unit.id,group_set_id:$scope.selectedGroupset.id,group_id:grp.id,project_id:$scope.project.project_id},function(){return projectService.updateGroups($scope.project),alertService.add("success","Joined group",2e3),$scope.refreshGroupMembers()},function(error){return alertService.add("danger",error.data.error,6e3),$scope.selectedGroup=null})},$scope.$watch("project",function(){return $scope.selectedGroup=$scope.groupForSet($scope.selectedGroupset),$scope.$digest}),$scope.$watch("selectedGroupset",function(newValue){return $scope.selectedGroup=$scope.groupForSet(newValue),$scope.$digest})}]}}),angular.module("doubtfire.groups.tutor-group-manager",[]).directive("tutorGroupManager",function(){return{restrict:"E",templateUrl:"groups/tutor-group-manager/tutor-group-manager.tpl.html",controller:["$scope",function(){}]}}),angular.module("doubtfire.home",["doubtfire.home.states"]),angular.module("doubtfire.home.states.home",[]).config(["headerServiceProvider",function(headerServiceProvider){var homeStateData;return homeStateData={url:"/home",views:{main:{controller:"HomeCtrl",templateUrl:"home/states/home/home.tpl.html"}},data:{pageTitle:"_Home_",roleWhitelist:["Student","Tutor","Convenor","Admin"]}},headerServiceProvider.state("home",homeStateData)}]).controller("HomeCtrl",["$scope","$state","User","Unit","headerService","currentUser","unitService","projectService","$rootScope","analyticsService","dateService",function($scope,$state,User,Unit,headerService,currentUser,unitService,projectService,$rootScope,analyticsService,dateService){var checkEnrolled,hasProjects,hasRoles,testForNewUserWizard,testForStateChanges,testSingleProjectRole;return analyticsService.event("Home","Viewed Home page"),$scope.userFirstName=currentUser.profile.nickname||currentUser.profile.first_name,$scope.showDate=dateService.showDate,hasRoles=!1,hasProjects=!1,testForNewUserWizard=function(){var firstTimeUser,showNewUserWizard,userHasNotOptedIn;return firstTimeUser=currentUser.profile.has_run_first_time_setup===!1,userHasNotOptedIn=null===currentUser.profile.opt_in_to_research,showNewUserWizard=firstTimeUser||userHasNotOptedIn,userHasNotOptedIn=userHasNotOptedIn&&!firstTimeUser,showNewUserWizard?$state.go("new-user-wizard",{optInOnly:userHasNotOptedIn}):void 0},testSingleProjectRole=function(){if(hasRoles&&hasProjects&&$scope.unitRoles.length+$scope.projects.length===1){if(1===$scope.projects.length)return analyticsService.event("Home","Switched to project on single unit"),$state.go("projects#show",{projectId:$scope.projects[0].project_id});if(1===$scope.unitRoles.length)return analyticsService.event("Home","Switched to unit on single unit"),$state.go("units#show",{unitRole:$scope.unitRoles[0].id})}},testForStateChanges=function(){return testForNewUserWizard(),testSingleProjectRole()},unitService.getUnitRoles(function(roles){return $scope.unitRoles=roles,hasRoles=!0,testForStateChanges()}),projectService.getProjects(function(projects){return $scope.projects=projects,hasProjects=!0,testForStateChanges()}),checkEnrolled=function(){return $scope.notEnrolled=function(){return 0===$scope.unitRoles.length&&"Tutor"===currentUser.role||0===$scope.projects.length&&"Student"===currentUser.role}},$scope.$watch("projects",checkEnrolled),$scope.$watch("unitRoles",checkEnrolled),"Student"!==currentUser.role&&Unit.query(function(units){return $scope.units=units}),$scope.unit=function(unitId){return _.find($scope.units,{id:unitId})},headerService.clearMenus(),$scope.currentUser=currentUser}]),angular.module("doubtfire.home.states.new-user-wizard",[]).config(["$stateProvider",function($stateProvider){var newUserWizardStateData;return newUserWizardStateData={url:"/home#new-user-wizard?optInOnly",views:{main:{controller:"NewUserWizardCtrl",templateUrl:"home/states/new-user-wizard/new-user-wizard.tpl.html"}},data:{pageTitle:"_Welcome to Doubtfire_",roleWhitelist:["Student","Tutor","Convenor","Admin"]}},$stateProvider.state("new-user-wizard",newUserWizardStateData)}]).controller("NewUserWizardCtrl",["$scope","$state","$stateParams","$q","User","Project","projectService","gradeService","currentUser","alertService","analyticsService","auth",function($scope,$state,$stateParams,$q,User,Project,projectService,gradeService,currentUser,alertService,analyticsService,auth){var email,firstName,lastName;return projectService.getProjects(function(projects){return $scope.projects=projects}),$scope.steps={nameStep:{title:"What's your name?",subtitle:"We will need a name to help identify you on Doubtfire.",seq:0},nicknameStep:{title:"Do you have a preferred name or nickname?",subtitle:"If you'll find it easier for your tutor to call you another name please let us know!",seq:1},emailStep:{title:"How would you like us to email you?",subtitle:"Based on your preferences, we will email you as frequently as you'd like us to.",seq:2},targetGradeStep:{title:"What grades are you aiming for?",subtitle:"We noticed you are enrolled in the following subject(s).",seq:3},optInToResearchStep:{title:"Would you like to help us make Doubtfire better?",subtitle:"We would like to anonymously use your Doubtfire usage for research in making Doubtfire better.",seq:4}},$scope.firstStep=_.find($scope.steps,{seq:0}),$scope.lastStep=_.find($scope.steps,{seq:_.keys($scope.steps).length-1}),$scope.currentStep=$scope.optInOnly?$scope.steps.optInToResearchStep:$scope.firstStep,$scope.optInOnly?($scope.user=currentUser.profile,$scope.user.opt_in_to_research=null):(firstName=null,lastName=null,email=null,"first name"!==currentUser.profile.first_name.toLowerCase()&&"last name"!==currentUser.profile.last_name.toLowerCase()&&(firstName=currentUser.profile.first_name,lastName=currentUser.profile.last_name,email=currentUser.profile.email),$scope.user={first_name:firstName,last_name:lastName,nickname:null,email:email,receive_feedback_notifications:null,receive_portfolio_notifications:null,receive_task_notifications:null,opt_in_to_research:null,has_run_first_time_setup:!0}),$scope.moveStep=function(skip){var stepAfterTargetStep,stepBeforeTargetStep;return 0===$scope.projects.length&&(stepBeforeTargetStep=_.find($scope.steps,{seq:$scope.steps.targetGradeStep.seq-1}),stepAfterTargetStep=_.find($scope.steps,{seq:$scope.steps.targetGradeStep.seq+1}),1===skip&&$scope.currentStep===stepBeforeTargetStep?skip+=1:-1===skip&&$scope.currentStep===stepAfterTargetStep&&(skip-=1)),$scope.currentStep=_.find($scope.steps,{seq:$scope.currentStep.seq+skip})},$scope.gradeAcronyms=gradeService.gradeAcronyms,$scope.grades=gradeService.grades,$scope.determineDisabledForCurrentStep=function(){var state,_ref,_ref1,_ref2;switch($scope.currentStep){case $scope.steps.nameStep:state=(null!=(_ref=$scope.user.first_name)?_ref.trim().length:void 0)>0&&(null!=(_ref1=$scope.user.last_name)?_ref1.trim().length:void 0)>0;break;case $scope.steps.nicknameStep:case $scope.steps.targetGradeStep:state=!0;break;case $scope.steps.emailStep:state=(null!=(_ref2=$scope.user.email)?_ref2.trim().length:void 0)>0&&_.isBoolean($scope.user.receive_feedback_notifications)&&_.isBoolean($scope.user.receive_portfolio_notifications)&&_.isBoolean($scope.user.receive_task_notifications);break;case $scope.steps.optInToResearchStep:state=_.isBoolean($scope.user.opt_in_to_research)}return!state},$scope.done=function(user){var errorFn,project,promises,_i,_len,_ref;for(user=null!=user?user:$scope.user,promises=[],errorFn=function(response){return console.log(response),alertService.add("danger","Error: "+response.data.error,6e3)},_ref=$scope.projects,_i=0,_len=_ref.length;_len>_i;_i++)project=_ref[_i],promises.push(Project.update(null,{id:project.project_id,target_grade:project.target_grade},null,errorFn).$promise);return promises.push(User.update(null,{id:currentUser.id,user:$scope.user},function(user){return currentUser.profile=user},errorFn).$promise),$q.all(promises).then(function(){return $scope.user.opt_in_to_research&&analyticsService.event("Doubtfire Analytics","User opted in research"),auth.saveCurrentUser(),$state.go("home")})},$scope.userFirstName=currentUser.profile.first_name}]),angular.module("doubtfire.home.states",["doubtfire.home.states.home","doubtfire.home.states.new-user-wizard"]),angular.module("doubtfire.projects.project-lab-list",[]).directive("projectLabList",function(){return{restrict:"E",templateUrl:"projects/project-lab-list/project-lab-list.tpl.html",controller:["$scope","$modal","User","Project","alertService","projectService","analyticsService",function($scope,$modal,User,Project,alertService,projectService,analyticsService){return $scope.sortOrder="abbreviation",$scope.setTutorial=function(id){return Project.update({id:$scope.project.project_id,tutorial_id:id},function(project){var eventName;return $scope.project.tutorial_id=project.tutorial_id,$scope.project.tutorial=$scope.unit.tutorialFromId($scope.project.tutorial_id),eventName=-1!==id?"Changed tutorial":"Withdrew from all tutorials",analyticsService.event("Student Project View - Tutorials Tab",eventName),projectService.updateGroups($scope.project)},function(response){return alertService.add("danger",response.data.error,6e3)})}}]}}),angular.module("doubtfire.projects.project-outcome-alignment",[]).directive("projectOutcomeAlignment",function(){return{restrict:"E",templateUrl:"projects/project-outcome-alignment/project-outcome-alignment.tpl.html",controller:["$scope","$rootScope","$timeout","outcomeService","Unit","alertService","analyticsService","Visualisation",function($scope,$rootScope,$timeout,outcomeService,Unit,alertService,analyticsService,Visualisation){var refreshAlignmentData;return $scope.poaView={activeTab:"list"},$scope.targets=outcomeService.calculateTargets($scope.unit,$scope.unit,outcomeService.unitTaskStatusFactor()),$scope.currentProgress=outcomeService.calculateProgress($scope.unit,$scope.project),$scope.refreshCharts=Visualisation.refreshAll,refreshAlignmentData=function(){return $scope.currentProgress.length=0,$scope.currentProgress=_.extend($scope.currentProgress,outcomeService.calculateProgress($scope.unit,$scope.project))},$scope.$watch("project",function(){return refreshAlignmentData(),$rootScope.$broadcast("ProgressUpdated")}),$scope.$watch("project.tasks",function(){return refreshAlignmentData(),$rootScope.$broadcast("ProgressUpdated")}),$scope.selectTab=function(tab){var eventName;return"progress"===tab&&null==$scope.classStats&&Unit.learningProgressClassStats.get({id:$scope.unit.id},function(response){return $scope.classStats=response},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):alertService.add("danger","Failed to get unit progress class statistics",6e3),$scope.classStats={}}),$scope.poaView.activeTab=tab,eventName="progress"===tab?"View Learning Progress Tab":"Reflect on Learning Tab",analyticsService.event("Stuent Feedback View - Learning Outcomes Tab","Switched Tab",eventName),$scope.refreshCharts()},$scope.selectTab("progress"),$scope.$on("UpdateAlignmentChart",function(){return refreshAlignmentData(),$rootScope.$broadcast("ProgressUpdated")})}]}}),angular.module("doubtfire.projects.project-portfolio-wizard.portfolio-add-extra-files-step",[]).directive("portfolioAddExtraFilesStep",function(){return{restrict:"E",templateUrl:"projects/project-portfolio-wizard/portfolio-add-extra-files-step/portfolio-add-extra-files-step.tpl.html",controller:["$scope",function($scope){return $scope.uploadType="code",$scope.uploadDropdown={open:!1},$scope.changeTo=function(type){return $scope.uploadType=type,$scope.fileUploader.clearQueue(),$scope.uploadDropdown.open=!1},$scope.submitOther=function(){return $scope.fileUploader.uploadPortfolioPart("Other",$scope.uploadType)}}]}}),angular.module("doubtfire.projects.project-portfolio-wizard.portfolio-compile-step",[]).directive("portfolioCompileStep",function(){return{restrict:"E",templateUrl:"projects/project-portfolio-wizard/portfolio-compile-step/portfolio-compile-step.tpl.html",controller:["$scope","Project","alertService",function($scope,Project,alertService){return $scope.toggleCompileProject=function(){return $scope.project.compile_portfolio=!$scope.project.compile_portfolio,Project.update({id:$scope.project.project_id,compile_portfolio:$scope.project.compile_portfolio},function(){return alertService.add("success","Project compile schedule changed.",2e3)})}}]}}),angular.module("doubtfire.projects.project-portfolio-wizard.portfolio-files-list",[]).directive("portfolioFilesList",function(){return{restrict:"E",templateUrl:"projects/project-portfolio-wizard/portfolio-files-list/portfolio-files-list.tpl.html",controller:["$scope",function($scope){return $scope.removeFile=function(file){return $scope.fileUploader.api["delete"]({id:$scope.project.project_id,idx:file.idx,kind:file.kind,name:file.name},function(){return $scope.project.portfolio_files=_.without($scope.project.portfolio_files,file)
})}}]}}),angular.module("doubtfire.projects.project-portfolio-wizard.portfolio-grade-select-step",[]).directive("portfolioGradeSelectStep",function(){return{restrict:"E",templateUrl:"projects/project-portfolio-wizard/portfolio-grade-select-step/portfolio-grade-select-step.tpl.html",controller:["$scope","Project","gradeService",function($scope,Project,gradeService){return $scope.gradeAcronyms=gradeService.gradeAcronyms,$scope.grades=gradeService.grades,$scope.chooseGrade=function(idx){return Project.update({id:$scope.project.project_id,target_grade:idx},function(project){return $scope.project.target_grade=project.target_grade,$scope.project.burndown_chart_data=project.burndown_chart_data})}}]}}),angular.module("doubtfire.projects.project-portfolio-wizard.portfolio-learning-summary-report-step",[]).directive("portfolioLearningSummaryReportStep",function(){return{restrict:"E",templateUrl:"projects/project-portfolio-wizard/portfolio-learning-summary-report-step/portfolio-learning-summary-report-step.tpl.html",controller:["$scope",function($scope){return $scope.submitLearningSummaryReport=function(){return $scope.fileUploader.uploadPortfolioPart("LearningSummaryReport","document")}}]}}),angular.module("doubtfire.projects.project-portfolio-wizard.portfolio-review-step",[]).directive("portfolioReviewStep",function(){return{restrict:"E",templateUrl:"projects/project-portfolio-wizard/portfolio-review-step/portfolio-review-step.tpl.html",controller:["$scope","PortfolioSubmission",function($scope){return $scope.deletePortfolio=function(){return $scope.fileUploader.api["delete"]({id:$scope.project.project_id},function(){return $scope.activePortfolioTab=$scope.tabData.compileStep,$scope.project.portfolio_available=!1})}}]}}),angular.module("doubtfire.projects.project-portfolio-wizard.portfolio-tasks-step",[]).directive("portfolioTasksStep",function(){return{restrict:"E",templateUrl:"projects/project-portfolio-wizard/portfolio-tasks-step/portfolio-tasks-step.tpl.html",controller:["$scope",function($scope){return $scope.unitHasILOs=$scope.unit.ilos.length>0,$scope.noTasksSelected=function(){var selectedTasks;return $scope.unitHasILOs?(selectedTasks=_.filter($scope.project.tasks,function(d){return d.include_in_portfolio&&null!=_.find($scope.project.task_outcome_alignments,{task_id:d.id})}),0===selectedTasks.length):(selectedTasks=_.filter($scope.project.tasks,function(d){return d.include_in_portfolio}),0===selectedTasks.length)}}]}}),angular.module("doubtfire.projects.project-portfolio-wizard",["doubtfire.projects.project-portfolio-wizard.portfolio-add-extra-files-step","doubtfire.projects.project-portfolio-wizard.portfolio-compile-step","doubtfire.projects.project-portfolio-wizard.portfolio-grade-select-step","doubtfire.projects.project-portfolio-wizard.portfolio-learning-summary-report-step","doubtfire.projects.project-portfolio-wizard.portfolio-review-step","doubtfire.projects.project-portfolio-wizard.portfolio-tasks-step","doubtfire.projects.project-portfolio-wizard.portfolio-files-list"]).directive("projectPortfolioWizard",function(){return{restrict:"E",templateUrl:"projects/project-portfolio-wizard/project-portfolio-wizard.tpl.html",controller:["$scope","taskService","PortfolioSubmission","analyticsService",function($scope,taskService,PortfolioSubmission,analyticsService){return $scope.portfolioTabsData={welcomeStep:{title:"Welcome",icon:"fa-smile-o",seq:0},gradeStep:{title:"Select Grade",icon:"fa-trophy",seq:1},summaryStep:{title:"Learning Summary Report",icon:"fa-graduation-cap",seq:2},taskStep:{title:"Align and Select Tasks",icon:"fa-tasks",seq:3},otherFilesStep:{title:"Upload Other Files",icon:"fa-plus",seq:4},compileStep:{title:"Compile PDF",icon:"fa-file-pdf-o",seq:5},reviewStep:{title:"Review Portfolio",icon:"fa-book",seq:6}},$scope.setActivePortfolioTab=function(tab){return $scope.activePortfolioTab=tab,analyticsService.event("Portfolio Wizard","Switched to Step",""+tab.title+" Step")},$scope.$watch("activePortfolioTab",function(newTab,oldTab){return newTab.active=!0,null!=oldTab?oldTab.active=!1:void 0}),$scope.advanceActivePortfolioTab=function(advanceBy){var newSeq,tab,tabKey;return newSeq=$scope.activePortfolioTab.seq+advanceBy,$scope.activePortfolioTab=function(){var _ref,_results;_ref=$scope.portfolioTabsData,_results=[];for(tabKey in _ref)tab=_ref[tabKey],tab.seq===newSeq&&_results.push(tab);return _results}()[0]},$scope.setActivePortfolioTab($scope.portfolioTabsData.welcomeStep),$scope.projectHasLearningSummaryReport=function(){return _.filter($scope.project.portfolio_files,{idx:0}).length>0},$scope.fileUploader=PortfolioSubmission.fileUploader($scope,$scope.project),$scope.clearUploads=function(){return $scope.fileUploader.clearQueue()},$scope.activePortfolioTab=$scope.project.portfolio_available?$scope.portfolioTabsData.reviewStep:$scope.project.compile_portfolio?$scope.portfolioTabsData.compileStep:$scope.projectHasLearningSummaryReport()?$scope.portfolioTabsData.taskStep:$scope.portfolioTabsData.welcomeStep,$scope.statusText=taskService.statusText,$scope.statusData=taskService.statusData,$scope.statusClass=taskService.statusClass}]}}),angular.module("doubtfire.projects.project-progress-dashboard",[]).directive("projectProgressDashboard",function(){return{restrict:"E",templateUrl:"projects/project-progress-dashboard/project-progress-dashboard.tpl.html",controller:["$scope","$state","$rootScope","$stateParams","Project","Unit","UnitRole","headerService","alertService","gradeService","taskService","projectService","analyticsService",function($scope,$state,$rootScope,$stateParams,Project,Unit,UnitRole,headerService,alertService,gradeService,taskService,projectService,analyticsService){var updateTaskCompletionStats;return null!=$stateParams.projectId?$scope.studentProjectId=$stateParams.projectId:null!=$scope.project&&($scope.studentProjectId=$scope.project.project_id),$scope.grades=gradeService.grades,$scope.gradeAcronyms=gradeService.gradeAcronyms,$scope.currentVisualisation="burndown",$scope.taskDetailsSelector={viewAll:!1},$scope.chooseGrade=function(idx){return Project.update({id:$scope.project.project_id,target_grade:idx},function(project){return $scope.project.target_grade=project.target_grade,$scope.project.burndown_chart_data=project.burndown_chart_data,projectService.updateTaskStats($scope.project,project.stats),analyticsService.event("Student Project View - Progress Tab","Grade Changed",$scope.grades[idx]),$rootScope.$broadcast("TargetGradeUpdated")})},$scope.taskCount=function(){return $scope.unit.task_definitions.length},$scope.taskStats={},updateTaskCompletionStats=function(){return $scope.taskStats.numberOfTasksCompleted=projectService.tasksByStatus($scope.project,taskService.acronymKey.COM).length,$scope.taskStats.numberOfTasksRemaining=projectService.tasksInTargetGrade($scope.project).length-$scope.taskStats.numberOfTasksCompleted},$scope.$watch("taskDetailsSelector.viewAll",function(){return $scope.taskDetailsSelector.viewAll?void 0:analyticsService.event("Student Project View","Showed Top Tasks")}),$scope.$on("TaskStatusUpdated",function(){return updateTaskCompletionStats()}),$scope.$on("TargetGradeUpdated",function(){return updateTaskCompletionStats()}),updateTaskCompletionStats()}]}}),angular.module("doubtfire.projects.project-viewer",[]).directive("projectViewer",function(){return{restrict:"E",replace:!0,templateUrl:"projects/project-viewer/project-viewer.tpl.html",scope:{showTaskId:"=?",unitRole:"=?",project:"=?",unit:"=?",assessingUnitRole:"=?",fullscreen:"=?"},controller:["$scope","$state","Visualisation","Project","UnitRole","headerService","alertService","taskService","unitService","projectService","analyticsService",function($scope,$state,Visualisation,Project,UnitRole,headerService,alertService,taskService,unitService,projectService,analyticsService){var cleanupTabs,refreshCharts,selectProjectTask;return null!=$scope.unit&&($scope.taskDefinition=taskService.taskDefinitionFn($scope.unit)),refreshCharts=Visualisation.refreshAll,$scope.showTaskView=function(task,trigger){return analyticsService.event("Student Project View","Switched to Task",trigger),task||$scope.project.selectedTask?!task&&$scope.project.selectedTask&&(task=$scope.project.selectedTask):task=_.find(_.sortBy($scope.project.tasks,"seq"),function(t){return $scope.taskDefinition(t).target_grade<=$scope.project.target_grade}),$scope.setActiveTab($scope.tabs.tasksTab),$scope.project.selectedTask=task},$scope.tabs={progressTab:{title:"Progress",icon:"fa-line-chart",seq:0},tasksTab:{title:"Tasks",icon:"fa-tasks",seq:1},tutorialTab:{title:"Tutorials",icon:"fa-pencil",seq:2},groupTab:{title:"Groups",icon:"fa-group",seq:3},learningOutcomeTab:{title:"Learning Outcomes",icon:"fa-graduation-cap",seq:4},portfolioTab:{title:"Portfolio",icon:"fa-book",seq:5}},$scope.setActiveTab=function(tab){var asUser,_ref;if(tab!==$scope.activeTab){switch(null!=(_ref=$scope.activeTab)&&(_ref.active=!1),$scope.activeTab=tab,$scope.activeTab.active=!0,tab){case $scope.tabs.progressTab:case $scope.tabs.learningOutcomeTab:refreshCharts();break;case $scope.tabs.tasksTab:$scope.showTaskView(null,"Tab Selected")}return asUser=null!=$scope.assessingUnitRole?$scope.assessingUnitRole.role:"Student",analyticsService.event("Student Project View","Switched Tab as "+asUser,""+tab.title+" Tab")}},cleanupTabs=function(){var _ref,_ref1;return null==$scope.activeTab&&($scope.activeTab=$scope.tabs.progressTab),(null!=(_ref=$scope.unit)?_ref.task_outcome_alignments.length:void 0)>0||delete $scope.tabs.learningOutcomeTab,(null!=(_ref1=$scope.unit)?_ref1.group_sets.length:void 0)>0?void 0:delete $scope.tabs.groupTab},$scope.$watch("unitLoaded",function(newValue){return newValue===!0?cleanupTabs():void 0}),$scope.$watch("project",function(){return projectService.fetchDetailsForProject($scope.project,$scope.unit,function(project){return project&&null==$scope.unit?unitService.getUnit(project.unit_id,!1,!1,function(unit){return $scope.unit=unit,unit.extendStudent(project),$scope.taskDefinition=taskService.taskDefinitionFn($scope.unit),selectProjectTask(project),$scope.unitLoaded=!0}):null!=$scope.unit?($scope.unitLoaded=!0,selectProjectTask(project)):void 0})}),selectProjectTask=function(project){var filteredTasks,t,task;return filteredTasks=_.filter(project.tasks,function(t){return $scope.taskDefinition(t).target_grade<=project.target_grade}),filteredTasks=_.sortBy(filteredTasks,function(t){return t.definition.seq}),$scope.projectLoaded=!0,filteredTasks.length>0?(null!=$scope.showTaskId?(task=_.find(filteredTasks,function(task){return task.id===$scope.showTaskId}),null!=task&&($scope.project.selectedTask=task)):null!=$scope.assessingUnitRole?(t=_.find(filteredTasks,function(t){return"need_help"===t.status||"ready_to_mark"===t.status}),null==t&&(t=_.find(filteredTasks,function(t){return"discuss"===t.status||"demonstrate"===t.status})),null==t&&(t=_.find(filteredTasks,function(t){return"redo"===t.status||"fix_and_resubmit"===t.status})),null==t&&(t=_.find(filteredTasks,function(t){return"working_on_it"===t.status})),null==t&&(t=_.find(filteredTasks,function(t){return"not_started"===t.status})),$scope.project.selectedTask=t):(t=_.find(filteredTasks,function(t){return"working_on_it"===t.status}),null==t&&(t=_.find(filteredTasks,function(t){return"redo"===t.status||"fix_and_resubmit"===t.status})),null==t&&(t=_.find(filteredTasks,function(t){return"not_started"===t.status})),$scope.project.selectedTask=t),null==$scope.project.selectedTask?$scope.project.selectedTask=filteredTasks[0]:void 0):$scope.project.selectedTask=null}}]}}),angular.module("doubtfire.projects",["doubtfire.projects.states","doubtfire.projects.project-viewer","doubtfire.projects.project-lab-list","doubtfire.projects.project-outcome-alignment","doubtfire.projects.project-portfolio-wizard","doubtfire.projects.project-progress-dashboard"]),angular.module("doubtfire.projects.states.feedback",[]).config(["$stateProvider",function($stateProvider){var projectsFeedbackStateData;return projectsFeedbackStateData={url:":viewing/:showTaskId",parent:"projects#show"},$stateProvider.state("projects#feedback",projectsFeedbackStateData)}]),angular.module("doubtfire.projects.states.show",[]).config(["headerServiceProvider",function(headerServiceProvider){var projectsShowStateData;return projectsShowStateData={url:"/projects/:projectId?unitRole",views:{main:{controller:"ProjectsShowCtrl",templateUrl:"projects/states/show/show.tpl.html"}},data:{pageTitle:"_Home_",roleWhitelist:["Student","Tutor","Convenor","Admin"]}},headerServiceProvider.state("projects#show",projectsShowStateData)}]).controller("ProjectsShowCtrl",["$scope","$stateParams","currentUser","UnitRole","Project","projectService","alertService","analyticsService",function($scope,$stateParams,currentUser,UnitRole,Project,projectService,alertService,analyticsService){return analyticsService.event("Student Project View","Started Viewing Project"),null!=$stateParams.authToken&&(currentUser.authenticationToken=$stateParams.authToken),null!=$stateParams.showTaskId&&($scope.showTaskId=parseInt($stateParams.showTaskId,10)),$scope.unitRole=$stateParams.unitRole,null!=$scope.unitRole?UnitRole.get({id:$scope.unitRole},function(response){return $scope.assessingUnitRole=response},function(){return $scope.assessingUnitRole=null,$scope.unitRole=null}):$scope.assessingUnitRole=null,$scope.project={project_id:$stateParams.projectId},$scope.unit=null,$scope.transitionWeekEnd=function(){return null!=$scope.project?Project.update({id:$scope.project.project_id,trigger:"trigger_week_end"},function(project){return projectService.updateTaskStats($scope.project,project.stats),_.each($scope.project.tasks,function(task){return task.status=_.filter(project.tasks,{task_definition_id:task.task_definition_id})[0].status}),alertService.add("success","Status updated.",2e3),analyticsService.event("Student Project View","Transitioned Week End")},function(response){return alertService.add("danger",response.data.error,6e3)}):void 0}}]),angular.module("doubtfire.projects.states",["doubtfire.projects.states.show","doubtfire.projects.states.feedback"]);var __indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};angular.module("doubtfire.sessions.auth",["doubtfire.sessions.auth.http-auth-injector","doubtfire.sessions.auth.roles"]).factory("auth",["$http","$cookieStore","$timeout","usernameCookie","currentUser","authRoles","localStorageService","doubtfireLoginTimeCookie","rememberDoubtfireCredentialsCookie","api","$rootScope",function($http,$cookieStore,$timeout,usernameCookie,currentUser,authRoles,localStorageService,doubtfireLoginTimeCookie,rememberDoubtfireCredentialsCookie,api,$rootScope){var auth,checkAuth,defaultAnonymousUser,delayTime,endTime,isValidRoleWhitelist,nowTime,saveCurrentUser,tryChangeUser,updateAuth;return defaultAnonymousUser=_.clone(currentUser),checkAuth=function(){return!_.isEqual(currentUser,defaultAnonymousUser)},saveCurrentUser=function(){return localStorageService.set(usernameCookie,currentUser),$cookieStore.put(usernameCookie,currentUser)},updateAuth=function(authenticationUrl){var remember;if(checkAuth())return remember=localStorageService.get(rememberDoubtfireCredentialsCookie),localStorageService.set(doubtfireLoginTimeCookie,(new Date).getTime()),$http.put(authenticationUrl,{username:currentUser.profile.username,remember:remember}).success(function(response){return currentUser.authenticationToken=response.auth_token,saveCurrentUser(),$timeout(function(){return updateAuth(api+"/auth/"+currentUser.authenticationToken+".json")},36e5)})},tryChangeUser=function(user){var prop,_ref;if(null!=user&&(_ref=user.role,__indexOf.call(authRoles,_ref)>=0)){for(prop in currentUser)delete currentUser[prop];return _.extend(currentUser,user),checkAuth()?saveCurrentUser():($cookieStore.remove(usernameCookie),localStorageService.remove(usernameCookie)),!0}return!1},isValidRoleWhitelist=function(roleWhitelist){return 0===_.difference(roleWhitelist,authRoles).length},tryChangeUser($cookieStore.get(usernameCookie))||tryChangeUser(localStorageService.get(usernameCookie)),auth={},auth.saveCurrentUser=saveCurrentUser,auth.isAuthenticated=checkAuth,auth.isAuthorised=function(roleWhitelist,role){return null==role&&(role=currentUser.role),null==roleWhitelist||isValidRoleWhitelist(roleWhitelist)&&__indexOf.call(roleWhitelist,role)>=0},auth.signIn=function(authenticationUrl,userCredentials,success,error){return null==success&&(success=function(){}),null==error&&(error=function(){}),$http.post(authenticationUrl,userCredentials).success(function(response){var user;return user={id:response.user.id,authenticationToken:response.auth_token,role:_.string.camelize(response.user.system_role),profile:response.user},$timeout(function(){return updateAuth(api+"/auth/"+currentUser.authenticationToken+".json")},36e5),tryChangeUser(user)?success():error()}).error(error)},auth.signOut=function(authenticationUrl){return $http["delete"](authenticationUrl),tryChangeUser(defaultAnonymousUser),$rootScope.$broadcast("signOut"),localStorageService.remove(usernameCookie),localStorageService.set(rememberDoubtfireCredentialsCookie,!1),localStorageService.remove(doubtfireLoginTimeCookie)},checkAuth()&&(nowTime=(new Date).getTime(),endTime=parseInt(localStorageService.get(doubtfireLoginTimeCookie),10)+36e5,delayTime=endTime-nowTime,100>delayTime&&(delayTime=100),$timeout(function(){return updateAuth(api+"/auth/"+currentUser.authenticationToken+".json")},delayTime)),auth}]),angular.module("doubtfire.sessions.auth.http-auth-injector",[]).config(["$httpProvider",function($httpProvider){return $httpProvider.interceptors.push(function($q,$rootScope,api,currentUser){var injectAuthForRequest,injectAuthForResponseWithError;return injectAuthForRequest=function(request){return _.string.startsWith(request.url,api)&&null!=currentUser.authenticationToken&&(_.has(request,"params")||(request.params={}),request.params.auth_token=currentUser.authenticationToken),request||$q.when(request)},injectAuthForResponseWithError=function(response){return response.config&&response.config.url&&_.string.startsWith(response.config.url,api)&&(419===response.status?$rootScope.$broadcast("tokenTimeout"):401===response.status&&$rootScope.$broadcast("unauthorisedRequestIntercepted")),$q.reject(response)},{request:injectAuthForRequest,responseError:injectAuthForResponseWithError}})}]),angular.module("doubtfire.sessions.auth.roles.if-role",[]).directive("ifRole",["auth",function(auth){return{restrict:"A",link:function(scope,element,attrs){var roleWhitelist;return roleWhitelist=_.string.words(attrs.ifRole),auth.isAuthorised(roleWhitelist)?void 0:element.remove()}}}]),angular.module("doubtfire.sessions.auth.roles",["doubtfire.sessions.auth.roles.if-role"]).constant("authRoles",["anon","Student","Tutor","Convenor","Admin"]),angular.module("doubtfire.sessions.cookies",[]).constant("usernameCookie","doubtfire_user").constant("rememberDoubtfireCredentialsCookie","remember_doubtfire_credentials_token").constant("doubtfireLoginTimeCookie","doubtfire_login_time"),angular.module("doubtfire.sessions.current-user",[]).constant("currentUser",{id:0,role:"anon",profile:{name:"Anonymous",nickname:"anon"}}),angular.module("doubtfire.sessions",["doubtfire.sessions.auth","doubtfire.sessions.cookies","doubtfire.sessions.current-user","doubtfire.sessions.states"]),angular.module("doubtfire.sessions.states.sign-in",[]).config(["$stateProvider",function($stateProvider){var signInStateData;return signInStateData={url:"/sign_in?dest&params",views:{main:{controller:"SignInCtrl",templateUrl:"sessions/states/sign-in/sign-in.tpl.html"}},data:{pageTitle:"_Sign In_"}},$stateProvider.state("sign_in",signInStateData)}]).controller("SignInCtrl",["$scope","$state","$stateParams","usernameCookie","$timeout","$modal","currentUser","auth","api","alertService","localStorageService","redirectService","rememberDoubtfireCredentialsCookie","doubtfireLoginTimeCookie","AboutDoubtfireModal",function($scope,$state,$stateParams,usernameCookie,$timeout,$modal,currentUser,auth,api,alertService,localStorageService,redirectService,rememberDoubtfireCredentialsCookie,doubtfireLoginTimeCookie,AboutDoubtfireModal){var ieVersion,isIE;return isIE=function(){return"Microsoft Internet Explorer"===window.navigator.appName},ieVersion=function(){var matches;return matches=new RegExp(" MSIE ([0-9].[0-9]);").exec(window.navigator.userAgent),null!=matches&&matches.length>1?parseInt(matches[1].replace(".0","")):!0},$scope.isIE=isIE()&&ieVersion()<11,$scope.session={remember_me:!0},angular.element(document).ready(function(){var a,aprilFools,h1,lead,logo,today;return today=new Date,aprilFools=1===today.getDate()&&3===today.getMonth(),aprilFools&&(h1=document.querySelector("#sign-in h1.logo"),logo=null!=h1?h1.querySelector("i"):void 0,null!=logo&&null!=h1)?(a=document.createElement("A"),a.href="http://www.imdb.com/title/tt0107614/",a.title="Mrs. Doubtfire (1993)",lead=document.createElement("P"),lead.appendChild(document.createTextNode("Happy April Fools Day! 🎉")),h1.classList.add("aprilfools"),h1.appendChild(a),h1.appendChild(lead),logo.style.backgroundImage='url("/assets/images/mrsdoubtfire.png")',logo.style.backgroundColor="inherit"):void 0}),$scope.openAboutModal=function(){return AboutDoubtfireModal.show()},auth.isAuthenticated()?redirectService.redirect("home",{}):$scope.signIn=function(){var signInFunc;return $scope.signingIn=!0,signInFunc=function(){var signInCredentials;return signInCredentials={username:$scope.session.username,password:$scope.session.password,remember:$scope.session.remember_me},auth.signIn(api+"/auth",signInCredentials,function(){return $scope.session.remember_me?(localStorageService.set(usernameCookie,currentUser),localStorageService.set(rememberDoubtfireCredentialsCookie,!0),localStorageService.set(doubtfireLoginTimeCookie,(new Date).getTime())):(localStorageService.remove(usernameCookie),localStorageService.set(rememberDoubtfireCredentialsCookie,!1),localStorageService.remove(doubtfireLoginTimeCookie)),alertService.clearAll(),redirectService.redirect("home",{})},function(response){var resetInvalidCreds;return $scope.session.password="",$scope.signingIn=!1,response.error?($scope.invalidCredentials=!0,resetInvalidCreds=function(){return $scope.invalidCredentials=!1},$timeout(resetInvalidCreds,300),alertService.add("warning","Login failed: "+response.error,6e3)):alertService.add("danger","Login failed: Unable to connect to server",6e3)})},$timeout(signInFunc,100)}}]),angular.module("doubtfire.sessions.states.sign-out",[]).config(["$stateProvider",function($stateProvider){var signOutStateData;return signOutStateData={url:"/sign_out",views:{main:{controller:"SignOutCtrl",templateUrl:"sessions/states/sign-out/sign-out.tpl.html"}},data:{pageTitle:"_Sign Out_"}},$stateProvider.state("sign_out",signOutStateData)}]).controller("SignOutCtrl",["$state","$timeout","auth","api","currentUser",function($state,$timeout,auth,api,currentUser){return auth.signOut(api+"/auth/"+currentUser.authenticationToken+".json")&&$timeout(function(){return $state.go("sign_in")},750),this}]),angular.module("doubtfire.sessions.states",["doubtfire.sessions.states.sign-in","doubtfire.sessions.states.sign-out"]),angular.module("doubtfire.tasks.modals.grade-task-modal",[]).factory("GradeTaskModal",["$modal",function($modal){var GradeTaskModal;return GradeTaskModal={},GradeTaskModal.show=function(task){return $modal.open({templateUrl:"tasks/modals/grade-task-modal/grade-task-modal.tpl.html",controller:"GradeTaskModal",resolve:{task:function(){return task}}})},GradeTaskModal}]).controller("GradeTaskModal",["$scope","$modalInstance","gradeService","task",function($scope,$modalInstance,gradeService,task){return $scope.task=task,$scope.data={desiredGrade:null},$scope.grades=gradeService.grades,$scope.dismiss=$modalInstance.dismiss,$scope.close=function(){return $modalInstance.close($scope.data.desiredGrade)}}]),angular.module("doubtfire.tasks.modals",["doubtfire.tasks.modals.grade-task-modal"]),angular.module("doubtfire.tasks.project-tasks-list",[]).directive("projectTasksList",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/project-tasks-list/project-tasks-list.tpl.html",scope:{unit:"=",project:"=",onSelect:"=",inMenu:"@"},controller:["$scope","$modal","taskService","groupService","analyticsService",function($scope,$modal,taskService,groupService,analyticsService){return analyticsService.event("Student Project View","Showed Task Button List"),$scope.statusClass=taskService.statusClass,$scope.statusText=taskService.statusText,$scope.taskDefinition=taskService.taskDefinitionFn($scope.unit),$scope.taskDisabled=function(task){return $scope.taskDefinition(task).target_grade>$scope.project.target_grade},$scope.groupSetName=function(id){return groupService.groupSetName(id,$scope.unit)},$scope.hideGroupSetName=0===$scope.unit.group_sets.length}]}}),angular.module("doubtfire.tasks.project-top-tasks-list",[]).directive("projectTopTasksList",function(){return{restrict:"E",templateUrl:"tasks/project-top-tasks-list/project-top-tasks-list.tpl.html",scope:{project:"=project",onSelect:"="},controller:["$scope","taskService","gradeService",function($scope,taskService,gradeService){var calculateTopTasks,now,refreshTopTasks,today,weekday;return $scope.statusText=taskService.statusText,$scope.statusData=taskService.statusData,$scope.statusClass=taskService.statusClass,$scope.statusIcon=function(status){return taskService.statusIcons[status]},now=new Date,weekday=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],today=weekday[now.getDay()],calculateTopTasks=function(input){var grade,overdueGradeTasks,overdueTasks,result,sortedTasks,tasksToDiscuss,toAdd,toAddGradeTasks,tutorialDay,_i,_j,_len,_len1,_ref,_ref1;if(result=[],sortedTasks=_.sortBy(_.sortBy(_.filter(input,function(task){return _.includes(taskService.validTopTask,task.status)}),"definition.seq"),"definition.start_date"),overdueTasks=_.filter(sortedTasks,function(task){return taskService.daysOverdue(task)>0}),tutorialDay=null!=$scope.project&&null!=$scope.project.tutorial?$scope.project.tutorial.meeting_day:"Monday",tasksToDiscuss=_.filter(overdueTasks,function(task){return _.includes(taskService.statusToDiscuss,task.status)}),null!=tasksToDiscuss&&tasksToDiscuss.length>0){if(today===tutorialDay&&(toAdd=_.map(tasksToDiscuss,function(task){return{task:task,reason:"Discuss this task with your tutor in class today."}}),Array.prototype.push.apply(result,toAdd)),_.size(result)>=5)return _.slice(result,0,5);overdueTasks=_.filter(overdueTasks,function(task){return!_.includes(tasksToDiscuss,task)})}for(_ref=gradeService.gradeValues,_i=0,_len=_ref.length;_len>_i&&(grade=_ref[_i],overdueGradeTasks=_.filter(overdueTasks,function(task){return task.definition.target_grade===grade}),null!=overdueGradeTasks&&overdueGradeTasks.length>0&&(toAdd=_.map(overdueGradeTasks,function(task){return{task:task,reason:"Complete this "+gradeService.grades[grade]+" task to get back on track."}}),Array.prototype.push.apply(result,toAdd)),!(result.length>=5));_i++);if(result.length>=5)return _.slice(result,0,5);for(toAdd=_.filter(sortedTasks,function(task){return _.includes(taskService.toBeWorkedOn,task.status)&&taskService.daysFromTarget(task)<=0}),_ref1=gradeService.gradeValues,_j=0,_len1=_ref1.length;_len1>_j;_j++)grade=_ref1[_j],toAddGradeTasks=_.map(_.filter(toAdd,function(task){return task.definition.target_grade===grade}),function(task){return{task:task,reason:"This is one of the next tasks for you to complete."}}),Array.prototype.push.apply(result,toAddGradeTasks);return _.slice(result,0,5)},$scope.topTasks=[],refreshTopTasks=function(){return $scope.topTasks.length=0,$scope.topTasks=calculateTopTasks($scope.project.activeTasks())},$scope.$watch("project.target_grade",refreshTopTasks),$scope.$watch("project.tasks",refreshTopTasks),refreshTopTasks()}]}}),angular.module("doubtfire.tasks.stats",["doubtfire.tasks.stats.task-completion-stats","doubtfire.tasks.stats.task-status-stats","doubtfire.tasks.stats.task-summary-stats"]),angular.module("doubtfire.tasks.stats.task-completion-stats",[]).directive("taskCompletionStats",function(){return{restrict:"E",templateUrl:"tasks/stats/task-completion-stats/task-completion-stats.tpl.html",scope:{unit:"="},controller:["$scope","Unit",function($scope,Unit){var overviewTutorial,_ref;return null==(null!=(_ref=$scope.unit.analytics)?_ref.taskCompletionStats:void 0)?Unit.taskCompletionStats.get({id:$scope.unit.id},function(response){return $scope.unit.analytics.taskCompletionStats=response,$scope.data=response.unit}):$scope.data=$scope.unit.analytics.taskCompletionStats.unit,overviewTutorial={id:-1,abbreviation:"Overview",tutor_name:"All Tutorials"},$scope.tutorialsForSelector=[overviewTutorial].concat($scope.unit.tutorials),$scope.switchToTutorial=function(tutorial){var _ref1;if(null!=(null!=(_ref1=$scope.unit.analytics)?_ref1.taskCompletionStats:void 0))return $scope.dataModel.selectedTutorial=tutorial,tutorial===overviewTutorial?($scope.data=$scope.unit.analytics.taskCompletionStats.tutorial,$scope.depth=1):($scope.data=$scope.unit.analytics.taskCompletionStats.tutorial[tutorial.id],$scope.depth=0)},$scope.drillDown=function(){return $scope.dataModel.selectedType="tutorial",$scope.switchToTutorial(overviewTutorial)},$scope.dataModel={selectedType:"unit",selectedTutorial:overviewTutorial},$scope.depth=0,$scope.$watch("dataModel.selectedType",function(newValue){var _ref1;return null!=(null!=(_ref1=$scope.unit.analytics)?_ref1.taskCompletionStats:void 0)&&($scope.data=$scope.unit.analytics.taskCompletionStats[newValue]),"tutorial"===newValue?$scope.switchToTutorial(overviewTutorial):$scope.depth=0}),$scope.$watch("dataModel.selectedTutorial",$scope.switchToTutorial)}]}}),angular.module("doubtfire.tasks.stats.task-status-stats",[]).directive("taskStatusStats",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/stats/task-status-stats/task-status-stats.tpl.html",scope:{unit:"="},controller:["$scope","$filter","Unit","taskService",function($scope,$filter,Unit,taskService){var userChange,userChangeType;return $scope.dataModel={},$scope.depth=0,$scope.overviewSelectors={task:{text:"Overview of tasks",seq:-1,id:-1},tutorial:{text:"Overview of tutorials",abbreviation:"ZZZ",id:-1}},$scope.tasksForSelector=[$scope.overviewSelectors.task],_.each($scope.unit.task_definitions,function(td){return $scope.tasksForSelector.push({text:td.abbreviation+" - "+td.name,id:td.id,seq:td.seq,abbreviation:td.abbreviation,name:td.name})}),$scope.tutorialsForSelector=[],_.each($scope.unit.tutorials,function(t){return $scope.tutorialsForSelector.push({text:t.abbreviation+" - "+t.tutor_name,id:t.id,meeting_time:t.meeting_time,tutor_name:t.tutor_name,abbreviation:t.abbreviation})}),$scope.tutorialsForSelector.push($scope.overviewSelectors.tutorial),null==$scope.unit.analytics.taskStatusCountByTutorial?Unit.taskStatusCountByTutorial.get({id:$scope.unit.id},function(response){var test;return delete response.$promise,delete response.$resolved,$scope.unit.analytics.taskStatusCountByTutorial=response,$scope.dataModel.selectedType="unit",test=$scope.switchToTasksForTutorial()}):$scope.dataModel.selectedType="unit",userChange=!0,userChangeType=!0,$scope.$watch("dataModel.selectedType",function(newValue){if(!userChangeType)return void(userChangeType=!0);if($scope.dataModel.selectedTutorial=null,$scope.dataModel.selectedTask=null,$scope.depth=0,null!=newValue)switch(newValue){case"unit":return $scope.data=$scope.reduceDataToOverall();case"tutorial":return $scope.dataModel.selectedTutorial=$scope.overviewSelectors.tutorial;case"task":return $scope.dataModel.selectedTask=$scope.overviewSelectors.task}}),$scope.$watch("dataModel.selectedTutorial",function(newValue){return null!=newValue?userChange?newValue.id>=0?($scope.depth=0,$scope.data=$scope.reduceDataToTutorialWithId(newValue)):($scope.depth=1,$scope.data=$scope.reduceDataToTutorial(),$scope.overviewKeys=_.map($scope.unit.tutorials,function(t){return{subtitle:""+t.tutor_name+" at "+$filter("date")(t.meeting_time,"shortTime"),title:t.abbreviation,data:$scope.data[t.id],show:_.keys($scope.data[t.id]).length>0,tutorial:t}
})):void(userChange=!0):void 0}),$scope.$watch("dataModel.selectedTask",function(newValue){return null!=newValue?userChange?newValue.id>=0?($scope.depth=0,$scope.data=$scope.reduceDataToTaskDefWithId(newValue)):($scope.depth=1,$scope.data=$scope.reduceDataToTaskDef(),$scope.overviewKeys=_.map($scope.unit.task_definitions,function(td){return{title:td.abbreviation,subtitle:td.name,data:$scope.data[td.id],show:_.keys($scope.data[td.id]).length>0,task:td}})):void(userChange=!0):void 0}),$scope.$watch("data",function(newValue){var completedPct,total;if(null!=newValue)return total=_.chain(newValue).values().reduce(function(memo,num){return memo+num},0).value(),completedPct=newValue[taskService.acronymKey.COM]/total,$scope.completeStats=null==completedPct||isNaN(completedPct)?{completed:0,left:100}:{completed:Math.round(100*completedPct),left:Math.round(100*(1-completedPct))}}),$scope.drillToTask=function(task){return 0===$scope.depth||2===$scope.depth?(userChangeType=!1,userChange=2===$scope.depth,$scope.dataModel.selectedType="task",$scope.dataModel.selectedTutorial=null,$scope.dataModel.selectedTask=task):(userChangeType=userChange=!1,$scope.drillDown(task))},$scope.drillToTutorial=function(tutorial){return 0===$scope.depth||2===$scope.depth?(userChangeType=!1,userChange=2===$scope.depth,$scope.dataModel.selectedType="tutorial",$scope.dataModel.selectedTask=null,$scope.dataModel.selectedTutorial=tutorial):(userChangeType=userChange=!1,$scope.drillDown(tutorial))},$scope.drillDown=function(focus){var target;switch($scope.dataModel.selectedType){case"unit":return $scope.dataModel.selectedType="tutorial";case"tutorial":return $scope.depth=2,null!=focus?($scope.dataModel.selectedTutorial=focus,target=focus):target=$scope.dataModel.selectedTutorial,$scope.data=$scope.switchToTasksForTutorial()[target.id],$scope.overviewKeys=_.map($scope.unit.task_definitions,function(td){return{data:$scope.data[td.id],show:_.keys($scope.data[td.id]).length>0,task:td,title:td.abbreviation,subtitle:td.name}});case"task":return $scope.depth=2,null!=focus?($scope.dataModel.selectedTask=focus,target=focus):target=$scope.dataModel.selectedTask,$scope.data=$scope.switchToTutorialsForTask()[target.id],$scope.overviewKeys=_.map($scope.unit.tutorials,function(t){return{data:$scope.data[t.id],show:_.keys($scope.data[t.id]).length>0,tutorial:t,title:t.abbreviation,subtitle:""+t.tutor_name+" at "+$filter("date")(t.meeting_time,"shortTime")}})}},$scope.resetToOverview=function(){switch($scope.dataModel.selectedType){case"unit":return;case"tutorial":$scope.dataModel.selectedTutorial=$scope.overviewSelectors.tutorial;break;case"task":$scope.dataModel.selectedTask=$scope.overviewSelectors.task}return drillDown()},$scope.switchToTasksForTutorial=function(){var result;return result={},result[""]={},_.each($scope.unit.task_definitions,function(td){return result[""][td.id]={}}),_.each($scope.unit.tutorials,function(tutorial){return result[tutorial.id]={},_.each($scope.unit.task_definitions,function(td){return result[tutorial.id][td.id]={}})}),_.each($scope.unit.analytics.taskStatusCountByTutorial,function(taskDef,taskDefId){return _.each(taskDef,function(stats,tutorialId){return _.each(stats,function(value){return result[tutorialId][taskDefId][value.status]=value.num})})}),result},$scope.switchToTutorialsForTask=function(){var result;return result={},_.each($scope.unit.task_definitions,function(td){return result[td.id]={},_.each($scope.unit.tutorials,function(tutorial){return result[td.id][tutorial.id]={}}),result[td.id][""]={}}),_.each($scope.unit.analytics.taskStatusCountByTutorial,function(taskDef,taskDefId){return _.each(taskDef,function(stats,tutorialId){return _.each(stats,function(value){return result[taskDefId][tutorialId][value.status]=value.num})})}),result},$scope.reduceDataToTaskDef=function(){return _.chain($scope.unit.analytics.taskStatusCountByTutorial).map(function(taskDef,taskDefId){var statusesForThisTaskDefId;return statusesForThisTaskDefId=_.chain(taskDef).values().flatten().groupBy("status").map(function(value,status){var sumOfStatuses;return sumOfStatuses=_.chain(value).map(function(value){return value.num}).reduce(function(memo,num){return memo+num},0).value(),[status,sumOfStatuses]}).fromPairs().value(),[taskDefId,statusesForThisTaskDefId]}).fromPairs().value()},$scope.reduceDataToTaskDefWithId=function(taskDef){return $scope.reduceDataToTaskDef()[taskDef.id]},$scope.reduceDataToOverall=function(){var taskDefValues;return taskDefValues=_.values($scope.reduceDataToTaskDef()),_.reduce(taskDefValues,function(memo,taskDef){var status;for(status in taskDef)memo[status]=(status in memo?memo[status]:0)+taskDef[status];return memo},{})},$scope.reduceDataToTutorial=function(){var data,statuses,taskDef,tutorialData,tutorialId,tutorialStatuses,_i,_len,_ref;data={},_ref=$scope.unit.analytics.taskStatusCountByTutorial;for(taskDef in _ref){tutorialData=_ref[taskDef];for(tutorialId in tutorialData)for(tutorialStatuses=tutorialData[tutorialId],null==data[tutorialId]&&(data[tutorialId]={}),_i=0,_len=tutorialStatuses.length;_len>_i;_i++)statuses=tutorialStatuses[_i],null==data[tutorialId][statuses.status]&&(data[tutorialId][statuses.status]=0),data[tutorialId][statuses.status]+=statuses.num}return data},$scope.reduceDataToTutorialWithId=function(tutorial){return $scope.reduceDataToTutorial()[tutorial.id]}}]}}),angular.module("doubtfire.tasks.stats.task-summary-stats",[]).directive("taskSummaryStats",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/stats/task-summary-stats/task-summary-stats.tpl.html",scope:{unit:"=unit"},controller:["$scope","$modal","Task","taskService","TaskCompletionCsv",function($scope,$modal,Task,taskService,TaskCompletionCsv){var indexOfTask,indexOfTutorial,numStudents,taskIDs;return $scope.statusClass=taskService.statusClass,$scope.statusText=taskService.statusText,$scope.headerRow=taskService.allStatusData(),$scope.scatterData=[],taskIDs=_.map($scope.unit.task_definitions,function(td){return td.id}),indexOfTask=function(task_definition_id){return _.indexOf(taskIDs,task_definition_id)},indexOfTutorial=function(tutorialId){return _.indexOf($scope.unit.tutorials,_.find($scope.unit.tutorials,function(tutorial){return tutorial.id===tutorialId}))},angular.forEach($scope.unit.tutorials,function(tute){var tutorial;return tutorial={key:tute.abbreviation}}),numStudents=0,$scope.countClass=function(count){return 0===numStudents?"":count/numStudents>.5?"warning":count/numStudents>.25?"info":""},$scope.fetchCSV=function(){return TaskCompletionCsv.downloadFile($scope.unit)},$scope.fetchStats=function(){var tmpScatterData,updateTask;return numStudents=$scope.unit.students.length,0!==numStudents?(tmpScatterData=[],updateTask=function(task_definition_id,status,tutorialId){var statusIdx,taskIdx,tutorialIdx;return tutorialIdx=indexOfTutorial(tutorialId),taskIdx=indexOfTask(task_definition_id),statusIdx=taskService.indexOf(status),tmpScatterData[tutorialIdx][statusIdx][taskIdx]+=1,tmpScatterData[tutorialIdx][0][taskIdx]-=1},angular.forEach($scope.unit.tutorials,function(tute){var tutorialData;return tutorialData=[],angular.forEach(taskService.statusKeys,function(sk){var col;return col=[],angular.forEach($scope.unit.task_definitions,function(){return col.push(sk===taskService.statusKeys[0]?tute.num_students:0)}),tutorialData.push(col)}),tmpScatterData.push(tutorialData)}),Task.summaryData.query({unit_id:$scope.unit.id},function(tasks){var scatterData;return angular.forEach(tasks,function(task){return updateTask(task.task_definition_id,task.status,task.tutorial_id)}),_.each(tmpScatterData,function(tute,tuteIdx){return _.each(tute,function(row,colIdx){return _.each(row,function(val,idx){return tmpScatterData[tuteIdx][colIdx][idx]/=numStudents})})}),scatterData=[],_.each($scope.unit.tutorials,function(tute,tuteIdx){var tutorial;return tutorial={key:tute.abbreviation,values:[]},_.each(tmpScatterData[tuteIdx],function(col,statusIdx){return _.each(col,function(val,taskIdx){var data;return val>0?(data={x:statusIdx+tuteIdx/(2*$scope.unit.tutorials.length),y:taskIdx,size:val},tutorial.values.push(data)):void 0})}),scatterData.push(tutorial)}),$scope.scatterData=scatterData})):void 0},$scope.fetchStats()}]}}),angular.module("doubtfire.tasks.task-comments-viewer",[]).directive("taskCommentsViewer",function(){return{restrict:"E",templateUrl:"tasks/task-comments-viewer/task-comments-viewer.tpl.html",scope:{project:"=",task:"=",comment:"=?"},controller:["$scope","$modal","$state","TaskFeedback","TaskComment","Task","Project","taskService","alertService","projectService","analyticsService",function($scope,$modal,$state,TaskFeedback,TaskComment,Task,Project,taskService,alertService,projectService,analyticsService){var fetchTaskComments,_ref;return $scope.currentPage=1,$scope.pageSize=3,$scope.maxSize=5,_.isString(null!=(_ref=$scope.comment)?_ref.text:void 0)||($scope.comment={text:""}),$scope.$watch("task",function(newTask){return fetchTaskComments(newTask)}),fetchTaskComments=function(task){return TaskComment.query({project_id:$scope.project.project_id,task_definition_id:task.task_definition_id},function(response){return task.comments=response,$scope.currentPage=1})},$scope.checkForEnterPress=function($event){var ENTER_KEY;return ENTER_KEY=13,$event.which!==ENTER_KEY||$event.shiftKey?void 0:(0!==$scope.comment.text.trim().length&&$scope.addComment(),!1)},$scope.addComment=function(){return taskService.addComment($scope.task,$scope.comment.text,function(){return $scope.comment.text="",analyticsService.event("View Task Comments","Added new comment")},function(response){return alertService.add("danger",response.data.error,2e3)})},$scope.deleteComment=function(id){return TaskComment["delete"]({project_id:$scope.project.project_id,task_definition_id:$scope.task.task_definition_id,id:id},function(){return $scope.task.comments=$scope.task.comments.filter(function(e){return e.id!==id}),analyticsService.event("View Task Comments","Deleted existing comment")},function(response){return alertService.add("danger",response.data.error,2e3)})}}]}}),angular.module("doubtfire.tasks.task-definition-editor",[]).directive("taskDefinitionEditor",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/task-definition-editor/task-definition-editor.tpl.html",scope:{unit:"=",task:"=",isNew:"="},controller:["$scope","$filter","taskService","gradeService","TaskDefinition","alertService","Unit","Task","ProgressModal",function($scope,$filter,taskService,gradeService,TaskDefinition,alertService,Unit,Task,ProgressModal){var populate_task;return $scope.grades=gradeService.grades,$scope.targetPicker={open:!1},$scope.duePicker={open:!1},$scope.startPicker={open:!1},$scope.taskAdmin={tabsData:{taskSheet:{title:"Task Description",subtitle:"Provide the descriptive details for this task",icon:"fa-info",seq:0,active:!1},fileUpload:{title:"Submission Details",subtitle:"Indicate what files students need to submit for this task",icon:"fa-upload",seq:1,active:!1},taskResources:{title:"Task Resources",subtitle:"Upload the task sheet and other resources for this task",icon:"fa-file-o",seq:2,active:!1},plagiarismChecks:{title:"Plagiarism Detection",subtitle:"Add plagiarism checks for this task",icon:"fa-eye",seq:4,active:!1}}},$scope.taskSheet={file:{name:"Task Sheet",type:"document"}},$scope.taskSheetUploadUrl=function(){return Unit.taskSheetUploadUrl($scope.unit,$scope.task)},$scope.onTaskSheetSuccess=function(){return alertService.add("success","Task sheet uploaded",2e3),$scope.task.has_task_pdf=!0},$scope.taskPDFUrl=function(){return Task.getTaskPDFUrl($scope.unit,$scope.task)},$scope.taskResources={file:{name:"Task Resources",type:"zip"}},$scope.taskResourcesUploadUrl=function(){return Unit.taskResourcesUploadUrl($scope.unit,$scope.task)},$scope.onTaskResourcesSuccess=function(){return alertService.add("success","Task sheet uploaded",2e3),$scope.task.has_task_resources=!0},$scope.resourceUrl=function(){return Task.getTaskResourcesUrl($scope.unit,$scope.task)},$scope.setActiveTab=function(tab){return tab!==$scope.activeTab?(null!=$scope.activeTab&&($scope.activeTab.active=!1),$scope.activeTab=tab,$scope.activeTab.active=!0):void 0},$scope.isActiveTab=function(tab){return tab===$scope.activeTab},$scope.setActiveTab($scope.taskAdmin.tabsData.taskSheet),$scope.open=function($event,pickerData){return $event.preventDefault(),$event.stopPropagation(),pickerData.open||($scope.targetPicker.open=!1,$scope.duePicker.open=!1,$scope.startPicker.open=!1),pickerData.open=!pickerData.open},$scope.addUpReq=function(){var newLength,newUpReq;return newLength=$scope.task.upload_requirements.length+1,newUpReq={key:"file"+(newLength-1),name:"",type:"code",language:"Pascal"},$scope.task.upload_requirements.push(newUpReq)},$scope.removeUpReq=function(upReq){return $scope.task.upload_requirements=$scope.task.upload_requirements.filter(function(anUpReq){return anUpReq.key!==upReq.key})},$scope.addCheck=function(){var newCheck,newLength;return newLength=$scope.task.plagiarism_checks.length+1,newCheck={key:"check"+(newLength-1),pattern:"",type:""},$scope.task.plagiarism_checks.push(newCheck)},$scope.removeCheck=function(check){return $scope.task.plagiarism_checks=$scope.task.plagiarism_checks.filter(function(aCheck){return aCheck.key!==check.key})},populate_task=function(oldTask,newTask){return _.extend(oldTask,newTask),newTask.weighting?oldTask.weight=newTask.weighting:void 0},$scope.deleteTask=function(){return taskService.deleteTask($scope.task,$scope.unit,null)},$scope.saveTask=function(){var due,promise,task,tgt;return task={},_.extend(task,$scope.task),task.weighting=$scope.task.weight,task.unit_id=$scope.unit.id,task.upload_requirements=JSON.stringify($scope.task.upload_requirements),task.plagiarism_checks=JSON.stringify($scope.task.plagiarism_checks),task.group_set_id=task.group_set?task.group_set.id:-1,task.target_date&&task.target_date.getMonth&&(tgt=task.target_date,task.target_date=""+tgt.getFullYear()+"-"+(tgt.getMonth()+1)+"-"+tgt.getDate()),task.start_date&&task.start_date.getMonth&&(tgt=task.start_date,task.start_date=""+tgt.getFullYear()+"-"+(tgt.getMonth()+1)+"-"+tgt.getDate()),task.due_date&&task.due_date.getMonth&&(due=task.due_date,task.due_date=""+due.getFullYear()+"-"+(due.getMonth()+1)+"-"+due.getDate()),$scope.isNew?(promise=TaskDefinition.create({task_def:task}).$promise,ProgressModal.show("Task Definition Creation","Please wait while student projects are updated.",promise),promise.then(function(response){return $scope.unit.task_definitions.push(response),alertService.add("success",""+response.name+" Added",2e3)},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):void 0})):TaskDefinition.update({id:task.id,task_def:task}).$promise.then(function(response){return populate_task($scope.task,response),alertService.add("success",""+response.name+" Updated",2e3)},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):void 0})}}]}}),angular.module("doubtfire.tasks.task-definition-selector",[]).directive("taskDefinitionSelector",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/task-definition-selector/task-definition-selector.tpl.html",scope:{unit:"=",onSelectDefinition:"=",buttonStyle:"@"},controller:["$scope","groupService",function($scope,groupService){return $scope.buttonStyle=null!=$scope.buttonStyle?$scope.buttonStyle:"primary",$scope.groupSetName=function(id){return groupService.groupSetName(id,$scope.unit)},$scope.hideGroupSetName=0===$scope.unit.group_sets.length,$scope.selectedDefinition=null,$scope.setSelectedDefinition=function(taskDef){return $scope.selectedDefinition=taskDef,null!=$scope.onSelectDefinition&&_.isFunction($scope.onSelectDefinition)?$scope.onSelectDefinition(taskDef):void 0}}]}}),angular.module("doubtfire.tasks.task-feedback-assessor-list",[]).directive("taskFeedbackAssessorList",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/task-feedback-assessor-list/task-feedback-assessor-list.tpl.html",scope:{unit:"=unit",context:"=context",assessingUnitRole:"=assessingUnitRole"},controller:["$scope","$filter","Unit","UnitMarkSubmissionsOfflineModal","currentUser","alertService","gradeService","taskService","unitService","analyticsService",function($scope,$filter,Unit,UnitMarkSubmissionsOfflineModal,currentUser,alertService,gradeService,taskService,unitService,analyticsService){var category,searchObj;return"assess"===$scope.context?($scope.title="Tasks Requring Feedback",$scope.statusFilter="ready_to_mark",$scope.taskPageSize=5,category="Teacher View - Feedback Tab"):($scope.title="Selected Task",$scope.statusFilter=null,$scope.taskPageSize=5,category="Teacher View - Tasks Tab"),$scope.search="",$scope.unitService=unitService,$scope.viewOptions={showPdf:!0,showComments:!0,showClassify:!0},$scope.$watch("viewOptions.showPdf",function(newVal,oldVal){return newVal!==oldVal?analyticsService.event(category,""+($scope.viewOptions.showPdf?"Showed":"Hid")+" submission PDF"):void 0}),$scope.$watch("viewOptions.showComments",function(newVal,oldVal){return newVal!==oldVal?analyticsService.event(category,""+($scope.viewOptions.showComments?"Showed":"Hid")+" Comments"):void 0}),$scope.$watch("viewOptions.showClassify",function(newVal,oldVal){return newVal!==oldVal?analyticsService.event(category,""+($scope.viewOptions.showClassify?"Showed":"Hid")+" Classify Buttons"):void 0}),analyticsService.watchEvent($scope,"sortOrder",category),analyticsService.watchEvent($scope,"statusFilter",category),analyticsService.watchEvent($scope,"fullscreen",category,function(newVal){return newVal?"Show Fullscreen":"Hide Fullscreen"}),analyticsService.watchEvent($scope,"studentFilter",category),analyticsService.watchEvent($scope,"taskCurrentPage",category,"Selected Page"),searchObj=function(obj,value,searched){return _.some(_.keys(obj),function(key){var actual,expected;if(_.isObject(obj[key])){if(_.includes(searched,obj[key]))return!1;if(searched.push(obj[key]),searchObj(obj[key],value,searched))return!0}else if(actual=(""+obj[key]).toLowerCase(),expected=(""+value).toLowerCase(),actual.indexOf(expected)>-1)return!0;return!1})},$scope.searchIncProject=function(item){var itemWithProj;return 0===$scope.search.length?!0:(itemWithProj=_.extend({},item,{project:item.project()}),searchObj(itemWithProj,$scope.search,[]))},$scope.tutorName=currentUser.profile.name,$scope.studentFilter="myStudents",$scope.taskCurrentPage=1,$scope.taskMaxSize=5,$scope.fullscreen=!1,$scope.refreshed=!1,$scope.activeTask=null,$scope.statusText=taskService.statusText,$scope.statusData=taskService.statusData,$scope.statusClass=taskService.statusClass,$scope.statusIcon=function(status){return taskService.statusIcons[status]},$scope.viewTask=function(task){return analyticsService.event(category,"Selected Task"),$scope.activeTask=task},$scope.onStatusUpdate=function(){return $scope.activeTask=null},$scope.tasksForFeedback=[],$scope.selectedDefinition=null,$scope.refreshTasksForSingleDef=function(){return $scope.refreshed=!1,null!=$scope.selectedDefinition?Unit.tasksForDefinition.query({id:$scope.unit.id,task_def_id:$scope.selectedDefinition.id},function(response){var tasks;return $scope.refreshed=!0,$scope.tasksForFeedback.length=0,tasks=$scope.unit.incorporateTasks(response),tasks=$scope.unit.fillWithUnStartedTasks(tasks,$scope.selectedDefinition),$scope.tasksForFeedback=_.extend($scope.tasksForFeedback,tasks)},function(response){return alertService.add("danger",response.data.error,6e3)}):void 0},$scope.onSelectDefinition=function(taskDef){return taskDef!==$scope.selectedDefinition?($scope.activeTask=null,$scope.selectedDefinition=taskDef,$scope.refreshTasksForSingleDef(),analyticsService.event(category,"Selected Task Definition")):void 0},$scope.refreshTasksForFeedback=function(){return $scope.refreshed=!1,Unit.tasksRequiringFeedback.query({id:$scope.unit.id},function(response){var tasks;return $scope.refreshed=!0,$scope.tasksForFeedback.length=0,tasks=$scope.unit.incorporateTasks(response),$scope.tasksForFeedback=_.extend($scope.tasksForFeedback,tasks)},function(response){return alertService.add("danger",response.data.error,6e3)})},$scope.refreshTasks=function(){return"assess"===$scope.context?$scope.refreshTasksForFeedback():$scope.refreshTasksForSingleDef()},$scope.$watch("unit.students",function(){var filteredStudents;return filteredStudents=$filter("showStudents")($scope.unit.students,"myStudents",$scope.tutorName),null!=filteredStudents&&0===filteredStudents.length&&($scope.studentFilter="allStudents"),$scope.refreshTasks()}),$scope.showMarkOfflineModal=function(){return analyticsService.event(category,"Showed Offline Modal"),UnitMarkSubmissionsOfflineModal.show($scope.unit)}}]}}),angular.module("doubtfire.tasks.task-feedback-assessor",[]).directive("taskFeedbackAssessor",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/task-feedback-assessor/task-feedback-assessor.tpl.html",scope:{task:"=task",unit:"=unit",assessingUnitRole:"=assessingUnitRole",unitRole:"=unitRole",onStatusUpdate:"=onStatusUpdate",viewOptions:"="},controller:["$scope","taskService",function($scope,taskService){return $scope.comment={text:""},$scope.triggerTransition=function(status){return $scope.comment.text.length>0&&taskService.addComment($scope.task,$scope.comment.text,function(){return $scope.comment.text=""}),taskService.updateTaskStatus($scope.unit,$scope.task.project(),$scope.task,status)},null!=$scope.onStatusUpdate&&_.isFunction($scope.onStatusUpdate)?$scope.$on("TaskStatusUpdated",function(event,args){return $scope.onStatusUpdate(args.status)}):void 0}]}}),angular.module("doubtfire.tasks.task-ilo-alignment.modals.task-ilo-alignment-modal",[]).factory("TaskILOAlignmentModal",["$modal",function($modal){var TaskILOAlignmentModal;return TaskILOAlignmentModal={},TaskILOAlignmentModal.show=function(task,ilo,alignment,unit,project,source){return $modal.open({controller:"TaskILOAlignmentModalCtrl",templateUrl:"tasks/task-ilo-alignment/modals/task-ilo-alignment-modal/task-ilo-alignment-modal.tpl.html",resolve:{task:function(){return task},ilo:function(){return ilo},alignment:function(){return alignment},unit:function(){return unit},project:function(){return project},source:function(){return source}}})},TaskILOAlignmentModal}]).controller("TaskILOAlignmentModalCtrl",["$scope","$rootScope","$modalInstance","LearningAlignments","alertService","projectService","task","ilo","alignment","unit","project","source",function($scope,$rootScope,$modalInstance,LearningAlignments,alertService,projectService,task,ilo,alignment,unit,project,source){var addAlignment,updateAlignment,updateRequest;return $scope.source=source,$scope.unit=unit,$scope.task=task,$scope.ilo=ilo,$scope.alignment=alignment,$scope.project=project,$scope.project&&(updateRequest=function(data){return data.task_id=projectService.taskFromTaskDefId($scope.project,data.task_definition_id).id}),$scope.editingRationale=!1,$scope.toggleEditRationale=function(){return $scope.editingRationale&&updateAlignment(),$scope.editingRationale=!$scope.editingRationale},$scope.removeAlignmentItem=function(){var data;return data=_.extend({unit_id:$scope.unit.id},$scope.alignment),LearningAlignments["delete"](data,function(){var indexToDelete;return indexToDelete=$scope.source.task_outcome_alignments.indexOf(_.find($scope.source.task_outcome_alignments,{id:$scope.alignment.id})),$scope.source.task_outcome_alignments.splice(indexToDelete,1),$scope.alignment=void 0,$rootScope.$broadcast("UpdateAlignmentChart",data,{remove:!0})},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):void 0})},updateAlignment=function(){var data;return data=_.extend({unit_id:$scope.unit.id},$scope.alignment),LearningAlignments.update(data,function(response){return alertService.add("success","Task - Outcome alignment rating saved",2e3),$rootScope.$broadcast("UpdateAlignmentChart",response,{updated:!0})},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):void 0})},addAlignment=function(){var data;return $scope.alignment=data={unit_id:$scope.unit.id,learning_outcome_id:$scope.ilo.id,task_definition_id:$scope.task.definition.id,rating:$scope.alignment.rating,description:null},$scope.project&&(data.project_id=$scope.project.project_id,updateRequest(data)),LearningAlignments.create(data,function(response){return $scope.alignment.id=response.id,$scope.source.task_outcome_alignments.push($scope.alignment),$rootScope.$broadcast("UpdateAlignmentChart",response,{created:!0})},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):void 0})},$scope.updateRating=function(alignment){return null==$scope.alignment.id?addAlignment(alignment):updateAlignment(alignment)},$scope.closeModal=function(){return $scope.editingRationale&&$scope.updateRating($scope.alignment),$modalInstance.close($scope.alignment)}}]),angular.module("doubtfire.tasks.task-ilo-alignment.modals",["doubtfire.tasks.task-ilo-alignment.modals.task-ilo-alignment-modal"]),angular.module("doubtfire.tasks.task-ilo-alignment.task-ilo-alignment-editor",[]).directive("taskIloAlignmentEditor",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/task-ilo-alignment/task-ilo-alignment-editor/task-ilo-alignment-editor.tpl.html",scope:{unit:"=",project:"=?",showCsv:"=",hidePanel:"=?",showIncludeTasks:"=?"},controller:["$scope","$modal","$rootScope","$filter","currentUser","unitService","alertService","gradeService","LearningAlignments","projectService","taskService","Visualisation","TaskAlignment","Task","CsvResultModal","outcomeService","TaskILOAlignmentModal",function($scope,$modal,$rootScope,$filter,currentUser,unitService,alertService,gradeService,LearningAlignments,projectService,taskService,Visualisation,TaskAlignment,Task,CsvResultModal,outcomeService,TaskILOAlignmentModal){var alignments;return $scope.showTaskName=$scope.unit.ilos.length<5,$scope.showGraph=!1,$scope.closeGraph=function(){return $scope.showGraph=!1},null!=$scope.project?($scope.source=$scope.project,$scope.tasks=$scope.project.tasks,$scope.taskStatusFactor=outcomeService.projectTaskStatusFactor($scope.project)):($scope.source=$scope.unit,$scope.tasks=_.map($scope.unit.task_definitions,function(td){return{definition:td}}),$scope.taskStatusFactor=outcomeService.unitTaskStatusFactor()),alignments=[],$scope.$watch("source.task_outcome_alignments.length",function(){return null!=$scope.source.task_outcome_alignments?alignments=_.chain($scope.source.task_outcome_alignments).filter(function(d){return d.rating>0}).groupBy("task_definition_id").map(function(d,i){return d=_.chain(d).groupBy("learning_outcome_id").map(function(d,i){return[i,d[0]]}).fromPairs().value(),[i,d]}).fromPairs().value():void 0}),$scope.showAlignmentModal=function(task,ilo,alignment){return TaskILOAlignmentModal.show(task,ilo,alignment,$scope.unit,$scope.project,$scope.source)},$scope.alignmentForTaskAndIlo=function(task,ilo){var _ref;return null!=(_ref=alignments[task.definition.id])?_ref[ilo.id]:void 0},$scope.disableInclude=function(task){return $scope.unit.ilos.length>0?void 0===alignments[task.definition.id]:!1},$scope.includeTaskInPorfolio=function(task){return task.include_in_portfolio=!task.include_in_portfolio,Task.update({project_id:$scope.project.project_id,task_definition_id:task.definition.id,include_in_portfolio:task.include_in_portfolio},function(success){return task.include_in_portfolio=success.include_in_portfolio})},$scope.csvImportResponse={},$scope.taskAlignmentCSV={file:{name:"Task Outcome Link CSV",type:"csv"}},$scope.taskAlignmentCSVUploadUrl=function(){return null!=$scope.project?TaskAlignment.taskAlignmentCSVUploadUrl($scope.unit,$scope.project.project_id):TaskAlignment.taskAlignmentCSVUploadUrl($scope.unit,null)},$scope.isTaskCSVUploading=null,$scope.onTaskAlignmentCSVSuccess=function(response){return CsvResultModal.show("Task CSV upload results.",response),$rootScope.$broadcast("UpdateAlignmentChart",response,{batch:!0}),null!=$scope.project?$scope.project.refresh($scope.unit):$scope.unit.refresh()},$scope.onTaskAlignmentCSVComplete=function(){return $scope.isTaskCSVUploading=null},$scope.downloadTaskAlignmentCSV=function(){return null!=$scope.project?TaskAlignment.downloadCSV($scope.unit,$scope.project.project_id):TaskAlignment.downloadCSV($scope.unit,null)}}]}}),angular.module("doubtfire.tasks.task-ilo-alignment.task-ilo-alignment-rater",[]).directive("taskIloAlignmentRater",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/task-ilo-alignment/task-ilo-alignment-rater/task-ilo-alignment-rater.tpl.html",scope:{readonly:"=?",ngModel:"=",unit:"=",onRatingChanged:"=?",tooltips:"=?",colorful:"=?",selectedTooltip:"=?",showTooltips:"=?",compact:"=?"},controller:["$scope",function($scope){var property,_i,_len,_ref;for($scope.max=5,$scope.compact&&($scope.readonly=!0),$scope.tooltips=["The task is slightly related to this outcome","The task is related to this outcome","The task is a reasonable example for this outcome","The task is a strong example of this outcome","The task is the best example of this outcome"],$scope.setHoverValue=function(value){return $scope.readonly&&!$scope.showTooltips?$scope.ngModel:$scope.hoveringOver=value},_ref=["tooltips","colorful","selectedTooltip"],_i=0,_len=_ref.length;_len>_i;_i++)property=_ref[_i],$scope[property]=null!=$scope[property]?$scope[property]:!0;return $scope.showTooltips=null!=$scope.showTooltips?$scope.showTooltips:!1,null!=$scope.onRatingChanged?$scope.$watch("ngModel.rating",function(newValue,oldValue){return null!=newValue&&newValue!==oldValue?$scope.onRatingChanged($scope.ngModel):void 0}):void 0}]}}),angular.module("doubtfire.tasks.task-ilo-alignment.task-ilo-alignment-viewer",[]).directive("taskIloAlignmentViewer",function(){return{restrict:"E",replace:!0,templateUrl:"tasks/task-ilo-alignment/task-ilo-alignment-viewer/task-ilo-alignment-viewer.tpl.html",scope:{currentProgress:"=?",classStats:"=?",project:"=?",task:"=?",unit:"=",alignments:"=?",summaryOnly:"=?",hideVisualisation:"=?"},controller:["$scope","Visualisation","outcomeService","analyticsService",function($scope,Visualisation,outcomeService,analyticsService){return $scope.hideVisualisation=null!=$scope.hideVisualisation?$scope.hideVisualisation:!1,$scope.targets=outcomeService.calculateTargets($scope.unit,$scope.unit,outcomeService.unitTaskStatusFactor()),$scope.toggleExpanded=function(align){return align.expanded=!align.expanded,align.expanded?(analyticsService.event("Student Project View","Showed ILO Details"),Visualisation.refreshAll()):analyticsService.event("Student Project View","Hid ILO Details")},null==$scope.alignments&&($scope.alignments=$scope.unit.ilos),null!=$scope.project&&null!=$scope.task?($scope.classStats=outcomeService.calculateTaskPotentialContribution($scope.unit,$scope.project,$scope.task),$scope.currentProgress=outcomeService.calculateTaskContribution($scope.unit,$scope.project,$scope.task)):void 0}]}}),angular.module("doubtfire.tasks.task-ilo-alignment",["doubtfire.tasks.task-ilo-alignment.modals","doubtfire.tasks.task-ilo-alignment.task-ilo-alignment-editor","doubtfire.tasks.task-ilo-alignment.task-ilo-alignment-rater","doubtfire.tasks.task-ilo-alignment.task-ilo-alignment-viewer"]),angular.module("doubtfire.tasks.task-plagiarism-file-viewer",[]).directive("taskPlagiarismFileViewer",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/task-plagiarism-file-viewer/task-plagiarism-file-viewer.tpl.html",scope:{match:"=match"},controller:["$scope",function(){}]}}),angular.module("doubtfire.tasks.task-plagiarism-report-viewer",[]).directive("taskPlagiarismReportViewer",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/task-plagiarism-report-viewer/task-plagiarism-report-viewer.tpl.html",scope:{task:"=task"},controller:["$scope","TaskSimilarity",function($scope,TaskSimilarity){var _ref;
return $scope.match=1,$scope.similarityData=null,$scope.$watch("task",function(){return $scope.fetchSimilarity()}),$scope.$watch("match",function(){return $scope.fetchSimilarity()}),$scope.noPlagiarismDetected=function(){var _ref;return(null!=(_ref=$scope.tasks)?_ref.similar_to_count:void 0)<=0||null===$scope.similarityData},$scope.fetchSimilarity=function(){var _ref;return(null!=(_ref=$scope.task)?_ref.similar_to_count:void 0)>0?TaskSimilarity.get($scope.task,$scope.match,function(data){return $scope.similarityData=data}):void 0},$scope.shouldDisableLeftNav=function(){return $scope.match<=1},$scope.shouldDisableRightNav=function(){return $scope.match>=$scope.task.similar_to_count},$scope.classForViews=function(){return"???"===$scope.similarityData.other_student.name?"col-xs-12":"col-lg-6 col-xs-12"},(null!=(_ref=$scope.task)?_ref.similar_to_count:void 0)>0?($scope.taskId=$scope.task.id,$scope.fetchSimilarity($scope.task,$scope.match-1)):void 0}]}}),angular.module("doubtfire.tasks.task-sheet-viewer",[]).directive("taskSheetViewer",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/task-sheet-viewer/task-sheet-viewer.tpl.html",scope:{task:"=",unit:"=",project:"="},controller:["$scope","$filter","currentUser","Task","analyticsService",function($scope,$filter,currentUser,Task,analyticsService){return $scope.showTaskSheet=!1,$scope.downloadEvent=function(type){return analyticsService.event("Task Sheet","Downloaded Task "+type)},$scope.$watch("project.selectedTask.task_definition_id",function(newTaskDefId){return $scope.alignments=$filter("taskFilter")($scope.unit.task_outcome_alignments,newTaskDefId)}),$scope.hasPDF=function(){return $scope.task.definition.has_task_pdf},$scope.toggleTaskSheet=function(){return analyticsService.event("Task Sheet",""+($scope.showTaskSheet?"Hid":"Showed")+" Task Sheet PDF Viewer"),$scope.showTaskSheet=!$scope.showTaskSheet},$scope.hasResources=function(){return $scope.task.definition.has_task_resources},$scope.taskPDFUrl=function(){return Task.getTaskPDFUrl($scope.unit,$scope.task.definition)},$scope.resourceUrl=function(){return Task.getTaskResourcesUrl($scope.unit,$scope.task.definition)}}]}}),angular.module("doubtfire.tasks.task-status-selector",[]).directive("taskStatusSelector",function(){return{replace:!0,restrict:"E",templateUrl:"tasks/task-status-selector/task-status-selector.tpl.html",scope:{task:"=task",assessingUnitRole:"=assessingUnitRole",inMenu:"=inMenu",triggerTransition:"=triggerTransition"},controller:["$scope","taskService",function($scope,taskService){return $scope.studentStatuses=taskService.switchableStates.student,$scope.tutorStatuses=taskService.switchableStates.tutor,$scope.taskEngagementConfig={studentTriggers:$scope.studentStatuses.map(function(status){return{status:status,label:taskService.statusLabels[status],iconClass:taskService.statusIcons[status],taskClass:_.trim(_.dasherize(status),"-"),helpText:taskService.helpText(status)}}),tutorTriggers:$scope.tutorStatuses.map(function(status){return{status:status,label:taskService.statusLabels[status],iconClass:taskService.statusIcons[status],taskClass:_.trim(_.dasherize(status),"-"),helpText:taskService.helpText(status)}})}}]}}),angular.module("doubtfire.tasks.task-submission-viewer",[]).directive("taskSubmissionViewer",function(){return{restrict:"E",templateUrl:"tasks/task-submission-viewer/task-submission-viewer.tpl.html",scope:{project:"=project",task:"=task"},controller:["$scope","TaskFeedback",function($scope,TaskFeedback){return $scope.notSubmitted=function(task){return!task.has_pdf&&!task.processing_pdf},$scope.loadingDetails=function(task){return task.needsSubmissionDetails()},$scope.$watch("task",function(newTask){return null!=newTask?(newTask.getSubmissionDetails(),$scope.taskUrl=TaskFeedback.getTaskUrl(newTask)):void 0})}]}});var __indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};angular.module("doubtfire.tasks.task-submission-wizard",[]).directive("taskSubmissionWizard",function(){return{restrict:"E",replace:!0,scope:{task:"=",project:"=",unit:"=",assessingUnitRole:"=?"},templateUrl:"tasks/task-submission-wizard/task-submission-wizard.tpl.html",controller:["$scope","$timeout","Task","taskService","alertService","projectService","groupService","analyticsService",function($scope,$timeout,Task,taskService,alertService,projectService,groupService,analyticsService){var UPLOAD_STATUS_TYPES,revertChanges,_ref,_ref1;return UPLOAD_STATUS_TYPES=["ready_to_mark","need_help"],revertChanges=function(task){var _ref;return task.definition.upload_requirements.length>0&&null!=$scope.uploadType&&(_ref=$scope.uploadType,__indexOf.call(UPLOAD_STATUS_TYPES,_ref)>=0)&&null!=$scope.oldStatus&&$scope.oldStatus!==task.status?(null!=$scope.oldStatus&&(task.status=$scope.oldStatus),alertService.add("info","No file(s) uploaded. Status reverted.",4e3)):void 0},$scope.$watch("task",function(task,oldTask){var upload,_i,_len,_ref,_ref1;for(revertChanges(oldTask),$scope.oldStatus=angular.copy($scope.task.status),$scope.uploadType=(_ref=task.status,__indexOf.call(UPLOAD_STATUS_TYPES,_ref)>=0?task.status:void 0),$scope.files={},_ref1=task.definition.upload_requirements,_i=0,_len=_ref1.length;_len>_i;_i++)upload=_ref1[_i],$scope.files[upload.key]={name:upload.name,type:upload.type};return $scope.url=Task.generateSubmissionUrl($scope.project,$scope.task),$scope.numberOfFiles=task.definition.upload_requirements.length}),$scope.$watch("task.status",function(newStatus){var uploadType;if(newStatus!==uploadType)return uploadType=__indexOf.call(UPLOAD_STATUS_TYPES,newStatus)>=0?newStatus:void 0,$scope.setUploadType(uploadType)}),$scope.isUploading=null,$scope.helpLabel="",$scope.setHelpLabel=function(text){return null==text&&(text=""),$scope.helpLabel=text},$scope.uploadTypes={ready_to_mark:{icon:taskService.statusIcons.ready_to_mark,text:taskService.statusLabels.ready_to_mark,"class":"ready-to-mark",hide:!1},need_help:{icon:taskService.statusIcons.need_help,text:taskService.statusLabels.need_help,"class":"need-help",hide:!1},reupload_evidence:{icon:"fa fa-recycle",text:"new evidence for portfolio","class":"btn-info",hide:"demonstrate"!==(_ref=$scope.task.status)&&"discuss"!==_ref&&"do_not_resubmit"!==_ref&&"complete"!==_ref&&"fail"!==_ref}},$scope.setUploadType=function(type){return __indexOf.call(UPLOAD_STATUS_TYPES,type)>=0&&($scope.task.status=type),$scope.uploadType=type},$scope.onSuccess=function(response){var asUser,updateTaskStatusFunc;return updateTaskStatusFunc=function(){return taskService.processTaskStatusChange($scope.unit,$scope.project,$scope.task,response.status,response)},$timeout(updateTaskStatusFunc,1500),asUser=null!=$scope.assessingUnitRole?$scope.assessingUnitRole.role:"Student",analyticsService.event("Task Submit Form","Updated Status as "+asUser,taskService.statusLabels[$scope.task.status]),analyticsService.event("Task Submit Form","Files Uploaded",void 0,$scope.numberOfFiles)},$scope.onComplete=function(){return $scope.uploadType=null},$scope.$on("$destroy",function(){return revertChanges($scope.task)}),$scope.recreateTask=function(){return taskService.recreatePDF($scope.task,null)},$scope.allowRegeneratePdf=("demonstrate"===(_ref1=$scope.task.status)||"ready_to_mark"===_ref1||"discuss"===_ref1||"complete"===_ref1)&&$scope.task.has_pdf,$scope.team={members:[]},$scope.payload={},$scope.mapTeamToPayload=function(){var total;return total=groupService.groupContributionSum($scope.team.members),_.map($scope.team.members,function(member){return{project_id:member.project_id,pct:(100*member.rating/total).toFixed(0)}})},$scope.onBeforeUpload=function(){return $scope.payload.contributions=groupService.isGroupTask($scope.task)?$scope.mapTeamToPayload():{},"need_help"===$scope.uploadType?$scope.payload.trigger="need_help":void 0},$scope.inGroupForTask=function(){return null!=projectService.getGroupForTask($scope.project,$scope.task)},$scope.isGroupTask=function(){return groupService.isGroupTask($scope.task)}}]}}),angular.module("doubtfire.tasks.task-viewer",[]).directive("taskViewer",function(){return{restrict:"E",replace:!0,templateUrl:"tasks/task-viewer/task-viewer.tpl.html",scope:{unit:"=",project:"=",assessingUnitRole:"="},controller:["$scope","$modal","$state","$stateParams","TaskFeedback","Task","Project","taskService","groupService","alertService","projectService","analyticsService",function($scope,$modal,$state,$stateParams,TaskFeedback,Task,Project,taskService,groupService,alertService,projectService,analyticsService){return $scope.tabs={taskSheet:{title:"Task Description",subtitle:"A brief description of this task",icon:"fa-info",seq:0,active:!1},fileUpload:{title:"Upload Submission",subtitle:"Upload your submission so it is ready for your tutor to mark",icon:"fa-upload",seq:1,active:!1},viewSubmission:{title:"View Submission",subtitle:"View the latest submission you have uploaded",icon:"fa-file-o",seq:2,active:!1},viewComments:{title:"View Comments",subtitle:"Write and read comments between you and your tutor",icon:"fa-comments-o",seq:3,active:!1},plagiarismReport:{title:"View Similarities Detected",subtitle:"See the other submissions and how closely they relate to your submission",icon:"fa-eye",seq:4,active:!1}},$scope.setActiveTab=function(tab){var asUser,_ref;if(tab!==$scope.activeTab)return null!=(_ref=$scope.activeTab)&&(_ref.active=!1),$scope.activeTab=tab,$scope.activeTab.active=!0,asUser=null!=$scope.assessingUnitRole?$scope.assessingUnitRole.role:"Student",analyticsService.event("Student Project View - Tasks Tab","Switched Tab as "+asUser,""+tab.title+" Tab")},$scope.isActiveTab=function(tab){return tab===$scope.activeTab},$scope.$watch("project.selectedTask",function(newTask){if(null==newTask&&(newTask=_.first($scope.project.tasks)),"feedback"===$stateParams.viewing)$scope.setActiveTab($scope.tabs.viewSubmission);else if("submit"===$stateParams.viewing)$scope.setActiveTab($scope.tabs.fileUpload);else if(null!=$scope.project.selectedTask)if($scope.project.selectedTask.similar_to_count>0)$scope.setActiveTab($scope.tabs.plagiarismReport);else switch($scope.project.selectedTask.status){case"not_started":$scope.setActiveTab($scope.tabs.taskSheet);break;case"ready_to_mark":case"complete":case"discuss":case"demonstrate":$scope.setActiveTab($scope.tabs.viewSubmission);break;case"fix_and_resubmit":case"working_on_it":case"need_help":case"redo":$scope.setActiveTab($scope.tabs.fileUpload);break;default:$scope.setActiveTab($scope.tabs.taskSheet)}else $scope.setActiveTab($scope.tabs.taskSheet);return $scope.taskIsGraded=taskService.taskIsGraded(newTask)}),$scope.$watch("project.selectedTask.grade",function(){return $scope.taskIsGraded=taskService.taskIsGraded($scope.project.selectedTask)}),$scope.setSelectedTask=function(task){return analyticsService.event("Student Project View","Switched to Task","Task Feedback Page Dropdown"),task!==$scope.project.selectedTask?$scope.project.selectedTask=task:void 0},$scope.statusData=taskService.statusData,$scope.statusClass=taskService.statusClass,$scope.daysOverdue=taskService.daysOverdue,$scope.daysOverdue=function(task){return taskService.daysOverdue(task)},$scope.activeStatusData=function(){return $scope.statusData($scope.project.selectedTask)},$scope.groupSetName=function(id){return groupService.groupSetName(id,$scope.unit)},$scope.hideGroupSetName=0===$scope.unit.group_sets.length,$scope.recreatePDF=function(){return taskService.recreatePDF($scope.project.selectedTask,null)},$scope.studentStatuses=taskService.switchableStates.student,$scope.tutorStatuses=taskService.switchableStates.tutor,$scope.taskEngagementConfig={studentTriggers:$scope.studentStatuses.map(function(status){return{status:status,label:taskService.statusLabels[status],iconClass:taskService.statusIcons[status],taskClass:_.trim(_.dasherize(status),"-"),helpText:taskService.helpText(status)}}),tutorTriggers:$scope.tutorStatuses.map(function(status){return{status:status,label:taskService.statusLabels[status],iconClass:taskService.statusIcons[status],taskClass:_.trim(_.dasherize(status),"-"),helpText:taskService.helpText(status)}})},$scope.activeClass=function(status){return status===$scope.project.selectedTask.status?"active":""},$scope.triggerTransition=function(status){var asUser;return("ready_to_mark"===status||"need_help"===status)&&$scope.project.selectedTask.definition.upload_requirements.length>0?($scope.setActiveTab($scope.tabs.fileUpload),void($scope.project.selectedTask.status=status)):(taskService.updateTaskStatus($scope.unit,$scope.project,$scope.project.selectedTask,status),asUser=null!=$scope.assessingUnitRole?$scope.assessingUnitRole.role:"Student",analyticsService.event("Student Project View - Tasks Tab","Updated Status as "+asUser,taskService.statusLabels[status]))}}]}}),angular.module("doubtfire.tasks",["doubtfire.tasks.modals","doubtfire.tasks.stats","doubtfire.tasks.task-ilo-alignment","doubtfire.tasks.project-tasks-list","doubtfire.tasks.project-top-tasks-list","doubtfire.tasks.task-comments-viewer","doubtfire.tasks.task-definition-editor","doubtfire.tasks.task-definition-selector","doubtfire.tasks.task-feedback-assessor","doubtfire.tasks.task-feedback-assessor-list","doubtfire.tasks.task-plagiarism-file-viewer","doubtfire.tasks.task-plagiarism-report-viewer","doubtfire.tasks.task-sheet-viewer","doubtfire.tasks.task-status-selector","doubtfire.tasks.task-submission-viewer","doubtfire.tasks.task-submission-wizard","doubtfire.tasks.task-viewer"]),angular.module("doubtfire.units.modals",["doubtfire.units.modals.unit-create-modal","doubtfire.units.modals.unit-ilo-edit-modal","doubtfire.units.modals.unit-student-enrolment-modal","doubtfire.units.modals.unit-tutorial-edit-modal","doubtfire.units.modals.unit-mark-submissions-offline-modal"]),angular.module("doubtfire.units.modals.unit-create-modal",[]).factory("UnitCreateModal",["$modal",function($modal){var UnitCreateModal;return UnitCreateModal={},UnitCreateModal.show=function(units){return $modal.open({controller:"UnitCreateModalCtrl",templateUrl:"units/modals/unit-create-modal/unit-create-modal.tpl.html",resolve:{units:function(){return units}}})},UnitCreateModal}]).controller("UnitCreateModalCtrl",["$scope","$modalInstance","alertService","units","Unit","analyticsService",function($scope,$modalInstance,alertService,units,Unit,analyticsService){return analyticsService.event("Unit Admin","Started to Create Unit"),$scope.units=units,$scope.unit={code:null,name:null},$scope.saveUnit=function(){return Unit.create({unit:$scope.unit},function(response){return alertService.add("success","Unit created.",2e3),$modalInstance.close(),$scope.units.push(response),analyticsService.event("Unit Admin","Saved New Unit")},function(response){return alertService.add("danger","Error creating unit - "+response.data.error)})}}]),angular.module("doubtfire.units.modals.unit-ilo-edit-modal",[]).factory("UnitILOEditModal",["$modal",function($modal){var UnitILOEditModalCtrl;return UnitILOEditModalCtrl={},UnitILOEditModalCtrl.show=function(unit,ilo){return $modal.open({controller:"UnitILOEditModalCtrl",templateUrl:"units/modals/unit-ilo-edit-modal/unit-ilo-edit-modal.tpl.html",resolve:{ilo:function(){return ilo},unit:function(){return unit}}})},UnitILOEditModalCtrl}]).controller("UnitILOEditModalCtrl",["$scope","$modalInstance","ilo","unit","IntendedLearningOutcome","alertService",function($scope,$modalInstance,ilo,unit,IntendedLearningOutcome,alertService){var prototypeIlo;return prototypeIlo={name:null,description:null,abbreviation:null},$scope.ilo=ilo||prototypeIlo,$scope.isNew=null==ilo,$scope.saveILO=function(){var save_data;return save_data={unit_id:unit.id,name:$scope.ilo.name,description:$scope.ilo.description,abbreviation:$scope.ilo.abbreviation},$scope.isNew?IntendedLearningOutcome.create(save_data,function(response){return $modalInstance.close(response),unit.ilos.push(response),alertService.add("success","Intended Learning Outcome Added",2e3)},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):void 0}):(save_data.id=$scope.ilo.id,IntendedLearningOutcome.update(save_data).$promise.then(function(response){return $modalInstance.close(response),alertService.add("success","Intended Learning Outcome Updated",2e3)},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):void 0}))}}]),angular.module("doubtfire.units.modals.unit-mark-submissions-offline-modal",[]).factory("UnitMarkSubmissionsOfflineModal",["$modal",function($modal){var UnitMarkSubmissionsOfflineModal;return UnitMarkSubmissionsOfflineModal={},UnitMarkSubmissionsOfflineModal.show=function(unit){return $modal.open({controller:"UnitMarkSubmissionsOfflineModalCtrl",templateUrl:"units/modals/unit-mark-submissions-offline-modal/unit-mark-submissions-offline-modal.tpl.html",resolve:{unit:function(){return unit}}})},UnitMarkSubmissionsOfflineModal}]).controller("UnitMarkSubmissionsOfflineModalCtrl",["$scope","$modalInstance","alertService","unit","Task","CsvResultModal",function($scope,$modalInstance,alertService,unit,Task,CsvResultModal){return $scope.unit=unit,$scope.zipMarkingFiles={file:{name:"Zip of annotated task PDFs and marks.csv",type:"zip"}},$scope.csvMarkingFiles={file:{name:"Modified marks.csv",type:"csv"}},$scope.uploadSubmissionUrl=$scope.readyToMarkSubmissionsUrl=Task.getTaskMarkingUrl($scope.unit),$scope.isUploading=null,$scope.isReady={csv:null,zip:null},$scope.onMarkingUploadSuccess=function(response){return CsvResultModal.show("Marking CSV and ZIP upload",response),$scope.unit.refreshStudents()},$scope.closeModal=$modalInstance.dismiss}]),angular.module("doubtfire.units.modals.unit-student-enrolment-modal",[]).factory("UnitStudentEnrolmentModal",["$modal",function($modal){var UnitStudentEnrolmentModal;return UnitStudentEnrolmentModal={},UnitStudentEnrolmentModal.show=function(unit){return $modal.open({controller:"UnitStudentEnrolmentModalCtrl",templateUrl:"units/modals/unit-student-enrolment-modal/unit-student-enrolment-modal.tpl.html",resolve:{unit:function(){return unit}}})},UnitStudentEnrolmentModal}]).controller("UnitStudentEnrolmentModalCtrl",["$scope","$modalInstance","Project","unit","alertService",function($scope,$modalInstance,Project,unit,alertService){return $scope.unit=unit,$scope.projects=unit.students,$scope.enrolStudent=function(student_id,tutorial){return Project.create({unit_id:unit.id,student_num:student_id,tutorial_id:tutorial?tutorial.id:null},function(project){return unit.studentEnrolled(project.project_id)?(alertService.add("danger","Student is already enrolled",2e3),$modalInstance.close()):(unit.addStudent(project),alertService.add("success","Student enrolled",2e3),$modalInstance.close())},function(){return alertService.add("danger","Unable to find student. Ensure they have an account.",6e3)})}}]),angular.module("doubtfire.units.modals.unit-tutorial-edit-modal",[]).factory("UnitTutorialEditModal",["$modal",function($modal){var UnitTutorialEditModal;return UnitTutorialEditModal={},UnitTutorialEditModal.show=function(unit,tutorial){return $modal.open({controller:"UnitTutorialEditModalCtrl",templateUrl:"units/modals/unit-tutorial-edit-modal/unit-tutorial-edit-modal.tpl.html",resolve:{tutorial:function(){return tutorial},unit:function(){return unit}}})},UnitTutorialEditModal}]).controller("UnitTutorialEditModalCtrl",["$scope","$modalInstance","tutorial","unit","Tutorial","alertService",function($scope,$modalInstance,tutorial,unit,Tutorial,alertService){var d,prototypeTutorial;return d=new Date,d.setHours(8),d.setMinutes(30),prototypeTutorial={meeting_day:"Monday",meeting_time:d,abbreviation:null,meeting_location:null},$scope.tutorial=tutorial||prototypeTutorial,$scope.isNew=null==tutorial,$scope.unit=unit,$scope.tutors=$scope.unit.staff,$scope.saveTutorial=function(){var save_data;return save_data=_.omit($scope.tutorial,"tutor","tutor_name","meeting_time","data"),save_data.tutor_id=$scope.tutorial.tutor.user_id?$scope.tutorial.tutor.user_id:$scope.tutorial.tutor.id,$scope.tutorial.meeting_time.getHours&&(save_data.meeting_time=$scope.tutorial.meeting_time.getHours()+":"+$scope.tutorial.meeting_time.getMinutes()),null==save_data.tutor_id?void alertService.add("danger","Ensure that you select a tutor from those engaged in this unit.",6e3):$scope.isNew?(save_data.unit_id=unit.id,Tutorial.create({tutorial:save_data}).$promise.then(function(response){return $modalInstance.close(response),$scope.unit.tutorials.push(response),alertService.add("success","Tutorial Added",2e3)},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):void 0})):Tutorial.update({id:tutorial.id,tutorial:save_data}).$promise.then(function(response){return $modalInstance.close(response),$scope.tutorial.tutor=response.tutor,$scope.tutorial.tutor_name=response.tutor_name,alertService.add("success","Tutorial Updated",2e3)},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):void 0})}}]),angular.module("doubtfire.units.states.edit-unit-view",[]).config(["headerServiceProvider",function(headerServiceProvider){var editUnitViewStateData;return editUnitViewStateData={url:"/admin/units/:unitId",views:{main:{controller:"EditUnitViewCtrl",templateUrl:"units/states/edit-unit-view/edit-unit-view.tpl.html"}},data:{pageTitle:"_Unit Administration_",roleWhitelist:["Admin","Convenor"]}},headerServiceProvider.state("admin/units#edit",editUnitViewStateData)}]).controller("EditUnitViewCtrl",["$scope","$state","$stateParams","Convenor","Tutor","UnitRole","unitService","headerService","alertService","analyticsService",function($scope,$state,$stateParams,Convenor,Tutor,UnitRole,unitService,headerService,alertService,analyticsService){return analyticsService.event("Edit Unit View","Started Edit Unit View","Unit Tab"),unitService.getUnit($state.params.unitId,!0,!0,function(unit){return $scope.unit=unit,$scope.newUnit=-1===$scope.unit.id,$scope.currentStaff=$scope.unit.staff,UnitRole.query(function(roles){return $scope.unitRoles=_.filter(roles,function(role){return role.unit_id===unit.id}),$scope.unitRoles?$scope.assessingUnitRole=$scope.unitRoles[0]:void 0})}),$scope.tabs={unitTab:{title:"Unit",icon:"fa-university",seq:0},learningOutcomesTab:{title:"Learning Outcomes",icon:"fa-graduation-cap",seq:1},staffTab:{title:"Staff",icon:"fa-male",seq:2},tutorialsTab:{title:"Tutorials",icon:"fa-pencil",seq:3},studentsTab:{title:"Students",icon:"fa-user",seq:4},tasksTab:{title:"Tasks",icon:"fa-tasks",seq:5},taskAlignmentTab:{title:"Task Alignment",icon:"fa-link",seq:5},groupsTab:{title:"Groups",icon:"fa-users",seq:6}},$scope.setActiveTab=function(tab){var _ref;if(tab!==$scope.activeTab)return null!=(_ref=$scope.activeTab)&&(_ref.active=!1),$scope.activeTab=tab,$scope.activeTab.active=!0,null!=$scope.assessingUnitRole?analyticsService.event(""+($scope.newUnit?"Edit":"Create")+" Unit View","Switched Tab as "+$scope.assessingUnitRole.role,""+tab.title+" Tab"):analyticsService.event(""+($scope.newUnit?"Edit":"Create")+" Unit View","Switched Tab as Administrator",""+tab.title+" Tab")},$scope.activeTab=$scope.tabs.unitTab,Convenor.query().$promise.then(function(convenors){return Tutor.query().$promise.then(function(tutors){var staff;return staff=_.union(convenors,tutors),staff=_.map(staff,function(convenor){return{id:convenor.id,full_name:convenor.first_name+" "+convenor.last_name}}),staff=_.uniq(staff,function(item){return item.id}),$scope.staff=staff})})}]),angular.module("doubtfire.units.states",["doubtfire.units.states.edit-unit-view","doubtfire.units.states.teacher-view","doubtfire.units.states.units-admin-view"]),angular.module("doubtfire.units.states.teacher-view",[]).config(["headerServiceProvider",function(headerServiceProvider){var teacherViewStateData;return teacherViewStateData={url:"/units?unitRole",views:{main:{controller:"TeacherViewCtrl",templateUrl:"units/states/teacher-view/teacher-view.tpl.html"}},data:{pageTitle:"_Home_",roleWhitelist:["Student","Tutor","Convenor","Admin"]}},headerServiceProvider.state("units#show",teacherViewStateData)}]).controller("TeacherViewCtrl",["$scope","$state","$stateParams","UnitRole","Visualisation","alertService","unitService","analyticsService",function($scope,$state,$stateParams,UnitRole,Visualisation,alertService,unitService,analyticsService){var cleanupTabs,refreshCharts;return analyticsService.event("Teacher View","Started Tutor Unit View","Feedback Tab"),$scope.unitLoaded=!1,refreshCharts=Visualisation.refreshAll,$scope.tabs={feedbackTab:{title:"Feedback",icon:"fa-check-square-o",seq:0},studentsTab:{title:"Students",icon:"fa-user",seq:1},tasksTab:{title:"Tasks",icon:"fa-tasks",seq:2},groupsTab:{title:"Groups",icon:"fa-users",seq:3},analyticsTab:{title:"Analytics",icon:"fa-bar-chart",seq:5},gradingTab:{title:"Grading",icon:"fa-book",seq:6}},$scope.setActiveTab=function(tab){var _ref;if(tab!==$scope.activeTab){switch(null!=(_ref=$scope.activeTab)&&(_ref.active=!1),$scope.activeTab=tab,$scope.activeTab.active=!0,tab){case $scope.tabs.analyticsTab:refreshCharts()}return analyticsService.event("Teacher View","Switched Tab as "+$scope.unitRole.role,""+tab.title+" Tab")}},cleanupTabs=function(){return null==$scope.activeTab&&($scope.activeTab=$scope.tabs.feedbackTab),$scope.unit.group_sets.length>0||delete $scope.tabs.groupsTab,$scope.unit.students.length>10?void 0:delete $scope.tabs.analyticsTab},$scope.assessingUnitRole=$stateParams.unitRole,$scope.$watch("unitLoaded",function(newValue){return newValue===!0?cleanupTabs():void 0}),UnitRole.get({id:$state.params.unitRole},function(unitRole){return $scope.unitRole=unitRole,$scope.assessingUnitRole=unitRole,unitRole?unitService.getUnit(unitRole.unit_id,!0,!1,function(unit){return $scope.unit=unit,$scope.$watch("unit.students",function(newValue){return _.isArray(newValue)?$scope.unitLoaded=!0:void 0})}):void 0}),$scope.unitService=unitService}]),angular.module("doubtfire.units.states.units-admin-view",[]).config(["headerServiceProvider",function(headerServiceProvider){var unitsAdminViewStateData;return unitsAdminViewStateData={url:"/admin/units",views:{main:{controller:"UnitsAdminViewCtrl",templateUrl:"units/states/units-admin-view/units-admin-view.tpl.html"}},data:{pageTitle:"_Unit Administration_",roleWhitelist:["Admin","Convenor"]}},headerServiceProvider.state("admin/units#index",unitsAdminViewStateData)}]).controller("UnitsAdminViewCtrl",["$scope","$state","$modal","Unit","UnitCreateModal","analyticsService",function($scope,$state,$modal,Unit,UnitCreateModal,analyticsService){return analyticsService.event("Unit Admin","Listed Units to Manage"),$scope.units=Unit.query({include_in_active:!0}),$scope.showUnit=function(unit){var unitToShow;return unitToShow=null!=unit?$state.transitionTo("admin/units#edit",{unitId:unit.id}):void 0},$scope.sortOrder="start_date",$scope.reverse=!0,$scope.currentPage=1,$scope.maxSize=5,$scope.pageSize=15,$scope.createUnit=function(){return UnitCreateModal.show($scope.units)}}]),angular.module("doubtfire.units.stats",["doubtfire.units.stats.unit-target-grade-stats","doubtfire.units.stats.unit-achievement-stats"]),angular.module("doubtfire.units.stats.unit-achievement-stats",[]).directive("unitAchievementStats",function(){return{replace:!0,restrict:"E",templateUrl:"units/stats/unit-achievement-stats/unit-achievement-stats.tpl.html",scope:{unit:"="},controller:["$scope","Unit",function($scope,Unit){var overviewTutorial,_ref;return null==(null!=(_ref=$scope.unit.analytics)?_ref.learningProgressClassDetails:void 0)?Unit.learningProgressClassDetails.get({id:$scope.unit.id},function(response){return $scope.unit.analytics.learningProgressClassDetails=response,$scope.data=response.all}):$scope.data=$scope.unit.analytics.learningProgressClassDetails.all,$scope.depth=0,$scope.switchToTutorial=function(tutorial){var rawData,_ref1;if(null!=(null!=(_ref1=$scope.unit.analytics)?_ref1.learningProgressClassDetails:void 0))return $scope.dataModel.selectedTutorial=tutorial,tutorial===overviewTutorial?(rawData=_.clone($scope.unit.analytics.learningProgressClassDetails),delete rawData.all,delete rawData.$promise,delete rawData.$resolved,$scope.data=rawData,$scope.depth=1):($scope.data=$scope.unit.analytics.learningProgressClassDetails[tutorial.id],$scope.depth=0),$scope.data=_.chain($scope.data).map(function(d,id){return delete d.students,[id,d]}).fromPairs().value()},$scope.drillDown=function(){return $scope.dataModel.selectedType="tutorial",$scope.switchToTutorial(overviewTutorial)},$scope.dataModel={selectedType:"unit",selectedTutorial:overviewTutorial,pct:!0},overviewTutorial={id:-1,abbreviation:"Overview",tutor_name:"All Tutorials"},$scope.tutorialsForSelector=[overviewTutorial].concat($scope.unit.tutorials),$scope.$watch("dataModel.selectedType",function(newValue){var _ref1;if(null!=(null!=(_ref1=$scope.unit.analytics)?_ref1.learningProgressClassDetails:void 0))return"tutorial"===newValue?$scope.switchToTutorial(overviewTutorial):($scope.depth=0,$scope.data=$scope.unit.analytics.learningProgressClassDetails.all)}),$scope.$watch("dataModel.selectedTutorial",$scope.switchToTutorial)}]}}),angular.module("doubtfire.units.stats.unit-target-grade-stats",[]).directive("unitTargetGradeStats",function(){return{replace:!0,restrict:"E",templateUrl:"units/stats/unit-target-grade-stats/unit-target-grade-stats.tpl.html",scope:{unit:"="},controller:["$scope","$filter","Unit","taskService",function($scope,$filter,Unit){return $scope.overviewSelectors={tutorial:{text:"Overview of tutorials",abbreviation:"ZZZ",id:-1}},$scope.tutorialsForSelector=[],_.each($scope.unit.tutorials,function(t){return $scope.tutorialsForSelector.push({text:t.abbreviation+" - "+t.tutor_name,id:t.id,meeting_time:t.meeting_time,tutor_name:t.tutor_name,abbreviation:t.abbreviation})}),$scope.tutorialsForSelector.push($scope.overviewSelectors.tutorial),$scope.switchToTutorial=function(tutorial){return $scope.dataModel.selectedType="tutorial",$scope.dataModel.selectedTask=null,$scope.dataModel.selectedTutorial=tutorial,$scope.depth=0},$scope.dataModel={},null==$scope.unit.analytics.targetGradeStats?Unit.targetGradeStats.query({id:$scope.unit.id},function(response){return delete response.$promise,delete response.$resolved,$scope.unit.analytics.targetGradeStats=response,$scope.dataModel.selectedType="unit"}):$scope.dataModel.selectedType="unit",$scope.$watch("dataModel.selectedType",function(newValue){if($scope.dataModel.selectedTutorial=null,$scope.dataModel.selectedTask=null,$scope.depth=0,null!=newValue)switch(newValue){case"unit":return $scope.data=$scope.reduceDataToOverall();case"tutorial":return $scope.dataModel.selectedTutorial=$scope.overviewSelectors.tutorial}}),$scope.$watch("dataModel.selectedTutorial",function(newValue){return null!=newValue?newValue.id>=0?($scope.depth=0,$scope.data=$scope.reduceDataToTutorialWithId(newValue)):($scope.depth=1,$scope.data=$scope.reduceDataToTutorial(),$scope.overviewKeys=_.map($scope.unit.tutorials,function(t){return{subtitle:""+t.tutor_name+" at "+$filter("date")(t.meeting_time,"shortTime"),title:t.abbreviation,data:$scope.data[t.id],show:_.keys($scope.data[t.id]).length>0,tutorial:t}})):void 0}),$scope.resetToOverview=function(){switch($scope.dataModel.selectedType){case"unit":return;case"tutorial":$scope.dataModel.selectedTutorial=$scope.overviewSelectors.tutorial}return drillDown()},$scope.drillDown=function(){switch($scope.dataModel.selectedType){case"unit":return $scope.dataModel.selectedType="tutorial";case"tutorial":return $scope.resetToOverview()}},$scope.reduceDataToOverall=function(){return _.chain($scope.unit.analytics.targetGradeStats).groupBy("grade").map(function(gradeInfo,gradeId){var totalForThisGrade;return totalForThisGrade=_.chain(gradeInfo).map(function(value){return value.num}).reduce(function(memo,num){return num+memo},0).value(),[gradeId,totalForThisGrade]}).fromPairs().value()},$scope.reduceDataToTutorial=function(){return _.chain($scope.unit.analytics.targetGradeStats).groupBy("tutorial_id").map(function(tutorialInfo,tutorialId){var gradeInfo;
return gradeInfo=_.chain(tutorialInfo).map(function(gradeInfo){return[gradeInfo.grade,gradeInfo.num]}).fromPairs().value(),[tutorialId,gradeInfo]}).fromPairs().value()},$scope.reduceDataToTutorialWithId=function(tutorial){return $scope.reduceDataToTutorial()[tutorial.id]}}]}}),angular.module("doubtfire.units.unit-analytics-viewer",[]).directive("unitAnalyticsViewer",function(){return{replace:!0,restrict:"E",templateUrl:"units/unit-analytics-viewer/unit-analytics-viewer.tpl.html",controller:["$scope","Unit",function($scope){return $scope.tabsData={taskStatusStats:{title:"Task Status Stats",subtitle:"View distribution of tasks by their current status either unit-wide or broken down into a specific tutorial or task",icons:["fa-tasks"],seq:0,active:!1},taskCompletionStats:{title:"Task Completion Stats",subtitle:"View how tasks have been marked as completed as a box plot",icons:["fa-check"],seq:1,active:!1},targetGradeStats:{title:"Target Grade Stats",subtitle:"View distribution of student target grades either unit-wide or broken down into a specific tutorial",icons:["fa-trophy"],seq:2,active:!1},achievementStats:{title:"ILO Achievement Stats",subtitle:"View how ILOs have been achieved by students to their associated tasks as a box plot",icons:["fa-graduation-cap"],seq:3,active:!1},taskSummaryStats:{title:"Task Statistics",subtitle:"Click a lab code's circle in the legend to remove the lab from the graph. Double click the lab code's circle to make this lab the only visible lab in the graph",icons:["fa-circle"],seq:4,active:!1}},$scope.setActiveTab=function(tab){return tab!==$scope.activeTab?(null!=$scope.activeTab&&($scope.activeTab.active=!1),$scope.activeTab=tab,$scope.activeTab.active=!0):void 0},$scope.setActiveTab($scope.tabsData.taskStatusStats),$scope.isActiveTab=function(tab){return tab===$scope.activeTab}}]}}),angular.module("doubtfire.units.unit-details-editor",[]).directive("unitDetailsEditor",function(){return{replace:!0,restrict:"E",templateUrl:"units/unit-details-editor/unit-details-editor.tpl.html",controller:["$scope","$state","$rootScope","Unit","alertService","unitService",function($scope,$state,$rootScope,Unit,alertService,unitService){return $scope.calOptions={startOpened:!1,endOpened:!1},$scope.open=function($event,pickerData){return $event.preventDefault(),$event.stopPropagation(),"start"===pickerData?($scope.calOptions.startOpened=!$scope.calOptions.startOpened,$scope.calOptions.endOpened=!1):($scope.calOptions.startOpened=!1,$scope.calOptions.endOpened=!$scope.calOptions.endOpened)},$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.unitTypeAheadData=unitService.unitTypeAheadData,$scope.studentSearch="",$scope.saveUnit=function(){var saveData;return $scope.unit.convenors&&delete $scope.unit.convenors,$scope.unit.start_date&&$scope.unit.start_date.getMonth&&($scope.unit.start_date=""+$scope.unit.start_date.getFullYear()+"-"+($scope.unit.start_date.getMonth()+1)+"-"+$scope.unit.start_date.getDate()),$scope.unit.end_date&&$scope.unit.end_date.getMonth&&($scope.unit.end_date=""+$scope.unit.end_date.getFullYear()+"-"+($scope.unit.end_date.getMonth()+1)+"-"+$scope.unit.end_date.getDate()),saveData={name:$scope.unit.name,code:$scope.unit.code,description:$scope.unit.description,start_date:$scope.unit.start_date,end_date:$scope.unit.end_date,active:$scope.unit.active},-1===$scope.unit.id?Unit.create({unit:saveData},function(unit){return $scope.saveSuccess(unit)},function(response){return alertService.add("danger",response.data.error,6e3)}):Unit.update({id:$scope.unit.id,unit:saveData},function(){return alertService.add("success","Unit updated.",2e3)},function(response){return alertService.add("danger","Failed to update unit. "+response.error,6e3)})}}]}}),angular.module("doubtfire.units.unit-groupset-editor",[]).directive("unitGroupsetEditor",function(){return{restrict:"E",templateUrl:"units/unit-groupset-editor/unit-groupset-editor.tpl.html",replace:!0,controller:["$scope","GroupSet","Group","GroupMember","gradeService","alertService","CsvResultModal",function($scope,GroupSet,Group,GroupMember,gradeService,alertService,CsvResultModal){return $scope.addGroupSet=function(){return 0===$scope.unit.group_sets.length?GroupSet.create({unit_id:$scope.unit.id,group_set:{name:"Group Work"}},function(gs){return $scope.selectGroupSet(gs),$scope.unit.group_sets.push(gs)},function(response){return alertService.add("danger","Failed to create group set. "+response.data.error,6e3)}):GroupSet.create({unit_id:$scope.unit.id,group_set:{name:"More Group Work"}},function(gs){return $scope.unit.group_sets.push(gs)},function(response){return alertService.add("danger","Failed to create group set. "+response.data.error,6e3)})},$scope.saveGroupSet=function(data,id){return GroupSet.update({unit_id:$scope.unit.id,id:id,group_set:{name:data.name,allow_students_to_create_groups:data.allow_students_to_create_groups,allow_students_to_manage_groups:data.allow_students_to_manage_groups,keep_groups_in_same_class:data.keep_groups_in_same_class}},function(){return alertService.add("success","Group set updated.",2e3)},function(response){return alertService.add("danger","Failed to update group set. "+response.data.error,6e3)})},$scope.removeGroupSet=function(gs){return GroupSet["delete"]({unit_id:$scope.unit.id,id:gs.id},function(){return $scope.unit.group_sets=_.filter($scope.unit.group_sets,function(gs1){return gs1.id!==gs.id})},function(response){return alertService.add("danger","Failed to delete group set. "+response.data.error,6e3)}),gs===$scope.selectedGroupset?$scope.selectGroupSet(null):void 0},$scope.selectGroupSet=function(gs){return $scope.selectedGroupset=gs,$scope.$digest},$scope.studentStaffOptions=[{value:!0,text:"Staff and Students"},{value:!1,text:"Staff Only"}],$scope.tutorialOptions=[{value:!0,text:"Same Tutorial"},{value:!1,text:"Any Tutorial"}],$scope.unit.group_sets.length>0&&$scope.selectGroupSet($scope.unit.group_sets[0]),$scope.csvImportResponse={},$scope.groupCSV={file:{name:"Group CSV",type:"csv"}},$scope.groupCSVUploadUrl=function(){return GroupSet.groupCSVUploadUrl($scope.unit,$scope.selectedGroupset)},$scope.isGroupCSVUploading=null,$scope.onGroupCSVSuccess=function(response){return CsvResultModal.show("Group CSV upload results.",response),$scope.unit.refresh()},$scope.onGroupCSVComplete=function(){return $scope.isGroupCSVUploading=null},$scope.downloadGroupCSV=function(){return GroupSet.downloadCSV($scope.unit,$scope.selectedGroupset)}}]}}),angular.module("doubtfire.units.unit-ilo-editor",[]).directive("unitIloEditor",function(){return{replace:!0,restrict:"E",templateUrl:"units/unit-ilo-editor/unit-ilo-editor.tpl.html",controller:["$scope","$modal","$rootScope","IntendedLearningOutcome","alertService","CsvResultModal","UnitILOEditModal",function($scope,$modal,$rootScope,IntendedLearningOutcome,alertService,CsvResultModal,UnitILOEditModal){return $scope.batchFiles={file:{name:"CSV Data",type:"csv"}},$scope.batchOutcomeUrl=function(){return IntendedLearningOutcome.getOutcomeBatchUploadUrl($scope.unit)},$scope.onBatchOutcomeSuccess=function(response){return CsvResultModal.show("Outcome CSV Upload Results",response),response.success.length>0?$scope.unit.refresh():void 0},$scope.editILO=function(ilo){return UnitILOEditModal.show($scope.unit,ilo)},$scope.createILO=function(){return $scope.editILO()},$scope.deleteILO=function(ilo){return IntendedLearningOutcome["delete"]({id:ilo.id,unit_id:$scope.unit.id},function(){return $scope.unit.ilos=_.without($scope.unit.ilos,ilo),alertService.add("info","ILO "+ilo.id+" was deleted successfully",2e3)},function(response){return alertService.add("danger","Error: "+response.data.error,6e3)})}}]}}),angular.module("doubtfire.units.unit-staff-editor",[]).directive("unitStaffEditor",function(){return{replace:!0,restrict:"E",templateUrl:"units/unit-staff-editor/unit-staff-editor.tpl.html",controller:["$scope","$rootScope","Unit","UnitRole","alertService","groupService",function($scope,$rootScope,Unit,UnitRole,alertService,groupService){var temp,users;return temp=[],users=[],$scope.changeRole=function(unitRole,role_id){return unitRole.role_id=role_id,unitRole.unit_id=$scope.unit.id,UnitRole.update({id:unitRole.id,unit_role:unitRole},function(){return alertService.add("success","Role changed",2e3)},function(response){return alertService.add("danger",response.data.error,6e3)})},$scope.addSelectedStaff=function(){var staff,tutorRole;return staff=$scope.selectedStaff,$scope.selectedStaff=null,$scope.unit.staff||($scope.unit.staff=[]),null!=staff.id?tutorRole=UnitRole.create({unit_id:$scope.unit.id,user_id:staff.id,role:"Tutor"},function(){return $scope.unit.staff.push(tutorRole)},function(response){return alertService.add("danger","Unable to add staff member. "+response.data.error,6e3)}):alertService.add("danger","Unable to add staff member. Ensure they have a tutor or convenor account in User admin first.",6e3)},$scope.findStaffUser=function(id){var staff,_i,_len,_ref;for(_ref=$scope.staff,_i=0,_len=_ref.length;_len>_i;_i++)if(staff=_ref[_i],staff.id===id)return staff},$scope.filterStaff=function(staff){return!_.find($scope.unit.staff,function(listStaff){return staff.id===listStaff.user_id})},$scope.removeStaff=function(staff){var staffUser;return $scope.unit.staff=_.without($scope.unit.staff,staff),UnitRole["delete"]({id:staff.id}),staffUser=$scope.findStaffUser(staff.user_id)},$scope.groupSetName=function(id){return groupService.groupSetName(id,$scope.unit)}}]}}),angular.module("doubtfire.units.unit-student-list",[]).directive("unitStudentList",function(){return{replace:!0,restrict:"E",templateUrl:"units/unit-student-list/unit-student-list.tpl.html",scope:{unitRole:"=unitRole",unit:"=unit",unitLoaded:"=unitLoaded",fullscreen:"=?"},controller:["$scope","$rootScope","$modal","$state","Project","$filter","currentUser","alertService","unitService","taskService","projectService","gradeService","analyticsService","UnitStudentEnrolmentModal",function($scope,$rootScope,$modal,$state,Project,$filter,currentUser,alertService,unitService,taskService,projectService,gradeService,analyticsService,UnitStudentEnrolmentModal){var update_project_details;return $scope.studentFilter="myStudents",$scope.grades=gradeService.grades,$scope.unitService=unitService,$scope.tutorName=currentUser.profile.name,$scope.search="",$scope.$watch("unit.students",function(){var filteredStudents;return filteredStudents=$filter("showStudents")($scope.unit.students,"myStudents",$scope.tutorName),null!=filteredStudents&&0===filteredStudents.length?$scope.studentFilter="allStudents":void 0}),analyticsService.watchEvent($scope,"studentFilter","Teacher View - Students Tab"),analyticsService.watchEvent($scope,"sortOrder","Teacher View - Students Tab"),analyticsService.watchEvent($scope,"currentPage","Teacher View - Students Tab","Selected Page"),analyticsService.watchEvent($scope,"fullscreen","Teacher View - Students Tab",function(newVal){return newVal?"Show Fullscreen":"Hide Fullscreen"}),$scope.switchToLab=function(student,tutorial){return student.switchToLab(tutorial)},$scope.getCSVHeader=function(){var result;return result=["student_code","name","email","portfolio","lab"],angular.forEach(taskService.statusKeys,function(key){return result.push(key)}),result},$scope.getCSVData=function(){var filteredStudents,result;return analyticsService.event("Teacher View - Students Tab","Export CSV data"),filteredStudents=$filter("filter")($filter("showStudents")($scope.unit.students,$scope.studentFilter,$scope.tutorName),$scope.search),result=[],angular.forEach(filteredStudents,function(student){var row;return row={},row.student_code=student.student_id,row.name=student.name,row.email=student.student_email,row.portfolio=student.portfolio_status,row.lab=student.tutorial?student.tutorial.abbreviation:"",angular.forEach(student.task_stats,function(stat){return row[stat.type]=stat.value}),result.push(row)}),result},$scope.viewStudent=function(student){return analyticsService.event("Teacher View - Students Tab","Viewed Student"),$scope.fullscreen?$scope.activeStudent=student:$state.go("projects#show",{projectId:student.project_id,unitRole:$scope.assessingUnitRole.id})},$scope.setFlagSort=function(flag){return $scope.sortOrder===flag?$scope.reverse=!$scope.reverse:$scope.sortOrder=flag},$scope.reverse=!1,$scope.statusClass=taskService.statusClass,$scope.statusName=function(status){return taskService.statusLabels[status.replace(/\-/g,"_")]},$scope.currentPage=1,$scope.maxSize=5,$scope.pageSize=15,$scope.fullscreen=!1,update_project_details=function(project,response){return projectService.updateTaskStats(project,response.stats),project.tasks&&_.each(project.tasks,function(task){return task.status=_.filter(response.tasks,{task_definition_id:task.task_definition_id})[0].status}),alertService.add("success","Status updated.",2e3)},$scope.transitionWeekEnd=function(project){return analyticsService.event("Teacher View - Students Tab","Trigger Week End"),Project.update({id:project.project_id,trigger:"trigger_week_end"},function(response){return update_project_details(project,response)},function(response){return alertService.add("danger",response.data.error,6e3)})},$scope.assessingUnitRole=$scope.unitRole,$scope.showEnrolModal=function(){return analyticsService.event("Teacher View - Students Tab","Enrol Student"),UnitStudentEnrolmentModal.show($scope.unit)}}]}}),angular.module("doubtfire.units.unit-student-plagiarism-list",[]).directive("unitStudentPlagiarismList",function(){return{replace:!0,restrict:"E",templateUrl:"units/unit-student-plagiarism-list/unit-student-plagiarism-list.tpl.html",controller:["$scope","$filter","currentUser","gradeService","projectService",function($scope,$filter,currentUser,gradeService,projectService){var studentFilter;return $scope.grades=gradeService.grades,$scope.view="all-students",studentFilter="allStudents",$scope.tutorName=currentUser.profile.name,$scope.search="",$scope.reverse=!1,$scope.currentPage=1,$scope.maxSize=5,$scope.pageSize=15,$scope.assessingUnitRole=$scope.unitRole,$scope.setActiveView=function(kind){return $scope.view=kind,studentFilter="my-students"===kind?"myStudents":"allStudents"},$scope.activeStudent=null,$scope.activeTask=null,$scope.selectStudent=function(student){return $scope.activeStudent=student,student?projectService.fetchDetailsForProject(student,$scope.unit,function(){return $scope.activeTask=_.find(student.tasks,function(task){return task.similar_to_count>0})}):void 0},$scope.selectTask=function(task){return $scope.activeTask=task}}]}}),angular.module("doubtfire.units.unit-student-portfolio-list",[]).directive("unitStudentPortfolioList",function(){return{restrict:"E",templateUrl:"units/unit-student-portfolio-list/unit-student-portfolio-list.tpl.html",controller:["$scope","Unit","analyticsService","gradeService","projectService","unitService","currentUser",function($scope,Unit,analyticsService,gradeService,projectService,unitService,currentUser){return $scope.portfolioDownloadUrl=Unit.getPortfoliosUrl($scope.unit),$scope.studentFilter="myStudents",$scope.grades=gradeService.grades,$scope.unitService=unitService,$scope.tutorName=currentUser.profile.name,$scope.search="",$scope.currentPage=1,$scope.maxSize=5,$scope.pageSize=5,$scope.filterOptions={selectedGrade:0},$scope.grades=gradeService.grades,$scope.gradeAcronyms=gradeService.gradeAcronyms,$scope.fullscreen=!1,$scope.selectedStudent=null,$scope.gradeResults=[{name:"Fail",scores:[0,10,20,30,40,44]},{name:"Pass",scores:[50,53,55,57]},{name:"Credit",scores:[60,63,65,67]},{name:"Distinction",scores:[70,73,75,77]},{name:"High Distinction",scores:[80,83,85,87]},{name:"High Distinction",scores:[90,93,95,97,100]}],$scope.editingRationale=!1,$scope.toggleEditRationale=function(){return $scope.editingRationale=!$scope.editingRationale},analyticsService.watchEvent($scope,"studentFilter","Teacher View - Grading Tab"),analyticsService.watchEvent($scope,"sortOrder","Teacher View - Grading Tab"),analyticsService.watchEvent($scope,"currentPage","Teacher View - Grading Tab","Selected Page"),analyticsService.watchEvent($scope,"fullscreen","Teacher View - Grading Tab",function(newVal){return newVal?"Show Fullscreen":"Hide Fullscreen"}),$scope.selectStudent=function(student){return $scope.selectedStudent=student,$scope.project=null,projectService.fetchDetailsForProject(student,$scope.unit,function(project){return $scope.project=project}),analyticsService.event("Teacher View - Grading Tab","Selected Student")}}]}}),angular.module("doubtfire.units.unit-students-editor",[]).directive("unitStudentsEditor",function(){return{replace:!0,restrict:"E",templateUrl:"units/unit-students-editor/unit-students-editor.tpl.html",controller:["$scope","Unit","Project","CsvResultModal","UnitStudentEnrolmentModal","alertService",function($scope,Unit,Project,CsvResultModal,UnitStudentEnrolmentModal,alertService){var changeEnrolment,onBatchEnrolSuccess,onBatchWithdrawSuccess;return $scope.activeBatchStudentType="enrol",$scope.showEnrolModal=function(){return UnitStudentEnrolmentModal.show($scope.unit)},$scope.switchToLab=function(student,tutorial){return student.switchToLab(tutorial)},onBatchEnrolSuccess=function(response){var newStudents;return newStudents=response,CsvResultModal.show("Enrol Student CSV Results",response),response.success.length>0?$scope.unit.refreshStudents():void 0},onBatchWithdrawSuccess=function(response){return CsvResultModal.show("Withdraw Student CSV Results",response),response.success.length>0?(alertService.add("success","Withdrew "+response.success.length+" students.",2e3),$scope.unit.refreshStudents()):alertService.add("info","No students need to be withdrawn.",4e3)},$scope.batchStudentTypes={enrol:{batchUrl:function(){return Unit.enrolStudentsCSVUrl($scope.unit)},batchFiles:{file:{name:"Enrol CSV Data",type:"csv"}},onSuccess:onBatchEnrolSuccess},withdraw:{batchUrl:function(){return Unit.withdrawStudentsCSVUrl($scope.unit)},batchFiles:{file:{name:"Withdraw CSV Data",type:"csv"}},onSuccess:onBatchWithdrawSuccess}},changeEnrolment=function(student,value){return Project.update({id:student.project_id,enrolled:value},function(project){return value===project.enrolled?alertService.add("success","Enrolment changed.",2e3):alertService.add("danger","Enrolment change failed.",5e3),student.enrolled=project.enrolled},function(response){return alertService.add("danger",response.data.error,5e3)})},$scope.withdraw=function(student){return changeEnrolment(student,!1)},$scope.enrol=function(student){return changeEnrolment(student,!0)},$scope.currentPage=1,$scope.maxSize=5,$scope.pageSize=15}]}}),angular.module("doubtfire.units.unit-tasks-editor",[]).directive("unitTasksEditor",function(){return{replace:!0,restrict:"E",templateUrl:"units/unit-tasks-editor/unit-tasks-editor.tpl.html",controller:["$scope","$rootScope","Task","Unit","gradeService","alertService","taskService","CsvResultModal","ConfirmationModal","ProgressModal",function($scope,$rootScope,Task,Unit,gradeService,alertService,taskService,CsvResultModal,ConfirmationModal,ProgressModal){var guessTaskAbbreviation;return $scope.grades=gradeService.grades,$scope.taskAdminPager={currentPage:1,maxSize:5,pageSize:5,search:"",sortOrder:"seq",reverse:!1},$scope.taskAdminData={selectedTask:null,isNew:!1},$scope.editTask=function(task){return $scope.taskAdminData.selectedTask=task,$scope.taskAdminData.isNew=!1},guessTaskAbbreviation=function(){var last_abbr,match,regex,unit;return unit=$scope.unit,0===unit.task_definitions.length?"1.1P":(last_abbr=unit.task_definitions[unit.task_definitions.length-1].abbreviation,regex=/(.*)(\d+)(\D*)/,match=regex.exec(last_abbr),null!=match?""+match[1]+(parseInt(match[2])+1)+match[3]:""+last_abbr+"1")},$scope.deleteTask=function(task){return ConfirmationModal.show("Delete Task "+task.abbreviation,"Are you sure you want to delete this task? This action is final and will delete student work associated with this task.",function(){var promise;return promise=taskService.deleteTask(task,$scope.unit,null),ProgressModal.show("Deleting Task "+task.abbreviation,"Please wait while student projects are updated.",promise)})},$scope.createTask=function(){var abbr,task;return abbr=guessTaskAbbreviation(),task={name:"Task "+abbr,abbreviation:abbr,description:"New Description",start_date:new Date,target_date:new Date,upload_requirements:[],plagiarism_checks:[],weight:4,target_grade:0,restrict_status_updates:!1,plagiarism_warn_pct:80,is_graded:!1},$scope.taskAdminData.selectedTask=task,$scope.taskAdminData.isNew=!0},$scope.$watch("unit.task_definitions.length",function(newLength,oldLength){return newLength!==oldLength?$scope.unit.task_definitions.length>0?$scope.editTask(oldLength>newLength?_.first($scope.unit.task_definitions):_.last($scope.unit.task_definitions)):$scope.taskAdminData.selectedTask=null:void 0}),$scope.taskFiles={file:{name:"Task PDFs",type:"zip"}},$scope.taskUploadUrl=Unit.taskUploadUrl($scope.unit),$scope.onTaskPDFSuccess=function(response){return alertService.add("success","Files uploaded",2e3),$scope.filesUploaded=response},$scope.batchFiles={file:{name:"CSV Data",type:"csv"}},$scope.batchTaskUrl=function(){return Task.getTaskDefinitionBatchUploadUrl($scope.unit)},$scope.allResourceUrl=function(){return Unit.allResourcesDownloadUrl($scope.unit)},$scope.onBatchTaskSuccess=function(response){return CsvResultModal.show("Task CSV Upload Results",response),response.success.length>0?$scope.unit.refresh():void 0}}]}}),angular.module("doubtfire.units.unit-tutorials-editor",[]).directive("unitTutorialsEditor",function(){return{replace:!0,restrict:"E",templateUrl:"units/unit-tutorials-editor/unit-tutorials-editor.tpl.html",controller:["$scope","$modal","$rootScope","Unit","UnitRole","Tutorial","UnitTutorialEditModal","alertService",function($scope,$modal,$rootScope,Unit,UnitRole,Tutorial,UnitTutorialEditModal,alertService){return $scope.editTutorial=function(tutorial){return UnitTutorialEditModal.show($scope.unit,tutorial)},$scope.deleteTutorial=function(tutorial){return Tutorial["delete"]({id:tutorial.id},function(){return $scope.unit.tutorials=_.without($scope.unit.tutorials,tutorial),alertService.add("info","Tutorial "+tutorial.abbreviation+" was deleted successfully")},function(response){return alertService.add("danger",response.data.error)})},$scope.createTutorial=function(){return UnitTutorialEditModal.show($scope.unit)}}]}}),angular.module("doubtfire.units",["doubtfire.units.modals","doubtfire.units.states","doubtfire.units.stats","doubtfire.units.unit-analytics-viewer","doubtfire.units.unit-details-editor","doubtfire.units.unit-groupset-editor","doubtfire.units.unit-ilo-editor","doubtfire.units.unit-staff-editor","doubtfire.units.unit-student-list","doubtfire.units.unit-student-plagiarism-list","doubtfire.units.unit-student-portfolio-list","doubtfire.units.unit-students-editor","doubtfire.units.unit-tasks-editor","doubtfire.units.unit-tutorials-editor"]),angular.module("doubtfire.users.modals",["doubtfire.users.modals.user-notification-settings-modal","doubtfire.users.modals.user-settings-modal"]),angular.module("doubtfire.users.modals.user-notification-settings-modal",[]).factory("UserNotificationSettingsModal",["$modal",function($modal){var UserNotificationSettingsModal;return UserNotificationSettingsModal={},UserNotificationSettingsModal.show=function(user){return $modal.open({templateUrl:"users/modals/user-notification-settings-modal/user-notification-settings-modal.tpl.html",controller:"UserNotificationSettingsModalCtrl",resolve:{user:function(){return user}}})},UserNotificationSettingsModal}]).controller("UserNotificationSettingsModalCtrl",["$scope","$modalInstance","alertService","currentUser","User","user","auth",function($scope,$modalInstance,alertService,currentUser,User,user,auth){return $scope.user=user,$scope.currentUser=currentUser,$scope.modalState={},$scope.saveNotifications=function(){return User.update({id:$scope.user.id,user:$scope.user}).$promise.then(function(response){return $modalInstance.close(response),user.name=user.first_name+" "+user.last_name,user===currentUser.profile?auth.saveCurrentUser():void 0},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):void 0})}}]),angular.module("doubtfire.users.modals.user-settings-modal",[]).factory("UserSettingsModal",["$modal",function($modal){var UserSettingsModal;return UserSettingsModal={},UserSettingsModal.show=function(user){return $modal.open({templateUrl:"users/modals/user-settings-modal/user-settings-modal.tpl.html",controller:"UserSettingsModalCtrl",resolve:{user:function(){return user}}})},UserSettingsModal}]).controller("UserSettingsModalCtrl",["$scope","$modalInstance","alertService","analyticsService","currentUser","User","user","auth",function($scope,$modalInstance,alertService,analyticsService,currentUser,User,user,auth){var createNewUser,updateExistingUser;return $scope.user=user||new User({}),$scope.isNew=void 0===(null!=user?user.id:void 0),$scope.isNew&&($scope.users=User.query()),$scope.currentUser=currentUser,$scope.modalState={},createNewUser=function(){return User.create({user:$scope.user}).$promise.then(function(response){return $modalInstance.close(response),$scope.users?$scope.users.push(response):void 0},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):void 0})},updateExistingUser=function(){return User.update({id:$scope.user.id,user:$scope.user}).$promise.then(function(response){return $modalInstance.close(response),user.name=user.first_name+" "+user.last_name,user===currentUser.profile&&(auth.saveCurrentUser(),$scope.user.opt_in_to_research)?analyticsService.event("Doubtfire Analytics","User opted in research"):void 0},function(response){return null!=response.data.error?alertService.add("danger","Error: "+response.data.error,6e3):void 0})},$scope.saveUser=function(){return $scope.isNew?createNewUser():updateExistingUser()}}]),angular.module("doubtfire.users.states",["doubtfire.users.states.users-admin-view"]),angular.module("doubtfire.users.states.users-admin-view",[]).config(["headerServiceProvider",function(headerServiceProvider){var usersAdminViewStateData;return usersAdminViewStateData={url:"/admin/users",views:{main:{controller:"UsersAdminViewCtrl",templateUrl:"users/states/users-admin-view/users-admin-view.tpl.html"}},data:{pageTitle:"_Users Administration_",roleWhitelist:["Admin","Convenor"]}},headerServiceProvider.state("admin/users#index",usersAdminViewStateData)}]).controller("UsersAdminViewCtrl",["$scope","$modal","User","alertService","CsvResultModal","UserSettingsModal",function($scope,$modal,User,alertService,CsvResultModal,UserSettingsModal){return $scope.file_data={onBatchUserSuccess:function(response){return CsvResultModal.show("User CSV import results",response),$scope.users=User.query()},batchUserUrl:User.csvUrl(),batchUserFiles:{file:{name:"CSV File",type:"csv"}}},$scope.users=User.query(),$scope.sortOrder="id",$scope.currentPage=1,$scope.maxSize=5,$scope.pageSize=15,$scope.showUserModal=function(user){var userToShow;return userToShow=null!=user?user:new User({}),UserSettingsModal.show(userToShow)}}]),angular.module("doubtfire.users",["doubtfire.users.modals","doubtfire.users.states"]),angular.module("doubtfire.visualisations.achievement-box-plot",[]).directive("achievementBoxPlot",function(){return{replace:!0,restrict:"E",templateUrl:"visualisations/visualisation.tpl.html",scope:{rawData:"=data",type:"=",unit:"=",pctHolder:"=",height:"=?",showLegend:"=?"},controller:["$scope","$timeout","Visualisation","outcomeService",function($scope,$timeout,Visualisation,outcomeService){var iloMaxes,iloValues,rangeMax,refreshData,_ref;return $scope.showLegend=null==$scope.showLegend?!0:$scope.showLegend,$scope.height=null==$scope.height?600:$scope.height,iloValues=outcomeService.calculateTargets($scope.unit,$scope.unit,outcomeService.unitTaskStatusFactor()),iloMaxes=_.mapValues(iloValues,function(d){return _.reduce(d,function(memo,value){return memo+value},0)}),rangeMax=_.max(_.values(iloMaxes)),refreshData=function(newData){var isPct;return isPct=null!=$scope.pctHolder&&$scope.pctHolder.pct,$scope.options.chart.yDomain=isPct?[0,1]:[0,rangeMax],$scope.data=_.map(newData,function(d,id){var label,max;return max=iloMaxes[id],null!=max&&0!==max&&isPct||(max=1),label=_.find($scope.unit.ilos,{id:+id}).abbreviation,{label:label,values:{Q1:d.lower/max,Q2:d.median/max,Q3:d.upper/max,whisker_low:d.min/max,whisker_high:d.max/max}}}),$timeout(function(){var _ref;return null!=(null!=(_ref=$scope.api)?_ref.refresh:void 0)?$scope.api.refresh():void 0})},_ref=Visualisation("boxPlotChart","ILO Achievement Box Plot",{x:function(d){return d.label},height:$scope.height,showXAxis:$scope.showLegend,margin:{top:$scope.showLegend?20:20,right:$scope.showLegend?10:10,bottom:$scope.showLegend?60:20,left:$scope.showLegend?80:40},yAxis:{axisLabel:$scope.showLegend?"ILO Achievement":void 0},tooltip:{enabled:$scope.showLegend},maxBoxWidth:75,yDomain:[0,1]},{},"Achievement Box Plot"),$scope.options=_ref[0],$scope.config=_ref[1],$scope.$watch("pctHolder.pct",function(newData,oldData){return newData!==oldData?refreshData($scope.rawData):void 0}),refreshData($scope.rawData)}]}}),angular.module("doubtfire.visualisations.achievement-custom-bar-chart",[]).directive("achievementCustomBarChart",function(){return{replace:!0,restrict:"E",templateUrl:"visualisations/visualisation.tpl.html",scope:{project:"=",unit:"="},controller:["$scope","Visualisation","outcomeService","gradeService",function($scope,Visualisation,outcomeService,gradeService){var achievementData,currentProgress,max,targets,_ref;return $scope.showLegend=null!=$scope.showLegend?$scope.showLegend:!0,null==nv.models.achievementBar&&(nv.models.achievementBar=function(){var chart,color,container,dispatch,duration,forceY,getX,getY,height,id,margin,rectClass,renderWatch,showValues,valueFormat,width,x,x0,xDomain,xRange,y,y0,yDomain,yRange;return chart=function(selection){return renderWatch.reset(),selection.each(function(data){var availableHeight,availableWidth,backBarSeries,backBars,backBarsEnter,bars,barsEnter,container,g,gEnter,groups,seriesData,wrap,wrapEnter,x0,y0;availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this),nv.utils.initSVG(container),data.forEach(function(series,i){series.values.forEach(function(point){point.series=i})}),seriesData=xDomain&&yDomain?[]:data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),y0:d.y0}})}),x.domain(xDomain||d3.merge(seriesData).map(function(d){return d.x})).rangeBands(xRange||[0,availableWidth],.1),y.domain(yDomain||d3.extent(d3.merge(seriesData).map(function(d){return d.y}).concat(forceY))),y.range(showValues?yRange||[availableHeight-(y.domain()[0]<0?12:0),y.domain()[1]>0?12:0]:yRange||[availableHeight,0]),x0=x0||x,y0=y0||y.copy().range([y(0),y(0)]),wrap=container.selectAll("g.nv-wrap.nv-discretebar").data([data]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-discretebar"),gEnter=wrapEnter.append("g"),g=wrap.select("g"),gEnter.append("g").attr("class","nv-groups"),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key}),groups.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),groups.exit().watchTransition(renderWatch,"discreteBar: exit groups").style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),groups.attr("class",function(d,i){return"nv-group nv-series-"+i}),groups.watchTransition(renderWatch,"discreteBar: groups").style("stroke-opacity",1).style("fill-opacity",.75),"undefined"!=typeof targets&&null!==targets&&_.size(targets)>0&&(backBarSeries=groups.selectAll("g.nv-backBarSeries").data(function(d){return d.values}),backBarSeries.exit().remove(),backBarSeries.enter().append("g").attr("transform",function(d,i){return"translate("+x(getX(d,i))+.05*x.rangeBand()+", "+y(0)+")"
}),backBarSeries.attr("class",function(d,i){return"nv-backBarSeries nv-backSeries-"+i}).classed("hover",function(d){return d.hover}),backBars=backBarSeries.selectAll("g.nv-backBar").data(function(d){return _.map(_.values(d.targets),function(v){return{value:v,key:d.label}})}),backBars.exit().remove(),backBarsEnter=backBars.enter().append("g"),backBarsEnter.append("rect").attr("height",10).attr("width",.9*x.rangeBand()/data.length),backBarsEnter.on("mouseover",function(d,i){d3.select(this).classed("hover",!0),dispatch.elementMouseover({data:gradeService.grades[i],index:i,color:d.value.color})}).on("mouseout",function(d,i){d3.select(this).classed("hover",!1),dispatch.elementMouseout({data:gradeService.grades[i],index:i,color:d.value.color})}).on("mousemove",function(d,i){dispatch.elementMousemove({data:gradeService.grades[i],index:i,color:d.value.color})}).on("click",function(d,i){var element;element=this,dispatch.elementClick({data:gradeService.grades[i],index:i,color:d.value.color,event:d3.event,element:element}),d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({data:gradeService.grades[i],index:i,color:d.value.color}),d3.event.stopPropagation()}),backBars.attr("class",function(d){return d.value.height<0?"nv-backBar negative":"nv-backBar positive"}).select("rect").attr("class",rectClass).style("fill-opacity","0.2").style("fill",function(d){return d.value.color}).watchTransition(renderWatch,"discreteBar: backBars rect").attr("width",.9*x.rangeBand()/data.length),backBars.watchTransition(renderWatch,"discreteBar: backBars").attr("transform",function(d){var left,top;return left=x(d.key)+.05*x.rangeBand(),top=y(d.value.height+d.value.offset),"translate("+left+", "+top+")"}).select("rect").attr("height",function(d){return Math.max(Math.abs(y(d.value.height)-y(0)),1)})),bars=groups.selectAll("g.nv-bar").data(function(d){return d.values}),bars.exit().remove(),barsEnter=bars.enter().append("g").attr("transform",function(d,i){return"translate("+x(getX(d,i))+.25*x.rangeBand()+", "+y(0)+")"}).on("mouseover",function(d,i){d3.select(this).classed("hover",!0),dispatch.elementMouseover({data:d,index:i,color:d3.select(this).style("fill")})}).on("mouseout",function(d,i){d3.select(this).classed("hover",!1),dispatch.elementMouseout({data:d,index:i,color:d3.select(this).style("fill")})}).on("mousemove",function(d,i){dispatch.elementMousemove({data:d,index:i,color:d3.select(this).style("fill")})}).on("click",function(d,i){var element;element=this,dispatch.elementClick({data:d,index:i,color:d3.select(this).style("fill"),event:d3.event,element:element}),d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({data:d,index:i,color:d3.select(this).style("fill")}),d3.event.stopPropagation()}),barsEnter.append("rect").attr("height",0).attr("width",.5*x.rangeBand()/data.length),showValues?(barsEnter.append("text").attr("text-anchor","middle"),bars.select("text").text(function(d,i){return valueFormat(getY(d,i))}).watchTransition(renderWatch,"discreteBar: bars text").attr("x",.5*x.rangeBand()/2).attr("y",function(d,i){return getY(d,i)<0?y(getY(d,i))-y(0)+12:-4})):bars.selectAll("text").remove(),bars.attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).style("fill",function(d,i){return d.color||color(d,i)}).style("stroke",function(d,i){return d.color||color(d,i)}).select("rect").attr("class",rectClass).watchTransition(renderWatch,"discreteBar: bars rect").attr("width",.5*x.rangeBand()/data.length),bars.watchTransition(renderWatch,"discreteBar: bars").attr("transform",function(d,i){var left,top;return left=x(getX(d,i))+.25*x.rangeBand(),top=getY(d,i)<0?y(0):y(0)-y(getY(d,i))<1?y(0)-1:y(getY(d,i)),"translate("+left+", "+top+")"}).select("rect").attr("height",function(d,i){return Math.max(Math.abs(y(getY(d,i))-y(0)),1)}),x0=x.copy(),y0=y.copy()}),renderWatch.renderEnd("achievementBar immediate"),chart},margin={top:0,right:0,bottom:0,left:0},width=960,height=500,id=Math.floor(1e4*Math.random()),container=void 0,x=d3.scale.ordinal(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},forceY=[0],color=nv.utils.defaultColor(),showValues=!1,valueFormat=d3.format(",.2f"),xDomain=void 0,yDomain=void 0,xRange=void 0,yRange=void 0,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove","renderEnd"),rectClass="discreteBar",duration=250,x0=void 0,y0=void 0,renderWatch=nv.utils.renderWatch(dispatch,duration),chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},forceY:{get:function(){return forceY},set:function(_){forceY=_}},showValues:{get:function(){return showValues},set:function(_){showValues=_}},x:{get:function(){return getX},set:function(_){getX=_}},y:{get:function(){return getY},set:function(_){getY=_}},xScale:{get:function(){return x},set:function(_){x=_}},yScale:{get:function(){return y},set:function(_){y=_}},xDomain:{get:function(){return xDomain},set:function(_){xDomain=_}},yDomain:{get:function(){return yDomain},set:function(_){yDomain=_}},xRange:{get:function(){return xRange},set:function(_){xRange=_}},yRange:{get:function(){return yRange},set:function(_){yRange=_}},valueFormat:{get:function(){return valueFormat},set:function(_){valueFormat=_}},id:{get:function(){return id},set:function(_){id=_}},rectClass:{get:function(){return rectClass},set:function(_){rectClass=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration)}}}),nv.utils.initOptions(chart),chart},nv.models.achievementBarChart=function(){var achievementbar,chart,color,dispatch,duration,height,legend,margin,noData,renderWatch,rightAlignYAxis,rotateLabels,showLegend,showXAxis,showYAxis,staggerLabels,tooltip,width,wrapLabels,x,xAxis,y,yAxis;return chart=function(selection){return renderWatch.reset(),renderWatch.models(achievementbar),showXAxis&&renderWatch.models(xAxis),showYAxis&&renderWatch.models(yAxis),selection.each(function(data){var availableHeight,availableWidth,barsWrap,container,defsEnter,g,gEnter,that,wrap,x,xTicks,y;return container=d3.select(this),that=this,nv.utils.initSVG(container),availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=nv.utils.availableHeight(height,container,margin),chart.update=function(){dispatch.beforeUpdate(),container.transition().duration(duration).call(chart)},chart.container=this,!data||!data.length||data.filter(function(d){return d.values.length}).length<=0?(nv.utils.noData(chart,container),chart):(container.selectAll(".nv-noData").remove(),x=achievementbar.xScale(),y=achievementbar.yScale().clamp(!0),wrap=container.selectAll("g.nv-wrap.nv-discreteBarWithAxes").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-discreteBarWithAxes").append("g"),defsEnter=gEnter.append("defs"),g=wrap.select("g"),gEnter.append("g").attr("class","nv-x nv-axis"),gEnter.append("g").attr("class","nv-y nv-axis").append("g").attr("class","nv-zeroLine").append("line"),gEnter.append("g").attr("class","nv-barsWrap"),gEnter.append("g").attr("class","nv-legendWrap"),g.attr("transform","translate("+margin.left+","+margin.top+")"),showLegend&&(legend.width(availableWidth),g.select(".nv-legendWrap").datum(data).call(legend),margin.top!==legend.height()&&(margin.top=legend.height(),availableHeight=nv.utils.availableHeight(height,container,margin)),wrap.select(".nv-legendWrap").attr("transform","translate(0,"+-margin.top+")")),rightAlignYAxis&&g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)"),rightAlignYAxis&&g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)"),achievementbar.width(availableWidth).height(availableHeight),barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return!d.disabled})),barsWrap.transition().call(achievementbar),defsEnter.append("clipPath").attr("id","nv-x-label-clip-"+achievementbar.id()).append("rect"),g.select("#nv-x-label-clip-"+achievementbar.id()+" rect").attr("width",x.rangeBand()*(staggerLabels?2:1)).attr("height",16).attr("x",-x.rangeBand()/(staggerLabels?1:2)),showXAxis&&(xAxis.scale(x)._ticks(nv.utils.calcTicksX(availableWidth/100,data)).tickSize(-availableHeight,0),g.select(".nv-x.nv-axis").attr("transform","translate(0,"+(y.range()[0]+(achievementbar.showValues()&&y.domain()[0]<0?16:0))+")"),g.select(".nv-x.nv-axis").call(xAxis),xTicks=g.select(".nv-x.nv-axis").selectAll("g"),staggerLabels&&xTicks.selectAll("text").attr("transform",function(d,i,j){return"translate(0,"+(j%2===0?"5":"17")+")"}),rotateLabels&&xTicks.selectAll(".tick text").attr("transform","rotate("+rotateLabels+" 0,0)").style("text-anchor",rotateLabels>0?"start":"end"),wrapLabels&&g.selectAll(".tick text").call(nv.utils.wrapTicks,chart.xAxis.rangeBand())),showYAxis&&(yAxis.scale(y)._ticks(nv.utils.calcTicksY(availableHeight/36,data)).tickSize(-availableWidth,0),g.select(".nv-y.nv-axis").call(yAxis)),void g.select(".nv-zeroLine line").attr("x1",0).attr("x2",rightAlignYAxis?-availableWidth:availableWidth).attr("y1",y(0)).attr("y2",y(0)))}),renderWatch.renderEnd("achievementBar chart immediate"),chart},achievementbar=nv.models.achievementBar(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),tooltip=nv.models.tooltip(),margin={top:15,right:10,bottom:50,left:60},width=null,height=null,color=nv.utils.getColor(),showLegend=!1,showXAxis=!0,showYAxis=!0,rightAlignYAxis=!1,staggerLabels=!1,wrapLabels=!1,rotateLabels=0,x=void 0,y=void 0,noData=null,dispatch=d3.dispatch("beforeUpdate","renderEnd"),duration=250,xAxis.orient("bottom").showMaxMin(!1).tickFormat(function(d){return d}),yAxis.orient(rightAlignYAxis?"right":"left").tickFormat(d3.format(",.1f")),tooltip.duration(0).headerEnabled(!1).keyFormatter(function(d,i){return xAxis.tickFormat()(d,i)}),renderWatch=nv.utils.renderWatch(dispatch,duration),achievementbar.dispatch.on("elementMouseover.tooltip",function(evt){var key;key=chart.x()(evt.data),key=null==key?""+evt.data+" task range":"Your progress with "+key,evt.series={key:key,color:evt.color},tooltip.data(evt).hidden(!1)}),achievementbar.dispatch.on("elementMouseout.tooltip",function(){tooltip.hidden(!0)}),achievementbar.dispatch.on("elementMousemove.tooltip",function(){tooltip.position({top:d3.event.pageY,left:d3.event.pageX})(),tooltip()}),chart.dispatch=dispatch,chart.achievementbar=achievementbar,chart.legend=legend,chart.xAxis=xAxis,chart.yAxis=yAxis,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},showLegend:{get:function(){return showLegend},set:function(_){showLegend=_}},staggerLabels:{get:function(){return staggerLabels},set:function(_){staggerLabels=_}},rotateLabels:{get:function(){return rotateLabels},set:function(_){rotateLabels=_}},wrapLabels:{get:function(){return wrapLabels},set:function(_){wrapLabels=!!_}},showXAxis:{get:function(){return showXAxis},set:function(_){showXAxis=_}},showYAxis:{get:function(){return showYAxis},set:function(_){showYAxis=_}},noData:{get:function(){return noData},set:function(_){noData=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},duration:{get:function(){return duration},set:function(_){duration=_,renderWatch.reset(duration),achievementbar.duration(duration),xAxis.duration(duration),yAxis.duration(duration)}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_),achievementbar.color(color),legend.color(color)}},rightAlignYAxis:{get:function(){return rightAlignYAxis},set:function(_){rightAlignYAxis=_,yAxis.orient(_?"right":"left")}}}),nv.utils.inheritOptions(chart,achievementbar),nv.utils.initOptions(chart),chart}),targets=outcomeService.calculateTargets($scope.unit,$scope.unit,outcomeService.unitTaskStatusFactor()),currentProgress=outcomeService.calculateProgress($scope.unit,$scope.project),achievementData={key:"Learning Achievement",values:[]},max=0,_.each($scope.unit.ilos,function(ilo){var iloTargets;return iloTargets={},iloTargets[0]={offset:0,height:targets[ilo.id][0],color:gradeService.gradeColors.P},iloTargets[1]={offset:iloTargets[0].offset+iloTargets[0].height,height:targets[ilo.id][1],color:gradeService.gradeColors.C},iloTargets[2]={offset:iloTargets[1].offset+iloTargets[1].height,height:targets[ilo.id][2],color:gradeService.gradeColors.D},iloTargets[3]={offset:iloTargets[2].offset+iloTargets[2].height,height:targets[ilo.id][2],color:gradeService.gradeColors.HD},iloTargets[3].offset+iloTargets[3].height>max&&(max=iloTargets[3].offset+iloTargets[3].height),achievementData.values.push({label:ilo.name,value:currentProgress[0][ilo.id],targets:iloTargets})}),_ref=Visualisation("achievementBarChart","ILO Achievement Bar Chart",{height:600,duration:500,yDomain:[0,max],showValues:!1,showYAxis:!1,showLegend:!1,x:function(d){return d.label},y:function(d){return d.value},color:function(){return"#373737"}},{}),$scope.options=_ref[0],$scope.config=_ref[1],$scope.data=[achievementData]}]}}),angular.module("doubtfire.visualisations.alignment-bar-chart",[]).directive("alignmentBarChart",function(){return{replace:!0,restrict:"E",templateUrl:"visualisations/visualisation.tpl.html",scope:{project:"=",unit:"=",source:"=",taskStatusFactor:"="},controller:["$scope","Visualisation","projectService","gradeService","taskService","outcomeService",function($scope,Visualisation,projectService,gradeService,taskService,outcomeService){var xFn,yFn,_ref;return xFn=function(d){return d.label},yFn=function(d){return d.value},_ref=Visualisation("multiBarChart","ILO Alignment Bar Chart",{clipEdge:!0,stacked:!1,height:200,duration:500,color:function(d){return gradeService.gradeColors[gradeService.gradeAcronyms[d.key]]},x:xFn,y:yFn,forceY:0,showYAxis:!1},{}),$scope.options=_ref[0],$scope.config=_ref[1],$scope.data=[],$scope.calculateAlignmentVisualisation=function(source){var unit;return unit=$scope.unit,_.extend($scope.data,outcomeService.targetsByGrade($scope.unit,source)),null!=$scope.api?$scope.api.update():void 0},$scope.calculateAlignmentVisualisation($scope.source,$scope.taskStatusFactor),$scope.$on("UpdateAlignmentChart",function(){return $scope.calculateAlignmentVisualisation($scope.source,$scope.taskStatusFactor)})}]}}),angular.module("doubtfire.visualisations.alignment-bullet-chart",[]).directive("alignmentBulletChart",function(){return{replace:!0,restrict:"E",templateUrl:"visualisations/visualisation.tpl.html",scope:{project:"=",unit:"=",ilo:"=",targets:"=",currentProgress:"=",classStats:"=",showLegend:"=?"},controller:["$scope","gradeService","Visualisation",function($scope,gradeService,Visualisation){var targetC,targetD,targetHD,targetP,updateProgress,_ref;return $scope.showLegend=null!=$scope.showLegend?$scope.showLegend:!0,null==nv.models.iloBullet&&(nv.models.iloBullet=function(){var chart,color,container,dispatch,forceX,height,margin,markerLabels,markers,measureLabels,measures,orient,rangeLabels,ranges,reverse,tickFormat,width;return chart=function(selection){return selection.each(function(d,i){var availableHeight,availableWidth,container,g,gEnter,h3,markerData,markerLabelz,markerz,measureLabelz,measurez,rangeC,rangeD,rangeHD,rangeLabelz,rangeP,rangez,w0,w1,wrap,wrapEnter,x0,x1,xp0,xp1;availableWidth=width-($scope.legend?margin.left:0)-($scope.legend?margin.right:0),availableHeight=height-margin.top-margin.bottom,container=d3.select(this),nv.utils.initSVG(container),rangez=ranges.call(this,d,i).slice().reverse(),markerz=markers.call(this,d,i).slice().sort(d3.descending),measurez=measures.call(this,d,i),rangeLabelz=rangeLabels.call(this,d,i).slice().reverse(),markerLabelz=markerLabels.call(this,d,i).slice(),measureLabelz=measureLabels.call(this,d,i).slice(),x1=d3.scale.linear().domain(d3.extent(d3.merge([forceX,rangez]))).range(reverse?[availableWidth,0]:[0,availableWidth]),x0=this.__chart__||d3.scale.linear().domain([0,1/0]).range(x1.range()),this.__chart__=x1,rangeHD=rangez[0],rangeD=rangez[1],rangeC=rangez[2],rangeP=rangez[3],wrap=container.selectAll("g.nv-wrap.nv-bullet").data([d]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-bullet"),gEnter=wrapEnter.append("g"),g=wrap.select("g"),gEnter.append("rect").attr("class","nv-range nv-rangeHD").style("fill-opacity","0.2").style("fill",gradeService.gradeColors.HD),gEnter.append("rect").attr("class","nv-range nv-rangeD").style("fill-opacity","0.2").style("fill",gradeService.gradeColors.D),gEnter.append("rect").attr("class","nv-range nv-rangeC").style("fill-opacity","0.2").style("fill",gradeService.gradeColors.C),gEnter.append("rect").attr("class","nv-range nv-rangeP").style("fill-opacity","0.2").style("fill",gradeService.gradeColors.P),gEnter.append("rect").attr("class","nv-measure"),gEnter.append("rect").attr("class","nv-median").style("fill-opacity","1.0").style("fill","#ffffff"),wrap.attr("transform","translate("+margin.left+","+margin.top+")"),w0=function(d){return Math.abs(x0(d)-x0(0))},w1=function(d){return Math.abs(x1(d)-x1(0))},xp0=function(d){return x0(d>0?d:0)},xp1=function(d){return x1(d>0?d:0)},g.select("rect.nv-rangeHD").attr("height",availableHeight).attr("width",w1(rangeHD-rangeD)).attr("x",xp1(rangeD)).datum(rangeHD),g.select("rect.nv-rangeD").attr("height",availableHeight).attr("width",w1(rangeD-rangeC)).attr("x",xp1(rangeC)).datum(rangeD),g.select("rect.nv-rangeC").attr("height",availableHeight).attr("width",w1(rangeC-rangeP)).attr("x",xp1(rangeP)).datum(rangeC),g.select("rect.nv-rangeP").attr("height",availableHeight).attr("width",w1(rangeP)).attr("x",xp1(0)).datum(rangeP),null!=measurez&&(g.select("rect.nv-median").style("fill","#373737").style("fill-opacity",.6).attr("height",availableHeight).attr("y",0).attr("width",2).attr("x",xp1(measurez.median)).on("mouseover",function(){dispatch.elementMouseover({value:measurez.median,label:"The average student is here",color:d3.select(this).style("fill")})}).on("mousemove",function(){dispatch.elementMousemove({value:measurez.median,label:"Class Median",color:d3.select(this).style("fill")})}).on("mouseout",function(){dispatch.elementMouseout({value:measurez.median,label:"Class Median",color:d3.select(this).style("fill")})}),g.select("rect.nv-measure").style("fill","#373737").style("fill-opacity",.6).attr("height",2*availableHeight/3).attr("y",availableHeight/6).attr("width",xp1(measurez.upper)-xp1(measurez.lower)).attr("x",xp1(measurez.lower)).on("mouseover",function(){dispatch.elementMouseover({value:measurez[0],label:measureLabelz[0]||"Current",color:d3.select(this).style("fill")})}).on("mousemove",function(){dispatch.elementMousemove({value:measurez[0],label:measureLabelz[0]||"Current",color:d3.select(this).style("fill")})}).on("mouseout",function(){dispatch.elementMouseout({value:measurez[0],label:measureLabelz[0]||"Current",color:d3.select(this).style("fill")})})),h3=availableHeight/6,markerData=markerz.map(function(marker,index){return{value:marker,label:markerLabelz[index]}}),gEnter.selectAll("path.nv-markerTriangle").data(markerData).enter().append("path").attr("class","nv-markerTriangle").attr("d",function(d,i){return i%2===0?"M0,"+h3+"L"+h3+","+-h3+" "+-h3+","+-h3+"Z":"M0,"+-h3+"L"+-h3+",0L0,"+h3+"L"+h3+",0Z"}).on("mouseover",function(d){dispatch.elementMouseover({value:d.value,label:d.label||"Previous",color:d3.select(this).style("fill"),pos:[x1(d.value),availableHeight/2]})}).on("mousemove",function(d){dispatch.elementMousemove({value:d.value,label:d.label||"Previous",color:d3.select(this).style("fill")})}).on("mouseout",function(d){dispatch.elementMouseout({value:d.value,label:d.label||"Previous",color:d3.select(this).style("fill")})}),g.selectAll("path.nv-markerTriangle").data(markerData).attr("transform",function(d){return"translate("+x1(d.value)+","+availableHeight/2+")"}),wrap.selectAll(".nv-range").on("mouseover",function(d,i){var label;label=rangeLabelz[i]||(i?1===i?"Mean":"Minimum":"Maximum"),dispatch.elementMouseover({value:d,label:label,color:d3.select(this).style("fill")})}).on("mousemove",function(){dispatch.elementMousemove({value:measurez[0],label:measureLabelz[0]||"Previous",color:d3.select(this).style("fill")})}).on("mouseout",function(d,i){var label;label=rangeLabelz[i]||(i?1===i?"Mean":"Minimum":"Maximum"),dispatch.elementMouseout({value:d,label:label,color:d3.select(this).style("fill")})})}),chart},margin={top:0,right:0,bottom:0,left:0},orient="left",reverse=!1,ranges=function(d){return d.ranges},markers=function(d){return d.markers?d.markers:[]},measures=function(d){return d.measures},rangeLabels=function(d){return d.rangeLabels?d.rangeLabels:[]},markerLabels=function(d){return d.markerLabels?d.markerLabels:[]},measureLabels=function(d){return d.measureLabels?d.measureLabels:[]},forceX=[0],width=380,height=30,container=null,tickFormat=null,color=nv.utils.getColor(["#1f77b4"]),dispatch=d3.dispatch("elementMouseover","elementMouseout","elementMousemove"),chart.dispatch=dispatch,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{ranges:{get:function(){return ranges},set:function(_){ranges=_}},markers:{get:function(){return markers},set:function(_){markers=_}},measures:{get:function(){return measures},set:function(_){measures=_}},forceX:{get:function(){return forceX},set:function(_){forceX=_}},width:{get:function(){return width},set:function(_){width=_}},height:{get:function(){return height},set:function(_){height=_}},tickFormat:{get:function(){return tickFormat},set:function(_){tickFormat=_}},margin:{get:function(){return margin},set:function(_){margin.top=void 0!==_.top?_.top:margin.top,margin.right=void 0!==_.right?_.right:margin.right,margin.bottom=void 0!==_.bottom?_.bottom:margin.bottom,margin.left=void 0!==_.left?_.left:margin.left}},orient:{get:function(){return orient},set:function(_){orient=_,reverse="right"===orient||"bottom"===orient}},color:{get:function(){return color},set:function(_){color=nv.utils.getColor(_)}}}),nv.utils.initOptions(chart),chart},nv.models.iloChart=function(){var bullet,chart,dispatch,height,margin,markers,measures,noData,orient,rangeLabels,ranges,reverse,tickFormat,ticks,tooltip,width;return bullet=nv.models.iloBullet(),tooltip=nv.models.tooltip(),orient="left",reverse=!1,margin=$scope.legend?{top:5,right:40,bottom:5,left:120}:{top:5,right:5,bottom:5,left:5},ranges=function(d){return d.ranges},rangeLabels=function(d){return d.rangeLabels},markers=function(d){return d.markers?d.markers:[]},measures=function(d){return d.measures},width=null,height=55,tickFormat=null,ticks=null,noData=null,dispatch=d3.dispatch,tooltip.duration(0).headerEnabled(!1),chart=function(selection){return selection.each(function(d,i){var availableHeight,availableWidth,bulletWrap,container,g,gEnter,markerz,measurez,rangez,that,title,w0,w1,wrap,wrapEnter,x0,x1;return container=d3.select(this),nv.utils.initSVG(container),availableWidth=nv.utils.availableWidth(width,container,margin),availableHeight=height-margin.top-margin.bottom,that=this,chart.update=function(){return chart(selection)},chart.container=this,d&&ranges.call(this,d,i)?(container.selectAll(".nv-noData").remove(),rangez=ranges.call(this,d,i).slice().sort(d3.descending),markerz=markers.call(this,d,i).slice().sort(d3.descending),measurez=measures.call(this,d,i),wrap=container.selectAll("g.nv-wrap.nv-bulletChart").data([d]),wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-bulletChart"),gEnter=wrapEnter.append("g"),g=wrap.select("g"),gEnter.append("g").attr("class","nv-bulletWrap"),$scope.legend&&gEnter.append("g").attr("class","nv-titles"),wrap.attr("transform","translate("+($scope.legend?margin.left:10)+","+margin.top+")"),x1=d3.scale.linear().domain([0,Math.max(rangez[0],markerz[0]||0,measurez[0])]).range(reverse?[availableWidth,0]:[0,availableWidth]),x0=this.__chart__||d3.scale.linear().domain([0,1/0]).range(x1.range()),this.__chart__=x1,w0=function(d){return Math.abs(x0(d)-x0(0))},w1=function(d){return Math.abs(x1(d)-x1(0))},$scope.legend&&(title=gEnter.select(".nv-titles").append("g").attr("text-anchor","end").attr("transform","translate(-6,"+(height-margin.top-margin.bottom)/2+")"),title.append("text").attr("class","nv-title").text(function(d){return d.title}),title.append("text").attr("class","nv-subtitle").attr("dy","1em").text(function(d){return d.subtitle})),bullet.width(availableWidth).height(availableHeight),bulletWrap=g.select(".nv-bulletWrap"),d3.transition(bulletWrap).call(bullet)):(nv.utils.noData(chart,container),chart)}),d3.timer.flush(),chart},bullet.dispatch.on("elementMouseover.tooltip",function(evt){return evt.series={key:evt.label,color:evt.color},tooltip.data(evt).hidden(!1)}),bullet.dispatch.on("elementMouseout.tooltip",function(){return tooltip.hidden(!0)}),bullet.dispatch.on("elementMousemove.tooltip",function(){return tooltip.position({top:d3.event.pageY,left:d3.event.pageX})(),tooltip()}),chart.bullet=bullet,chart.dispatch=dispatch,chart.tooltip=tooltip,chart.options=nv.utils.optionsFunc.bind(chart),chart._options=Object.create({},{ranges:{get:function(){return ranges},set:function(_){return ranges=_}},rangeLabels:{get:function(){return rangeLabels},set:function(_){return rangeLabels=_}},markers:{get:function(){return markers},set:function(_){return markers=_}},measures:{get:function(){return measures},set:function(_){return measures=_}},width:{get:function(){return width},set:function(_){return width=_}},height:{get:function(){return height},set:function(_){return height=_}},tickFormat:{get:function(){return tickFormat},set:function(_){return tickFormat=_}},ticks:{get:function(){return ticks},set:function(_){return ticks=_}},noData:{get:function(){return noData},set:function(_){return noData=_}},margin:{get:function(){return margin},set:function(_){return margin.top=null!=_.top?_.top:margin.top,margin.right=null!=_.right?_.right:margin.right,margin.bottom=null!=_.bottom?_.bottom:margin.bottom,margin.left=null!=_.left?_.left:margin.left}},orient:{get:function(){return orient},set:function(_){return orient=_,reverse="right"===orient||"bottom"===orient}}}),nv.utils.inheritOptions(chart,bullet),nv.utils.initOptions(chart),chart}),_ref=Visualisation("iloChart","ILO Alignment Bullet Chart",{height:60,duration:500},{}),$scope.options=_ref[0],$scope.config=_ref[1],targetP=$scope.targets[$scope.ilo.id][0],targetC=targetP+$scope.targets[$scope.ilo.id][1],targetD=targetC+$scope.targets[$scope.ilo.id][2],targetHD=targetD+$scope.targets[$scope.ilo.id][3],$scope.data={title:$scope.ilo.abbreviation,subtitle:$scope.ilo.name,ranges:[targetP,targetC,targetD,targetHD],rangeLabels:["Pass","Credit","Distinction","High Distinction"],measures:{},measureLabels:["Most of the class are in this area"],markers:[],markerLabels:["Your Suggested Progress - Staff Suggestion","Your Current Progress - Self Reflection"]},null!=$scope.classStats&&null!=$scope.classStats.title&&($scope.data.measureLabels[0]=$scope.classStats.title),updateProgress=function(){return null!=$scope.currentProgress&&_.each($scope.currentProgress,function(d,i){return $scope.data.markers[i]=$scope.currentProgress[i][$scope.ilo.id],null!=$scope.currentProgress[i].title?$scope.data.markerLabels[i]=$scope.currentProgress[i].title:void 0}),$scope.data.measures=null!=$scope.classStats&&null!=$scope.classStats[$scope.ilo.id]?$scope.classStats[$scope.ilo.id]:0},updateProgress(),$scope.$on("ProgressUpdated",function(){return updateProgress(),$scope.api?$scope.api.update():void 0})}]}}),angular.module("doubtfire.visualisations.progress-burndown-chart",[]).directive("progressBurndownChart",function(){return{replace:!0,restrict:"E",templateUrl:"visualisations/visualisation.tpl.html",scope:{project:"=",unit:"="},controller:["$scope","Visualisation",function($scope,Visualisation){var colorFunction,dates,i,ticks,toUTS,weeksTotal,xAxisClipNegBurndown,xAxisTickFormatDateFormat,xDomain,yAxisClipNegBurndown,yAxisTickFormatPercentFormat,_ref;return $scope.data=[],$scope.$watch("project.burndown_chart_data",function(newValue){var now,timeSeries;if(null!=newValue)return now=+(new Date).getTime()/1e3,timeSeries={key:"NOW",values:[[now,0],[now,1]],color:"#CACACA",classed:"dashed"},_.find(newValue,{key:"NOW"})||newValue.push(timeSeries),$scope.data.length=0,_.extend($scope.data,newValue),null!=$scope.api&&$scope.api.refresh(),null}),xAxisTickFormatDateFormat=function(d){return d3.time.format("%b %d")(new Date(1e3*d))},yAxisTickFormatPercentFormat=function(d){return d3.format(",%")(d)},colorFunction=function(d,i){return 0===i?"#AAAAAA":1===i?"#777777":2===i?"#0079d8":"#E01B5D"},xAxisClipNegBurndown=function(d){var c,m,originX,pt1x,pt1y,pt2x,pt2y,_ref,_ref1;return d[1]<0?(originX=$scope.project.burndown_chart_data[0].values[0][0],_ref=[originX,1],pt1x=_ref[0],pt1y=_ref[1],_ref1=[d[0],d[1]],pt2x=_ref1[0],pt2y=_ref1[1],m=(pt2y-pt1y)/(pt2x-pt1x),c=pt1y-m*pt1x,-c/m):d[0]},yAxisClipNegBurndown=function(d){return d[1]<0?0:d[1]},dates={start:moment($scope.unit.start_date),end:moment($scope.unit.end_date).add(2,"weeks")},toUTS=function(momentDate){return+momentDate/1e3},xDomain=[toUTS(dates.start),toUTS(dates.end)],weeksTotal=dates.end.diff(dates.start,"weeks"),ticks=function(){var _i,_results;for(_results=[],i=_i=0;weeksTotal>=0?weeksTotal>=_i:_i>=weeksTotal;i=weeksTotal>=0?++_i:--_i)_results.push(toUTS(moment(dates.start).add(i,"weeks")));return _results}(),_ref=Visualisation("lineChart","Student Progress Burndown Chart",{useInteractiveGuideline:!0,interactiveLayer:{tooltip:{contentGenerator:function(data){var d,date,html,series;return date=data.value,series=data.series,html="<table class='col-sm-6'><thead><tr><td colspan='3'><strong class='x-value'>"+date+"</strong></td></tr></thead><tbody>",html+=function(){var _i,_len,_results;for(_results=[],_i=0,_len=series.length;_len>_i;_i++)d=series[_i],"NOW"!==d.key&&_results.push("<tr><td class='legend-color-guide'><div style='background-color: "+d.color+";'></div></td><td class='key'>"+d.key+"</td><td class='value'>"+d3.format(",%")(d.value)+"</td></tr><tr>");return _results}().join(""),html+="</tbody></table>"}}},height:440,margin:{left:75,right:50},xAxis:{axisLabel:"Time",tickFormat:xAxisTickFormatDateFormat,tickValues:ticks},yAxis:{axisLabel:"Tasks Remaining",tickFormat:yAxisTickFormatPercentFormat},color:colorFunction,legendColor:colorFunction,x:xAxisClipNegBurndown,y:yAxisClipNegBurndown,yDomain:[0,1],xDomain:xDomain},{}),$scope.options=_ref[0],$scope.config=_ref[1],_ref}]}}),angular.module("doubtfire.visualisations.student-task-status-pie-chart",[]).directive("studentTaskStatusPieChart",function(){return{replace:!0,restrict:"E",templateUrl:"visualisations/visualisation.tpl.html",scope:{project:"="},controller:["$scope","taskService","projectService","Visualisation",function($scope,taskService,projectService,Visualisation){var colors,updateData,_ref;return colors=taskService.statusColors,$scope.data=[],updateData=function(){return $scope.data.length=0,_.each(taskService.statusLabels,function(label,key){var count;return count=projectService.tasksByStatus($scope.project,key).length,$scope.data.push({key:label,y:count,status_key:key})}),$scope.api?$scope.api.update():void 0},$scope.$on("TaskStatusUpdated",function(){return updateData()}),$scope.$on("TargetGradeUpdated",function(){return updateData()}),updateData(),_ref=Visualisation("pieChart","Student Task Status Pie Chart",{color:function(d){return colors[d.status_key]
},x:function(d){return d.key},y:function(d){return d.y},showLabels:!1,tooltip:{valueFormatter:function(d){var fixed,pct,task;return fixed=d.toFixed(),pct=Math.round(d/$scope.project.tasks.length*100),task=1===fixed?"task":"tasks",""+fixed+" "+task+" ("+pct+"%)"},keyFormatter:function(d){return d}}},{}),$scope.options=_ref[0],$scope.config=_ref[1],_ref}]}}),angular.module("doubtfire.visualisations.summary-task-status-scatter",[]).directive("summaryTaskStatusScatter",function(){return{replace:!0,restrict:"E",templateUrl:"visualisations/visualisation.tpl.html",scope:{data:"=",unit:"="},controller:["$scope","taskService","Visualisation",function($scope,taskService,Visualisation){var xAxisTickFormatFunction,yAxisTickFormatFunction,_ref;return yAxisTickFormatFunction=function(value){return $scope.unit.task_definitions[value]?$scope.unit.task_definitions[value].abbreviation:""},xAxisTickFormatFunction=function(value){var idx;return idx=Math.floor(value),taskService.statusAcronym[taskService.statusKeys[idx]]},_ref=Visualisation("scatterChart","Task Status Summary Scatter Chart",{xAxis:{axisLabel:"Statuses",tickFormat:xAxisTickFormatFunction},yAxis:{axisLabel:"Task",tickFormat:yAxisTickFormatFunction},showDistX:!0,showDistY:!0},{}),$scope.options=_ref[0],$scope.config=_ref[1],_ref}]}}),angular.module("doubtfire.visualisations.target-grade-pie-chart",[]).directive("targetGradePieChart",function(){return{replace:!0,restrict:"E",templateUrl:"visualisations/visualisation.tpl.html",scope:{rawData:"=data",showLegend:"=?",height:"=?"},controller:["$scope","$timeout","gradeService","projectService","Visualisation",function($scope,$timeout,gradeService,projectService,Visualisation){var colors,updateData,zeroMargin,_ref;return colors=gradeService.gradeColors,updateData=function(rawData){return $scope.data=_.map(rawData,function(value,grade){return $scope.total=_.chain(rawData).values().reduce(function(memo,num){return memo+num},0).value(),{key:gradeService.grades[grade],y:value,status_key:grade}}),$timeout(function(){var _ref;return null!=(null!=(_ref=$scope.api)?_ref.refresh:void 0)?$scope.api.refresh():void 0})},updateData($scope.rawData),$scope.$watch("rawData",updateData),zeroMargin={top:0,right:0,bottom:0,left:0},_ref=Visualisation("pieChart","Target Grade Summary Chart",{color:function(d){return colors[d.status_key]},x:function(d){return d.key},y:function(d){return d.y},showLabels:!1,margin:zeroMargin,legend:{padding:64,margin:zeroMargin},height:$scope.height,showLegend:$scope.showLegend,tooltip:{valueFormatter:function(d){var pct;return pct=Math.round(d/$scope.total*100),""+pct+"%"},keyFormatter:function(d){return d}}},{}),$scope.options=_ref[0],$scope.config=_ref[1],_ref}]}}),angular.module("doubtfire.visualisations.task-completion-box-plot",[]).directive("taskCompletionBoxPlot",function(){return{replace:!0,restrict:"E",templateUrl:"visualisations/visualisation.tpl.html",scope:{rawData:"=data",unit:"=",type:"=",height:"=?",showLegend:"=?"},controller:["$scope","$filter","$timeout","gradeService","Visualisation",function($scope,$filter,$timeout,gradeService,Visualisation){var refreshData,_ref;return $scope.showLegend=null==$scope.showLegend?!0:$scope.showLegend,$scope.height=null==$scope.height?600:$scope.height,refreshData=function(newData){return $scope.data="grade"!==$scope.type?[{label:$filter("ucfirst")($scope.type),values:{Q1:newData.lower,Q2:newData.median,Q3:newData.upper,whisker_low:newData.min,whisker_high:newData.max}}]:_.map(newData,function(d,id){var label;return label=gradeService.grades[id],{label:label,values:{Q1:d.lower,Q2:d.median,Q3:d.upper,whisker_low:d.min,whisker_high:d.max}}}),$timeout(function(){var _ref;return null!=(null!=(_ref=$scope.api)?_ref.refresh:void 0)?$scope.api.refresh():void 0})},$scope.$watch("rawData",refreshData),refreshData($scope.rawData),_ref=Visualisation("boxPlotChart","Task Completion Summary Box Plot",{x:function(d){return d.label},height:$scope.height,showXAxis:$scope.showLegend,margin:{top:$scope.showLegend?20:20,right:$scope.showLegend?10:10,bottom:$scope.showLegend?60:20,left:$scope.showLegend?80:40},yAxis:{axisLabel:$scope.showLegend?"Number of tasks completed":void 0},tooltip:{enabled:$scope.showLegend},maxBoxWidth:75,yDomain:[0,2*Math.ceil($scope.unit.task_definitions.length/2)]},{}),$scope.options=_ref[0],$scope.config=_ref[1],_ref}]}}),angular.module("doubtfire.visualisations.task-status-pie-chart",[]).directive("taskStatusPieChart",function(){return{replace:!0,restrict:"E",templateUrl:"visualisations/visualisation.tpl.html",scope:{rawData:"=data",showLegend:"=?",height:"=?"},controller:["$scope","$timeout","taskService","projectService","Visualisation",function($scope,$timeout,taskService,projectService,Visualisation){var colors,updateData,zeroMargin,_ref;return colors=taskService.statusColors,updateData=function(rawData){return $scope.total=_.chain(rawData).values().reduce(function(memo,num){return memo+num},0).value(),$scope.data=_.map(rawData,function(value,status){return{key:taskService.statusLabels[status],y:value,status_key:status}}),$timeout(function(){var _ref;return null!=(null!=(_ref=$scope.api)?_ref.refresh:void 0)?$scope.api.refresh():void 0})},updateData($scope.rawData),$scope.$watch("rawData",updateData),zeroMargin={top:0,right:0,bottom:0,left:0},_ref=Visualisation("pieChart","Task Status Summary Pie Chart",{color:function(d){return colors[d.status_key]},x:function(d){return d.key},y:function(d){return d.y},showLabels:!1,margin:zeroMargin,height:$scope.height,legend:{padding:64,margin:zeroMargin},showLegend:$scope.showLegend,tooltip:{valueFormatter:function(d){var pct;return pct=Math.round(d/$scope.total*100),""+pct+"%"},keyFormatter:function(d){return d}}},{}),$scope.options=_ref[0],$scope.config=_ref[1],_ref}]}}),angular.module("doubtfire.visualisations",["doubtfire.visualisations.summary-task-status-scatter","doubtfire.visualisations.progress-burndown-chart","doubtfire.visualisations.alignment-bar-chart","doubtfire.visualisations.alignment-bullet-chart","doubtfire.visualisations.student-task-status-pie-chart","doubtfire.visualisations.task-status-pie-chart","doubtfire.visualisations.target-grade-pie-chart","doubtfire.visualisations.task-completion-box-plot","doubtfire.visualisations.achievement-box-plot","doubtfire.visualisations.achievement-custom-bar-chart"]).factory("Visualisation",["$interval","analyticsService",function($interval,analyticsService){var Visualisation;return Visualisation=function(type,visualisationName,opts,conf,titleOpts,subtitleOpts){var DEFAULT_CONF,DEFAULT_OPTS,dirtyConf,dirtyOpts;return DEFAULT_OPTS={objectequality:!0,interactive:!0,showValues:!0,showXAxis:!0,showYAxis:!0,showLegend:!0,transitionDuration:500,duration:500,height:600,color:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"]},DEFAULT_CONF={visible:!0,extended:!1,disabled:!1,autorefresh:!0,refreshDataOnly:!0,deepWatchOptions:!0,deepWatchData:!1,deepWatchConfig:!0,debounce:10},dirtyOpts=angular.extend({},DEFAULT_OPTS,opts),dirtyOpts.type=type,dirtyConf=angular.extend({},DEFAULT_CONF,conf),analyticsService.event("Visualisations","Created Visualisation",visualisationName),[{chart:dirtyOpts,title:titleOpts,subtitle:subtitleOpts},dirtyConf]},Visualisation.refreshAll=function(){return $interval(function(){return window.dispatchEvent(new Event("resize"))},50,1)},Visualisation}]),angular.module("localization",[]).factory("localize",["$http","$rootScope","$window","$filter",function($http,$rootScope,$window,$filter){var localize={language:$window.navigator.userLanguage||$window.navigator.language,dictionary:[],resourceFileLoaded:!1,successCallback:function(data){localize.dictionary=data,localize.resourceFileLoaded=!0,$rootScope.$broadcast("i18nReady")},setLanguage:function(value){localize.language=value,localize.initLocalizedResources()},initLocalizedResources:function(){var url="src/i18n/resources-locale_"+localize.language+".js";$http({method:"GET",url:url,cache:!1}).success(localize.successCallback).error(function(){var url="src/i18n/resources-locale_default.js";$http({method:"GET",url:url,cache:!1}).success(localize.successCallback)})},getLocalizedString:function(value){var result="";if(localize.dictionary!==[]&&localize.dictionary.length>0){var entry=$filter("filter")(localize.dictionary,function(element){return element.key===value})[0];result=entry.value}return result}};return localize.initLocalizedResources(),localize}]).filter("i18n",["localize",function(localize){return function(input){return localize.getLocalizedString(input)}}]).directive("i18n",["localize",function(localize){var i18nDirective={restrict:"EAC",updateText:function(elm,token){var values=token.split("|");if(values.length>=1){var tag=localize.getLocalizedString(values[0]);if(null!==tag&&tag!==undefined&&""!==tag){if(values.length>1)for(var index=1;index<values.length;index++){var target="{"+(index-1)+"}";tag=tag.replace(target,values[index])}elm.text(tag)}}},link:function(scope,elm,attrs){scope.$on("i18nReady",function(){i18nDirective.updateText(elm,attrs.i18n)}),attrs.$observe("i18n",function(){i18nDirective.updateText(elm,attrs.i18n)})}};return i18nDirective}]).directive("i18nAttr",["localize",function(localize){var i18NAttrDirective={restrict:"EAC",updateText:function(elm,token){var values=token.split("|"),tag=localize.getLocalizedString(values[0]);if(null!==tag&&tag!==undefined&&""!==tag){if(values.length>2)for(var index=2;index<values.length;index++){var target="{"+(index-2)+"}";tag=tag.replace(target,values[index])}elm.attr(values[1],tag)}},link:function(scope,elm,attrs){scope.$on("localizeResourcesUpdated",function(){i18NAttrDirective.updateText(elm,attrs.i18nAttr)}),attrs.$observe("i18nAttr",function(value){i18NAttrDirective.updateText(elm,value)})}};return i18NAttrDirective}]),angular.module("utilService",[]).filter("fromNow",function(){return function(date){return moment(new Date(date)).fromNow()}}).filter("titleize",function(){return function(input){return _.string.titleize(input)}}).filter("humanize",function(){return function(input){return _.string.humanize(input)}}).directive("autoFillSync",["$timeout",function($timeout){return{require:"ngModel",link:function(scope,elem,attrs,ngModel){var origVal;return origVal=elem.val(),$timeout(function(){var newVal;return newVal=elem.val(),ngModel.$pristine&&origVal!==newVal?ngModel.$setViewValue(newVal):void 0},500)}}}]),angular.module("templates-app",["common/alert-list/alert-list.tpl.html","common/file-uploader/file-uploader.tpl.html","common/grade-icon/grade-icon.tpl.html","common/header/header.tpl.html","common/markdown-editor/markdown-editor.tpl.html","common/modals/about-doubtfire-modal/about-doubtfire-modal.tpl.html","common/modals/confirmation-modal/confirmation-modal.tpl.html","common/modals/csv-result-modal/csv-result-modal.tpl.html","common/modals/progress-modal/progress-modal.tpl.html","common/pdf-panel-viewer/pdf-panel-viewer.tpl.html","common/status-icon/status-icon.tpl.html","errors/states/not-found/not-found.tpl.html","errors/states/timeout/timeout.tpl.html","errors/states/unauthorised/unauthorised.tpl.html","groups/group-member-contribution-assigner/group-member-contribution-assigner.tpl.html","groups/group-member-list/group-member-list.tpl.html","groups/group-selector/group-selector.tpl.html","groups/groupset-group-manager/groupset-group-manager.tpl.html","groups/groupset-selector/groupset-selector.tpl.html","groups/student-group-manager/student-group-manager.tpl.html","groups/tutor-group-manager/tutor-group-manager.tpl.html","home/states/home/home.tpl.html","home/states/new-user-wizard/new-user-wizard.tpl.html","projects/project-lab-list/project-lab-list.tpl.html","projects/project-outcome-alignment/project-outcome-alignment.tpl.html","projects/project-portfolio-wizard/portfolio-add-extra-files-step/portfolio-add-extra-files-step.tpl.html","projects/project-portfolio-wizard/portfolio-compile-step/portfolio-compile-step.tpl.html","projects/project-portfolio-wizard/portfolio-files-list/portfolio-files-list.tpl.html","projects/project-portfolio-wizard/portfolio-grade-select-step/portfolio-grade-select-step.tpl.html","projects/project-portfolio-wizard/portfolio-learning-summary-report-step/portfolio-learning-summary-report-step.tpl.html","projects/project-portfolio-wizard/portfolio-review-step/portfolio-review-step.tpl.html","projects/project-portfolio-wizard/portfolio-tasks-step/portfolio-tasks-step.tpl.html","projects/project-portfolio-wizard/project-portfolio-wizard.tpl.html","projects/project-progress-dashboard/project-progress-dashboard.tpl.html","projects/project-viewer/project-viewer.tpl.html","projects/states/show/show.tpl.html","sessions/states/sign-in/sign-in.tpl.html","sessions/states/sign-out/sign-out.tpl.html","tasks/modals/grade-task-modal/grade-task-modal.tpl.html","tasks/project-tasks-list/project-tasks-list.tpl.html","tasks/project-top-tasks-list/project-top-tasks-list.tpl.html","tasks/stats/task-completion-stats/task-completion-stats.tpl.html","tasks/stats/task-status-stats/task-status-stats.tpl.html","tasks/stats/task-summary-stats/task-summary-stats.tpl.html","tasks/task-comments-viewer/task-comments-viewer.tpl.html","tasks/task-definition-editor/task-definition-editor.tpl.html","tasks/task-definition-selector/task-definition-selector.tpl.html","tasks/task-feedback-assessor-list/task-feedback-assessor-list.tpl.html","tasks/task-feedback-assessor/task-feedback-assessor.tpl.html","tasks/task-ilo-alignment/modals/task-ilo-alignment-modal/task-ilo-alignment-modal.tpl.html","tasks/task-ilo-alignment/task-ilo-alignment-editor/task-ilo-alignment-editor.tpl.html","tasks/task-ilo-alignment/task-ilo-alignment-rater/task-ilo-alignment-rater.tpl.html","tasks/task-ilo-alignment/task-ilo-alignment-viewer/task-ilo-alignment-viewer.tpl.html","tasks/task-plagiarism-file-viewer/task-plagiarism-file-viewer.tpl.html","tasks/task-plagiarism-report-viewer/task-plagiarism-report-viewer.tpl.html","tasks/task-sheet-viewer/task-sheet-viewer.tpl.html","tasks/task-status-selector/task-status-selector.tpl.html","tasks/task-submission-viewer/task-submission-viewer.tpl.html","tasks/task-submission-wizard/task-submission-wizard.tpl.html","tasks/task-viewer/task-viewer.tpl.html","units/modals/unit-create-modal/unit-create-modal.tpl.html","units/modals/unit-ilo-edit-modal/unit-ilo-edit-modal.tpl.html","units/modals/unit-mark-submissions-offline-modal/unit-mark-submissions-offline-modal.tpl.html","units/modals/unit-student-enrolment-modal/unit-student-enrolment-modal.tpl.html","units/modals/unit-tutorial-edit-modal/unit-tutorial-edit-modal.tpl.html","units/states/edit-unit-view/edit-unit-view.tpl.html","units/states/teacher-view/teacher-view.tpl.html","units/states/units-admin-view/units-admin-view.tpl.html","units/stats/unit-achievement-stats/unit-achievement-stats.tpl.html","units/stats/unit-target-grade-stats/unit-target-grade-stats.tpl.html","units/unit-analytics-viewer/unit-analytics-viewer.tpl.html","units/unit-details-editor/unit-details-editor.tpl.html","units/unit-groupset-editor/unit-groupset-editor.tpl.html","units/unit-ilo-editor/unit-ilo-editor.tpl.html","units/unit-staff-editor/unit-staff-editor.tpl.html","units/unit-student-list/unit-student-list.tpl.html","units/unit-student-plagiarism-list/unit-student-plagiarism-list.tpl.html","units/unit-student-portfolio-list/unit-student-portfolio-list.tpl.html","units/unit-students-editor/unit-students-editor.tpl.html","units/unit-tasks-editor/unit-tasks-editor.tpl.html","units/unit-tutorials-editor/unit-tutorials-editor.tpl.html","users/modals/user-notification-settings-modal/user-notification-settings-modal.tpl.html","users/modals/user-settings-modal/user-settings-modal.tpl.html","users/states/users-admin-view/users-admin-view.tpl.html","visualisations/visualisation.tpl.html"]),angular.module("common/alert-list/alert-list.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("common/alert-list/alert-list.tpl.html",'<div class="alert-top">\n  <alert ng-repeat="alert in alerts" class="col-xs-12 col-md-4 col-md-push-8" type="{{alert.type}}" close="alert.close()">\n    <div class="alert-wrapper">\n      <i class="fa fa-3x"></i>\n      <div class="alert-content">\n        <h4>{{alert.type | ucfirst}}</h4>\n        <div ng-bind-html="alert.msg"></div>\n      </div>\n    </div>\n  </alert>\n</div>')}]),angular.module("common/file-uploader/file-uploader.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("common/file-uploader/file-uploader.tpl.html",'<div class="file-uploader" ng-class="{ \'is-uploading\': isUploading }">\n  <div ng-if="uploadingInfo == null" ng-repeat="upload in uploadZones" class="file-drop-area">\n    <h3 class="file-title">\n      {{uploadZones.length == 1 ? \'\' : $index + 1 + \' -\'}} {{upload.display.name}}\n    </h3>\n    <div ngf-select ngf-drop\n      ng-show="upload.model == null || upload.model.length == 0"\n      class="drop well {{upload.display.error ? \'file-rejected\' : \'\'}}"\n      ng-model="upload.model"\n      ng-model-rejected="upload.rejects"\n      ngf-change="checkForError(upload)"\n      ngf-accept="{{upload.accept}}"\n      ngf-drag-over-class="{accept:\'file-over\', reject:\'file-over\', delay:100}"\n      ngf-drop-available="dropSupported">\n        <p class="fa {{upload.display.icon}} fa-3x"></p>\n        <p ng-show="upload.display.error">\n          Invalid file provided\n          <small> Accepted files: <code>{{upload.accept}}</code> </small>\n        </p>\n        <p ng-show="dropSupported" ng-hide="upload.display.error">\n          Drop {{upload.display.type}} file here\n          <small> or click to select one </small>\n        </p>\n        <p ng-hide="dropSupported || upload.display.error">\n          Click to select {{upload.display.type}} file\n        </p>\n      </div><!--/drop-zone-->\n    <div ng-hide="upload.model == null || upload.model.length == 0">\n      <p class="file-registered">\n        <i class="fa {{upload.display.icon}}"></i>\n        {{upload.model[0].name}}\n      </p>\n      <a class="clear-upload text-muted" ng-click="clearEnqueuedUpload(upload)">\n        <i class="fa fa-times"></i>\n      </a>\n      </p>\n    </div><!--/actual-file-->\n  </div><!--/drop-zones-->\n  <div ng-show="readyToUpload()" class="upload-area text-center clearfix">\n    <button ng-show="uploadingInfo == null" ng-click="initiateUpload()" class="btn btn-primary btn-download">\n      <i class="fa fa-upload"></i> Upload\n    </button><!--/upload-button-->\n    <div ng-hide="uploadingInfo == null || uploadingInfo.complete" class="progress-area">\n      <div class="icons">\n        <i ng-repeat="upload in uploadZones" class="fa {{upload.display.icon}}"></i>\n        <i class="fa fa-arrow-right"></i>\n        <i class="logo"></i>\n      </div>\n      <progressbar class="progress-striped active" value="uploadingInfo.progress"></progressbar>\n    </div><!--/progress-area-->\n    <div ng-if="uploadingInfo.complete" class="result-area">\n      <i class="fa {{uploadingInfo.success === true ? \'fa-check-circle text-success\' : \'fa-times-circle text-danger\'}} fa-4x"></i>\n      <h3>Upload {{uploadingInfo.success === true ? \'Successful\' : \'Failed\'}}</h3>\n      <div class="error-message-area" ng-hide="uploadingInfo.success === true">\n        <p>\n          <strong>Error Message: </strong>\n          {{uploadingInfo.error}}\n        </p>\n        <p class="retry-options">\n          <a href=\'\' ng-click="initiateUpload()">Retry Upload</a>\n          <a href=\'\' ng-click="resetUploader()">Cancel</a>\n        </p><!--/error-message-area-->\n      </div>\n    </div><!--/result-area-->\n  </div><!--/upload-area-->\n</div>\n')}]),angular.module("common/grade-icon/grade-icon.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("common/grade-icon/grade-icon.tpl.html",'<span class="grade-icon grade-{{grade}}" tooltip="{{gradeText(grade)}}">{{gradeLetter(grade)}}</span>\n')}]),angular.module("common/header/header.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("common/header/header.tpl.html",'<nav class="navbar navbar-default" role="navigation" ng-show="$parent.showHeader">\n  <!-- Brand and toggle get grouped for better mobile display -->\n  <div class="navbar-header">\n      <button type="button" class="navbar-toggle" ng-init="navCollapsed = true" ng-click="navCollapsed = !navCollapsed">\n        <span class="sr-only">Toggle navigation</span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n      </button>\n    <a class="navbar-brand" href="#">\n      <i class="logo"></i>\n      <h1 class="logo">Doubtfire</h1>\n    </a>\n  </div>\n  <!-- Collect the nav links, forms, and other content for toggling -->\n  <div class="collapse navbar-collapse" ng-class="!navCollapsed && \'in\'" ng-show="!navCollapsed">\n    <ul class="nav navbar-nav navbar-right">\n      <li class="dropdown dropdown-admin" dropdown ng-repeat="menu in menus | orderBy:\'name\'">\n        <a class="dropdown-toggle" dropdown-toggle role="button"><span class="glyphicon glyphicon-{{menu.icon}}">{{menu.name}}</span><b class="caret"></b></a>\n        <ul class="dropdown-menu">\n          <li ng-repeat="link in menu.links | orderBy:\'name\'"\n              ng-class="{active: link.class === \'active\'}">\n            <a href="{{link.url}}">{{link.name}}</a>\n          </li>\n        </ul>\n      </li>\n\n      <li class="dropdown dropdown-units" dropdown ng-hide="projects.length == 0 && unitRoles.length == 0">\n        <a role="button" class="dropdown-toggle" dropdown-toggle><span class="glyphicon glyphicon-book"></span> Units <b class="caret"></b></a>\n        <ul class="dropdown-menu">\n          <li ng-hide="unitRoles.length == 0" class="dropdown-header">Units You Teach</li>\n          <li ng-repeat="unitRole in unitRoles | filter:isUniqueUnitRole">\n            <a href="#/units?unitRole={{unitRole.id}}">\n                <small class="unit-info">\n                  <label class="label label-info small">{{unitRole.unit_code}}</label>\n                  <small class="text-muted">{{showDate(unitRole.start_date)}}</small>\n                </small>\n                <span class="unit-name">{{unitRole.unit_name}}</span>\n              </a>\n          </li>\n          <li ng-hide="unitRoles.length == 0 || projects.length == 0" class="divider"></li>\n          <li ng-hide="projects.length == 0" class="dropdown-header" ng-hide="{{projects.length}}">Units You Study</li>\n          <li ng-repeat="project in projects">\n            <a href="#/projects/{{project.project_id}}">\n              <small class="unit-info">\n                <label class="label label-info small">{{project.unit_code}}</label>\n                <small class="text-muted">{{showDate(project.start_date)}}</small>\n              </small>\n              <span class="unit-name">{{project.unit_name}}</span>\n            </a>\n            </a>\n          </li>\n        </ul>\n      </li>\n\n      <li class="dropdown" dropdown if-role="Admin">\n        <a class="dropdown-toggle" dropdown-toggle><span class="glyphicon glyphicon-wrench"></span> Administration<b class="caret"></b></a>\n        <ul class="dropdown-menu">\n          <li><a href="#/admin/units">Manage Units</a></li>\n          <li><a href="#/admin/users">Manage Users</a></li>\n        </ul>\n      </li>\n\n      <li class="dropdown" dropdown if-role="Convenor">\n        <a class="dropdown-toggle" dropdown-toggle><span class="glyphicon glyphicon-wrench"></span> Administration<b class="caret"></b></a>\n        <ul class="dropdown-menu">\n          <li><a href="#/admin/units">Manage Units</a></li>\n          <li><a href="#/admin/users">Manage Users</a></li>\n        </ul>\n      </li>\n\n      <li class="dropdown" dropdown>\n        <a class="dropdown-toggle" dropdown-toggle><span class="glyphicon glyphicon-user"></span> {{currentUser.name}} {{currentUser.nickname ? \'(\' + currentUser.nickname + \')\' : \'\'}}<b class="caret"></b></a>\n        <ul class="dropdown-menu">\n          <li><a ng-click="openUserSettings()">Profile</a></li>\n          <li><a ng-click="openNotificationSettings()">Notifications</a></li>\n          <li class="divider"></li>\n          <li><a ng-click="openAboutModal()">About</a></li>\n          <li class="divider"></li>\n          <li><a href="#/sign_out">Sign Out</a></li>\n        </ul>\n      </li>\n    </ul>\n  </div><!-- /.navbar-collapse -->\n</nav>\n')}]),angular.module("common/markdown-editor/markdown-editor.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("common/markdown-editor/markdown-editor.tpl.html",'<div class="markdown-editor">\n  <div class="markdown-editor-inner-context">\n    <div ng-show="isEditing" ui-codemirror="{ onLoad : codemirrorLoaded }" ui-codemirror-opts="editorOpts" ui-refresh="true" ng-model="markdownText"></div>\n    <div style="{{heightStyle()}}" class="markdown-editor-preview markdown-to-html" ng-hide="isEditing">\n      <div ng-bind-html="markdownText | markdown"></div>\n    </div>\n    <div class="markdown-editor-actions">\n      <span ng-click="isEditing = !isEditing" class="markdown-editor-action fa-stack fa-lg" tooltip="{{isEditing ? \'View preview\' : \'Continue editing\'}}">\n        <i class="fa fa-{{isEditing ? \'eye\' : \'pencil\'}} fa-stack-1x"></i>\n      </span>\n      <a href="https://en.support.wordpress.com/markdown-quick-reference/" target="_blank" class="markdown-editor-action fa-stack fa-lg" tooltip="Markdown guide">\n        <i class="fa fa-question fa-stack-1x"></i>\n      </a>\n    </div>\n  </div>\n</div>\n')}]),angular.module("common/modals/about-doubtfire-modal/about-doubtfire-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("common/modals/about-doubtfire-modal/about-doubtfire-modal.tpl.html",'<div class="modal-about">\n  <div class="modal-header">\n    <i class="logo"></i>\n    <h1 class="full logo">\n      Doubtfire\n      <small>\n        Version 4\n      </small>\n    </h1>\n  </div>\n  <div class="modal-body">\n    <h2>Contributors</h2>\n    <ul>\n      <li ng-repeat="person in contributors">\n        <a ng-href="{{person.website}}">\n          <img ng-src="{{person.avatar}}">\n          <span class="name">{{person.name}}</span>\n        </a>\n        <a ng-href="{{person.github}}" class="handler">@{{person.handler}}</a>\n      </li>\n    </ul>\n    <p class="text-muted text-center">\n      &copy; 2012&ndash;2016. Made in Melbourne.\n    </p>\n    <p class="text-muted text-center logo-smallprint">\n      Doubtfire is an <a href="http://github.com/doubtfire-lms">Open Source</a> project licensed under <strong>GNU Affero General Public License (AGPL) v3.0</strong>. Star us on <a href="http://github.com/doubtfire-lms/doubtfire-web">GitHub</a>!\n      <br>\n      The Doubtfire Logo adapted under Creative Commons from "Progress" by Creative Stall from the <a href="https://thenounproject.com/search/?q=progress&i=175994">Noun Project</a>.\n    </p>\n  </div>\n  <div class="modal-footer">\n    <button class="btn btn-primary" ng-click="close()">Done</button>\n  </div>\n</div>\n')}]),angular.module("common/modals/confirmation-modal/confirmation-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("common/modals/confirmation-modal/confirmation-modal.tpl.html",'<div class="confirmation-modal">\n  <div class="modal-header clearfix">\n    <h3 class="modal-title">\n      <i class="fa fa-question fa-2x pull-left"></i>\n      <div>{{title}}</div>\n      <small>Please confirm that you want to perform this action.</small>\n    </h3>\n  </div>\n  <div class="modal-body">\n    <div class="large-notice-block">\n      <p>\n        {{message}}\n      </p>\n    </div>\n  </div>\n  <div class="modal-footer clearfix">\n    <button class="btn btn-success pull-right" ng-click="confirmAction()">\n      <i class="fa fa-check"> Confirm </i>\n    </button>\n    <button class="btn btn-danger pull-right" ng-click="cancelAction()">\n      <i class="fa fa-times"> Cancel </i>\n    </button>\n  </div>\n</div>\n')}]),angular.module("common/modals/csv-result-modal/csv-result-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("common/modals/csv-result-modal/csv-result-modal.tpl.html",'<div class="csv-result-modal">\n  <div class="modal-header clearfix">\n    <h3 class="modal-title">\n      <i class="fa fa-file-excel-o fa-2x pull-left"></i>\n      {{title}}\n      <small>Response details</small>\n    </h3>\n  </div>\n  <div class="modal-body clearfix">\n    <p class="btn-group col-sm-8 col-sm-offset-2">\n        <button class="btn btn-default col-sm-4" ng-class="{ \'btn-success\': activeCsvResponseSelection == \'success\' }" ng-model="activeCsvResponseSelection" btn-radio="\'success\'">\n          Success <span class="badge pull-right">{{response.success.length}}</span>\n        </button>\n        <button class="btn btn-default col-sm-4" ng-class="{ \'btn-danger\': activeCsvResponseSelection == \'errors\' }" ng-model="activeCsvResponseSelection" btn-radio="\'errors\'">\n          Errors <span class="badge pull-right">{{response.errors.length}}</span>\n        </button>\n        <button class="btn btn-default col-sm-4" ng-class="{ \'btn-warning\': activeCsvResponseSelection == \'ignored\' }" ng-model="activeCsvResponseSelection" btn-radio="\'ignored\'">\n          Ignored <span class="badge pull-right">{{response.ignored.length}}</span>\n        </button>\n    </p>\n    <div ng-hide="response[activeCsvResponseSelection].length > 0" class="callout callout-info col-sm-12">\n      No data to show\n    </div>\n    <table ng-show="response[activeCsvResponseSelection].length > 0" class="table table-condensed table-hover">\n      <thead>\n          <tr>\n              <th class="message">\n                  Message\n              </th>\n              <th class="data">\n                  Data\n              </th>\n          </tr>\n      </thead>\n      <tbody>\n          <tr ng-repeat="item in response[activeCsvResponseSelection] | startFrom:(currentPage - 1) * pageSize | limitTo: pageSize">\n              <td>\n                {{item.message}}\n              </td>\n              <td class="csv-row">\n                {{item.row}}\n              </td>\n          </tr>\n      </tbody>\n  </table><!--/enrolment-table-->\n  </div>\n  <div class="modal-footer clearfix">\n    <pagination ng-show="response[activeCsvResponseSelection].length > pageSize" total-items="response[activeCsvResponseSelection].length" ng-model="currentPage" items-per-page="pageSize" max-size="maxSize" class="pagination-sm pull-left" boundary-links="true" rotate="false"></pagination>\n    <button class="btn btn-primary pull-right" ng-click="close()">Done</button>\n  </div>\n</div>')}]),angular.module("common/modals/progress-modal/progress-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("common/modals/progress-modal/progress-modal.tpl.html",'<div class="progress-modal">\n  <div class="modal-header clearfix">\n    <h3 class="modal-title">\n      <i class="fa fa-spinner fa-2x pull-left"></i>\n      <div>{{title}}</div>\n      <small>{{message}}</small>\n    </h3>\n  </div>\n  <div class="modal-body">\n    <div class="large-notice-block">\n      <i class="fa fa-3x fa-spinner fa-pulse"></i>\n      <p>Processing...</p>\n    </div>\n  </div>\n  <div class="modal-footer clearfix">\n    <p class="help-block col-sm-6 col-sm-offset-3 text-center">\n      You can close this modal and you will be alerted when processing has finished\n    </p>\n    <button class="btn btn-primary pull-right" ng-click="close()">\n      <i class="fa fa-check"></i>\n    </button>\n  </div>\n</div>\n')}]),angular.module("common/pdf-panel-viewer/pdf-panel-viewer.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("common/pdf-panel-viewer/pdf-panel-viewer.tpl.html",'<div class="pdf-panel-viewer">\n  <div class="panel-body">\n    <div class="iframe-wrapper">\n      <iframe ng-if="shouldShowIframe" ng-src="{{googleDocsUrl}}"></iframe>\n      <div class="loading-icon">\n        <i class="fa fa-spinner fa-pulse fa-2x"></i>\n        <p class="loading-text">\n          Loading PDF\n        </p>\n      </div>\n    </div>\n  </div><!--/panel-body-->\n  <div class="panel-footer" ng-if="!hideFooter">\n    <div class="pull-left text-muted" ng-show="footerText">\n      <strong>Note:</strong> {{footerText}}\n    </div>\n    <div class="pull-right btn-group">\n      <a ng-click="downloadEvent(\'Resources\')" ng-href="{{resourcesUrl}}" class="btn btn-primary" ng-if="resourcesUrl">\n        <i class="fa fa-download"></i><span> Resources</span>\n      </a>\n      <a ng-click="downloadEvent(\'PDF\')" ng-href="{{pdfUrl}}" class="btn btn-success">\n        <i class="fa fa-download"></i><span ng-show="resourcesUrl"> PDF</span>\n      </a>\n    </div>\n  </div><!--/panel-footer-->\n</div>\n')
}]),angular.module("common/status-icon/status-icon.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("common/status-icon/status-icon.tpl.html",'<div class="status-icon {{statusClass(status)}}">\n  <i class="fa fa-{{statusIcon(status)}}" tooltip="{{statusLabel(status)}}"></i>\n</div>\n')}]),angular.module("errors/states/not-found/not-found.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("errors/states/not-found/not-found.tpl.html",'<div class="container text-center">\n  <div class="error-container">\n    <i class="fa fa-question-circle"></i>\n    <h1>Not Found</h1>\n    <p>This page doesn\'t exist.</p>\n  </div>\n</div>')}]),angular.module("errors/states/timeout/timeout.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("errors/states/timeout/timeout.tpl.html",'<div class="container text-center">\n  <div class="error-container">\n    <i class="fa fa-clock-o"></i>\n    <h1>Authentication Timeout</h1>\n    <p>Your session has expired and you need to log back in to proceed.</p>\n  </div>\n</div>')}]),angular.module("errors/states/unauthorised/unauthorised.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("errors/states/unauthorised/unauthorised.tpl.html",'<div class="container text-center">\n  <div class="error-container">\n    <i class="fa fa-exclamation-triangle"></i>\n    <h1>Unauthorised</h1>\n    <p>You do not have sufficient permissions to access this resource, or your session has expired.</p>\n  </div>\n</div>')}]),angular.module("groups/group-member-contribution-assigner/group-member-contribution-assigner.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("groups/group-member-contribution-assigner/group-member-contribution-assigner.tpl.html",'<div class="group-member-contribution-assigner">\n  <h4>\n    Team Contribution<br/>\n    <small>\n      Please rate each team member\'s contribution to this work. To mark a <i>0% contribution</i>, click the first star twice.\n    </small>\n  </h4>\n  <table class="table table-condensed table-hover">\n    <thead>\n      <tr>\n        <th><a ng-click="memberSortOrder=\'student_name\'; reverse=!reverse">Team Member</a></th>\n        <th><a ng-click="memberSortOrder=\'target_grade\'; reverse=!reverse">Target Grade</a></th>\n        <th class="col-sm-4"><a ng-click="memberSortOrder=\'rating\'; reverse=!reverse">Contribution</a></th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr ng-repeat="member in team.members | orderBy:memberSortOrder:reverse">\n        <td>{{member.student_name}}</td>\n        <td>{{gradeFor(member)}}</td>\n        <td ng-init="member.rating = initialStars">\n          <rating class="group-member-contribution-rating" ng-click="checkClearRating(member)" ng-model="member.rating" on-hover="hoveringOver(member, value)" on-leave="hoveringOver(member, null)" max="numStars"></rating>\n          <span class="label" ng-class="{\'label-danger\': member.percent==dangerPct, \'label-warning\': member.percent>dangerPct && member.percent<infoPct,\'label-info\': member.percent>=infoPct && member.percent<successPct, \'label-success\': member.percent>=successPct}" ng-show="member.overStar">{{member.percent}}%</span>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n')}]),angular.module("groups/group-member-list/group-member-list.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("groups/group-member-list/group-member-list.tpl.html",'<div class="group-member-list">\n  <div ng-hide="members.length > 0">\n    <div class="callout callout-info">\n      There are no members in this group\n    </div>\n  </div>\n  <table ng-show="members.length > 0" class="table table-condensed table-hover">\n    <thead>\n      <tr>\n        <th ng-if="assessingUnitRole">\n          <a href="" ng-click="memberSortOrder=\'student_id\'; reverse=!reverse"> Student ID  <i ng-show="memberSortOrder == \'student_id\'" class="fa fa-caret-{{reverse ? \'up\' : \'down\'}}"></i>\n          </a>\n        </th>\n        <th>\n          <a href="" ng-click="memberSortOrder=\'student_name\'; reverse=!reverse">\n            Name <i ng-show="memberSortOrder == \'student_name\'" class="fa fa-caret-{{reverse ? \'up\' : \'down\'}}"></i>\n          </a>\n        </th>\n        <th>\n          <a href="" ng-click="memberSortOrder=\'target_grade\'; reverse=!reverse">\n            Target Grade <i ng-show="memberSortOrder == \'target_grade\'" class="fa fa-caret-{{reverse ? \'up\' : \'down\'}}"></i>\n          </a>\n        </th>\n        <th ng-if="assessingUnitRole && removeGroupMember">Actions</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr ng-repeat="member in members | orderBy:memberSortOrder:reverse">\n        <td class="student-id" ng-if="assessingUnitRole"><a href="#/projects/{{member.project_id}}?unitRole={{assessingUnitRole.id}}">{{member.student_id}}</a></td>\n        <td class="student-name">{{member.student_name}}</td>\n        <td class="student-grade">\n          <grade-icon grade="member.target_grade"></grade-icon>\n        </td>\n        <td class="actions" ng-if="assessingUnitRole && removeGroupMember">\n          <button ng-click="removeGroupMember(member)" class="btn btn-small btn-danger">\n            <i class="fa fa-trash-o"></i>\n          </button>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n')}]),angular.module("groups/group-selector/group-selector.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("groups/group-selector/group-selector.tpl.html",'<div class="col-sm-12 group-selector">\n  <form name="addGroupForm" class="add-group-form input-group" ng-if="assessingUnitRole || selectedGroupset.allow_students_to_create_groups" ng-submit="addGroup(groupAddName)">\n    <input class="form-control" placeholder="Add New Group..." ng-model="groupAddName">\n    <span class="input-group-btn">\n      <button type="submit" class="btn btn-success">\n        <i class="fa fa-plus"></i>\n      </button>\n    </span>\n  </form>\n  <div ng-hide="filteredGroups.length > 0">\n    <div class="callout callout-info">\n      {{selectedGroupset.name}} has no groups {{(staffFilter == \'mine\' || selectedGroupset.keep_groups_in_same_class) ? \'in this tutorial\' : \'\' }}\n    </div>\n  </div>\n  <table ng-show="filteredGroups.length > 0" class="table table-condensed table-hover table-pointer">\n    <thead>\n      <tr>\n        <th>\n          <a href="" ng-click="groupSortOrder=\'name\'; grpReverse=!grpReverse">\n            Group Name <i ng-show="groupSortOrder == \'name\'" class="fa fa-caret-{{grpReverse ? \'up\' : \'down\'}}"></i>\n          </a>\n        </th>\n        <th>\n          <a href="" ng-click="groupSortOrder=\'tutorial_id\'; grpReverse=!grpReverse">\n            Tutorial <i ng-show="groupSortOrder == \'tutorial_id\'" class="fa fa-caret-{{grpReverse ? \'up\' : \'down\'}}"></i>\n          </a>\n        </th>\n        <th ng-show="assessingUnitRole">Actions</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr ng-repeat="grp in filteredGroups = (groups | groupFilter:unit:selectedGroupset:project:assessingUnitRole:staffFilter) | orderBy:groupSortOrder:grpReverse | startFrom:(currentPage - 1) * pageSize | limitTo: pageSize" ng-class="{info: grp == selectedGroup}">\n        <td ng-click="selectGroup(grp)" class="group-name">\n          <span editable-text="grp.name" e-name="name" e-form="grpRowform" e-required>\n            {{ grp.name || \'empty\' }}\n          </span>\n        </td>\n        <td ng-click="selectGroup(grp)" class="tutorial-id">\n          <span editable-select="grp.tutorial_id" e-name="tutorial_id" e-form="grpRowform" e-ng-options="t.id as t.abbreviation for t in unit.tutorials">\n            <div tooltip-html-unsafe="<strong>{{selectTutorial(grp.tutorial_id).meeting_day}} {{selectTutorial(grp.tutorial_id).meeting_time | date: \'shortTime\'}}</strong><br/> {{selectTutorial(grp.tutorial_id).meeting_location}} - {{selectTutorial(grp.tutorial_id).tutor_name}}">\n              {{ selectTutorial(grp.tutorial_id).abbreviation }}\n            </div>\n          </span>\n        </td>\n        <td class="actions" ng-show="assessingUnitRole">\n          <form editable-form name="grpRowform" onbeforesave="saveGroup($data, grp.id)" ng-show="grpRowform.$visible" class="form-buttons form-inline" shown="inserted == grp">\n            <button type="submit" ng-disabled="grpRowform.$waiting" class="btn btn-primary">\n              <i class="fa fa-floppy-o"></i>\n            </button>\n            <button type="button" ng-disabled="grpRowform.$waiting" ng-click="grpRowform.$cancel()" class="btn btn-default">\n              <i class="fa fa-times"></i>\n            </button>\n          </form>\n          <div ng-show="!grpRowform.$visible">\n            <button ng-click="grpRowform.$show()" class="btn btn-primary">\n              <i class="fa fa-pencil"></i>\n            </button>\n            <button ng-click="removeGroup(grp)" class="btn btn-danger">\n              <i class="fa fa-trash-o"></i>\n            </button>\n          </div><!--/actions-->\n        </td>\n      </tr>\n    </tbody>\n  </table>\n  <div ng-show="filteredGroups.length > pageSize" class="text-center col-sm-12">\n    <pagination total-items="filteredGroups.length" ng-model="currentPage" items-per-page="pageSize" max-size="maxSize" class="pagination-sm" boundary-links="true" rotate="false"></pagination>\n  </div>\n</div>\n')}]),angular.module("groups/groupset-group-manager/groupset-group-manager.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("groups/groupset-group-manager/groupset-group-manager.tpl.html",'<div class="groupset-group-manager">\n\n  <div class="group-listings col-sm-6">\n    <div class="panel panel-primary">\n      <div class="clearfix info-area panel-heading">\n        <div class="col-sm-8 pull-left">\n          <h4 class="panel-title">\n            <strong>{{selectedGroupset.name}}</strong> Groups\n          </h4>\n          Total of {{groups.length}} Group{{groups.length == 1 ? \'\' : \'s\'}}\n        </div>\n        <div class="pull-right col-sm-4 text-right multi-group-actions">\n          <div class="btn-group">\n            <label class="btn btn-default col-sm-6" ng-model="staffFilter" btn-radio="\'all\'">\n              <i class="fa fa-university" tooltip="Show groups from every tutorial"></i>\n            </label>\n            <label class="btn btn-default col-sm-6" ng-model="staffFilter" btn-radio="\'mine\'">\n              <i class="fa fa-pencil" tooltip="Show groups from only my tutorials"></i>\n            </label>\n          </div>\n        </div>\n      </div>\n      <div class="panel-body">\n        <group-selector></group-selector>\n      </div>\n    </div>\n  </div>\n\n\n\n    <div class="col-sm-6" ng-hide="selectedGroup">\n      <div class="group-memberships not-selected" >\n        <i class="fa fa-3x fa-chevron-circle-right"></i><i class="fa fa-3x fa-users"></i>\n        <p>Please select a group in the groups list on the left</p>\n      </div>\n    </div>\n\n\n  <div class="col-sm-6" ng-show="selectedGroup">\n    <div class="group-memberships">\n      <div class="panel panel-default">\n        <div class="panel-heading">\n          <h4 class="panel-title">Members of <strong>{{selectedGroup.name}}</strong></h4>\n        </div>\n        <div class="panel-body">\n          <form name="addStudentForm" ng-submit="addSelectedStudent(selectedStudent)" class="input-group" ng-show="selectedGroup">\n            <input class="form-control" id="students" placeholder="Add Student" ng-model="selectedStudent" typeahead="student as studentDetails(student) for student in unit.active_students() | studentsForGroup:selectedGroupset:selectedGroup:members | filter:$viewValue | limitTo:8" typeahead-wait-ms="200">\n            <span class="input-group-btn">\n              <button type="submit" ng-disabled="!selectedStudent.project_id" class="btn btn-success">\n                <i class="fa fa-plus"></i>\n              </button>\n            </span>\n          </form>\n          <group-member-list></group-member-list>\n        </div>\n      </div>\n    </div>\n  </div>\n\n\n</div>\n')}]),angular.module("groups/groupset-selector/groupset-selector.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("groups/groupset-selector/groupset-selector.tpl.html",'<div class="groupset-selector">\n  <span class="dropdown" dropdown>\n    <h3 class="nav dropdown-toggle" dropdown-toggle>{{selectedGroupset.name}} <span class="caret"></span></h3>\n    <ul class="dropdown-menu">\n      <li ng-repeat="gs in unit.group_sets" ng-click="selectGroupSet(gs)"><a href="">{{gs.name}}</a></li>\n    </ul>\n  </span>\n</div>')}]),angular.module("groups/student-group-manager/student-group-manager.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("groups/student-group-manager/student-group-manager.tpl.html",'<div class="col-sm-8 col-sm-offset-2">\n  <div class="col-md-12">\n    <div class="groupset-switcher" ng-show="unit.group_sets.length > 1">\n      <groupset-selector></groupset-selector>\n      <hr/>\n    </div>\n    <div class="panel panel-default">\n      <div class="panel-heading">\n        <h3 class="panel-title">\n          <span ng-show="selectedGroup">\n            Group Members of\n            <strong>\n              <a editable-text="selectedGroup.name" ng-show="selectedGroupset.allow_students_to_manage_groups" onbeforesave="updateGroup($data)">{{selectedGroup.name}}</a>\n              <span ng-hide="selectedGroupset.allow_students_to_manage_groups">{{selectedGroup.name}}</span>\n            </strong>\n          </span>\n          <span ng-hide="selectedGroup">\n            Join a Group\n          </span>\n        </h3>\n      </div>\n      <div class="panel-body">\n        <group-member-list ng-show="selectedGroup"></group-member-list>\n        <div ng-hide="selectedGroup">\n          <group-selector ng-show="selectedGroupset.allow_students_to_manage_groups"></group-selector>\n          <span class="callout callout-info" ng-hide="selectedGroupset.allow_students_to_manage_groups">\n          <strong>You are not part of a group.</strong> Talk to your tutor or convenor and ask them to add you to a group.\n          </span>\n        </div>\n    </div>\n  </div>\n</div>')}]),angular.module("groups/tutor-group-manager/tutor-group-manager.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("groups/tutor-group-manager/tutor-group-manager.tpl.html",'\n  <div class="groupset-switcher" ng-show="unit.group_sets.length > 1">\n    <groupset-selector></groupset-selector>\n    <hr/>\n  </div>\n<div class="row">\n  <groupset-group-manager></groupset-group-manager>\n</div>\n')}]),angular.module("home/states/home/home.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("home/states/home/home.tpl.html",'<div id="home">\n  <div class="text-center welcome-to-doubtfire clearfix">\n    <i class="logo"></i>\n    <h1>Doubtfire</h1>\n    <p class="lead">Welcome back, {{userFirstName}}</p>\n  </div>\n  <div class="text-danger text-center" ng-show="notEnrolled()">\n    <i class="fa fa-university fa-4x"></i>  <i class="fa fa-arrow-right fa-4x"></i> <i class="fa fa-question fa-4x"></i>\n    <h4>You don\'t seem to be enrolled in any subjects</h4>\n    <p class="strong">Contact your unit convenor or tutor to enrol you in a subject.</p>\n  </div>\n  <div class="row">\n    <div class="panel-wrapper clearfix">\n      <div class="col-sm-12 col-md-4 panel-container" ng-if="unitRoles.length > 0 && currentUser.role != \'Student\'">\n        <div class="panel panel-primary panel-project">\n          <div class="panel-heading">\n            <h4 class="panel-title">Units You Teach</h4>\n          </div>\n          <div class="list-group">\n            <a ng-repeat="unitRole in unitRoles" ui-sref="units#show({unitRole: unitRole.id})" class="list-group-item clearfix">\n              <div>\n                <i class="fa fa-pencil"></i>\n                <h4 class="list-group-item-heading">{{unitRole.unit_name}} <small>{{showDate(unitRole.start_date)}}</small></h4>\n                <p class="list-group-item-text">\n                  <label class="label label-info">{{unitRole.unit_code}}</label>\n                  <label class="label label-primary">{{unitRole.role}}</label>\n                </p>\n              </div>\n            </a>\n          </div>\n          <div class="panel-body no-content" ng-if="unitRoles.length == 0">\n            <i class="fa fa-4x fa-pencil"></i>\n            You teach no units\n          </div>\n        </div>\n      </div><!--/project-teaching-->\n\n      <div class="col-sm-12 col-md-4 panel-container" ng-if="projects.length > 0">\n        <div class="panel panel-primary panel-project">\n          <div class="panel-heading">\n            <h4 class="panel-title">Units You Study</h4>\n          </div>\n          <div class="list-group">\n            <a ng-repeat="project in projects" ui-sref=\'projects#show({projectId: project.project_id})\' class="list-group-item clearfix">\n              <div>\n                <i class="fa fa-university"></i>\n                <h4 class="list-group-item-heading">{{project.unit_name}} <small>{{showDate(project.start_date)}}</small></h4>\n                <p class="list-group-item-text">\n                  <label class="label label-info">{{project.unit_code}}</label>\n                </p>\n              </div>\n            </a>\n          </div>\n          <div class="panel-body no-content" ng-if="projects.length == 0">\n            <i class="fa fa-4x fa-university"></i>\n            You study no units\n          </div>\n        </div>\n      </div><!--/project-panel-->\n\n      <div class="col-sm-12 col-md-4 panel-container" if-role="Admin Convenor">\n        <div class="panel panel-primary panel-admin">\n          <div class="panel-heading">\n            <h4 class="panel-title">Administration</h4>\n          </div>\n          <div class="list-group">\n            <a href="#/admin/units" class="list-group-item clearfix">\n              <div>\n                <i class="fa fa-university"></i>\n                <h4 class="list-group-item-heading">Manage Units</h4>\n                <p class="list-group-item-text">Add new units, or modify existing units you have convenor access to.</p>\n              </div>\n            </a>\n            <a href="#/admin/users" class="list-group-item clearfix">\n              <div>\n                <i class="fa fa-user"></i>\n                <h4 class="list-group-item-heading">Manage Users</h4>\n                <p class="list-group-item-text">Add, modify or remove existing users.</p>\n              </div>\n            </a>\n          </div>\n        </div>\n      </div><!--/admin-panel-->\n    </div>\n  </div>\n</div>\n')}]),angular.module("home/states/new-user-wizard/new-user-wizard.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("home/states/new-user-wizard/new-user-wizard.tpl.html",'<div class="new-user-wizard">\n  <div class="text-center welcome-to-doubtfire clearfix col-sm-12">\n    <i class="logo"></i>\n    <h1>Welcome to Doubtfire {{userFirstName}}</h1>\n    <p class="lead">To get you up and running, let us ask you a few questions</p>\n  </div>\n  <div class="new-user-wizard clearfix col-sm-12 col-md-6 col-md-offset-3">\n    <div class="panel panel-primary text-center">\n      <div class="panel-heading">\n        <h3 class="panel-title">{{currentStep.title}}</h3>\n      </div>\n      <div class="panel-body">\n        <p class="strong">{{currentStep.subtitle}}</p>\n        <div ng-show="currentStep == steps.nameStep" class="col-sm-12">\n          <div class="form-group col-sm-6">\n            <input class="form-control text-center input-lg" placeholder="First Name" ng-model="user.first_name">\n          </div>\n          <div class="form-group col-sm-6">\n            <input class="form-control text-center input-lg" placeholder="Last Name"  ng-model="user.last_name">\n          </div>\n        </div><!--/name-step-->\n        <div ng-show="currentStep == steps.nicknameStep">\n          <input class="form-control text-center input-lg" placeholder="Nickname or Preferred Name"  ng-model="user.nickname">\n          <p class="help-block col-sm-12 text-center">You can choose to leave this blank</p>\n        </div><!--/nickname-step-->\n        <div ng-show="currentStep == steps.emailStep">\n          <div class="form-group">\n            <input class="form-control input-lg text-center" placeholder="Email Address"  ng-model="user.email">\n          </div>\n          <hr>\n          <div class="form-group clearfix">\n            <div class="col-sm-12">\n              <label>Task Notifications</label>\n              <p class="help-block">\n                Recieve email notifications when new tasks become avaliable\n              </p>\n            </div>\n            <div class="col-sm-12">\n              <div class="btn-group">\n                <label class="btn btn-default" ng-model="user.receive_task_notifications" btn-radio="true">\n                  <i class="fa fa-check"></i>\n                </label>\n                <label class="btn btn-default" ng-model="user.receive_task_notifications" btn-radio="false">\n                  <i class="fa fa-close"></i>\n                </label>\n              </div>\n            </div>\n          </div>\n          <hr>\n          <div class="form-group clearfix">\n            <div class="col-sm-12">\n              <label>Feedback Notifications</label>\n              <p class="help-block">\n                Recieve email notifications when your tutor has feedback for you\n              </p>\n            </div>\n            <div class="col-sm-12">\n              <div class="btn-group">\n                <label class="btn btn-default" ng-model="user.receive_feedback_notifications" btn-radio="true">\n                  <i class="fa fa-check"></i>\n                </label>\n                <label class="btn btn-default" ng-model="user.receive_feedback_notifications" btn-radio="false">\n                  <i class="fa fa-close"></i>\n                </label>\n              </div>\n            </div>\n          </div>\n          <hr>\n          <div class="form-group clearfix">\n            <div class="col-sm-12">\n              <label>Portfolio Notifications</label>\n              <p class="help-block">\n                Recieve email notifications when your portfolio is ready to mark\n              </p>\n            </div>\n            <div class="col-sm-12">\n              <div class="btn-group">\n                <label class="btn btn-default" ng-model="user.receive_portfolio_notifications" btn-radio="true">\n                  <i class="fa fa-check"></i>\n                </label>\n                <label class="btn btn-default" ng-model="user.receive_portfolio_notifications" btn-radio="false">\n                  <i class="fa fa-close"></i>\n                </label>\n              </div>\n            </div>\n          </div>\n        </div><!--/email-step-->\n        <div ng-show="currentStep == steps.targetGradeStep">\n          <div ng-repeat="project in projects">\n            <div class="clearfix">\n              <p>\n                Select your target grade for {{project.unit_name}}\n              </p>\n              <div class="btn-group col-sm-12">\n                <label ng-repeat="grade in grades" class="btn btn-default col-sm-3" ng-model="project.target_grade" btn-radio="{{$index}}">\n                  <grade-icon grade="grade" class="text-{{project.target_grade == grades.indexOf(grade) ? \'primary\' : \'muted\'}}"></grade-icon>\n                </label>\n              </div>\n            </div>\n            <hr>\n          </div>\n          <p class="help-block">You can change this target at any time while you are enrolled.</p>\n        </div><!--/target-grade-step-->\n        <div ng-show="currentStep == steps.optInToResearchStep">\n          <div class="col-sm-12 text-center">\n            <div class="btn-group">\n              <label class="btn btn-default" ng-change="optInOnly && done(user)" ng-model="user.opt_in_to_research" btn-radio="true">\n                <i class="fa fa-check"></i> Yes, I\'ll help\n              </label>\n              <label class="btn btn-default" ng-change="optInOnly && done(user)" ng-model="user.opt_in_to_research" btn-radio="false">\n                <i class="fa fa-close"></i> No, thank you\n              </label>\n            </div>\n            <p class="help-block"> You may choose to opt-in or out later at any time. </p>\n          </div>\n        </div><!--/research-step-->\n      </div>\n      <div class="panel-footer clearfix" ng-hide="optInOnly">\n        <button class="btn btn-primary pull-left" ng-click="moveStep(-1)" ng-hide="currentStep == firstStep"><i class="fa fa-arrow-left"></i> Back</button>\n        <button class="btn btn-primary pull-right" ng-click="moveStep(1)" ng-disabled="determineDisabledForCurrentStep()" ng-hide="currentStep == lastStep">Next <i class="fa fa-arrow-right"></i></button>\n        <button class="btn btn-success pull-right" ng-click="done()" ng-disabled="determineDisabledForCurrentStep()" ng-show="currentStep == lastStep">Done <i class="fa fa-check"></i></a>\n      </div>\n    </div>\n  </div>\n</div>\n')}]),angular.module("projects/project-lab-list/project-lab-list.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/project-lab-list/project-lab-list.tpl.html",'<div class="col-sm-8 col-sm-offset-2">\n  <div class="panel panel-default">\n    <div class="panel-heading">\n      <h4 class="panel-title">Select a Tutorial</h4>\n      Click a check to assign yourself to that tutorial, or select the red cross at the end of the list to remove yourself from all tutorials.\n    </div>\n    <div class="panel-body">\n      <table class="table table-condensed table-hover">\n        <thead>\n          <tr>\n            <th>Lab Code</th>\n            <th><a href="" ng-click="sortOrder=\'meeting_day\'; reverse=!reverse">Day</a></th>\n            <th>Time</th>\n            <th>Room</th>\n            <th>Tutor</th>\n            <th>Assigned</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr ng-repeat="tutorial in unit.tutorials | orderBy:sortOrder:reverse">\n            <td>{{tutorial.abbreviation}}</td>\n            <td>{{tutorial.meeting_day}}</td>\n            <td>{{tutorial.meeting_time | date: \'shortTime\'}}</td>\n            <td>{{tutorial.meeting_location}}</td>\n            <td>{{tutorial.tutor_name}}</td>\n            <td ng-if="project.tutorial_id == tutorial.id"><button type="button" class="btn btn-success"><span class="glyphicon glyphicon-ok"></span> </button>\n            </td>\n            <td ng-if="project.tutorial_id != tutorial.id"><button type="button" class="btn btn-default" ng-click ="setTutorial(tutorial.id)"><span class="glyphicon glyphicon-minus"></span></button>\n            </td>\n          </tr>\n        </tbody>\n        <tfoot if-role="Tutor Convenor Admin">\n          <tr>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td><button type="button" class="btn btn-danger" ng-click="setTutorial(-1)"><span class="glyphicon glyphicon-remove"></span></button></td>\n          </tr>\n        </tfoot>\n      </table>\n    </div>\n  </div>\n</div>')}]),angular.module("projects/project-outcome-alignment/project-outcome-alignment.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/project-outcome-alignment/project-outcome-alignment.tpl.html",'<div>\n  <div style="margin-bottom:15px;">\n  <tabset class="task-feedback-tab-selector col-md-2" vertical="true" type="pills">\n    <tab ng-click="selectTab(\'progress\')">\n      <tab-heading tooltip="View learning progress" tooltip-placement="right" tooltip-popup-delay="200">\n        <div class="text-center">\n          <i class="fa fa-2x fa-bar-chart" style="margin-right: 1ex"></i>\n        </div>\n      </tab-heading>\n    </tab>\n    <tab ng-click="selectTab(\'reflect\')">\n      <tab-heading tooltip="Reflect on learning" tooltip-placement="right" tooltip-popup-delay="200">\n        <div class="text-center">\n          <i class="fa fa-2x fa-balance-scale" style="margin-right: 1ex"></i>\n        </div>\n      </tab-heading>\n    </tab>\n  </tabset><!--/tab-selector-->\n</div>\n\n  <div class="col-md-10">\n    <div ng-show="poaView.activeTab == \'progress\'">\n      <div class="panel panel-primary">\n        <div class="panel-heading">\n          <h3 class="panel-title">\n            Outcome Alignment and Achievement\n          </h3>\n          Overall progress on unit outcome are shown below\n        </div>\n        <div class="panel-body view-alignment" style="padding: 0px;">\n          <task-ilo-alignment-viewer\n            project="project"\n            unit="unit"\n            class-stats="classStats"\n            current-progress="currentProgress"\n            summary-only="true"></task-ilo-alignment-viewer>\n        </div>\n      </div>\n      <div class="panel panel-default">\n        <div class="panel-heading">\n          <h3 class="panel-title">\n            Visualise Achievement\n          </h3>\n          Your achievement with all ILOs are visualised below\n        </div>\n        <div class="panel-body clearfix">\n          <achievement-custom-bar-chart\n            show-legend="false"\n            unit="unit"\n            project="project"\n            class="col-sm-12">\n          </achievement-custom-bar-chart>\n        </div>\n      </div>\n    </div>\n    <div ng-show="poaView.activeTab == \'reflect\'">\n      <task-ilo-alignment-editor show-csv="false" unit="unit" project="project"></task-ilo-alignment-editor>\n    </div>\n  </div>\n</div>\n')}]),angular.module("projects/project-portfolio-wizard/portfolio-add-extra-files-step/portfolio-add-extra-files-step.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/project-portfolio-wizard/portfolio-add-extra-files-step/portfolio-add-extra-files-step.tpl.html",'<div id="panel" class="panel panel-primary">\n  <div class="panel-heading task-status row-fluid">\n      <h3 class="panel-title">Add Extra Files</h3><!--/title-->\n      Add extra files that justify your learning to your portfolio.\n  </div>\n  <div class="panel-body">\n    <form ng-submit="submitOther()">\n      <div class="callout callout-info" ng-show="project.portfolio_files.length < 2">\n        <h4>No files to add?</h4>\n        <p>If you do not have any files to add you can skip this step.</p>\n      </div>\n      <div class="callout callout-info" ng-show="project.portfolio_files.length >= 2">\n        <h4>Adding Files</h4>\n        <p>The files you add will appear in the portfolio in the order shown.</p>\n      </div>\n      <p>\n        You can upload <i>other files</i> you want to include in your portfolio. These will be added at the end of your portfolio.\n      </p>\n      <p>\n        To select a new file to upload, select the <i>type</i> of file from the button switch below, and drag and drop the file in to\n        grey drop-zone. Then click upload.\n      </p>\n      <hr>\n      <h4 class="col-sm-12">Upload New File</h4>\n      <div class="col-sm-4">\n        <div class="btn-group col-sm-12">\n          <label class="btn btn-default col-sm-4" ng-click="changeTo(\'code\')" ng-model="uploadType" btn-radio="\'code\'">\n            <i class="fa fa-file-code-o"></i>\n            <div>Code</div>\n          </label>\n          <label class="btn btn-default col-sm-4" ng-click="changeTo(\'document\')" ng-model="uploadType" btn-radio="\'document\'">\n            <i class="fa fa-file-text-o"></i>\n            <div>Document</div>\n          </label>\n          <label class="btn btn-default col-sm-4" ng-click="changeTo(\'image\')" ng-model="uploadType" btn-radio="\'image\'">\n            <i class="fa fa-file-image-o"></i>\n            <div>Image</div>\n          </label>\n        </div>\n      </div>\n\n      <div ng-hide="fileUploader.isUploading" class="col-sm-8">\n        <input ng-hide="fileUploader.isHTML5" options="{ alias: \'file0\' }" type="file" uploader="fileUploader" ng-required="!fileUploader.isHTML5" nv-file-select />\n        <div uploader="fileUploader" ng-show="fileUploader.isHTML5 && fileUploader.queue.length == 0" class="drop well" over-class="file-over-hover" options="{ alias: \'file0\' }" nv-file-drop nv-file-over filters="is_{{uploadType}}">\n          <p class="fa fa-file-{{uploadType == \'document\' ? \'pdf\' : uploadType}}-o fa-3x"></p>\n          <br/>\n          Drop {{uploadType}} here\n        </div>\n        <p ng-show="fileUploader.queue.length == 1" class="form-control-static">{{fileUploader.queue[0].file.name}} <span class="glyphicon glyphicon-file"></span></p>\n      </div>\n      <div class="form-group">\n        <div class="col-sm-3 col-sm-offset-9">\n          <button type="submit" ng-disabled="fileUploader.isUploading || fileUploader.queue.length != 1" class="btn btn-success form-control">\n            <i class="fa fa-cloud-upload"></i> Upload\n          </button>\n        </div>\n        <div ng-show="fileUploader.isUploading">\n          <progressbar class="progress-striped active" value="fileUploader.progress"></progressbar>\n        </div>\n      </form>\n\n    </div>\n  </div>\n  <div class="panel-footer clearfix">\n    <button class="btn btn-primary pull-left" ng-click="advanceActivePortfolioTab(-1)"><i class="fa fa-arrow-left"></i> Back</button>\n    <button class="btn btn-primary pull-right" ng-click="advanceActivePortfolioTab(1)">Next <i class="fa fa-arrow-right"></i></button>\n  </div>\n</div>\n')
}]),angular.module("projects/project-portfolio-wizard/portfolio-compile-step/portfolio-compile-step.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/project-portfolio-wizard/portfolio-compile-step/portfolio-compile-step.tpl.html",'<div class="panel panel-primary">\n  <div class="panel-heading task-status row-fluid">\n    <h3 class="panel-title">Compile Portfolio</h3>\n  </div>\n  <div class="panel-body">\n    <div class="col-sm-12" ng-hide="projectHasLearningSummaryReport()">\n      <div class="callout callout-danger">\n        <h4>Learning Summary Report Missing</h4>\n        <p>Your portfolio must include a learning summary report. Upload this before you schedule your portfolio to be compiled.</p>\n      </div>\n    </div>\n    <div class="col-xs-12" ng-show="project.compile_portfolio">\n      <div class="callout callout-info">\n        <h4>Compile Scheduled</h4>\n        <p>Your portfolio compilation is scheduled with Doubtfire. This process will take some time, check back soon to see if your portfolio is available. Alternatively, you can cancel the compile if you want to make changes.</p>\n      </div>\n    </div>\n    <div class="col-xs-12" ng-show="projectHasLearningSummaryReport()">\n      <div class="callout callout-warning">\n        <h4>Click to Create Portfolio</h4>\n        <p>Your portfolio will not be created until you have clicked the <strong>Create Portfolio</strong>\n          button. Once you click Create Portfolio, the construction of your portfolio will be scheduled with Doubtfire. This process will take some time, and you will be emailed when your portfolio is ready to review if you have enabled portfolio notifications.</p>\n      </div>\n    </div>\n    <div class="col-xs-12" ng-show="!project.compile_portfolio">\n      <p>Compiling your portfolio combines together your learning summary report, tasks, and other files into a single document.</p>\n      <p ng-show="projectHasLearningSummaryReport()">Click the <strong>Create Portfolio</strong> button to schedule your portfolio to be compiled. This will take a few minutes, so check back later to see if your portfolio has been created.</p>\n    </div>\n  </div>\n  <div class="panel-footer clearfix">\n    <button class="btn btn-primary pull-left" ng-click="advanceActivePortfolioTab(-1)"><i class="fa fa-arrow-left"></i> Back</button>\n    <button class="btn btn-primary pull-right" ng-show="project.compile_portfolio" ng-click="advanceActivePortfolioTab(1)">Next <i class="fa fa-arrow-right"></i></button>\n    <div ng-hide="project.compile_portfolio">\n      <button class="btn btn-success pull-right" ng-disabled="!projectHasLearningSummaryReport()" ng-click="toggleCompileProject(); advanceActivePortfolioTab(1)"><i class="fa fa-book"></i> Create Portfolio</span></button>\n      <div class="help-block pull-right col-sm-4" ng-hide="projectHasLearningSummaryReport()">\n        You\'re missing a Learning Summary Report. Add this first before you compile.\n      </div>\n    </div>\n  </div>\n</div>\n')}]),angular.module("projects/project-portfolio-wizard/portfolio-files-list/portfolio-files-list.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/project-portfolio-wizard/portfolio-files-list/portfolio-files-list.tpl.html",'<div class="panel panel-success">\n  <div class="panel-heading">Files Uploaded</div>\n  <div class="panel-body">\n    <table class="table table-condensed table-hover">\n      <thead>\n        <tr>\n          <th>Kind</th>\n          <th>File</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr ng-repeat="file in project.portfolio_files">\n          <td>{{file.name}}</td>\n          <td>\n            <i tooltip="{{file.kind | ucfirst }}" class="fa fa-file-{{file.kind == \'document\' ? \'pdf\' : file.kind}}-o fa-2x"></i>\n          </td>\n          <td>\n            <button class="btn btn-danger pull-right" ng-click="removeFile(file)"><i tooltip="Remove this file" class="fa fa-times"></i>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</div>\n')}]),angular.module("projects/project-portfolio-wizard/portfolio-grade-select-step/portfolio-grade-select-step.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/project-portfolio-wizard/portfolio-grade-select-step/portfolio-grade-select-step.tpl.html",'<div id="panel" class="panel panel-primary">\n  <div class="panel-heading task-status row-fluid">\n      <h3 class="panel-title">Select Grade</h3><!--/title-->\n      In preparing your portfolio, you need to undertake a self assessment. Use the unit\'s assessment criteria to determine the grade your portfolio should be awarded.\n  </div>\n  <div class="panel-body">\n      <div class="callout callout-warning">\n        <h4>Assessment Criteria</h4>\n        <p>Make sure that you have reviewed the <strong>Assessment Criteria</strong> for the grade you are applying for. Each grade will have a list of criteria that you can use to determine if you meet the requirements to achieve that grade.</p>\n      </div>\n      <p>Select the <strong>grade</strong> you are applying for below:</p>\n\n      <div class="btn-group btn-group-justified">\n        <label ng-repeat="grade in grades" ng-click="chooseGrade($index); status.isopen=false" class="btn btn-default col-sm-3" ng-model="project.target_grade" btn-radio="{{$index}}">\n          <h3>{{gradeAcronyms[grade]}}</h3>\n          <p>{{grade}}</p>\n        </label>\n      </div>\n      <p class="help-block text-center col-sm-12">\n        Make sure this grade will be justified in the Learning Summary Report.\n      </p>\n  </div>\n  <div class="panel-footer clearfix">\n    <button class="btn btn-primary pull-left" ng-click="advanceActivePortfolioTab(-1)"><i class="fa fa-arrow-left"></i> Back</button>\n    <button class="btn btn-primary pull-right" ng-click="advanceActivePortfolioTab(1)">Next <i class="fa fa-arrow-right"></i></button>\n  </div>\n</div>\n')}]),angular.module("projects/project-portfolio-wizard/portfolio-learning-summary-report-step/portfolio-learning-summary-report-step.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/project-portfolio-wizard/portfolio-learning-summary-report-step/portfolio-learning-summary-report-step.tpl.html",'<div id="panel" class="panel panel-primary">\n  <div class="panel-heading task-status row-fluid">\n      <h3 class="panel-title">Learning Summary Report</h3><!--/title-->\n      Upload the Learning Summary Report, the primary porfolio document which justifies your desired grade.\n  </div>\n  <div class="panel-body">\n    <form ng-submit="submitLearningSummaryReport()" class="col-sm-12">\n      <div class="callout callout-warning">\n        <h4>Before you submit the Learning Summary</h4>\n        <p>Think of this as applying for a grade. Provide a justification for why you believe you have achieved your selected grade.</p>\n      </div>\n      <p>Your <i>Learning Summary Report</i> is a summary of what you have learnt in this unit. It consists of two parts: a self-assessment and your reflections. The self-assessment indicates how your portfolio aligns with the assessment criteria, and which grade you are applying for. Your reflections are a personal comment on what you have learnt in the unit, and how your knowledge and skills have developed.</p>\n      <div ng-hide="fileUploader.isUploading" class="col-sm-4 col-sm-offset-4">\n        <input ng-hide="fileUploader.isHTML5" options="{ alias: \'file0\' }" type="file" uploader="fileUploader" ng-required="!fileUploader.isHTML5" nv-file-select />\n        <div uploader="fileUploader" ng-show="fileUploader.isHTML5 && fileUploader.queue.length == 0" class="drop well" over-class="file-over-hover" options="{ alias: \'file0\' }" nv-file-drop nv-file-over filters="is_document">\n          <p class="fa fa-file-pdf-o fa-3x"></p>\n          <br/>\n          Drop Learning Summary Report here\n        </div>\n        <p ng-show="fileUploader.queue.length == 1" class="form-control-static">{{fileUploader.queue[0].file.name}} <span class="glyphicon glyphicon-file"></span></p>\n      </div>\n      <div class="form-group">\n        <div class"col-sm-4 col-sm-offset-4"\n          <button type="submit" ng-disabled="fileUploader.isUploading || fileUploader.queue.length != 1" class="btn btn-success form-control" ng-click="submitLearningSummaryReport()">\n            <i class="fa fa-cloud-upload"></i> Upload\n          </button>\n        </div>\n        <div ng-show="fileUploader.isUploading">\n          <progressbar class="progress-striped active" value="fileUploader.progress"></progressbar>\n        </div>\n      </form>\n    </div>\n  </div>\n  <div class="panel-footer clearfix">\n    <button class="btn btn-primary pull-left" ng-click="advanceActivePortfolioTab(-1)"><i class="fa fa-arrow-left"></i> Back</button>\n    <button class="btn btn-primary pull-right" ng-disabled="!projectHasLearningSummaryReport()" ng-click="advanceActivePortfolioTab(1)">Next <i class="fa fa-arrow-right"></i></button>\n    <div class="help-block pull-right col-sm-4" ng-hide="projectHasLearningSummaryReport()">\n      You\'re missing a Learning Summary Report. Upload one to continue.\n    </div>\n  </div>\n</div>\n')}]),angular.module("projects/project-portfolio-wizard/portfolio-review-step/portfolio-review-step.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/project-portfolio-wizard/portfolio-review-step/portfolio-review-step.tpl.html",'<div>\n  <div class="panel panel-primary">\n    <div class="panel-heading task-status row-fluid">\n        <h3 class="panel-title">Review Portfolio</h3>\n        Review your portfolio submission progress.\n    </div>\n    <div class="panel-body">\n      <div class="col-xs-12">\n        <div class="callout callout-warning" ng-hide="project.portfolio_available">\n          <h4>Your portfolio not yet available</h4>\n          {{project.compile_portfolio ? "It is currently being processed. Check back soon." : "Please compile a portfolio first."}}\n        </div>\n        <p>You can download or review your portfolio online. Check that it includes all of the evidence you need to achieve the grade you are applying for. If needed, you can delete this version and repeat the process to create a new portolio.</p>\n      </div>\n    </div>\n    <div class="panel-footer">\n      <button class="btn btn-primary" ng-click="advanceActivePortfolioTab(-1)"><i class="fa fa-arrow-left"></i> Back</button>\n    </div>\n  </div>\n  <div class="panel panel-primary" ng-if="project.portfolio_available">\n    <div class="panel-heading clearfix">\n      <div class="pull-left">\n        <h3 class="panel-title">Portfolio Preview</h3><!--/title-->\n        This is the exact same document your unit assessor will see\n      </div>\n      <div class="pull-right" ng-show="project.portfolio_available">\n        <button class="btn btn-danger" ng-click="deletePortfolio()">\n          <i class="fa fa-trash-o" tooltip="Delete Portfolio"></i>\n        </button>\n        <a href="{{project.portfolioUrl()}}" class="btn btn-success">\n          <i class="fa fa-download" tooltip="Download Portfolio"></i>\n        </a>\n      </div>\n    </div>\n    <pdf-panel-viewer\n      ng-show="project.portfolio_available"\n      pdf-url="project.portfolioUrl()">\n    </pdf-panel-viewer>\n  </div>\n</div>\n')}]),angular.module("projects/project-portfolio-wizard/portfolio-tasks-step/portfolio-tasks-step.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/project-portfolio-wizard/portfolio-tasks-step/portfolio-tasks-step.tpl.html",'<div id="panel" class="panel panel-primary">\n  <div class="panel-heading task-status row-fluid">\n    <h3 class="panel-title">Select Tasks</h3>\n    Select tasks to include and showcase in your portfolio that demonstrates your\n    understanding of each Indended Learning Outcome.\n  </div>\n  <div class="panel-body">\n    <task-ilo-alignment-editor\n      unit="unit"\n      project="project"\n      hide-panel="true"\n      hide-graph="true"\n      show-include-tasks="true"></task-ilo-alignment-editor>\n  </div>\n  <div class="panel-footer clearfix">\n    <button class="btn btn-primary pull-left" ng-click="advanceActivePortfolioTab(-1)"><i class="fa fa-arrow-left"></i> Back</button>\n    <button class="btn btn-primary pull-right" ng-disabled="noTasksSelected()" ng-click="advanceActivePortfolioTab(1)">Next <i class="fa fa-arrow-right"></i></button>\n    <div class="help-block pull-right col-sm-4" ng-show="noTasksSelected()">\n'+"      You need to select at least one task {{unitHasILOs ? 'that is aligned to an ILO above' : 'above'}}, otherwise your portfolio will be consist of no tasks.\n    </div>\n  </div>\n</div>\n")}]),angular.module("projects/project-portfolio-wizard/project-portfolio-wizard.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/project-portfolio-wizard/project-portfolio-wizard.tpl.html",'<div class="project-portfolio-wizard">\n  <tabset class="col-md-2" vertical="true" type="pills">\n    <tab ng-repeat="(tabKey, tab) in portfolioTabsData | orderObjectBy: \'seq\'" active="tab.active" select="setActivePortfolioTab(tab)">\n      <tab-heading tooltip-html-unsafe="<strong>Step {{tab.seq}}</strong><br>{{tab.title}}" tooltip-placement="right" tooltip-popup-delay="200">\n        <div class="text-center">\n          <i class="fa fa-2x {{tab.icon}}"></i>\n        </div>\n      </tab-heading>\n    </tab>\n    <br />\n  </tabset><!--/tab-selector-->\n  <div class="col-md-10">\n    <div ng-if="activePortfolioTab == portfolioTabsData.welcomeStep">\n      <div id="panel" class="panel panel-primary">\n        <div class="panel-heading task-status row-fluid">\n            <h3 class="panel-title">Preparing Your Portfolio</h3>\n            Welcome to the portfolio creation wizard\n        </div>\n        <div class="panel-body">\n            <p>Preparing your portfolio involves 6 steps:</p>\n            <ol>\n              <li>Select your <strong>Grade</strong> you are applying for</li>\n              <li>Upload your <strong>Learning Summary Report</strong></li>\n              <li>Select the <strong>Tasks</strong> you want included</li>\n              <li>Upload any <strong>Other Resources</strong> you want to add</li>\n              <li><strong>Compile</strong> your resources into your portfolio</li>\n              <li><strong>Review</strong> your portfolio</li>\n            </ol>\n            <p>\n              Once you have completed all of these steps, your portfolio will be prepared by Doubtfire and you will be notified when it is ready. You can then check your work, and if you want to make any corrections you can repeat these steps to create a new version of your portfolio.\n            </p>\n        </div>\n        <div class="panel-footer">\n          <div class="text-right">\n            <button class="btn btn-primary" ng-click="advanceActivePortfolioTab(1)">Next <i class="fa fa-arrow-right"></i></button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <portfolio-grade-select-step ng-if="activePortfolioTab == portfolioTabsData.gradeStep"></portfolio-grade-select-step>\n    <portfolio-learning-summary-report-step ng-if="activePortfolioTab == portfolioTabsData.summaryStep"></portfolio-learning-summary-report-step>\n    <portfolio-tasks-step ng-if="activePortfolioTab == portfolioTabsData.taskStep"></portfolio-tasks-step>\n    <portfolio-add-extra-files-step ng-if="activePortfolioTab == portfolioTabsData.otherFilesStep"></portfolio-add-extra-files-step>\n    <portfolio-compile-step ng-if="activePortfolioTab == portfolioTabsData.compileStep"></portfolio-compile-step>\n    <portfolio-review-step ng-if="activePortfolioTab == portfolioTabsData.reviewStep"></portfolio-review-step>\n    <div ng-if="project.portfolio_files.length > 0 && activePortfolioTab.seq < portfolioTabsData.reviewStep.seq">\n      <portfolio-files-list></portfolio-files-list>\n    </div>\n  </div><!--/tabs-->\n</div>\n')}]),angular.module("projects/project-progress-dashboard/project-progress-dashboard.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/project-progress-dashboard/project-progress-dashboard.tpl.html",'<div ng-if="unitLoaded" class="project-progress-dashboard">\n  <div class="col-lg-4 col-lg-push-8">\n    <div class="row">\n      <div class="col-sm-6 col-lg-12">\n        <div class="panel panel-primary">\n          <div class="panel-heading clearfix">\n            <div class="pull-left">\n              <h4 class="panel-title">Task List</h4>\n              <div ng-hide="taskDetailsSelector.viewAll">\n                The tasks you need to focus on now.\n              </div>\n              <div ng-show="taskDetailsSelector.viewAll">\n                All of the tasks to achieve a {{grades[project.target_grade]}}.\n              </div>\n            </div>\n            <div class="pull-right toolbar">\n              <div class="buttons">\n                <div class="btn-group">\n                  <label class="btn btn-default" ng-model="taskDetailsSelector.viewAll" btn-radio="false">\n                    <i tooltip="View the tasks to focus on now" class="fa fa-dashboard"></i>\n                  </label>\n                  <label class="btn btn-default" ng-model="taskDetailsSelector.viewAll" btn-radio="true">\n                    <i tooltip="View all tasks" class="fa fa-list"></i>\n                  </label>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class="panel-body">\n            <project-tasks-list project="project" on-change="updateBurndownChart" student-project-id="studentProjectId" task-def="taskDef" unit="unit" assessing-unit-role="assessingUnitRole" on-select="showTaskView" ng-if="taskDetailsSelector.viewAll"></project-tasks-list>\n            <project-top-tasks-list on-select="showTaskView" project="project" ng-hide="taskDetailsSelector.viewAll"></project-top-tasks-list>\n          </div>\n        </div><!--task-lists-->\n      </div>\n      <div class="col-sm-6 col-lg-12">\n        <div class="panel panel-default">\n          <div class="panel-heading">\n            <h3 class="panel-title">Target Grade</h3>\n            Select the grade you wish to achieve in the unit.\n          </div>\n          <div class="panel-body text-center">\n            <p class="btn-group">\n              <label ng-repeat="grade in grades" ng-click="chooseGrade($index)" class="btn btn-default col-sm-3 text-center" ng-model="project.target_grade" btn-radio="{{$index}}">\n                <grade-icon grade="grade" tooltip="Select a {{grade}} as your target grade" tooltip-append-to-body="true" class="text-{{$index == project.target_grade ? \'primary\' : \'muted\'}}"></grade-icon>\n              </label>\n            </p>\n            <p class="help-block">\n              You target grade is\n              <strong>{{grades[project.target_grade]}}</strong>.\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div><!--right-hand-panel-->\n\n  <div class="col-lg-8 col-lg-pull-4">\n    <div class="panel panel-default">\n      <div class="panel-heading clearfix">\n        <div class="pull-left">\n          <div ng-show="currentVisualisation == \'burndown\'">\n            <h3 class="panel-title">Burndown Chart</h3>\n            The Burndown chart shows how much work remains for you to achieve your target grade.\n          </div>\n          <div ng-show="currentVisualisation == \'taskSummary\'">\n            <h3 class="panel-title">Task Summary Chart</h3>\n            Summary of each of your task statuses\n          </div>\n        </div><!--/headings-->\n        <div class="pull-right text-right toolbar">\n          <div class="buttons">\n            <div class="btn-group">\n              <label class="btn btn-default text-center" btn-radio="\'burndown\'" ng-model="currentVisualisation">\n                <i class="fa fa-line-chart"></i>\n              </label>\n              <label class="btn btn-default text-center" btn-radio="\'taskSummary\'" ng-model="currentVisualisation">\n                <i class="fa fa-pie-chart"></i>\n              </label>\n            </div>\n          </div>\n        </div><!--/button-switch-->\n      </div>\n      <div class="panel-body">\n        <div class="burndown-chart" ng-if="currentVisualisation == \'burndown\'">\n          <progress-burndown-chart project="project" unit="unit"></progress-burndown-chart>\n        </div>\n        <div ng-if="currentVisualisation == \'taskSummary\'">\n          <student-task-status-pie-chart project="project"></student-task-status-pie-chart>\n        </div>\n      </div>\n      <div class="panel-footer text-center">\n        <div ng-show="currentVisualisation == \'taskSummary\'">\n          You have completed\n          <strong>{{taskStats.numberOfTasksCompleted}}</strong>\n          tasks and have\n          <strong>{{taskStats.numberOfTasksRemaining}}</strong>\n          left to complete to achieve a\n          <strong>{{grades[project.target_grade]}}</strong>.\n        </div>\n        <div ng-show="currentVisualisation == \'burndown\'">\n          Aim to keep your\n          <strong style="color: #e01b5d">Complete</strong>\n          line close to or ahead of the\n          <strong class="text-muted">Target</strong>\n          line to keep on track.\n        </div>\n      </div>\n    </div>\n  </div><!--primary-panel-->\n</div>\n')}]),angular.module("projects/project-viewer/project-viewer.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/project-viewer/project-viewer.tpl.html",'<div class="project-viewer">\n  <div ng-hide="unitLoaded" class="large-notice-block">\n    <i class="fa fa-2x fa-spinner fa-pulse"></i>\n    <p>Loading...</p>\n  </div><!--/loading-->\n  <div ng-if="unitLoaded">\n    <h2 ng-hide="fullscreen">\n      {{unit.name}}\n      <small>{{unit.code}}</small>\n      <p class="lead">\n        {{project.student_name}} <small>{{project.student_id}}</small>\n      </p>\n    </h2>\n    <h2 ng-show="fullscreen">\n      {{project.student_name}}\n      <small>{{project.student_id}}</small>\n    </h2><!--header-->\n    <tabset class="tabset-icon" justified="true">\n      <tab ng-repeat="tab in tabs | toArray | orderBy: \'seq\'" active="tab.active" ng-click="setActiveTab(tab)">\n        <tab-heading>\n          <i class="fa fa-2x {{tab.icon}}"></i> {{tab.title}}\n        </tab-heading>\n      </tab>\n    </tabset><!--tabs-->\n    <div class="row">\n      <project-progress-dashboard ng-if="activeTab === tabs.progressTab"></project-progress-dashboard>\n      <task-viewer ng-if="activeTab === tabs.tasksTab" unit="unit" project="project" assessing-unit-role="assessingUnitRole"></task-viewer>\n      <student-group-manager ng-if="activeTab === tabs.groupTab"></student-group-manager>\n      <project-lab-list ng-if="activeTab === tabs.tutorialTab"></project-lab-list>\n      <project-outcome-alignment ng-if="activeTab === tabs.learningOutcomeTab"></project-outcome-alignment>\n      <project-portfolio-wizard ng-if="activeTab === tabs.portfolioTab" project="project"></project-portfolio-wizard>\n    </div>\n  </div><!--/content-->\n</div>\n')}]),angular.module("projects/states/show/show.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("projects/states/show/show.tpl.html",'<ul class="breadcrumb">\n  <li><a href="#/home">Home</a></li>\n  <li ng-if="!assessingUnitRole">\n    <a href="#/projects/{{project.project_id}}">{{unit.name}}</a>\n  </li>\n  <li ng-if="assessingUnitRole">\n    <a href="#/units?unitRole={{assessingUnitRole.id}}">{{unit.name}}</a>\n  </li>\n  <li class="active">{{project.student_name}}</li>\n</ul>\n<div id="projects-show">\n  <project-viewer\n    project-id="studentProjectId"\n    show-task-id="showTaskId"\n    unit-role="unitRole"\n    project="project"\n    unit="unit"\n    assessing-unit-role="assessingUnitRole"></project-viewer>\n</div>\n<div class="feedback-float-toolbar well" ng-if="assessingUnitRole && project">\n  <label>Tutor Actions</label>\n  <button ng-click="transitionWeekEnd()" class="btn btn-info">\n    <i class="fa fa-comment fa-2x"></i><br/>\n    Discussed\n  </button>\n  <a href="#/units?unitRole={{assessingUnitRole.id}}" class="btn btn-default">\n    <i class="fa fa-list fa-2x"></i><br/>\n    Student List\n  </a>\n</div><!--/feedback-float-toolbar-->\n')}]),angular.module("sessions/states/sign-in/sign-in.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("sessions/states/sign-in/sign-in.tpl.html",'<div id="sign-in" class="center-full-screen">\n  <div ng-if="noIE" class="no-ie">\n    <h1 class="logo">\n      <p>\n        <a href="http://www.apple.com/safari/" tooltip="Safari is compatible with Doubtfire" tooltip-append-to-body="true">\n          <i class="fa fa-safari text-primary"></i>\n        </a>\n        <a href="http://www.google.com/chrome" tooltip="Chrome is compatible with Doubtfire" tooltip-append-to-body="true">\n          <i class="fa fa-chrome text-primary"></i>\n        </a>\n        <a href="http://www.firefox.com/" tooltip="Firefox is compatible with Doubtfire" tooltip-append-to-body="true">\n          <i class="fa fa-firefox text-primary"></i>\n        </a>\n        <a href="http://browsehappy.com" tooltip="This version of Internet Explorer is not compatible with Doubtfire" tooltip-append-to-body="true">\n          <i class="fa fa-internet-explorer text-danger"></i>\n        </a>\n      </p>\n      Doubtfire\n    </h1>\n    <p class="upgrade"> To use Doubtfire, you should <a href="http://browsehappy.com/">upgrade your browser</a></p>\n  </div>\n  <div ng-if="!noIE" class="login">\n    <h1 class="logo">\n      <i class="logo"></i> Doubtfire\n      <p class="lead">Learning Management System<p>\n    </h1>\n    <form name="form" ng-submit="signIn()">\n      <div class="username-password-entry" ng-class="{\'invalid-credentials\': invalidCredentials}">\n        <input autofocus class="form-control" name="username" type="username" placeholder="Username" ng-model="session.username" auto-fill-sync required />\n        <input class="form-control" name="password" type="password" placeholder="Password" ng-model="session.password" password-validate auto-fill-sync required />\n      </div>\n      <button class="btn btn-lg btn-primary btn-block text-center" type="submit">\n        <span ng-hide="signingIn">Sign In</span>\n        <i class="fa fa-spinner fa-pulse" ng-show="signingIn"></i>\n      </button>\n      <label class="checkbox remember-me">\n        <input type="checkbox" ng-model="session.remember_me"></input>\n        <span>Remember Me</span>\n      </label>\n    </form>\n  </div>\n  <footer class="about-doubtfire text-center">\n    <a href="" ng-click="openAboutModal()">About Doubtfire</a>\n  </footer>\n</div>\n')}]),angular.module("sessions/states/sign-out/sign-out.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("sessions/states/sign-out/sign-out.tpl.html",'<div class="container text-center center-full-screen">\n  <h1>\n    <i class="fa fa-sign-out fa-5x"></i>\n    <br>\n    Signing out...\n  </h1>\n</div>\n')}]),angular.module("tasks/modals/grade-task-modal/grade-task-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/modals/grade-task-modal/grade-task-modal.tpl.html",'<div class="grade-task-modal">\n  <div class="modal-header">\n    <h3>Provide Grade</h3>\n  </div>\n  <div class="modal-body text-center">\n    <p>Please provide a grade to change the student\'s status for task <label class="label label-info">{{task.abbreviation}}</label>.</p>\n    <p class="btn-group">\n      <label ng-repeat="grade in grades" class="btn btn-default col-sm-3 text-center" ng-model="data.desiredGrade" btn-radio="{{$index}}">\n        <grade-icon grade="grade" tooltip="This student completed the task to a {{grade}} standard" tooltip-append-to-body="true"></grade-icon>\n      </label>\n    </p>\n  </div>\n  <div class="modal-footer">\n    <button class="btn btn-default" ng-click="dismiss()">\n      <i class="fa fa-times"></i>\n    </button>\n    <button class="btn btn-primary" ng-click="close()" ng-disabled="data.desiredGrade == null">\n      <i class="fa fa-check"></i>\n    </button>\n  </div>\n</div>\n')}]),angular.module("tasks/project-tasks-list/project-tasks-list.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/project-tasks-list/project-tasks-list.tpl.html",'<ul class="project-tasks-list">\n  <div ng-repeat="(groupSetId, relatedTasks) in project.tasks | groupBy: \'definition.group_set_id\'" class="groupset-tasks clearfix">\n    <h5 class="groupset-name" ng-hide="hideGroupSetName">{{groupSetName(groupSetId)}}</h5>\n    <li class="col-xs-4 col-sm-3 col-md-2 col-lg-4" ng-repeat="task in relatedTasks | byGrade:project.target_grade | orderBy: \'definition.seq\'">\n      <button type="button" class="col-xs-12 btn task-status {{statusClass(task.status)}}" ng-click="onSelect(task, \'Task Button List\')" tooltip-popup-delay=\'200\' tooltip-placement="bottom" tooltip-html-unsafe="<strong>{{taskDefinition(task).name}}:</strong><br>{{task.status_txt()}}">\n        <i class="fa fa-eye" ng-show="task.similar_to_count > 0"></i> {{task.definition.abbreviation}}\n      </button>\n    </li>\n  </div>\n</ul>\n')}]),angular.module("tasks/project-top-tasks-list/project-top-tasks-list.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/project-top-tasks-list/project-top-tasks-list.tpl.html",'<div class="project-top-tasks-list">\n  <div class="help-block text-center all-completed" ng-show="topTasks.length == 0">You have completed all of the tasks!</div>\n  <table ng-hide="topTasks.length == 0" class="table table-condensed table-hover table-pointer ">\n    <thead>\n      <tr>\n        <th class="task-abbreviation">\n          <a ng-click="sortOrder=\'task.definition.abbreviation\'; reverse=!reverse">\n            Task <i ng-show="sortOrder==\'task.definition.abbreviation\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n          </a>\n        </th>\n        <th class="status">\n          <a ng-click="sortOrder=\'statusSeq()\'; reverse=!reverse">\n            Status <i ng-show="sortOrder==\'statusSeq()\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n          </a>\n        </th>\n        <th class="reason">\n          <a ng-click="sortOrder=\'reason\'; reverse=!reverse">\n            Reason <i ng-show="sortOrder==\'reason\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n          </a>\n        </th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr ng-repeat="data in topTasks" ng-click="onSelect(data.task, \'Top Task Select\')">\n        <td ng-click="viewTask(data.task)">\n          <label class="label label-info pointer label-task-definition" tooltip="{{data.task.definition.name}}" tooltip-append-to-body="true">\n            {{data.task.definition.abbreviation}}\n          </label>\n        </td>\n        <td ng-click="viewTask(data.task)">\n          <status-icon status="data.task.status"></status-icon>\n        </td>\n        <td ng-click="viewTask(data.task)">{{data.reason}}</td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n')}]),angular.module("tasks/stats/task-completion-stats/task-completion-stats.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/stats/task-completion-stats/task-completion-stats.tpl.html",'<div class="task-completion-stats drilldown-visualiser panel-body">\n  <div class="data-loaded" ng-if="data">\n    <div class="clearfix">\n      <div class="btn-group col-sm-6 pull-left">\n        <label class="btn btn-default" ng-model="dataModel.selectedType" btn-radio="\'unit\'">\n          <i tooltip="View stats over entire unit" class="fa fa-university"></i>\n        </label>\n        <label class="btn btn-default" ng-model="dataModel.selectedType" btn-radio="\'tutorial\'">\n          <i tooltip="View stats by tutorial" class="fa fa-pencil"></i>\n        </label>\n        <label class="btn btn-default" ng-model="dataModel.selectedType" btn-radio="\'grade\'">\n          <i tooltip="View stats by target grade" class="fa fa-trophy"></i>\n        </label>\n      </div>\n      <div class="col-sm-6 pull-right" ng-if="dataModel.selectedType == \'tutorial\'">\n        <select\n          class="form-control"\n          ng-options="tutorial as (tutorial.abbreviation + \' - \' + tutorial.tutor_name) for tutorial in (tutorialsForSelector | orderBy: \'tutorial.id\' | orderBy: \'tutorial.abbreviation\' | reverse) track by tutorial.id"\n          ng-model="dataModel.selectedTutorial"></select>\n      </div>\n    </div><!--/toolbar-->\n    <hr>\n    <div ng-show="depth == 0">\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'unit\'">\n        Task completion distribution in <strong>{{unit.code}}</strong>\n      </h4>\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'tutorial\'">\n        <p>Task completion distribution for Tutorial <strong>{{dataModel.selectedTutorial.abbreviation}}</strong></p>\n        <p class=\'small text-muted\'>{{dataModel.selectedTutorial.tutor_name}} at {{dataModel.selectedTutorial.meeting_time | date: shortTime}}</p>\n      </h4>\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'grade\'">\n        Task completion distribution by Target Grade\n      </h4>\n    </div><!--/headers-for-depth-0-->\n    <div ng-show="depth == 1">\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'tutorial\'">\n        Task completion distribution over all tutorials in <strong>{{unit.code}}</strong>\n      </h4>\n    </div><!--/headers-for-depth-1-->\n    <div ng-if="depth == 0" ng-click="drillDown()" class="overview-chart">\n      <task-completion-box-plot\n          data="data"\n          unit="unit"\n          type="dataModel.selectedType"></task-completion-box-plot>\n    </div><!--/depth-0-chart-->\n    <div ng-if="dataModel.selectedTutorial.id < 0 && depth == 1" class="overview-chart">\n      <div ng-repeat="tutorial in unit.tutorials | orderBy: \'abbreviation\'" class="col-xs-6 col-sm-4 col-md-3" ng-click="switchToTutorial(tutorial)">\n        <task-completion-box-plot\n            data="data[tutorial.id]"\n            unit="unit"\n            type="dataModel.selectedType"\n            height="200"\n            show-legend="false"></task-completion-box-plot>\n        <div class="col-xs-12 caption text-center">\n          <strong>{{tutorial.abbreviation}}</strong>\n          <div class="small text-muted">{{tutorial.tutor_name}} at {{tutorial.meeting_time | date: shortTime}}</div>\n        </div>\n      </div>\n    </div><!--/overview-charts-->\n  </div>\n  <div class="data-not-loaded" ng-hide="data">\n    <i class="fa fa-spinner fa-pulse fa-3x"></i>\n    <p>Loading...</p>\n  </div>\n</div>\n')
}]),angular.module("tasks/stats/task-status-stats/task-status-stats.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/stats/task-status-stats/task-status-stats.tpl.html",'<div class="task-status-stats drilldown-visualiser">\n  <div class="panel-body" ng-if="data">\n    <div class="clearfix">\n      <div class="btn-group col-sm-6 pull-left">\n        <label class="btn btn-default" ng-model="dataModel.selectedType" btn-radio="\'unit\'">\n          <i tooltip="View task statuses over entire unit" class="fa fa-university"></i>\n        </label>\n        <label class="btn btn-default" ng-model="dataModel.selectedType" btn-radio="\'tutorial\'">\n          <i tooltip="View task statuses by tutorial" class="fa fa-pencil"></i>\n        </label>\n        <label class="btn btn-default" ng-model="dataModel.selectedType" btn-radio="\'task\'">\n          <i tooltip="View task statuses by task" class="fa fa-tasks"></i>\n        </label>\n      </div>\n      <div class="col-sm-6 pull-right" ng-if="dataModel.selectedType == \'tutorial\'">\n        <select\n          class="form-control"\n          ng-options="tutorial as (tutorial.text) for tutorial in (tutorialsForSelector | orderBy: \'tutorial.abbreviation\' | reverse) track by tutorial.id"\n          ng-model="dataModel.selectedTutorial"></select>\n      </div>\n      <div class="col-sm-6 pull-right" ng-if="dataModel.selectedType == \'task\'">\n        <select\n          class="form-control"\n          ng-options="task as (task.text) for task in (tasksForSelector | orderBy: \'seq\') track by task.id"\n          ng-model="dataModel.selectedTask"></select>\n      </div>\n    </div><!--/toolbar-->\n    <hr>\n    <div ng-show="depth == 0">\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'unit\'">\n        Task status distribution in <strong>{{unit.code}}</strong>\n      </h4>\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'task\'">\n        <p>Task status distribution of <strong>{{dataModel.selectedTask.abbreviation}}</strong> in <strong>{{unit.code}}</strong></p>\n        <p class=\'small text-muted\'>{{dataModel.selectedTask.name}}</p>\n      </h4>\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'tutorial\'">\n        <p>Status by Task for Tutorial <strong>{{dataModel.selectedTutorial.abbreviation}}</strong></p>\n        <p class=\'small text-muted\'>{{dataModel.selectedTutorial.tutor_name}} at {{dataModel.selectedTutorial.meeting_time | date: shortTime}}</p>\n      </h4>\n    </div><!--/headers-for-depth-0-->\n    <div ng-show="depth == 1">\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'tutorial\'">\n        Task status distribution over all tutorials in <strong>{{unit.code}}</strong>\n      </h4>\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'task\'">\n        Task status distribution over all tasks in <strong>{{unit.code}}</strong>\n      </h4>\n    </div><!--/headers-for-depth-1-->\n    <div ng-show="depth == 2">\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'tutorial\'">\n        <p>Status by Task for Tutorial <strong>{{dataModel.selectedTutorial.abbreviation}}</strong></p>\n        <p class=\'small text-muted\'>{{dataModel.selectedTutorial.tutor_name}} at {{dataModel.selectedTutorial.meeting_time | date: shortTime}}</p>\n      </h4>\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'task\'">\n        <p>Status by Tutorial for Task <strong>{{dataModel.selectedTask.abbreviation}}</strong></p>\n        <p class=\'small text-muted\'>{{dataModel.selectedTask.name}}</p>\n      </h4>\n    </div><!--/headers-for-depth-2-->\n    <p class="col-sm-12 help-block text-center">\n      Click chart to explore details\n    </p><!--/click-chart-help-block-->\n    <div ng-if="depth == 0" ng-click="drillDown()" class="overview-chart">\n      <task-status-pie-chart data="data" show-legend="true" height="600"></task-status-pie-chart>\n    </div><!--/depth-0-chart-->\n    <div ng-if="(dataModel.selectedTask.id < 0) || (depth >= 1 && dataModel.selectedTutorial.id > 0)" class="overview-charts">\n      <div ng-repeat="chart in overviewKeys" class="col-xs-6 col-sm-4 col-md-3 overview-chart" ng-click="drillToTask(chart.task)">\n        <task-status-pie-chart ng-if="chart.show" data="chart.data" show-legend="false" height="200"></task-status-pie-chart>\n        <div class="no-data-to-display" ng-hide="chart.show">\n          No data\n        </div>\n        <div class="col-xs-12 caption text-center">\n          <strong class="col-xs-12">{{chart.title}}</strong>\n          <div class="col-xs-12 small text-muted">{{chart.subtitle}}</div>\n        </div>\n      </div>\n    </div><!--/overview-chart-charts-of-tutorials-or-tasks-->\n    <div ng-if="(dataModel.selectedTutorial.id < 0) || (depth >= 1 && dataModel.selectedTask.id > 0)" class="overview-charts">\n      <div ng-repeat="chart in (overviewKeys | orderBy: \'title\' )" class="col-xs-6 col-sm-4 col-md-3 overview-chart" ng-click="drillToTutorial(chart.tutorial)">\n        <task-status-pie-chart ng-if="chart.show" data="chart.data" show-legend="false" height="200"></task-status-pie-chart>\n        <div class="no-data-to-display" ng-hide="chart.show">\n          No data\n        </div>\n        <div class="col-xs-12 caption text-center">\n          <strong>{{chart.title}}</strong>\n          <div class="small text-muted">{{chart.subtitle}}</div>\n        </div>\n      </div>\n    </div><!--/overview-chart-charts-of-tutorials-or-tasks-->\n  </div>\n  <div class="large-notice-block" ng-hide="data">\n    <i class="fa fa-spinner fa-pulse fa-3x"></i>\n    <p>Loading...</p>\n  </div>\n  <div class="panel-footer text-center" ng-show="data && depth == 0">\n    <strong>{{completeStats.completed}}%</strong> of student tasks are marked as complete, while <strong>{{completeStats.left}}%</strong> are not\n  </div><!--/footer-->\n</div>\n')}]),angular.module("tasks/stats/task-summary-stats/task-summary-stats.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/stats/task-summary-stats/task-summary-stats.tpl.html",'<div class="task-summary-stats">\n  <div class="panel-body text-center">\n    <div ng-show="scatterData.length == 0">\n      <i class="fa fa-4x fa-spinner fa-pulse"></i>\n      <h2>Loading...</h2>\n    </div>\n    <div ng-if="scatterData.length > 0">\n      <summary-task-status-scatter data="scatterData" unit="unit">\n      </summary-task-status-scatter>\n    </div>\n  </div>\n  <div class="panel-footer clearfix">\n    <a class="btn btn-success pull-right" ng-click="fetchCSV()">\n      <i class="fa fa-file-excel-o"></i> Download as CSV\n    </a>\n  </div>\n</div>\n')}]),angular.module("tasks/task-comments-viewer/task-comments-viewer.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-comments-viewer/task-comments-viewer.tpl.html",'<div class="panel-body task-comments-viewer">\n  <div class="large-notice-block no-comments" ng-show="(!task.comments) || task.comments.length == 0">\n    <i class="fa fa-2x fa-comments-o"></i>\n    <p>No comments have yet been made</p>\n  </div>\n  <div class="comment col-sm-12 col-lg-8 col-lg-offset-2" ng-repeat="comment in task.comments">\n    <div class="comment-details col-md-2">\n      <span class="comment-by">\n        {{comment.comment_by}}\n      </span>\n      <span class="comment-date">\n        {{comment.created_at | date: \'d MMM yyyy\'}}\n      </span>\n    </div>\n    <div class="comment-text col-md-9">\n      <div class="markdown-to-html col-md-11" ng-bind-html="comment.comment | markdown"></div>\n      <div class="col-md-1 delete-comment text-right" ng-click="deleteComment(comment.id)" tooltip="Delete comment" tooltip-placement="right">\n        <i class="fa fa-trash"></i>\n      </div>\n    </div>\n  </div>\n</div>\n\n  <div class="panel-footer">\n    <form class="input-group col-sm-12 comment-submitter" ng-submit="addComment()" role="form">\n      <markdown-editor class="editor col-sm-11" ng-model="comment.text" ng-keydown="checkForEnterPress($event)" placeholder="Make a comment on this submission..." height="auto"></markdown-editor>\n      <div class="send-button-wrapper col-sm-1">\n        <button type="submit" class="btn btn-primary" type="button" ng-disabled="comment.text.trim().length == 0">\n          <i class="fa fa-paper-plane fa-2x"></i>\n          <div>Send</div>\n        </button>\n      </div>\n    </form>\n  </div>\n')}]),angular.module("tasks/task-definition-editor/task-definition-editor.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-definition-editor/task-definition-editor.tpl.html",'<div class="panel panel-primary task-definition-editor">\n  <div class="panel-heading clearfix">\n    <h3 class="panel-title">\n      {{task ? (isNew ? "Create Task" : "Edit Task") : "Task Details"}}\n    </h3>\n  </div>\n  <div class="panel-body large-notice-block" ng-hide="task" ng-hide="task">\n    <i class="fa fa-tasks"></i>\n    <p>Select a task to view its definition in detail</p>\n  </div>\n  <div class="panel-body" ng-show="task">\n    <form class="form-horizontal" role="form">\n    <div class="task-admin-tabs">\n        <tabset class="pull-left col-md-2" vertical="true" type="pills">\n          <tab ng-repeat="(tabKey, tab) in taskAdmin.tabsData | orderObjectBy: \'seq\'" active="tab.active" ng-click="setActiveTab(tab)">\n            <tab-heading tooltip="{{tab.title}}" tooltip-placement="right" tooltip-popup-delay="200">\n              <div class="text-center">\n                <i class="fa fa-2x {{tab.icon}}" style="margin-right: 1ex"></i>\n              </div>\n            </tab-heading>\n          </tab>\n        </tabset><!--/tab-selector-->\n\n        <div class="col-md-10 pull-right task-admin-tab-contents">\n          <div class="panel panel-default">\n            <div class="panel-heading row-fluid">\n              <h3 class="panel-title">\n                {{activeTab.title}}\n              </h3>\n              {{activeTab.subtitle}}\n            </div>\n            <div class="task-admin-tab-panel panel-body">\n              <div ng-show="activeTab == taskAdmin.tabsData.taskSheet">\n                <div class="form-group" ng-required="isNew">\n                  <label class="col-sm-3 control-label">Name</label>\n                  <div class="col-sm-8">\n                    <input type="text" class="form-control" ng-model="task.name">\n                  </div>\n                </div><!--/name-->\n\n                <div class="form-group" ng-required="isNew">\n                  <label class="col-sm-3 control-label">Abbreviation</label>\n                  <div class="col-sm-8">\n                    <input type="text" class="form-control" ng-model="task.abbreviation"/>\n                  </div>\n                </div><!--/abbr-->\n\n                <div class="form-group" ng-required="isNew">\n                  <label class="col-sm-3 control-label">Grade</label>\n                  <div class="col-sm-7">\n                    <label ng-repeat="grade in grades" name="target-grade-{{grade}}" class="radio-inline" for="target-grade-{{grade}}">\n                      <input type="radio" id="target-grade-{{grade}}" value="{{$index}}" ng-model="task.target_grade"/>{{grade}}\n                    </label>\n                  </div>\n                </div><!--/grade-->\n\n                <div class="form-group" ng-required="isNew">\n                  <label class="col-sm-3 control-label">Description</label>\n                  <div class="col-sm-8">\n                    <textarea class="form-control" ng-model="task.description"></textarea>\n                  </div>\n                </div><!--/desc-->\n\n                <div class="form-group" ng-required="isNew">\n                  <label class="col-sm-3 control-label">Weighting</label>\n                  <div class="col-sm-8">\n                    <input type="number" class="form-control" ng-model="task.weight" min="1"/>\n                  </div>\n                </div><!--/weighting-->\n\n                <div class="form-group" ng-required="isNew" ng-show="unit.hasGroupwork()">\n                  <label class="col-sm-3 control-label">Group Task</label>\n                  <div class="col-sm-8">\n                    <select class="form-control" ng-model="task.group_set" ng-options="gs.name for gs in unit.group_sets track by gs.id"><option value="">None</option></select>\n                  </div>\n                </div><!--/group task-->\n                <div class="form-group" ng-required="isNew">\n                  <label class="col-sm-3 control-label">Restricted</label>\n                  <div class="col-sm-7">\n                    <button type="button" class="btn btn-default" ng-model="task.restrict_status_updates" btn-checkbox btn-checkbox-true="1" btn-checkbox-false="0">\n                      <i class="fa fa-{{task.restrict_status_updates ? \'check\' : \'times\'}}"></i>\n                    </button>\n                    <span class="help-block">\n                      If true, the status cannot be changed by students after it has been assigned by staff\n                    </span>\n                  </div>\n                </div><!--/restricted-->\n\n                <div class="form-group" ng-required="isNew">\n                  <label class="col-sm-3 control-label">Graded</label>\n                  <div class="col-sm-7">\n                    <button type="button" class="btn btn-default" ng-model="task.is_graded" btn-checkbox btn-checkbox-true="1" btn-checkbox-false="0">\n                      <i class="fa fa-{{task.is_graded ? \'check\' : \'times\'}}"></i>\n                    </button>\n                    <span class="help-block">\n                      If true, the task will be assessed with a grade to a specific standard. For example, <em>the task was completed to a HD standard</em>.\n                    </span>\n                  </div>\n                </div><!--/graded-task-->\n\n                <div class="form-group" ng-required="isNew">\n                  <label tooltip="Date students should aim to start this task." class="col-sm-3 control-label">Start Date</label>\n                  <div class="col-sm-7">\n                    <div class="col-sm-4 input-group">\n                      <input datepicker-popup="yyyy-MM-dd" is-open="startPicker.open" type="text" class="form-control" ng-model="task.start_date" placeholder="yyyy-MM-dd" close-text="Close" />\n                      <span class="input-group-btn">\n                        <button class="btn btn-default" ng-click="open($event, startPicker)"><i class="glyphicon glyphicon-calendar"></i></button>\n                      </span>\n                    </div>\n                  </div>\n                </div><!--/start-date-->\n\n                <div class="form-group" ng-required="isNew">\n                  <label tooltip="Date students should aim to complete this task." class="col-sm-3 control-label">Target Date</label>\n                  <div class="col-sm-7">\n                    <div class="col-sm-4 input-group">\n                      <input datepicker-popup="yyyy-MM-dd" is-open="targetPicker.open" type="text" class="form-control" ng-model="task.target_date" placeholder="yyyy-MM-dd" close-text="Close" />\n                      <span class="input-group-btn">\n                        <button class="btn btn-default" ng-click="open($event, targetPicker)"><i class="glyphicon glyphicon-calendar"></i></button>\n                      </span>\n                    </div>\n                  </div>\n                </div><!--/target-date-->\n\n                <div class="form-group">\n                  <label tooltip="Date after which task submissions will not appear for feedback. Can be empty." class="col-sm-3 control-label">Due Date</label>\n                  <div class="col-sm-7">\n                    <div class="col-sm-4 input-group">\n                      <input datepicker-popup="yyyy-MM-dd" is-open="duePicker.open" type="text" class="form-control" ng-model="task.due_date" placeholder="yyyy-MM-dd" close-text="Close" />\n                      <span class="input-group-btn">\n                        <button class="btn btn-default" ng-click="open($event, duePicker)"><i class="glyphicon glyphicon-calendar"></i></button>\n                      </span>\n                    </div>\n                  </div>\n                </div><!--/due-date-->\n              </div>\n              <div ng-show="activeTab == taskAdmin.tabsData.fileUpload">\n                <div class="form-group" ng-required="isNew">\n                  <div class="panel-body large-notice-block" ng-hide="task.upload_requirements.length > 0">\n                    <i class="fa fa-2x fa-upload"></i>\n                    <p>Add Submission Requirements</p>\n                  </div>\n                  <div ng-show="task.upload_requirements.length > 0">\n                    <div class="panel-body clearfix submission-requirement" ng-repeat="upreq in task.upload_requirements">\n                      <label class="col-sm-3 control-label">Requirement Name</label>\n                      <div class="col-sm-7 form-group">\n                        <input class="form-control" placeholder="Hello World Code" type="text" required ng-model="upreq.name"/>\n                      </div>\n                      <button tooltip="Remove this requirement" tooltip-append-to-body="true" class="btn btn-danger pull-right" ng-click="removeUpReq(upreq)">\n                        <i class="fa fa-trash-o"></i>\n                      </button>\n                      <label class="col-sm-3 control-label">Requirement Type</label>\n                      <div class="col-sm-7 form-group">\n                        <div class="btn-group pull-left">\n                          <label name="upreq-type-{{upreq.key}}" class="btn btn-default" btn-radio="\'code\'" ng-model="upreq.type">\n                            <i class="fa fa-file-code-o"></i> Code\n                          </label>\n                          <label name="upreq-type-{{upreq.key}}" class="btn btn-default" btn-radio="\'document\'" ng-model="upreq.type">\n                            <i class="fa fa-file-pdf-o"></i> Document\n                          </label>\n                          <label name="upreq-type-{{upreq.key}}" class="btn btn-default" btn-radio="\'image\'" ng-model="upreq.type">\n                            <i class="fa fa-file-image-o"></i> Image\n                          </label>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div><!--/upload-requirements-->\n              </div>\n              <div ng-show="activeTab == taskAdmin.tabsData.taskResources">\n                <div class="panel-body large-notice-block" ng-hide="task && task.id">\n                  <i class="fa fa-2x fa-floppy-o"></i>\n                  <p>Save Task to Upload Resources</p>\n                </div>\n                <div ng-if="task && task.id">\n                  <div class="col-sm-6">\n                    <file-uploader\n                      files="taskSheet"\n                      url="taskSheetUploadUrl()"\n                      on-success="onTaskSheetSuccess">\n                    </file-uploader>\n                    <a href="{{taskPDFUrl()}}" ng-show="task.has_task_pdf" target="_blank" class="btn btn-lg btn-info col-sm-12">\n                      <div>\n                        <i class="fa fa-2x fa-download"></i>\n                        <p>Download Task Sheet</p>\n                      </div>\n                    </a>\n                  </div>\n                  <div class="col-sm-6">\n                    <file-uploader\n                      files="taskResources"\n                      url="taskResourcesUploadUrl()"\n                      on-success="onTaskResourcesSuccess">\n                    </file-uploader>\n                    <a href="{{resourceUrl()}}" ng-show="task.has_task_resources" target="_blank" class="btn btn-lg btn-success col-sm-12">\n                      <div>\n                        <i class="fa fa-2x fa-download"></i>\n                        <p>Download Resources</p>\n                      </div>\n                    </a>\n                  </div>\n                </div>\n              </div>\n              <div ng-show="activeTab == taskAdmin.tabsData.plagiarismChecks" class="form-group">\n                <div class="panel-body plagiarism-check" ng-required="isNew">\n                  <label class="col-sm-3 control-label">Warn Percent</label>\n                  <div class="col-sm-8">\n                    <input type="number" ng-disabled="task.plagiarism_checks.length == 0" class="form-control" ng-model="task.plagiarism_warn_pct"/>\n                    <p class="help-block">\n                      The percentage similarity where Doubtfire creates a warning\n                    </p>\n                  </div>\n                </div><!--/check-perecent-->\n                <div ng-required="isNew" class="panel-body plagiarism-check clearfix" ng-show="task.plagiarism_checks.length > 0" ng-repeat="check in task.plagiarism_checks">\n                  <label class="col-sm-3 control-label">Detect Language</label>\n                  <div class="col-sm-7">\n                    <select class="form-control" ng-model="check.type">\n                      <option selected disabled value="">Select language</option>\n                      <option value="moss pascal">Pascal</option>\n                      <option value="moss c">C</option>\n                      <option value="moss csharp">C#</option>\n                      <option value="moss cc">C++</option>\n                      <option value="moss python">Python</option>\n                    </select>\n                    <p class="help-block">\n                      Doubtfire uses <a href="http://theory.stanford.edu/~aiken/moss/"M>Measure Of Software Similarity</a> (Moss) developed by Stanford University.\n                    </p>\n                  </div>\n                  <button class="btn btn-danger pull-right" ng-click="removeCheck(check)">\n                    <i tooltip="Remove this check" tooltip-append-to-body="true" class="fa fa-trash-o"></i>\n                  </button>\n                  <label class="col-sm-3 control-label">File Patterns</label>\n                  <div class="col-sm-7">\n                    <input class="form-control" placeholder="*.c|*.h" type="text" required ng-model="check.pattern"/>\n                    <p class="help-block">\n                      Separate file patterns with a pipe symbol, e.g.: <code>*.c|*.h</code>\n                    </p>\n                  </div>\n                </div>\n              </div><!--/plagiarism checks-->\n            </div><!--/panel-body-area-->\n            <div class="panel-footer text-right" ng-show="activeTab == taskAdmin.tabsData.fileUpload">\n              <button type="button" ng-click="addUpReq()" class="btn btn-success">\n                  <span class="glyphicon glyphicon-plus"></span> Add Submission Requirement\n              </button>\n            </div>\n            <div class="panel-footer text-right" ng-show="activeTab == taskAdmin.tabsData.plagiarismChecks">\n              <button type="button" ng-click="addCheck()" class="btn btn-success">\n                  <span class="glyphicon glyphicon-plus"></span> Add Plagiarism Check\n              </button>\n            </div>\n          </div><!--/tab-contents-panel-->\n        </div><!--/tab-contents-->\n      </div><!--/tab-feedback-tabs-->\n    </form>\n  </div>\n  <div class="panel-footer text-right" ng-show="task">\n    <button type="button" ng-hide="isNew" class="btn btn-danger" ng-click="deleteTask()">\n      <i class="fa fa-trash-o"></i> Delete\n    </button>\n    <button type="button" class="btn btn-primary" ng-click="saveTask()">\n      <i class="fa fa-save"></i> {{isNew ? \'Create\' : \'Save\'}}\n    </button>\n  </div>\n</div>\n')}]),angular.module("tasks/task-definition-selector/task-definition-selector.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-definition-selector/task-definition-selector.tpl.html",'<div class="btn-group task-definition-selector dropdown" dropdown>\n  <button class="btn btn-{{buttonStyle}} dropdown-toggle col-sm-12" type="button" dropdown-toggle>\n    <span ng-show="selectedDefinition">\n      Task\n      <label class="label label-info" ng-show="selectedDefinition" tooltip="{{selectedDefinition.name}}" tooltip-append-to-body="true">\n        {{selectedDefinition.abbreviation}}\n      </label>\n    </span>\n    <span ng-hide="selectedDefinition">Select Task</span>\n    <div class="pull-right">\n      <span class="caret"></span>\n    </div>\n  </button><!--/dropdown-button-->\n  <ul class="dropdown-menu project-tasks-list">\n    <div ng-repeat="(groupSetId, relatedTaskDefs) in unit.task_definitions | groupBy: \'group_set_id\'" class="col-sm-12">\n      <h5 class="groupset-name" ng-hide="hideGroupSetName">\n        {{groupSetName(groupSetId)}}\n      </h5>\n      <li class="col-xs-4 col-sm-3" ng-repeat="taskDef in relatedTaskDefs | orderBy: \'seq\'">\n        <button type="button" class="col-xs-12 btn btn-default" ng-class="{\'active\' : taskDef == selectedDefinition}" ng-click="setSelectedDefinition(taskDef)" tooltip-popup-delay=\'200\' tooltip-placement="bottom" tooltip="{{taskDef.name}}">\n          {{taskDef.abbreviation}}\n        </button>\n      </li>\n    </div>\n  </ul>\n</div>\n')}]),angular.module("tasks/task-feedback-assessor-list/task-feedback-assessor-list.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-feedback-assessor-list/task-feedback-assessor-list.tpl.html",'<div class="task-feedback-assessor-list">\n  <div class="panel panel-primary" ng-class="{fullscreen: fullscreen}">\n    <div class="panel-heading clearfix">\n      <div class="pull-left">\n        <h4 class="panel-title" ng-hide="context==\'task\'">{{title}}</h4>\n        <task-definition-selector button-style="default" unit="unit" on-select-definition="onSelectDefinition" ng-show="context==\'task\'"></task-definition-selector>\n        <div ng-hide="context==\'task\'">Show tasks from {{studentFilter == \'myStudents\' ? \'my tutorials\' : \'any tutorial\'}}</div>\n      </div>\n      <div class="pull-right text-right toolbar">\n        <div class="buttons">\n          <div class="btn-group">\n            <label class="btn btn-default" ng-model="studentFilter" btn-radio="\'allStudents\'">\n              <i class="fa fa-university" tooltip-placement="{{ fullscreen ? \'bottom\' : \'top\' }}" tooltip-append-to-body="true" tooltip="Show tasks for all students"></i>\n            </label>\n            <label class="btn btn-default" ng-model="studentFilter" btn-radio="\'myStudents\'">\n              <i class="fa fa-pencil" tooltip-placement="{{ fullscreen ? \'bottom\' : \'top\' }}" tooltip-append-to-body="true" tooltip="Only show tasks for my students"></i>\n            </label>\n          </div>\n          <div class="btn-group" ng-show="context == \'assess\'">\n            <label class="btn btn-default" ng-model="statusFilter" btn-radio="\'ready_to_mark\'">\n              <i class="fa fa-thumbs-up" tooltip-placement="{{ fullscreen ? \'bottom\' : \'top\' }}" tooltip-append-to-body="true" tooltip="Show tasks that are ready to mark."></i>\n            </label>\n            <label class="btn btn-default" ng-model="statusFilter" btn-radio="\'need_help\'">\n              <i class="fa fa-question" tooltip-placement="{{ fullscreen ? \'bottom\' : \'top\' }}" tooltip-append-to-body="true" tooltip="Show tasks that need help."></i>\n            </label>\n            <label class="btn btn-default" ng-model="statusFilter" btn-radio="\'discuss\'">\n              <i class="fa fa-commenting" tooltip-placement="{{ fullscreen ? \'bottom\' : \'top\' }}" tooltip-append-to-body="true" tooltip="Show tasks to discuss with students."></i>\n            </label>\n          </div>\n          <button class="btn btn-default fullscreen-toggle" ng-model="fullscreen" btn-checkbox btn-checkbox-true="1" btn-checkbox-false="0">\n            <i class="fa" ng-class="{\'fa-expand\' : !fullscreen, \'fa-compress\': fullscreen}"></i>\n          </button>\n        </div><!--buttons-->\n        <form role="search" class="form-horizontal">\n          <input id="searchbar" class="input-md form-control" placeholder="Search..." type="search"  typeahead="text for text in unitService.unitTypeAheadData(unit) | filter:$viewValue | limitTo:8" typeahead-wait-ms="200"  ng-model="search" autofocus />\n          <p ng-show="filteredTasks.length < allTasks.length && filteredTasks.length != 0">Showing {{filteredTasks.length}} of {{allTasks.length}} tasks requiring feedback.</p>\n        </form><!--search-->\n      </div><!--/toolbar-->\n    </div>\n    <div class="panel-body unit-student-list">\n      <div class="large-notice-block" ng-show="filteredTasks.length == 0 && ((selectedDefinition != null && context == \'task\') || context == \'assess\')">\n        <i class="fa fa-tasks"></i>\n        <p> No tasks found </p>\n      </div>\n      <div class="large-notice-block" ng-show="selectedDefinition == null && context == \'task\'">\n        <i class="fa fa-tasks"></i>\n        <p> Select a task from the panel header </p>\n      </div>\n      <table ng-hide="(!refreshed) || filteredTasks.length == 0" class="table table-condensed table-hover table-pointer ">\n        <thead>\n          <tr>\n            <th class="task-abbr">\n              <a ng-click="sortOrder=\'project().student_id\'; reverse=!reverse">\n                Student ID <i ng-show="sortOrder==\'project().student_id\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n              </a>\n            </th>\n            <th class="name">\n              <a ng-click="sortOrder=\'project().name\'; reverse=!reverse">\n                Name <i ng-show="sortOrder==\'project().name\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n              </a>\n            </th>\n            <th class="submisson_date">\n              <a ng-click="sortOrder=\'submission_date\'; reverse=!reverse">\n                Submitted On<i ng-show="sortOrder==\'submission_date\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n              </a>\n            </th>\n            <th class="task">\n              <a ng-click="sortOrder=\'definition.abbreviation\'; reverse=!reverse">\n                Task <i ng-show="sortOrder==\'definition.abbreviation\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n              </a>\n            </th>\n            <th class="status">\n              <a ng-click="sortOrder=\'statusSeq()\'; reverse=!reverse">\n                Status <i ng-show="sortOrder==\'statusSeq()\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n              </a>\n            </th>\n            <th class="times_assessed">\n              <a ng-click="sortOrder=\'times_assessed\'; reverse=!reverse">\n                Times Assessed <i ng-show="sortOrder==\'times_assessed\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n              </a>\n            </th>\n            <th class="tutorial">\n              <a ng-click="sortOrder=\'project().tutorial.abbreviation\'; reverse=!reverse">\n                <i ng-show="sortOrder==\'project().tutorial.abbreviation\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i> Tutorial\n              </a>\n            </th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr class="task-progress-row" ng-repeat="task in filteredTasks = (allTasks = (tasksForFeedback | showTasks:studentFilter:tutorName | statusFilter:statusFilter) | taskFilter:search) | orderBy:sortOrder:reverse | startFrom:(taskCurrentPage - 1) * taskPageSize | limitTo: taskPageSize" ng-class="{\'info\': activeTask == task}" ng-click="viewTask(task)">\n            <td>{{task.project().student_id}}</td>\n            <td>{{task.project().name}}</td>\n            <td>{{task.submission_date | date: short}}</td>\n            <td><span class="label label-info" tooltip="{{task.definition.name}}">{{task.definition.abbreviation}}</span></td>\n            <td>\n              <status-icon status="task.status"></status-icon>\n            </td>\n            <td>{{task.times_assessed}}</td>\n            <td><span tooltip-html-unsafe="<strong>{{task.project().tutorial.meeting_day}} {{task.project().tutorial.meeting_time | date: \'shortTime\'}}</strong><br/> {{task.project().tutorial.meeting_location}} - {{task.project().tutorial.tutor_name}}">{{task.project().tutorial.abbreviation}}</span></td>\n        </tr>\n        </tbody>\n      </table>\n    </div>\n    <div class="panel-body project-show no-padding" ng-if="fullscreen">\n      <task-feedback-assessor\n        scope="student-project-scope"\n        task="activeTask"\n        unit="unit"\n        view-options="viewOptions"\n        assessing-unit-role="assessingUnitRole"\n        unit-role="assessingUnitRole.id"\n        on-status-update="onStatusUpdate"></task-feedback-assessor>\n    </div>\n    <div class="panel-footer clearfix">\n      <div class="pull-right">\n        <button type="button" class="btn btn-primary btn-download" ng-click="showMarkOfflineModal()">\n          <i class="fa fa-laptop"></i> Mark Offline\n        </button>\n        <button type="button" class="btn btn-success btn-download" ng-click="refreshTasks()">\n          <i class="fa fa-refresh"></i> Refresh Tasks\n        </button>\n      </div>\n      <pagination total-items="filteredTasks.length" ng-model="taskCurrentPage" items-per-page="taskPageSize" max-size="taskMaxSize" class="pagination-sm pull-left" boundary-links="true" rotate="false"></pagination>\n    </div>\n  </div>\n  <task-feedback-assessor\n    ng-if="!fullscreen"\n    scope="student-project-scope"\n    task="activeTask"\n    unit="unit"\n    view-options="viewOptions"\n    assessing-unit-role="assessingUnitRole"\n    unit-role="assessingUnitRole.id"\n    fullscreen="fullscreen"\n    on-status-update="onStatusUpdate"></task-feedback-assessor>\n</div>\n')
}]),angular.module("tasks/task-feedback-assessor/task-feedback-assessor.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-feedback-assessor/task-feedback-assessor.tpl.html",'<div class="task-feedback-assessor">\n  <div class="panel panel-default" ng-hide="task">\n    <div class="panel-heading">\n      <h3 class="panel-title">\n        Task Details\n      </h3>\n    </div>\n    <div class="panel-body large-notice-block nothing-selected" ng-hide="task">\n      <i class="fa fa-tasks"></i>\n      <p>Select a task to view its status in detail</p>\n    </div>\n  </div>\n  <div class="panel panel-default" ng-if="task">\n    <div class="panel-heading" ng-show="task.definition.upload_requirements.length > 0">\n      <a class="pull-right" ng-click="viewOptions.showPdf = !viewOptions.showPdf"><i ng-show="viewOptions.showPdf" class="fa fa-2x fa-chevron-circle-down"></i><i ng-hide="viewOptions.showPdf" class="fa fa-2x fa-chevron-circle-up"></i></a>\n      <h3 class="panel-title">\n        Task Submission\n      </h3>\n    </div>\n    <div class="panel-body large-notice-block" ng-show="viewOptions.showPdf && (!task.has_pdf) && task.definition.upload_requirements.length > 0 ">\n        <i class="fa fa-file-pdf-o fa-2x"></i>\n        <p>No submission PDF available.</p>\n    </div>\n    <task-submission-viewer ng-show="viewOptions.showPdf && (task.has_pdf || task.needsSubmissionDetails())" project="task.project()" task="task"></task-submission-viewer>\n    <div class="panel-heading">\n      <a class="pull-right" ng-click="viewOptions.showComments = !viewOptions.showComments"><i ng-show="viewOptions.showComments" class="fa fa-2x fa-chevron-circle-down"></i><i ng-hide="viewOptions.showComments" class="fa fa-2x fa-chevron-circle-up"></i></a>\n      <h3 class="panel-title">\n        Task Comments\n      </h3>\n    </div>\n    <task-comments-viewer project="task.project()" task="task" comment="comment" ng-show="viewOptions.showComments"></task-comments-viewer>\n\n    <div class="panel-heading">\n      <a class="pull-right" ng-click="viewOptions.showClassify = !viewOptions.showClassify"><i ng-show="viewOptions.showClassify" class="fa fa-2x fa-chevron-circle-down"></i><i ng-hide="viewOptions.showClassify" class="fa fa-2x fa-chevron-circle-up"></i></a>\n      <h3 class="panel-title">\n        Update Task Status\n      </h3>\n    </div>\n    <div class="panel-body" ng-show="viewOptions.showClassify">\n      <task-status-selector\n        task="task"\n        assessing-unit-role="assessingUnitRole"\n        in-menu="false"\n        trigger-transition="triggerTransition"\n        ></task-status-selector>\n    </div>\n  </div>\n</div>\n')}]),angular.module("tasks/task-ilo-alignment/modals/task-ilo-alignment-modal/task-ilo-alignment-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-ilo-alignment/modals/task-ilo-alignment-modal/task-ilo-alignment-modal.tpl.html",'<div class="task-ilo-alignment-modal">\n  <div class="modal-header text-center">\n    <h3>\n      How much does <label class="label label-info" tooltip="{{task.name}}">{{task.abbreviation}}</label> relate to <label class="label label-info" tooltip="{{ilo.name}}">{{ilo.abbreviation}}</label>?\n    </h3>\n  </div>\n  <div class="modal-body clearfix">\n    <p class="help-block col-sm-12 text-center">\n      Hover and click over a rating value below\n    </p>\n    <task-ilo-alignment-rater ng-model="alignment" on-rating-changed="updateRating"></task-ilo-alignment-rater>\n    <div class="col-sm-12 rationale-wrapper" ng-show="alignment.rating > 0">\n      <div tooltip="Click to edit rationale" tooltip-placement="left" tooltip-append-to-body="false" tooltip-popup-delay="300" tooltip-enable="alignment.description != null" ng-click="toggleEditRationale()" class="rationale" ng-class="{\'no-rationale\': alignment.description == null}" ng-hide="editingRationale">\n        <label class="text-muted" ng-show="alignment.description != null">\n          Provided Rationale\n        </label>\n        <div ng-bind-html="(alignment.description || \'No rationale provided\') | markdown"></div>\n        <div class="small" ng-hide="alignment.description">Click to add one</div>\n      </div>\n      <div ng-if="editingRationale" class="clearfix">\n        <markdown-editor\n          height="200"\n          ng-model="alignment.description"\n          placeholder="Edit rationale..."\n          autofocus="true">\n        </markdown-editor>\n        <a ng-click="toggleEditRationale(alignment)" class="pull-right">Done Editing</a>\n      </div>\n    </div>\n  </div>\n  <div class="modal-footer">\n    <button ng-click="closeModal()" class="btn btn-primary">\n      <i class="fa fa-check"></i>\n    </button>\n    <button ng-click="removeAlignmentItem(alignment)" ng-if="alignment" tooltip="Remove this alignment" tooltip-append-to-body="true" class="btn btn-danger">\n      <i class="fa fa-trash-o"></i>\n    </button>\n  </div>\n</div>\n')}]),angular.module("tasks/task-ilo-alignment/task-ilo-alignment-editor/task-ilo-alignment-editor.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-ilo-alignment/task-ilo-alignment-editor/task-ilo-alignment-editor.tpl.html",'<div class="task-ilo-alignment-editor row ">\n  <div class="alignment-panels" ng-class="{\'col-md-9\': showCsv}">\n    <div class="{{hidePanel ? \'\' : \'panel panel-primary\'}}">\n      <div ng-hide="hidePanel" class="panel-heading clearfix">\n        <h3 class="panel-title">\n          {{showIncludeTasks ? \'Select Tasks\' : \'Intended Learning Outcome Alignment\'}}\n        </h3>\n        <div class="col-sm-8 pull-left" style="padding-left: 0;">\n          <div ng-show="showIncludeTasks" >\n            Select tasks to include and showcase in your portfolio that demonstrates your\n            understanding of each Indended Learning Outcome.\n          </div>\n          <div ng-hide="showIncludeTasks">\n            Align tasks to an Intended Learning Outcome by selecting the red circle and choosing a rating,\n            providing an optional rational to justify why that task is related to the outcome selected.\n          </div>\n        </div>\n        <div class="btn-group pull-right">\n          <button class="btn btn-default" ng-model="showGraph" btn-radio="true" uncheckable>\n            <i class="fa fa-bar-chart"></i>\n          </button>\n        </div>\n      </div><!--/heading-->\n\n      <div class="panel-body">\n        <div class="large-notice-block" ng-hide="tasks.length > 0">\n          <i class="fa fa-2x fa-tasks"></i>\n          <p>No tasks in this unit</p>\n        </div>\n        <div class="large-notice-block" ng-hide="unit.ilos.length > 0 || showIncludeTasks">\n          {{unit.ilos.length > 0 && ! showIncludeTasks}}\n          <i class="fa fa-2x fa-graduation-cap"></i>\n          <p>No learning outcomes in this unit</p>\n        </div>\n        <table class="table table-task-alignment col-sm-12" ng-hide="tasks.length == 0 || (unit.ilos.length == 0 && ! showIncludeTasks)">\n          <thead>\n            <tr>\n              <th class="task" colspan="{{(showTaskName ? 3 : 2) - (source === unit ? 1 : 0)}}">Task</th>\n              <th class="ilo text-center" ng-repeat="ilo in unit.ilos | orderBy: \'abbreviation\'" tooltip="{{ilo.name}}" tooltip-append-to-body="true">\n                <label class="label label-info">{{ilo.abbreviation}}</label>\n              </th>\n              <th ng-if="showIncludeTasks" class="include-in-portfolio">Include</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr ng-repeat="task in tasks | taskForPortfolio: source === project | orderBy: \'definition.seq\'">\n              <td class="task-abbreviation" tooltip="{{task.definition.name}}" tooltip-append-to-body="true">\n                <label class="label label-info">{{task.definition.abbreviation}}</label>\n              </td>\n              <td class="task-status-icon" ng-if="source === project">\n                <status-icon status="task.status"></status-icon>\n              </td>\n              <td class="task-name" ng-show="showTaskName">\n                {{task.definition.name}}\n              </td>\n              <td ng-repeat="ilo in unit.ilos | orderBy: \'abbreviation\'" class="ilo-alignment text-center">\n                {{alignment = alignmentForTaskAndIlo(task, ilo); \'\'}}\n                <button ng-click="showAlignmentModal(task, ilo, alignment)" class="btn btn-sm btn-default btn-alignment">\n                  <task-ilo-alignment-rater ng-if="alignment" ng-model="alignment" compact="true"></task-ilo-alignment-rater>\n                  <i ng-hide="alignment" class="fa fa-circle-o fa-3x text-danger" tooltip-append-to-body="true" tooltip="You decided {{task.definition.abbreviation}} is not aligned to {{ilo.abbreviation}}"></i>\n                </button>\n              </td>\n              <td ng-if="showIncludeTasks" class="include-in-portfolio">\n                <div\n                  tooltip-enable="disableInclude(task)"\n                  tooltip="You cannot select this task as it is not aligned to any ILOs"\n                  tooltip-placement="left"\n                  tooltip-append-to-body="true"\n                  class="button-wrapper">\n                  <button\n                    class="btn btn-sm btn-{{task.include_in_portfolio ? \'success\' : \'default\'}} col-sm-6 text-center"\n                    ng-click="includeTaskInPorfolio(task)"\n                    ng-if="!disableInclude(task)">\n                    <i class="fa fa-{{task.include_in_portfolio ? \'check\' : \'times\'}}"></i>\n                  </button>\n                  <button\n                    class="btn btn-sm btn-warning col-sm-6 text-center"\n                    ng-disabled="disableInclude(task)"\n                    ng-show="disableInclude(task)">\n                    <i class="fa fa-question"></i>\n                  </button>\n                </div>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div><!--/select-panel-body-->\n    </div><!--/select-panel-->\n    <div class="panel panel-default visualisation" ng-if="showGraph">\n      <div class="panel-heading clearfix">\n          <h4 class="panel-title pull-left">Visualisation</h4>\n          <button class="pull-right close" ng-click="closeGraph()">&times;</button>\n      </div>\n      <div class="panel-body">\n        <alignment-bar-chart unit="unit" project="project" source="source" task-status-factor="taskStatusFactor"></alignment-bar-chart>\n      </div>\n      <div class="panel-footer text-center">\n        Hover over this panel to highlight\n      </div>\n    </div><!--/visualisation-->\n  </div><!--/main-panels-->\n  <div class="col-md-3" ng-if="showCsv">\n    <div class="panel panel-default">\n      <div class="panel-heading">\n        <h3 class="panel-title">Import Task Outcome Alignments</h3>\n        Import links between tasks and outcomes from a CSV containing: unit_code, learning_outcome, task_abbr, rating.\n      </div>\n      <div class="panel-body">\n        <file-uploader\n          files="taskAlignmentCSV"\n          url="taskAlignmentCSVUploadUrl()"\n          is-uploading="isTaskAlignmentCSVUploading"\n          on-success="onTaskAlignmentCSVSuccess"\n          on-complete="onTaskAlignmentCSVComplete"></file-uploader>\n      </div>\n      <div class="panel-heading">\n        <h3 class="panel-title">Export Task Outcome Alignments</h3>\n        Download a CSV of task outcome alignment details.\n      </div>\n      <div class="panel-body text-center">\n        <button class="btn btn-primary btn-download" ng-click="downloadTaskAlignmentCSV()">\n          <i class="fa fa-download"></i> Download\n        </button>\n      </div>\n    </div><!--/csv-import-export-->\n  </div><!--/csv-panels-->\n</div>\n')}]),angular.module("tasks/task-ilo-alignment/task-ilo-alignment-rater/task-ilo-alignment-rater.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-ilo-alignment/task-ilo-alignment-rater/task-ilo-alignment-rater.tpl.html",'<div class="task-ilo-alignment-rater" ng-class="{colorful: colorful}">\n  <rating ng-hide="compact" on-leave="setHoverValue(null)" on-hover="setHoverValue(value)" titles="null" ng-model="ngModel.rating" max="max" state-on="\'fa fa-2x fa-circle\'" state-off="\'fa fa-2x fa-circle-o\'" tooltip="{{tooltips[hoveringOver-1]}}" tooltip-placement="right" tooltip-class="tooltip-rating-{{hoveringOver}}" tooltip-append-to-body="true" tooltip-popup-delay="200" tooltip-enable="showTooltips" readonly="readonly" class="rating-area"></rating>\n  <div ng-show="selectedTooltip && !showTooltips && !compact" class="text-center rating-static-tooltip">\n    <span class="rating-{{hoveringOver || ngModel.rating}} badge">{{tooltips[(hoveringOver || ngModel.rating) - 1]}}</span>\n  </div>\n  <div ng-show="compact && readonly" class="compact-rating rating-{{ngModel.rating}}" tooltip="{{tooltips[ngModel.rating - 1]}}" tooltip-class="tooltip-rating-{{ngModel.rating}}" tooltip-append-to-body="true">\n    {{ngModel.rating}}\n  </div>\n</div>\n')}]),angular.module("tasks/task-ilo-alignment/task-ilo-alignment-viewer/task-ilo-alignment-viewer.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-ilo-alignment/task-ilo-alignment-viewer/task-ilo-alignment-viewer.tpl.html",'<div class="task-ilo-alignment-viewer">\n  <div class="clearfix" ng-if="alignments.length > 0">\n    <ul class="list-group alignment-list">\n      <li ng-click="toggleExpanded(align)" ng-class="{expanded: align.expanded}" ng-repeat="align in alignments | orderBy: \'ilo_number\'" class="list-group-item col-sm-12">\n        <header class="clearfix">\n          <div class="col-sm-6 pull-left header-item">\n            {{ilo = summaryOnly ? align : unit.outcome(align.learning_outcome_id); \'\'}}\n            <h3 class="list-group-item-heading outcome-heading col-sm-12" style="padding: 0;">\n              <span class="col-sm-3 label label-info pull-left">{{ilo.abbreviation}}</span>\n              <span class="col-sm-9 pull-left">{{ilo.name}}</span>\n            </h3>\n          </div>\n          <div class="col-sm-6 pull-right clearfix header-item">\n            <task-ilo-alignment-rater\n              ng-hide="summaryOnly"\n              readonly="true"\n              unit="unit"\n              ng-model="align"></task-ilo-alignment-rater>\n            <div ng-if="ilo && classStats && summaryOnly">\n              <alignment-bullet-chart\n                show-legend="false"\n                unit="unit"\n                project="project"\n                ilo="ilo"\n                targets="targets"\n                current-progress="currentProgress"\n                class-stats="classStats"></alignment-bullet-chart>\n            </div>\n            <div class="expand-icon text-muted text-{{align.expanded ? \'primary\' : \'muted\'}}">\n              <i class="fa fa-3x fa-chevron-circle-{{align.expanded ? \'up\' : \'down\'}}"></i>\n            </div>\n          </div>\n        </header><!--/alignment-header-->\n        <div class="list-group-item-text alignment-content col-sm-8" ng-show="align.expanded">\n          <div ng-show="ilo.description">\n            <h5>Description</h5>\n            <div class="markdown-to-html" ng-bind-html="ilo.description | markdown"></div>\n          </div>\n          <div ng-if="ilo && classStats &&!hideVisualisation">\n            <h5>Visualisation</h5>\n            <alignment-bullet-chart\n              show-legend="false"\n              unit="unit"\n              project="project"\n              ilo="ilo"\n              targets="targets"\n              current-progress="currentProgress"\n              class-stats="classStats">\n            </alignment-bullet-chart>\n          </div>\n          <div ng-show="!summaryOnly && align.description">\n            <h5>Rationale</h5>\n            <div class="markdown-to-html" ng-bind-html="align.description | markdown"></div>\n          </div>\n          <div ng-show="summaryOnly">\n            <h5>Related Tasks</h5>\n            <div class="related-outcome-tasks">\n              <ul class="list-group">\n                <li class="list-group-item" ng-repeat="align in unit.task_outcome_alignments | outcomeFilter: ilo.id | orderBy: \'seq\'">\n                  <div class="clearfix">\n                    {{taskDef = unit.taskDef(align.task_definition_id); \'\'}}\n                    <task-ilo-alignment-rater\n                      class="pull-right"\n                      readonly="true"\n                      unit="unit"\n                      show-tooltips="true"\n                      ng-model="align">\n                    </task-ilo-alignment-rater>\n                    <div class="task-def-alignment-item">\n                      <label class="label label-info task-def-label pull-left">{{taskDef.abbreviation}}</label>\n                      <span class="col-sm-6">{{taskDef.name}}</span>\n                    </div>\n                  </div>\n                </li>\n              </ul>\n            </div>\n          </div>\n        </div>\n      </li>\n    </ul>\n  </div>\n  <div class="large-notice-block" ng-hide="alignments.length > 0">\n    <i class="fa fa-2x fa-graduation-cap"></i>\n    <p>No alignments</p>\n  </div>\n</div>\n')}]),angular.module("tasks/task-plagiarism-file-viewer/task-plagiarism-file-viewer.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-plagiarism-file-viewer/task-plagiarism-file-viewer.tpl.html",'<div class="panel panel-default task-plagiarism-file-viewer">\n  <div class="panel-heading">\n    <h5 class="panel-title">{{match.username}}: {{match.name}}\n      <br>\n      <small>{{match.pct}}% {{match.tutor}} {{match.tutorial}} <a ng-show="match.lnk" ng-href="{{match.lnk}}" target="new">report</a></small>\n    </h5>\n  </div>\n  <div class="panel-body plagiarism-panel">\n    <code ng-class="match.name == \'???\' ? \'col-sm-12\' : \'plagiarism-panel col-sm-12\'" ng-bind-html="match.html"></code>\n  </div>\n</div>\n')}]),angular.module("tasks/task-plagiarism-report-viewer/task-plagiarism-report-viewer.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-plagiarism-report-viewer/task-plagiarism-report-viewer.tpl.html",'<div class="task-plagiarism-report-viewer">\n  <div class="panel-body">\n    <div class="large-notice-block" ng-show="noPlagiarismDetected()">\n      <i class="fa fa-eye fa-2x"></i>\n      <p>Doubtfire has detected no similarities for this work</p>\n    </div><!--/no-detections-->\n    <div ng-if="task.similar_to_count > 0 && similarityData">\n      <div ng-class="classForViews()">\n        <task-plagiarism-file-viewer match="similarityData.student"></task-plagiarism-file-viewer>\n      </div>\n      <div ng-class="classForViews()">\n        <task-plagiarism-file-viewer match="similarityData.other_student"></task-plagiarism-file-viewer>\n      </div>\n    </div>\n  </div>\n  <div class="panel-footer" ng-hide="noPlagiarismDetected()">\n    <pagination ng-show="task.similar_to_count > 1" total-items="task.similar_to_count" ng-model="match" items-per-page="1" max-size="5" class="pagination-sm" boundary-links="true" rotate="false"></pagination>\n  </div>\n</div>\n')}]),angular.module("tasks/task-sheet-viewer/task-sheet-viewer.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-sheet-viewer/task-sheet-viewer.tpl.html",'<div class="task-sheet-viewer">\n  <div class="panel-body task-description">\n    <div class="markdown-to-pdf" ng-bind-html="project.selectedTask.definition.description | markdown"></div>\n  </div><!--task-description-panel-body-->\n  <div class="panel-heading task-view-alignment-panel" ng-hide="showTaskSheet" ng-if="alignments.length > 0">\n    <h3 class="panel-title">\n      Task Outcome Alignments\n    </h3>\n    Teaching staff believe that completing this task will help you achieve the outcomes listed below\n  </div><!--view-alignment-panel-header-->\n  <div class="panel-body task-view-alignment-panel" ng-hide="showTaskSheet" ng-if="alignments.length > 0">\n    <task-ilo-alignment-viewer\n      project="project"\n      task="task"\n      unit="unit"\n      alignments="alignments"\n      summative="false"\n      hide-visualisation="true"></task-ilo-alignment-viewer>\n  </div><!--view-alignment-panel-body-->\n  <div class="panel-heading row-fluid task-download" ng-show="hasPDF() || hasResources()">\n    <h3 class="panel-title">\n      Begin task\n    </h3>\n    Begin task by {{hasPDF() ? "viewing the task sheet" : ""}} {{hasPDF() && hasResources() ? "or" : ""}} {{hasResources() ? "downloading task resources" : ""}}\n  </div>\n  <div class="panel-body task-buttons-download-area" ng-class="{ small: showTaskSheet }" ng-show="hasPDF() || hasResources()">\n    <a ng-class="{ active: showTaskSheet }" ng-click="toggleTaskSheet()" ng-show="hasPDF()" class="btn btn-lg btn-default">\n      <div>\n        <i class="fa fa-2x fa-file-pdf-o"></i>\n        <p>View{{showTaskSheet ? "ing" : \'\'}} PDF</p>\n      </div>\n    </a>\n    <a ng-click="downloadEvent(\'PDF\')" href="{{taskPDFUrl()}}" ng-show="hasPDF()" target="_blank" class="btn btn-lg btn-info">\n      <div>\n        <i class="fa fa-2x fa-file-pdf-o"></i>\n        <i class="fa fa-2x fa-download"></i>\n        <p>Download PDF</p>\n      </div>\n    </a>\n    <a ng-click="downloadEvent(\'Resources\')" href="{{resourceUrl()}}" ng-show="hasResources()" target="_blank" class="btn btn-lg btn-success">\n      <div>\n        <i class="fa fa-2x fa-download"></i>\n        <p>Download Resources</p>\n      </div>\n    </a>\n  </div>\n  <div ng-if="showTaskSheet && hasPDF() && hasResources()">\n    <pdf-panel-viewer\n      pdf-url="taskPDFUrl()"\n      resources-url="resourceUrl()"\n      hide-footer="true">\n    </pdf-panel-viewer>\n  </div>\n  <div ng-if="showTaskSheet && hasPDF() && !hasResources()">\n    <pdf-panel-viewer\n      pdf-url="taskPDFUrl()"\n      hide-footer="true">\n    </pdf-panel-viewer>\n  </div><!--viewing-task-sheet-->\n</div>\n')}]),angular.module("tasks/task-status-selector/task-status-selector.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-status-selector/task-status-selector.tpl.html",'<ul ng-class="{\'dropdown-menu\' :inMenu}" class="task-status-selector">\n  <li ng-show="assessingUnitRole" class="col-xs-6 col-sm-4 col-md-4" ng-repeat="action in taskEngagementConfig.tutorTriggers" >\n    <div class="row">\n    <button class="col-xs-12 btn task-status {{action.taskClass}}" ng-class="{\'active\' : project.selectedTask.status == action.status}" ng-click="triggerTransition(action.status)" ng-model="project.selectedTask.status" btn-radio="action.status" uncheckable>\n      <i class="{{action.iconClass}} fa-2x task-status-icon"></i>\n      <strong>{{action.label}}</strong>\n    </button>\n    </div>\n  </li><!--/tutor-statuses-->\n  <li class="col-xs-6 col-sm-4 col-md-4" ng-repeat="action in taskEngagementConfig.studentTriggers" >\n    <div class="row">\n      <button class="col-xs-12 btn task-status {{action.taskClass}}" ng-class="{\'active\' : project.selectedTask.status == action.status}" ng-click="triggerTransition(action.status)" ng-model="project.selectedTask.status" btn-radio="action.status" >\n        <i class="{{action.iconClass}} fa-2x task-status-icon"></i>\n        <strong>{{action.label}}</strong>\n      </button>\n    </div>\n  </li><!--/student-statuses-->\n</ul>\n')}]),angular.module("tasks/task-submission-viewer/task-submission-viewer.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-submission-viewer/task-submission-viewer.tpl.html",'<div class="panel-body task-submission-viewer">\n  <div ng-show="notSubmitted(task) || task.processing_pdf || loadingDetails(task)">\n    <div class="large-notice-block" ng-show="notSubmitted(task) && ! loadingDetails(task)">\n      <i class="fa fa-upload fa-2x"></i>\n      <p>Upload submission before viewing.</p>\n    </div><!--/no-pdf-->\n    <div class="large-notice-block" ng-show="task.processing_pdf && ! loadingDetails(task)">\n        <i class="fa fa-clock-o fa-2x"></i>\n        <p>Submission is being processed. Come back soon.</p>\n    </div><!--/pdf-in-process-->\n    <div class="large-notice-block" ng-show="loadingDetails(task)">\n        <i class="fa fa-spinner fa-pulse fa-2x"></i>\n        <p>Fetching Submission Details.</p>\n    </div><!--/loading details-->\n  </div>\n  <div ng-if="task.has_pdf">\n    <pdf-panel-viewer\n      pdf-url="taskUrl"\n      footer-text="{{task.status != \'ready_to_mark\' ? \'Annotated comments are viewable once PDF is downloaded\' : \'Comments will be available once your tutor has assessed your submission\'}}"\n      ng-hide="notSubmitted(task) || task.processing_pdf">\n    </pdf-panel-viewer>\n  </div>\n</div>\n')}]),angular.module("tasks/task-submission-wizard/task-submission-wizard.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-submission-wizard/task-submission-wizard.tpl.html",'<div class="task-submission-wizard">\n  <div class="panel-body">\n    <div class="help-block" ng-show="task.definition.upload_requirements.length == 0">\n      <i class="fa fa-upload fa-2x"></i>\n      <p>No files required for this task.</p>\n    </div><!--/no-files-required-->\n    <div class="help-block" ng-show="isGroupTask() && ! inGroupForTask()">\n      <i class="fa fa-upload fa-2x"></i>\n      <p>Join a {{task.definition.group_set.name}} group to submit this task.</p>\n    </div><!--/no-detections-->\n    <div class="large-notice-block" ng-hide="uploadType" ng-if="task.definition.upload_requirements.length > 0 && ((! isGroupTask()) || inGroupForTask())">\n      <div>\n        <i ng-repeat="(k, file) in files" class="fa fa-2x fa-file-{{file.type == \'document\' ? \'pdf\' : file.type}}-o"></i>\n      </div>\n      <h3>{{numberOfFiles}} File{{numberOfFiles > 1 ? "s" : ""}} Required</h3>\n      <p class="lead">\n        <span ng-show="uploadType || helpLabel">\n        Upload as\n        </span>\n        {{helpLabel || "Please select upload type below"}}\n      </p>\n      <div class="text-center">\n        <div class="btn-group">\n          <button ng-repeat="(key, data) in uploadTypes"\n              class="btn btn-lg task-status {{data.class}}"\n              ng-click="setUploadType(key)"\n              ng-mouseover="setHelpLabel(data.text)"\n              ng-mouseout="setHelpLabel()"\n              ng-if="!data.hide"\n              ng-class="{active: uploadType == key}">\n            <i class="fa-2x {{data.icon}}"></i>\n          </button>\n        </div><!--/upload-type-buttons-->\n      </div>\n    </div><!--upload-header-->\n    <div class="upload-type-selected-state" ng-if="uploadType && task.definition.upload_requirements.length > 0">\n      <div class="upload-assistant clearfix" ng-if="!isUploading">\n        <h3>\n          Upload {{task.definition.name}}...\n          <small>Select {{numberOfFiles}} file{{numberOfFiles > 1 ? "s" : ""}} below</small>\n        </h3>\n        <div class="upload-type-switcher">\n          <div class="btn-group">\n            <button ng-repeat="(key, data) in uploadTypes"\n                class="btn task-status {{data.class}}"\n                ng-click="setUploadType(key)"\n                ng-mouseover="setHelpLabel(data.text)"\n                ng-mouseout="setHelpLabel()"\n                ng-if="!data.hide"\n                ng-class="{active: uploadType == key}">\n              <i class="fa-2x {{data.icon}}"></i>\n            </button>\n          </div><!--/upload-type-buttons-->\n          <p class="">\n            <strong>Upload{{helpLabel == \'\' ? \'ing\' : \'\'}} as</strong>\n            <span>{{helpLabel || uploadTypes[uploadType].text}}</span>\n          </p>\n        </div>\n      </div><!--/upload-assistant-->\n      <div ng-if="isGroupTask()">\n        <group-member-contribution-assigner task="task" project="project" team="team"></group-member-contribution-assigner>\n        <hr>\n      </div>\n      <file-uploader\n        files="files"\n        url="url"\n        payload="payload"\n        on-before-upload="onBeforeUpload"\n        is-uploading="isUploading"\n        on-success="onSuccess"\n        on-complete="onComplete"></file-uploader>\n    </div><!--/upload-area--><!--end if to hide group tasks-->\n  </div>\n  <div class="panel-footer clearfix" ng-if="allowRegeneratePdf">\n    <button class="btn btn-primary pull-right" tooltip="Ask Doubtfire to regenerate the PDF that was created" ng-click="recreateTask()">\n      <i class=\'fa fa-refresh\'></i>\n    </button>\n  </div>\n</div>\n')}]),angular.module("tasks/task-viewer/task-viewer.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("tasks/task-viewer/task-viewer.tpl.html",'<div class="task-viewer">\n  <div class="col-sm-12">\n    <div class="task-viewer-toolbar clearfix">\n      <div class="btn-group dropdown active-task-selector col-sm-1" dropdown>\n        <button class="btn task-status {{activeStatusData().class}} dropdown-toggle" dropdown-toggle>\n          <label>{{project.selectedTask.definition.abbreviation}}</label>\n          <span class="caret"></span>\n        </button><!--/dropdown-button-->\n        <project-tasks-list\n          class="dropdown-menu"\n          in-menu="true"\n          unit="unit"\n          project="project"\n          on-select="setSelectedTask"></project-tasks-list>\n      </div><!--/active-task-selector-->\n\n      <div class="task-header-info col-sm-10">\n        <div class="col-sm-8 task-status-summary">\n          <!-- Lachlan -->\n          <div class="task-header-grade-icon">\n            <grade-icon grade="project.selectedTask.definition.target_grade"></grade-icon>\n          </div>\n          <h3>{{project.selectedTask.definition.name}}</h3>\n          <p class="help-block">{{activeStatusData().helpText}}</p>\n          <div class="graded-task-mark text-danger" ng-if="taskIsGraded">\n            Your tutor has marked you on this task to a <grade-icon grade="project.selectedTask.grade"></grade-icon> standard.\n          </div>\n        </div>\n        <div class="col-sm-4 date-info">\n          <div class="overdue label label-{{daysOverdue(project.selectedTask) > 5 ? \'danger\' : \'warning\'}}" ng-hide="daysOverdue(project.selectedTask) === false" tooltip="Tasks are overdue until they are discussed with your tutor." tooltip-placement="right">\n            <i class="fa fa-exclamation-triangle"></i>\n            Past Target By <br/> {{daysOverdue(project.selectedTask)}} day{{daysOverdue(project.selectedTask) > 1 ? \'s\' : \'\'}}\n          </div>\n          <p class="due-date" tooltip="You should aim to complete the task by this date" tooltip-placement="right">\n            <label>Target:</label> {{project.selectedTask.definition.target_date | date:\'EEE MMM d\'}}\n          </p>\n          <p class="due-date" ng-show="project.selectedTask.definition.due_date" tooltip="The task must be completed by this date" tooltip-placement="right">\n            <label>Deadline:</label> {{project.selectedTask.definition.due_date | date:\'EEE MMM d\'}}\n          </p>\n        </div>\n      </div><!--/task-header-info-->\n\n      <div tooltip-placement="left" tooltip="{{activeStatusData().label}}" tooltip-append-to-body="true" class="btn-group dropdown active-task-status-selector col-sm-1 pull-right" dropdown>\n        <button type="button" class="btn task-status {{statusClass(project.selectedTask.status)}} dropdown-toggle" dropdown-toggle>\n          <i class="{{activeStatusData().icon}} fa-2x"></i>\n          <span class="caret"></span>\n        </button>\n\n        <task-status-selector\n          task="project.selectedTask"\n          assessing-unit-role="assessingUnitRole"\n          in-menu="true"\n          trigger-transition="triggerTransition"></task-status-selector>\n\n      </div><!--/active-task-status-selector-->\n    </div><!--/task-toolbar-->\n  </div>\n  <div class="col-sm-2 col-lg-1 task-viewer-tabs">\n      <tabset vertical="false" type="pills">\n        <tab ng-repeat="(tabKey, tab) in tabs | orderObjectBy: \'seq\'" active="tab.active" ng-click="setActiveTab(tab)">\n          <tab-heading class="text-center" tooltip="{{tab.title}}" tooltip-placement="right" tooltip-popup-delay="200">\n              <i class="fa fa-2x {{tab.icon}}"></i>\n              <i class="fa fa-2x fa-warning" ng-class="{ \'text-warning\': !isActiveTab(tab) }" ng-show="tab == tabs.plagiarismReport && project.selectedTask.similar_to_count > 0"></i>\n              <strong class="comment-count" ng-show="tab == tabs.viewComments && project.selectedTask.comments.length > 0">{{project.selectedTask.comments.length}}</strong>\n          </tab-heading>\n        </tab>\n      </tabset>\n  </div>\n  <div class="col-sm-10 col-lg-11" class="class-viewer-tab-contents">\n    <div class="panel panel-primary">\n      <div class="panel-heading row-fluid">\n        <h3 class="panel-title">\n          {{activeTab.title}}\n        </h3>\n        {{activeTab.subtitle}}\n      </div>\n      <div class="task-viewer-tab-panel">\n        <task-sheet-viewer task="project.selectedTask" project="project" unit="unit" ng-if="activeTab == tabs.taskSheet"></task-sheet-viewer>\n        <task-submission-wizard task="project.selectedTask" project="project" unit="unit" assessing-unit-role="assessingUnitRole" ng-if="activeTab == tabs.fileUpload"></task-submission-wizard>\n        <task-submission-viewer ng-show="activeTab == tabs.viewSubmission" project="project" task="project.selectedTask"></task-submission-viewer>\n        <task-comments-viewer ng-show="activeTab == tabs.viewComments" project="project" task="project.selectedTask"></task-comments-viewer>\n        <task-plagiarism-report-viewer task="project.selectedTask" ng-if="activeTab == tabs.plagiarismReport"></task-plagiarism-report-viewer>\n      </div><!--/panel-body-area-->\n    </div><!--/tab-contents-panel-->\n  </div>\n</div>\n')
}]),angular.module("units/modals/unit-create-modal/unit-create-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/modals/unit-create-modal/unit-create-modal.tpl.html",'<div class="unit-create-modal">\n  <form class="form-horizontal" ng-submit="saveUnit()" role="form">\n    <div class="modal-header">\n      <h3>Create Unit</h3>\n    </div>\n    <div class="modal-body">\n      <div class="form-group" required>\n        <label class="col-sm-3 control-label">Name</label>\n        <div class="col-sm-7">\n          <input type="text" class="form-control" ng-model="unit.name" placeholder="Introduction to Doubtfire"/>\n        </div>\n      </div>\n      <div class="form-group" required>\n        <label class="col-sm-3 control-label">Code</label>\n        <div class="col-sm-7">\n          <input type="text" class="form-control" ng-model="unit.code" placeholder="COS123456"/>\n        </div>\n      </div>\n    </div>\n    <div class="modal-footer text-right">\n      <input type="submit" class="btn btn-primary" value="Create" ng-disabled="unit.name == null || unit.code == null"/>\n    </div>\n  </form>\n</div>\n')}]),angular.module("units/modals/unit-ilo-edit-modal/unit-ilo-edit-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/modals/unit-ilo-edit-modal/unit-ilo-edit-modal.tpl.html",'<div class="unit-ilo-edit-modal">\n  <form class="form-horizontal" ng-submit="saveILO()" role="form">\n    <div class="modal-header">\n      <h3>{{isNew ? "Create Learning Outcome" : "Edit Learning Outcome: " + ilo.ilo_number}}</h3>\n    </div>\n    <div class="modal-body">\n      <div class="form-group" required>\n        <label class="col-sm-3 control-label">Name</label>\n        <div class="col-sm-7">\n          <input type="text" class="form-control" ng-model="ilo.name" placeholder="Outcome Name"/>\n        </div>\n      </div>\n      <div class="form-group" required>\n        <label class="col-sm-3 control-label">Abbreviation</label>\n        <div class="col-sm-7">\n          <input type="text" class="form-control" ng-model="ilo.abbreviation" placeholder="ABBR"/>\n        </div>\n      </div>\n      <div class="form-group" required>\n        <label class="col-sm-3 control-label">Description</label>\n        <div class="col-sm-7">\n          <markdown-editor height="200" placeholder="Enter markdown description..." ng-model="ilo.description"></markdown-editor>\n        </div>\n      </div>\n    </div>\n    <div class="modal-footer text-right">\n      <input type="submit" class="btn btn-primary" ng-disabled="ilo.name == null || ilo.abbreviation == null || ilo.description == null" value="{{isNew ? \'Create\' : \'Update\'}}" />\n    </div>\n  </form>\n</div>\n')}]),angular.module("units/modals/unit-mark-submissions-offline-modal/unit-mark-submissions-offline-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/modals/unit-mark-submissions-offline-modal/unit-mark-submissions-offline-modal.tpl.html",'<div ng-init="selectedGroup = \'download\'">\n  <div class="modal-header">\n    <h4 class="modal-title">Mark Tasks Offline</h4>\n  </div>\n  <div class="modal-body text-center">\n    <div class="clearfix">\n      <div class="btn-group col-sm-12">\n        <button class="btn btn-default btn-large col-sm-4" ng-model="selectedGroup" btn-radio="\'download\'" style="padding: 1em;">\n          <p><i class="fa fa-file-zip-o fa-2x"></i> <i class="fa fa-download fa-2x"></i></p>\n          <div>Download Unmarked</div>\n        </button>\n        <button class="btn btn-default btn-large col-sm-4" ng-model="selectedGroup" btn-radio="\'uploadZip\'" style="padding: 1em;">\n          <p><i class="fa fa-file-zip-o fa-2x"></i> <i class="fa fa-upload fa-2x"></i></p>\n          <div>Upload Marked</div>\n        </button>\n        <button class="btn btn-default btn-large col-sm-4" ng-model="selectedGroup" btn-radio="\'uploadCSV\'" style="padding: 1em;">\n          <p><i class="fa fa-file-excel-o fa-2x"></i> <i class="fa fa-upload fa-2x"></i></p>\n          <div>Upload <code>marks.csv</code></div>\n        </button>\n      </div>\n    </div>\n    <hr/>\n    <div ng-show="selectedGroup === \'download\'" class="clearfix">\n      <p class="help-block">\n        Download a zip file containing the tasks that require feedback,\n        along with a CSV you can use to submit your comments and task\n        status changes.\n      </p>\n      <a target="_blank" class="btn btn-primary btn-lg" href="{{readyToMarkSubmissionsUrl}}" style="margin-bottom: 1em">\n        <i class="fa fa-file-zip-o"></i> <i class="fa fa-download" style="margin-right:0.5ex"></i> Download Tasks To Mark\n      </a>\n    </div><!--/download-->\n    <div ng-hide="taskUploadResults && taskUploadResults.length > 0" ng-if="selectedGroup === \'uploadCSV\' || selectedGroup === \'uploadZip\'" class="clearfix">\n      <div class="col-sm-10 col-sm-offset-1" ng-show="selectedGroup === \'uploadZip\'">\n        <strong>\n          Make changes to student\'s statuses in the downloaded <code>marks.csv</code>\n          file. Re-zip your changes and optional annotated PDFs with your feedback and\n          upload below.\n        </strong>\n        <p class="help-block">\n          Use this option when you have made annotations to student\'s work for feedback\n          and to change student\'s task states.\n        </p>\n      </div>\n      <div ng-show="selectedGroup === \'uploadCSV\'" class="col-sm-10 col-sm-offset-1">\n        <strong>\n          Make changes to student\'s statuses in the downloaded <code>marks.csv</code>\n          file. Upload your modified <code>marks.csv</code> below.\n        </strong>\n        <p class="help-block">\n          Use this option when you have not made annotations to student\'s work\n          and just want to change student\'s task states.\n        </p>\n      </div>\n      <div class="col-sm-12">\n        <file-uploader\n          ng-if="selectedGroup === \'uploadZip\'"\n          ng-hide="isReady.csv"\n          url="uploadSubmissionUrl"\n          files="zipMarkingFiles"\n          is-uploading="isUploading"\n          is-ready="isReady.zip"\n          on-success="onMarkingUploadSuccess"></file-uploader>\n        <file-uploader\n          ng-if="selectedGroup === \'uploadCSV\'"\n          ng-hide="isReady.zip"\n          url="uploadSubmissionUrl"\n          files="csvMarkingFiles"\n          is-uploading="isUploading"\n          is-ready="isReady.csv"\n          on-success="onMarkingUploadSuccess"></file-uploader>\n      </div>\n    </div><!--/upload-files-->\n    <div ng-show="taskUploadResults && taskUploadResults.length > 0">\n      <p class="help-block">\n      Upload results listed below. Click <a ng-click="dismissResults()" href="">here</a> to dismiss.\n      </p>\n      <table class="table table-striped">\n        <thead>\n          <th>Filename</th>\n          <th>Task</th>\n          <th>Message</th>\n        </thead>\n        <tr ng-repeat="item in taskUploadResults.failed" class="danger">\n          <td>{{item.file}}</td>\n          <td>{{item.task}}</td>\n          <td>{{item.error}}</td>\n        </tr>\n        <tr ng-repeat="item in taskUploadResults.succeeded">\n          <td>{{item.file}}</td>\n          <td>{{item.task}}</td>\n          <td>Success</td>\n        </tr>\n        <tr ng-repeat="item in taskUploadResults.ignored" class="info">\n          <td>{{item.file}}</td>\n          <td>{{item.task}}</td>\n          <td>File ignored</td>\n        </tr>\n      </table>\n    </div><!--/upload-results-->\n  </div>\n  <div class="modal-footer">\n    <button class="btn btn-success" ng-click="closeModal()">\n      <i class="fa fa-check"></i>\n    </button>\n  </div>\n</div>\n')}]),angular.module("units/modals/unit-student-enrolment-modal/unit-student-enrolment-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/modals/unit-student-enrolment-modal/unit-student-enrolment-modal.tpl.html",'<div class="unit-student-enrolment-modal">\n  <div class="modal-header">\n    <h3>Enrol Student</h3>\n  </div>\n  <div class="modal-body">\n    <form class="form-horizontal">\n      <div class="form-group" required>\n        <label class="col-sm-3 control-label">Student ID</label>\n        <div class="col-sm-7">\n          <input type="input" class="form-control" placeholder="Student ID" ng-model="student_id">\n        </div>\n      </div>\n      <div class="form-group" required>\n        <label class="col-sm-3 control-label">Tutorial</label>\n        <div class="col-sm-7">\n          <input id="searchbar" class="form-control" placeholder="Tutorial Code" type="search" ng-model="tutorial" typeahead="tutorial as tutorial.abbreviation for tutorial in unit.tutorials" />\n        </div>\n      </div>\n    </form>\n  </div>\n  <div class="modal-footer text-right">\n    <input type="button" ng-click="enrolStudent(student_id, tutorial)" class="btn btn-primary" value="Save" />\n  </div>\n</div>\n')}]),angular.module("units/modals/unit-tutorial-edit-modal/unit-tutorial-edit-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/modals/unit-tutorial-edit-modal/unit-tutorial-edit-modal.tpl.html",'<div class="unit-tutorial-edit-modal">\n  <form class="form-horizontal" ng-submit="saveTutorial()" role="form">\n    <div class="modal-header">\n      <h3>{{isNew ? "Create Tutorial" : "Edit Tutorial"}}</h3>\n    </div>\n    <div class="modal-body">\n      <div class="form-group" required>\n        <label class="col-sm-3 control-label">Abbreviation</label>\n        <div class="col-sm-7">\n          <input type="text" class="form-control" ng-model="tutorial.abbreviation" placeholder="Abbreviation eg. LA1-01"/>\n        </div>\n      </div>\n      <div class="form-group" required>\n        <label class="col-sm-3 control-label">Location</label>\n        <div class="col-sm-7">\n          <input type="input" class="form-control" ng-model="tutorial.meeting_location" placeholder="Location eg. ATC101">\n        </div>\n      </div>\n      <div class="form-group" required>\n        <label class="col-sm-3 control-label">Day</label>\n        <div class="col-sm-7">\n          <select id="day" class="form-control" ng-model="tutorial.meeting_day" name="day">\n            <option value="Monday">Monday</option>\n            <option value="Tuesday">Tuesday</option>\n            <option value="Wednesday">Wednesday</option>\n            <option value="Thursday">Thursday</option>\n            <option value="Friday">Friday</option>\n          </select>\n        </div>\n      </div>\n      <div class="form-group" required>\n        <label class="col-sm-3 control-label">Time</label>\n        <div class="col-sm-7">\n          <timepicker ng-model="tutorial.meeting_time" hour-step="1" minute-step="30" show-meridian="false"></timepicker>\n        </div>\n      </div>\n      <div class="form-group">\n        <label class="col-sm-3 control-label">Tutor</label>\n        <div class="col-sm-7">\n          <input type="text" class="form-control" ng-model="tutorial.tutor" placeholder="Freddy McDerfson" typeahead="tutor as tutor.name for tutor in tutors | filter: $viewValue">\n        </div>\n      </div>\n    </div>\n    <div class="modal-footer text-right">\n      <input type="submit" class="btn btn-primary" value="{{isNew ? \'Create\' : \'Update\'}}" />\n    </div>\n  </form>\n</div>\n')}]),angular.module("units/states/edit-unit-view/edit-unit-view.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/states/edit-unit-view/edit-unit-view.tpl.html",'<div>\n  <ul class="breadcrumb">\n      <li><a href="#/home">Home</a></li>\n      <li>Administrator</li>\n      <li><a href="#/admin/units">Manage Units</a></li>\n      <li class="active">{{newUnit ? \'New Unit\' : unit.name}}</li>\n  </ul><!--breadcrumbs-->\n  <div ng-if="!unit" class="large-notice-block">\n    <i class="fa fa-2x fa-spinner fa-pulse"></i>\n    <p>Loading...</p>\n  </div><!--/loading-->\n  <div ng-if="unit">\n    <div>\n      <h2>\n        <span ng-hide="newUnit">Edit {{unit.name}}</span> <small ng-hide="newUnit">{{unit.code}}</small>\n        <span ng-show="newUnit">Create Unit</span>\n        <p class="lead">Convenor View</p>\n      </h2>\n      <tabset class="tabset-icon" justified="true">\n        <tab ng-repeat="tab in tabs | toArray | orderBy: \'seq\'" active="tab.active" ng-click="setActiveTab(tab)">\n          <tab-heading>\n            <i class="fa fa-2x {{tab.icon}}"></i> {{tab.title}}\n          </tab-heading>\n        </tab>\n      </tabset><!--tabs-->\n    </div><!--tabs-->\n    <div>\n      <div ng-if="activeTab === tabs.unitTab">\n        <unit-details-editor unit="unit"></unit-details-editor>\n      </div>\n      <div ng-if="activeTab === tabs.learningOutcomesTab">\n        <unit-ilo-editor></unit-ilo-editor>\n      </div>\n      <div ng-if="activeTab === tabs.staffTab">\n        <unit-staff-editor></unit-staff-editor>\n      </div>\n      <div ng-if="activeTab === tabs.tutorialsTab">\n        <unit-tutorials-editor></unit-tutorials-editor>\n      </div>\n      <div ng-if="activeTab === tabs.studentsTab">\n        <unit-students-editor></unit-students-editor>\n      </div>\n      <div ng-if="activeTab === tabs.tasksTab">\n        <unit-tasks-editor></unit-tasks-editor>\n      </div>\n      <div ng-if="activeTab === tabs.taskAlignmentTab">\n        <task-ilo-alignment-editor show-csv="true" unit="unit"></task-ilo-alignment-editor>\n      </div>\n      <div ng-if="activeTab === tabs.groupsTab">\n        <unit-groupset-editor></unit-groupset-editor>\n      </div>\n    </div><!--content-->\n  </div>\n</div>\n')}]),angular.module("units/states/teacher-view/teacher-view.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/states/teacher-view/teacher-view.tpl.html",'<div if-role="Admin Convenor Tutor">\n  <ul class="breadcrumb">\n      <li><a href="#/home">Home</a></li>\n      <li class="active">{{unitRole.unit_name}} {{unitRole.role}}</li>\n  </ul><!--breadcrumbs-->\n  <div>\n    <div ng-hide="unitLoaded" class="large-notice-block">\n      <i class="fa fa-2x fa-spinner fa-pulse"></i>\n      <p>Loading unit details...</p>\n    </div><!--/loading-->\n    <div ng-if="unitLoaded">\n      <h2>{{unit.name}} <small>{{unit.code}}</small><p class="lead"> Teacher View</p></h2>\n      <tabset class="tabset-icon" justified="true" ng-if="unitLoaded">\n        <tab ng-repeat="tab in tabs | toArray | orderBy: \'seq\'" active="tab.active" ng-click="setActiveTab(tab)">\n          <tab-heading>\n            <i class="fa fa-2x {{tab.icon}}"></i> {{tab.title}}\n          </tab-heading>\n        </tab>\n      </tabset><!--tabs-->\n      <task-feedback-assessor-list ng-if="activeTab === tabs.feedbackTab" unit="unit" context="\'assess\'" assessing-unit-role="assessingUnitRole"></task-feedback-assessor-list>\n      <unit-student-list  ng-if="activeTab === tabs.studentsTab" unit-role="unitRole" unit="unit" unit-loaded="unitLoaded"></unit-student-list>\n      <task-feedback-assessor-list  ng-if="activeTab === tabs.tasksTab" unit="unit" context="\'task\'" assessing-unit-role="assessingUnitRole"></task-feedback-assessor-list>\n      <tutor-group-manager ng-if="activeTab === tabs.groupsTab"></tutor-group-manager>\n      <unit-student-plagiarism-list  ng-if="activeTab === tabs.plagiarismTab"></unit-student-plagiarism-list>\n      <unit-analytics-viewer  ng-if="activeTab === tabs.analyticsTab"></unit-analytics-viewer>\n      <unit-student-portfolio-list ng-if="activeTab === tabs.gradingTab"></unit-student-portfolio-list>\n    </div><!--content-->\n  </div>\n</div>\n')}]),angular.module("units/states/units-admin-view/units-admin-view.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/states/units-admin-view/units-admin-view.tpl.html",'<ul class="breadcrumb">\n    <li><a href="#/home">Home</a></li>\n    <li>Administrator</li>\n    <li class="active">Manage Units</li>\n</ul>\n<div id="admin-units">\n  <div class="col-sm-12">\n    <h2>Doubtfire Units <small>{{unit.code}}</small><p class="lead">Unit Administration View</p></h2>\n    <div class="panel panel-primary">\n      <div class="panel-heading clearfix">\n        <div class="pull-left">\n          <h4 class="panel-title">Units</h4>\n          Modify units registered with Doubtfire\n        </div>\n        <form role="search" class="pull-right form-horizontal">\n          <input id="searchbar" class="input-md form-control" placeholder="Search for units..." type="search" ng-model="search.$" typeahead="unit.name for unit in units | filter:$viewValue | limitTo:8" />\n          <p ng-show="filteredUnits.length < students.length && filteredUnits.length != 0">Showing {{filteredUnits.length}} of {{users.length}} users.</p>\n          <p ng-show="filteredUnits.length < students.length && filteredUnits.length == 0">No students found.</p>\n        </form>\n      </div>\n      <div class="panel-body">\n        <div class="callout callout-info" ng-hide="units.length > 0">No units have been registered with Doubtfire yet</div>\n        <table ng-show="units.length > 0" class="table table-hover table-pointer">\n         <thead>\n           <tr>\n             <th><a ng-click="sortOrder=\'code\'; reverse=!reverse">Unit Code <i ng-show="sortOrder==\'code\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i></a></th>\n             <th><a ng-click="sortOrder=\'name\'; reverse=!reverse">Name <i ng-show="sortOrder==\'name\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i></a></th>\n             <th><a ng-click="sortOrder=\'start_date\'; reverse=!reverse">Start Date <i ng-show="sortOrder==\'start_date\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i></a></th>\n             <th><a ng-click="sortOrder=\'end_date\'; reverse=!reverse">End Date <i ng-show="sortOrder==\'end_date\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i></a></th>\n             <th><a ng-click="sortOrder=\'active\'; reverse=!reverse">Active <i ng-show="sortOrder==\'active\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i></a></th>\n           </tr>\n         </thead>\n         <tbody>\n         <tr ng-repeat="unit in filteredUnits = (units | filter:search) | orderBy:sortOrder:reverse | startFrom:(currentPage - 1) * pageSize | limitTo: pageSize" ng-click="showUnit(unit)" >\n           <td>\n             <label class="label label-info">\n               {{unit.code}}\n             </label>\n           </td>\n           <td>{{unit.name}}</td>\n           <td>{{unit.start_date | date: short }}</td>\n           <td>{{unit.end_date | date: short }}</td>\n           <td>\n             <i ng-show="unit.active" class="fa fa-check"></i>\n             <i ng-hide="unit.active" class="fa fa-times"></i>\n           </td>\n         </tr>\n         </tbody>\n        </table>\n      </div>\n      <div class="panel-footer clearfix">\n        <pagination ng-show="filteredUnits.length > pageSize" total-items="filteredUnits.length" ng-model="currentPage" items-per-page="pageSize" max-size="maxSize" class="pagination-sm pull-left" boundary-links="true" rotate="false"></pagination>\n        <button class="btn btn-success pull-right" ng-click="createUnit()">\n          <i class="fa fa-university"></i>\n          <i class="fa fa-plus"></i>\n           Create Unit\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n')}]),angular.module("units/stats/unit-achievement-stats/unit-achievement-stats.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/stats/unit-achievement-stats/unit-achievement-stats.tpl.html",'<div class="unit-achievement-stats drilldown-visualiser panel-body">\n  <div ng-if="data">\n    <div class="clearfix">\n      <div class="col-sm-6 pull-left">\n        <div class="btn-group">\n          <label class="btn btn-default" ng-model="dataModel.selectedType" btn-radio="\'unit\'">\n            <i tooltip="View stats over entire unit" class="fa fa-university"></i>\n          </label>\n          <label class="btn btn-default" ng-model="dataModel.selectedType" btn-radio="\'tutorial\'">\n            <i tooltip="View stats by tutorial" class="fa fa-pencil"></i>\n          </label>\n        </div>\n        <div class="btn-group">\n          <label class="btn btn-default" ng-model="dataModel.pct" btn-radio="true">\n            <i tooltip="View as percent of maximum achievement" class="fa fa-percent" tooltip-append-to-body="true"></i>\n          </label>\n          <label class="btn btn-default" ng-model="dataModel.pct" btn-radio="false">\n            <i tooltip="View as the raw achievement data" class="fa fa-database" tooltip-append-to-body="true"></i>\n          </label>\n        </div>\n      </div>\n      <div class="col-sm-6 pull-right" ng-if="dataModel.selectedType == \'tutorial\'">\n        <select\n          class="form-control"\n          ng-options="tutorial as (tutorial.abbreviation + \' - \' + tutorial.tutor_name) for tutorial in (tutorialsForSelector | orderBy: \'tutorial.abbreviation\' | reverse) track by tutorial.id"\n          ng-model="dataModel.selectedTutorial"></select>\n      </div>\n    </div><!--/toolbar-->\n    <hr>\n    <div ng-show="depth == 0">\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'unit\'">\n        ILO achievement distribution in <strong>{{unit.code}}</strong>\n      </h4>\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'tutorial\'">\n        <p>ILO achievement distribution for Tutorial <strong>{{dataModel.selectedTutorial.abbreviation}}</strong></p>\n        <p class=\'small text-muted\'>{{dataModel.selectedTutorial.tutor_name}} at {{dataModel.selectedTutorial.meeting_time | date: shortTime}}</p>\n      </h4>\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'grade\'">\n        ILO achievement distribution by Target Grade\n      </h4>\n    </div><!--/headers-for-depth-0-->\n    <div ng-show="depth == 1">\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'tutorial\'">\n        ILO achievement distribution over all tutorials in <strong>{{unit.code}}</strong>\n      </h4>\n    </div><!--/headers-for-depth-1-->\n    <div ng-if="depth == 0" ng-click="drillDown()" class="overview-chart">\n      <achievement-box-plot\n          data="data"\n          unit="unit"\n          type="dataModel.selectedType"\n          pct-holder="dataModel"></achievement-box-plot>\n    </div><!--/depth-0-chart-->\n    <div ng-if="dataModel.selectedTutorial.id < 0 && depth == 1" class="overview-chart">\n      <div ng-repeat="tutorial in unit.tutorials | orderBy: \'abbreviation\'" class="col-xs-6 col-sm-4 col-md-3" ng-click="switchToTutorial(tutorial)">\n        <achievement-box-plot\n            data="data[tutorial.id]"\n            unit="unit"\n            type="dataModel.selectedType"\n            height="200"\n            show-legend="false"\n            pct-holder="dataModel"></achievement-box-plot>\n        <div class="col-xs-12 caption text-center">\n          <strong>{{tutorial.abbreviation}}</strong>\n          <div class="small text-muted">{{tutorial.tutor_name}} at {{tutorial.meeting_time | date: shortTime}}</div>\n        </div>\n      </div>\n    </div><!--/overview-charts-->\n  </div>\n</div>\n')}]),angular.module("units/stats/unit-target-grade-stats/unit-target-grade-stats.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/stats/unit-target-grade-stats/unit-target-grade-stats.tpl.html",'<div class="drilldown-visualiser">\n  <div class="data-loaded panel-body" ng-if="data">\n    <div class="clearfix">\n      <div class="btn-group col-sm-6 pull-left">\n        <label class="btn btn-default" ng-model="dataModel.selectedType" btn-radio="\'unit\'">\n          <i tooltip="View target grades over unit" class="fa fa-university"></i>\n        </label>\n        <label class="btn btn-default" ng-model="dataModel.selectedType" btn-radio="\'tutorial\'">\n          <i tooltip="View target grades by tutorial" class="fa fa-pencil"></i>\n        </label>\n      </div>\n      <div class="col-sm-6 pull-right" ng-if="dataModel.selectedType == \'tutorial\'">\n        <select\n          class="form-control"\n          ng-options="tutorial as (tutorial.text) for tutorial in (tutorialsForSelector | orderBy: \'tutorial.abbreviation\' | reverse) track by tutorial.id"\n          ng-model="dataModel.selectedTutorial"></select>\n      </div>\n    </div><!--/toolbar-->\n    <hr>\n    <div ng-show="depth == 0">\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'unit\'">\n        Target grade distribution in <strong>{{unit.code}}</strong>\n      </h4>\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'tutorial\'">\n        <p>Task grade distribution for Tutorial <strong>{{dataModel.selectedTutorial.abbreviation}}</strong></p>\n        <p class=\'small text-muted\'>{{dataModel.selectedTutorial.tutor_name}} at {{dataModel.selectedTutorial.meeting_time | date: shortTime}}</p>\n      </h4>\n    </div><!--/headers-for-depth-0-->\n    <div ng-show="depth == 1">\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'tutorial\'">\n        Target grade distribution over all tutorials in <strong>{{unit.code}}</strong>\n      </h4>\n    </div><!--/headers-for-depth-1-->\n    <div ng-show="depth == 2">\n      <h4 class="col-xs-12 text-center" ng-show="dataModel.selectedType == \'tutorial\'">\n        <p>Target grade distribution for Tutorial <strong>{{dataModel.selectedTutorial.abbreviation}}</strong></p>\n        <p class=\'small text-muted\'>{{dataModel.selectedTutorial.tutor_name}} at {{dataModel.selectedTutorial.meeting_time | date: shortTime}}</p>\n      </h4>\n    </div><!--/headers-for-depth-2-->\n    <p class="col-sm-12 help-block text-center">\n      {{depth == 0 && dataModel.selectedType == \'unit\' || depth == 1 ? \'Click chart to explore details\' : \'Click to return to overview\'}}\n    </p><!--/click-chart-help-block-->\n    <div ng-if="depth == 0" ng-click="drillDown()" class="overview-chart">\n      <target-grade-pie-chart data="data" show-legend="true" height="600"></target-grade-pie-chart>\n    </div><!--/depth-0-chart-->\n    <div ng-if="dataModel.selectedTutorial.id < 0" class="overview-charts">\n      <div ng-repeat="chart in (overviewKeys | orderBy: \'title\' )" class="col-xs-6 col-sm-4 col-md-3 overview-chart" ng-click="switchToTutorial(chart.tutorial)">\n        <target-grade-pie-chart data="chart.data" show-legend="false" height="200"></target-grade-pie-chart>\n        <div class="no-data-to-display" ng-hide="chart.show">\n          No data\n        </div>\n        <div class="col-xs-12 caption text-center">\n          <strong>{{chart.title}}</strong>\n          <div class="small text-muted">{{chart.subtitle}}</div>\n        </div>\n      </div>\n    </div><!--/overview-charts-->\n  </div>\n  <div class="data-not-loaded" ng-hide="data">\n    <i class="fa fa-spinner fa-pulse fa-3x"></i>\n    <p>Loading...</p>\n  </div>\n</div>\n')}]),angular.module("units/unit-analytics-viewer/unit-analytics-viewer.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/unit-analytics-viewer/unit-analytics-viewer.tpl.html",'<div class="row unit-analytics-viewer">\n  <tabset class="col-md-2" vertical="true" type="pills">\n    <tab ng-repeat="(tabKey, tab) in tabsData | orderObjectBy: \'seq\'" active="tab.active" ng-click="setActiveTab(tab)">\n      <tab-heading tooltip="{{tab.title}}" tooltip-placement="right" tooltip-popup-delay="200">\n        <div class="text-center">\n          <i class="fa fa-2x {{icon}}" ng-repeat="icon in tab.icons"></i>\n        </div>\n      </tab-heading>\n    </tab>\n    <br />\n  </tabset><!--/tab-selector-->\n  <div class="col-md-10">\n    <div class="panel panel-primary">\n      <div class="panel-heading row-fluid">\n        <h3 class="panel-title">\n          {{activeTab.title}}\n        </h3>\n        {{activeTab.subtitle}}\n      </div>\n      <task-summary-stats unit="unit" ng-if="unit.students && activeTab === tabsData.taskSummaryStats"></task-summary-stats>\n      <task-status-stats unit="unit" ng-if="activeTab === tabsData.taskStatusStats"></task-status-stats>\n      <unit-target-grade-stats unit="unit" ng-if="activeTab === tabsData.targetGradeStats"></unit-target-grade-stats>\n      <task-completion-stats unit="unit" ng-if="activeTab === tabsData.taskCompletionStats"></task-completion-stats>\n      <unit-achievement-stats unit="unit" ng-if="activeTab === tabsData.achievementStats"></unit-achievement-stats>\n    </div><!--/tab-contents-panel-->\n  </div><!--/tab-contents-->\n</div>\n')}]),angular.module("units/unit-details-editor/unit-details-editor.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/unit-details-editor/unit-details-editor.tpl.html",'<div class="unit-details-editor">\n  <div class="panel panel-primary">\n    <div class="panel-heading" ng-if="unit.id == -1">\n      <h3 class="panel-title">Create Unit</h3>\n      Create a new unit with all overview unit details here.\n    </div>\n    <div class="panel-heading" ng-if="unit.id != -1">\n      <h3 class="panel-title">Update Unit</h3>\n      Update overview details of the unit below.\n    </div>\n    <form class="form-horizontal" role="form" name="unitForm" ng-submit="saveUnit()">\n      <div class="panel-body">\n        <div class="form-group">\n          <label class="col-sm-2 control-label" for="code">Code</label>\n          <div class="col-sm-9">\n            <input class="form-control" id="code" type="text" placeholder="COS1234567" ng-model="unit.code">\n          </div>\n        </div><!--/code-date-->\n\n        <div class="form-group">\n          <label class="col-sm-2 control-label" for="name">Name</label>\n          <div class="col-sm-9">\n            <input id="name" type="text" class="form-control" ng-model="unit.name" placeholder="Introduction to Doubtfire">\n          </div>\n        </div><!--/name-date-->\n\n        <div class="form-group">\n          <label class="col-sm-2 control-label" for="description">Description</label>\n          <div class="col-sm-9">\n            <textarea id="description" class="form-control" ng-model="unit.description"></textarea>\n          </div>\n        </div><!--/description-date-->\n\n        <div class="form-group">\n          <label tooltip="Date for the start of teaching in the unit." class="col-sm-2 control-label" for="startdate">Start Date</label>\n          <div class="col-sm-9">\n            <div class="col-sm-4 input-group">\n              <input datepicker-popup="yyyy-MM-dd" is-open="calOptions.startOpened" type="text" class="form-control" id="startdate" ng-model="unit.start_date" ng-required="true" placeholder="yyyy-MM-dd" close-text="Close" />\n              <span class="input-group-btn">\n                <button class="btn btn-default" type="button" ng-click="open($event,\'start\')">\n                  <i class="fa fa-calendar"></i>\n                </button>\n              </span>\n            </div>\n          </div>\n        </div><!--/start-date-->\n\n        <div class="form-group">\n          <label class="col-sm-2 control-label" for="enddate">End Date</label>\n          <div class="col-sm-9">\n            <div class="col-sm-4 input-group">\n              <input datepicker-popup="{{format}}" id="enddate" type="text" class="form-control" ng-model="unit.end_date" is-open="calOptions.endOpened" ng-required="true" close-text="Close" />\n              <span class="input-group-btn">\n                <button class="btn btn-default" type="button" ng-click="open($event,\'end\')">\n                  <i class="fa fa-calendar"></i>\n                </button>\n              </span>\n            </div>\n          </div>\n        </div><!--/end-date-->\n\n        <div class="form-group">\n          <label class="col-sm-2 control-label" for="enddate">Active</label>\n          <div class="col-sm-9">\n            <div class="btn-group">\n              <label class="btn btn-{{unit.active ? \'success\' : \'default\'}}" ng-model="unit.active" btn-radio="true" uncheckable>\n                <i class="fa fa-check"></i>\n              </label>\n              <label class="btn btn-{{unit.active ? \'default\' : \'danger\'}}" ng-model="unit.active" btn-radio="false" uncheckable>\n                <i class="fa fa-times"></i>\n              </label>\n            </div>\n          </div>\n        </div><!--/active-->\n      </div>\n      <div class="panel-footer text-right">\n        <input type="submit" value="{{ unit.id == -1 ? \'Create\' : \'Update\' }}" class="btn btn-success" ng-disabled="unitForm.$pristine" />\n      </div>\n    </form>\n  </div>\n</div>\n')
}]),angular.module("units/unit-groupset-editor/unit-groupset-editor.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/unit-groupset-editor/unit-groupset-editor.tpl.html",'<div class="unit-groupset-editor row">\n  <div ng-class="{\'col-sm-9\': unit.group_sets.length > 0, \'col-sm-8 col-sm-offset-2\': unit.group_sets.length == 0 }">\n    <div class="row">\n      <div class="col-sm-12">\n        <div class="panel panel-primary">\n          <div class="panel-heading">\n            <h3 class="panel-title">\n              Group Sets\n            </h3>\n            A group set is a set of related group-work. A unit can have multiple group sets for various kinds of group work which has multiple teams\n          </div>\n          <div class="groupset-selector panel-body">\n            <div ng-hide="unit.group_sets.length > 0">\n              <div class="callout callout-info">\n                This unit has no group sets\n              </div>\n            </div>\n            <table ng-show="unit.group_sets.length > 0" class="table table-condensed table-hover table-pointer groupsets">\n              <thead>\n                <tr>\n                  <th>\n                    <span tooltip="Name of the group set">Name</span>\n                  </th>\n                  <th>\n                    <span tooltip="Who can create groups?">Create Groups</span>\n                  </th>\n                  <th>\n                    <span tooltip="Who can manage groups?">Manage Groups</span>\n                  </th>\n                  <th>\n                    <span tooltip="Are groups restricted to tutorials?">Restrict to Tutorials</span>\n                  </th>\n                  <th>Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr ng-repeat="gs in unit.group_sets" ng-class="{info: gs == selectedGroupset}" ng-click="selectGroupSet(gs)">\n                  <td class="col-sm-3">\n                    <span editable-text="gs.name" e-name="name" e-form="gsRowform" e-required>\n                      {{ gs.name || \'empty\' }}\n                    </span>\n                  </td>\n                  <td>\n                    <span editable-select="gs.allow_students_to_create_groups" e-name="allow_students_to_create_groups" e-form="gsRowform" e-ng-options="opt.value as opt.text for opt in studentStaffOptions">\n                      {{ ( (gs && gs.allow_students_to_create_groups) ? \'Staff and Students\' : \'Staff Only\' ) }}\n                    </span>\n                  </td>\n                  <td>\n                    <span editable-select="gs.allow_students_to_manage_groups" e-name="allow_students_to_manage_groups" e-form="gsRowform" e-ng-options="opt.value as opt.text for opt in studentStaffOptions">\n                      {{ ( (gs && gs.allow_students_to_manage_groups) ? \'Staff and Students\' : \'Staff Only\' ) }}\n                    </span>\n                  </td>\n                  <td>\n                    <span editable-select="gs.keep_groups_in_same_class" e-name="keep_groups_in_same_class" e-form="gsRowform" e-ng-options="opt.value as opt.text for opt in tutorialOptions">\n                      {{ ( (gs && gs.keep_groups_in_same_class) ? \'Same Tutorial\' : \'Any Tutorial\' ) }}\n                    </span>\n                  </td>\n                  <td>\n                    <form editable-form name="gsRowform" onbeforesave="saveGroupSet($data, gs.id)" ng-show="gsRowform.$visible" class="form-buttons form-inline" shown="inserted == gs">\n                      <button type="submit" ng-disabled="gsRowform.$waiting" class="btn btn-primary">\n                        <i class="fa fa-floppy-o"></i>\n                      </button>\n                      <button type="button" ng-disabled="gsRowform.$waiting" ng-click="gsRowform.$cancel()" class="btn btn-default">\n                        <i class="fa fa-times"></i>\n                      </button>\n                    </form>\n                    <div ng-show="!gsRowform.$visible">\n                      <button ng-click="gsRowform.$show()" class="btn btn-primary">\n                        <i class="fa fa-pencil"></i>\n                      </button>\n                      <button ng-click="removeGroupSet(gs)" class="btn btn-danger">\n                        <i class="fa fa-trash-o"></i>\n                      </button>\n                    </div>\n                    <!--/actions-->\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n          <div class="panel-footer clearfix">\n            <button class="btn pull-right btn-success" ng-click="addGroupSet()">\n              <i class="fa fa-users"></i>\n              <i class="fa fa-plus"></i>\n              New Group Set\n            </button>\n          </div>\n        </div>\n      </div>\n      <div style="margin-bottom:15px;">\n        <groupset-group-manager ng-show="selectedGroupset && unit.group_sets.length > 0"></groupset-group-manager>\n      </div>\n\n    </div>\n  </div>\n\n  <div class="col-sm-3" ng-if="selectedGroupset && unit.group_sets.length > 0">\n    <div class="panel panel-default">\n      <div class="panel-heading">\n        <h3 class="panel-title">Import to\n          <strong>{{selectedGroupset.name}}</strong>\n        </h3>\n        Import groups into\n        {{selectedGroupset.name}}\n        with a CSV containing: group_name, username, and tutorial.\n      </div>\n      <div class="panel-body">\n        <file-uploader files="groupCSV" url="groupCSVUploadUrl()" is-uploading="isGroupCSVUploading" on-success="onGroupCSVSuccess" on-complete="onGroupCSVComplete"></file-uploader>\n      </div>\n      <div class="panel-heading">\n        <h3 class="panel-title">Export\n          <strong>{{selectedGroupset.name}}</strong>\n        </h3>\n        Download a CSV of all teams in the\n        {{selectedGroupset.name}}\n        Group Set.\n      </div>\n      <div class="panel-body text-center">\n        <button class="btn btn-primary btn-download" ng-click="downloadGroupCSV()">\n          <i class="fa fa-download"></i>\n          Download\n        </button>\n      </div>\n    </div>\n  </div>\n  <!-- IO panels -->\n</div>\n')}]),angular.module("units/unit-ilo-editor/unit-ilo-editor.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/unit-ilo-editor/unit-ilo-editor.tpl.html",'<div class="unit-ilo-editor row">\n  <div class="col-md-9">\n    <div class="panel panel-primary">\n      <div class="panel-heading">\n        <h3 class="panel-title">Edit Intended Learning Outcomes</h3>\n        Add, edit or delete intended learning outcomes for this unit\n      </div>\n      <div class="panel-body">\n          <div class="callout callout-info" ng-hide="unit.ilos.length > 0">This unit has no Intended Learning Outcomes</div>\n          <div ng-show="unit.ilos.length > 0">\n            <table class="table table-pointer table-hover">\n              <thead>\n                <tr>\n                  <th> Number </th>\n                  <th> Abbreviation </th>\n                  <th> Name </th>\n                  <th> Description </th>\n                  <th> Actions </th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr ng-repeat="ilo in unit.ilos | orderBy:\'ilo_number\'">\n                  <td ng-click="editILO(ilo)">{{ilo.ilo_number}}</td>\n                  <td ng-click="editILO(ilo)">{{ilo.abbreviation}}</td>\n                  <td ng-click="editILO(ilo)">{{ilo.name}}</td>\n                  <td ng-click="editILO(ilo)">{{ilo.description}}</td>\n                  <td>\n                    <button class="btn btn-danger" ng-click="deleteILO(ilo)">\n                      <i class="fa fa-trash-o"></i>\n                    </button>\n                  </td>\n              </tbody>\n            </table>\n          </div>\n      </div>\n      <div class="panel-footer clearfix">\n        <button class="btn btn-success pull-right" ng-click="createILO()">\n          <i class="fa fa-graduation-cap"></i>\n          <i class="fa fa-plus"></i> Add Outcome\n        </button>\n      </div>\n    </div>\n  </div>\n  <div class="col-md-3">\n    <div class="panel panel-default">\n        <div class="panel-heading">\n            <h4 class="panel-title">Batch Upload Outcome Definitions</h4>\n            Batch upload learning outcome definitions with a CSV containing: unit_code, ilo_number, abbreviation, name, and description.\n        </div>\n        <div class="panel-body">\n            <file-uploader\n              files="batchFiles"\n              url="batchOutcomeUrl()"\n              on-success="onBatchOutcomeSuccess"></file-uploader>\n        </div><!--batch-withdraw-->\n        <div class="panel-heading">\n            <h4 class="panel-title">Download Outcomes</h4>\n            Download all outcomes for the unit.\n        </div>\n        <div class="panel-body text-center">\n            <a target="_blank" ng-href="{{batchOutcomeUrl()}}" class="btn btn-primary btn-download">\n                <i class="fa fa-download"></i> Download\n            </a>\n        </div>\n    </div>\n  </div>\n</div>\n')}]),angular.module("units/unit-staff-editor/unit-staff-editor.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/unit-staff-editor/unit-staff-editor.tpl.html",'<div class="unit-staff-editor">\n  <div class="panel panel-primary">\n    <div class="panel-heading">\n      <h3 class="panel-title">Modify Unit Staff</h3>\n      Add staff members to the unit, assigning them a convenor or tutor role.\n    </div>\n    <div class="panel-body">\n      <div class="col-sm-12">\n        <div class="callout callout-info" ng-hide="unit.staff.length > 0">This unit has no staff assigned</div>\n        <div ng-show="unit.staff.length > 0">\n          <table class="table table-condensed table-hover">\n            <thead>\n              <tr>\n                <th> Name </th>\n                <th> Role </th>\n                <th> Actions </th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr ng-repeat="staff in unit.staff">\n                <td> {{staff.name}} </td>\n                <td>\n                  <div class="btn-group">\n                    <label class="btn btn-default" ng-model="staff.role" btn-radio="\'Tutor\'" ng-click="changeRole(staff,2)">Tutor</label>\n                    <label class="btn btn-default" ng-model="staff.role" btn-radio="\'Convenor\'" ng-click="changeRole(staff,3)">Convenor</label>\n                  </div>\n                </td>\n                <td>\n                  <button class="btn btn-danger" ng-click="removeStaff(staff)">\n                    <i class="fa fa-trash-o"></i>\n                  </button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n    <div class="panel-footer clearfix">\n      <div class="input-group col-sm-12">\n        <input class="form-control" id="convenors" placeholder="Staff Name" ng-model="selectedStaff" typeahead="staff as\n        staff.full_name for staff in staff | filter: $viewValue | filter: filterStaff">\n\n        <span class="input-group-btn">\n          <button class="btn btn-success pull-right" ng-click="addSelectedStaff()">\n            <i class="fa fa-male"></i>\n            <i class="fa fa-plus"></i> Add Staff\n          </button>\n        </span>\n      </div>\n    </div>\n  </div>\n</div>\n')}]),angular.module("units/unit-student-list/unit-student-list.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/unit-student-list/unit-student-list.tpl.html",'<div class="panel panel-primary unit-student-list" ng-class="{fullscreen: fullscreen}">\n  <div class="panel-heading clearfix">\n    <div class="pull-left">\n      <h4 class="panel-title">Students</h4>\n      Students from {{studentFilter == \'myStudents\' ? \'my tutorials\' : \'every tutorial\'}} and their current state\n    </div>\n    <div class="pull-right toolbar text-right">\n      <div class="buttons">\n        <button class="btn btn-default fullscreen-toggle" ng-model="fullscreen" btn-checkbox btn-checkbox-true="1" btn-checkbox-false="0">\n          <i class="fa" ng-class="{\'fa-expand\' : !fullscreen, \'fa-compress\': fullscreen}"></i>\n        </button>\n        <div class="btn-group pull-right">\n          <label class="btn btn-default" ng-model="studentFilter" btn-radio="\'allStudents\'">\n            <i class="fa fa-university" tooltip-placement="{{ fullscreen ? \'bottom\' : \'top\' }}" tooltip="Show all students"></i>\n          </label>\n          <label class="btn btn-default" ng-model="studentFilter" btn-radio="\'myStudents\'">\n            <i class="fa fa-pencil" tooltip-placement="{{ fullscreen ? \'bottom\' : \'top\' }}" tooltip="Show only my students"></i>\n          </label>\n        </div>\n      </div><!--/buttons-->\n      <form role="search" class="form-horizontal pull-right">\n        <input id="searchbar" class="input-md form-control" placeholder="Search..." type="search" ng-model="search" typeahead="text for text in unitService.unitTypeAheadData(unit) | filter:$viewValue | limitTo:8" typeahead-wait-ms="200" autofocus />\n        <p ng-show="filteredStudents.length < allStudents.length && filteredStudents.length != 0">Showing {{filteredStudents.length}} of {{unit.students.length}} students enrolled.</p>\n      </form><!--/search-->\n    </div><!--/toolbar-->\n  </div>\n  <div class="panel-body student-list">\n    <div class="large-notice-block" ng-show="filteredStudents.length == 0">\n      <i class="fa fa-user"></i>\n      <p> No students found </p>\n    </div>\n    <table ng-hide="filteredStudents.length == 0" class="table table-condensed table-hover table-pointer ">\n      <thead>\n        <tr>\n          <th class="student-id">\n            <a ng-click="sortOrder=\'student_id\'; reverse=!reverse">\n              Student ID <i ng-show="sortOrder==\'student_id\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n            </a>\n          </th>\n          <th class="name">\n            <a ng-click="sortOrder=\'name\'; reverse=!reverse">\n              Name <i ng-show="sortOrder==\'name\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n            </a>\n          </th>\n          <th class="stats">\n            <a ng-click="sortOrder=\'progressSortOrder()\'; reverse=!reverse">\n              Stats <i ng-show="sortOrder==\'progressSortOrder()\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n            </a>\n          </th>\n          <th class="flags">\n            <a class="sort-by-flag-anchor" ng-click="showFlagSortOptions = !showFlagSortOptions">\n              <span class="show-link"> Flags </span> <i ng-show="sortOrder==\'tasks_with_similarities * 100 + max_pct_copy\' || sortOrder==\'target_grade\' || sortOrder==\'portfolio_status\'" class="ng-hide fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n            </a>\n            <span class="flag-sort-options" ng-show="showFlagSortOptions">\n              <span class="flag-sort">\n                <grade-icon ng-click="setFlagSort(\'target_grade\')" tooltip="Sort by grade" class="text-muted" ng-class="{\'text-primary\' : sortOrder == \'target_grade\'}"></grade-icon>\n                <i ng-show="sortOrder==\'target_grade\'" class="text-primary fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n              </span>\n              <span class="flag-sort">\n                <i class="fa fa-eye fa-2x text-muted" tooltip="Sort by plagarism" ng-class="{\'text-primary\' : sortOrder == \'tasks_with_similarities * 100 + max_pct_copy\'}" ng-click="setFlagSort(\'tasks_with_similarities * 100 + max_pct_copy\')"></i>\n                <i ng-show="sortOrder==\'tasks_with_similarities * 100 + max_pct_copy\'" class="text-primary fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n              </span>\n              <span class="flag-sort">\n                <i class="fa fa-book fa-2x text-muted" tooltip="Sort by portfolio status" ng-class="{\'text-primary\' : sortOrder == \'portfolio_status\'}" ng-click="setFlagSort(\'portfolio_status\')"></i>\n                <i ng-show="sortOrder==\'portfolio_status\'" class="text-primary fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n              </span>\n            </span>\n          </th>\n          <th class="tutorial">\n            <a ng-click="sortOrder=\'tutorial.abbreviation\'; reverse=!reverse">\n              <i ng-show="sortOrder==\'tutorial.abbreviation\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i> Tutorial\n            </a>\n          </th>\n          <th class="actions">Actions</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr class="task-progress-row" ng-repeat="student in filteredStudents = (allStudents = (unit.students | showStudents:studentFilter:tutorName) | projectFilter:search) | orderBy:sortOrder:reverse | startFrom:(currentPage - 1) * pageSize | limitTo: pageSize" ng-class="{\'info\': fullscreen && activeStudent == student}">\n          <td ng-click="viewStudent(student)">{{student.student_id}}</td>\n          <td ng-click="viewStudent(student)">{{student.name}}</td>\n          <td ng-click="viewStudent(student)" class="task-progress-bar">\n            <progress class="task-progress" animate="true">\n              <bar ng-repeat="bar in student.task_stats | filter:barLargerZero track by $index" value="bar.value" type="{{bar.type}}" tooltip="{{bar.value}}% {{statusName(bar.type)}}">\n                <span ng-hide="bar.value < 10">{{bar.value}}%</span>\n              </bar>\n            </progress>\n          </td>\n          <td class="flags-data" ng-click="viewStudent(student)">\n            <span class="flags">\n              <span class="flag">\n                <grade-icon grade="student.target_grade"></grade-icon>\n              </span>\n              <span ng-if="student.tasks_with_similarities > 0" class="flag">\n                <i class="fa fa-eye fa-2x" ></i>\n              </span>\n              <span ng-if="student.has_portfolio" class="flag">\n                <i class="fa fa-book fa-2x" ng-class="{\'text-muted\': student.compile_portfolio}"></i>\n              </span>\n            </span>\n          </td>\n          <!--/flags-data-->\n          <td>\n            <span tooltip-html-unsafe="<strong>{{student.tutorial.meeting_day}} {{student.tutorial.meeting_time | date: \'shortTime\'}}</strong><br/> {{student.tutorial.meeting_location}} - {{student.tutorial.tutor_name}}">\n              <div class="btn-group dropdown" dropdown is-open="status.isopen">\n                <button type="button" class="btn btn-default dropdown-toggle" dropdown-toggle>\n                  {{student.tutorial ? student.tutorial.abbreviation : \'None\'}} <span class="caret"></span>\n                </button>\n                <ul class="dropdown-menu">\n                  <li><a ng-click="switchToLab(student, nil); status.isopen = false">None</a></li>\n                  <li ng-repeat="tutorial in unit.tutorials | orderBy:\'abbreviation\'"><a ng-click="switchToLab(student, tutorial); status.isopen = false" ng-hide="tutorial == student.tutorial">{{tutorial.abbreviation}}</a></li>\n                </ul>\n              </div>\n            </span>\n          </td>\n          <td><button type="button" class="btn btn-info" ng-click="transitionWeekEnd(student)"><span class="fa fa-comment"></span></button></td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n  <div class="panel-body project-show" ng-if="fullscreen">\n    <div class="nothing-selected" ng-hide="activeStudent">\n      <i class="fa fa-user"></i>\n      <p>Click a student to view their status in detail</p>\n    </div>\n    <project-viewer\n      ng-if="activeStudent"\n      scope="student-project-scope"\n      project="activeStudent"\n      unit="unit"\n      assessing-unit-role="assessingUnitRole"\n      unit-role="assessingUnitRole.id"\n      fullscreen="fullscreen"></project-viewer>\n  </div>\n  <div class="panel-footer clearfix">\n    <div class="pull-right">\n      <button type="button" class="btn btn-success btn-download" ng-csv="getCSVData" lazy-load="true" csv-header="getCSVHeader()" filename="student-project-export.csv" ng-hide="filteredStudents.length < allStudents.length && filteredStudents.length == 0" target="_blank">\n        <i class="fa fa-file-excel-o"></i>\n        <i class="fa fa-download"></i> Export\n      </button>\n      <button type="button" class="btn btn-success btn-download" ng-click="showEnrolModal()">\n        <i class="fa fa-user"></i>\n        <i class="fa fa-plus"></i> Enrol\n      </button>\n    </div>\n    <pagination total-items="filteredStudents.length" ng-model="currentPage" items-per-page="pageSize" max-size="maxSize" class="pagination-sm pull-left" boundary-links="true" rotate="false"></pagination>\n  </div>\n</div>\n')}]),angular.module("units/unit-student-plagiarism-list/unit-student-plagiarism-list.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/unit-student-plagiarism-list/unit-student-plagiarism-list.tpl.html",'<div>\n  <!-- TODO: This needs to be refactored -->\n  <ul class="nav nav-pills nav-stacked col-sm-2">\n    <li role="presentation" ng-class="{\'active\' : view == \'all-students\' }"><a ng-click="setActiveView(\'all-students\')">All Students</a></li>\n    <li role="presentation" ng-class="{\'active\' : view == \'my-students\' }"><a ng-click="setActiveView(\'my-students\')">My Students</a></li>\n    <li role="presentation" ng-class="{\'active\' : view == \'tasks\' }"><a ng-click="setActiveView(\'tasks\')">Tasks</a></li>\n  </ul>\n  <div class="col-sm-10">\n    <div ng-show="view == \'all-students\' || view == \'my-students\'">\n      <form role="search" class="pull-right form-horizontal" style="margin:-60px 0 20px 0;">\n        <input id="searchbar" class="input-md form-control" placeholder="Search students, tutors..." type="search" ng-model="search" typeahead="text for text in unitService.unitTypeAheadData(unit) | filter:$viewValue | limitTo:8" typeahead-wait-ms="500" autofocus />\n        <p class="help-block" ng-show="filteredStudents.length < allStudents.length && filteredStudents.length != 0">Showing {{filteredStudents.length}} of {{allStudents.length}} students.</p>\n        <p class="help-block" ng-show="filteredStudents.length < allStudents.length && filteredStudents.length == 0">No students found.</p>\n      </form>\n      <div class="table-responsive">\n        <table class="table table-condensed table-hover">\n          <thead>\n            <tr>\n              <th></th>\n              <th><a href="" ng-click="sortOrder=\'student_id\'; reverse=!reverse">Student ID</a></th>\n              <th><a href="" ng-click="sortOrder=\'name\'; reverse=!reverse">Name</a></th>\n              <th><a href="" ng-click="sortOrder=\'target_grade\'; reverse=!reverse">Grade</a></th>\n              <th><a href="" ng-click="sortOrder=\'tasks_with_similarities\'; reverse=!reverse">Number Similar</a></th>\n              <th><a href="" ng-click="sortOrder=\'max_pct_copy\'; reverse=!reverse">Max Pct Similar</a></th>\n              <th><a href="" ng-click="sortOrder=\'tutorial.abbreviation\'; reverse=!reverse">Tutorial</a></th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr class="task-progress-row" ng-repeat="student in filteredStudents = (allStudents = (unit.students | showStudents:studentFilter:tutorName | studentsWithPlagiarism) | filter:search) | orderBy:sortOrder:reverse | startFrom:(currentPage - 1) * pageSize | limitTo: pageSize" >\n              <td><a ng-show="activeStudent != student" href="" ng-click="selectStudent(student)">Select</a><a ng-hide="activeStudent != student" href="" ng-click="selectStudent(null)">Deselect</a></td>\n              <td><a href="#/projects/{{student.project_id}}?unitRole={{assessingUnitRole.id}}">{{student.student_id}}</a></td>\n              <td>{{student.name}}</td>\n              <td>{{grades[student.target_grade]}}</td>\n              <td>{{student.tasks_with_similarities}}</td>\n              <td>{{student.max_pct_copy}}%</td>\n              <td><span tooltip-html-unsafe="<strong>{{student.tutorial.meeting_day}} {{student.tutorial.meeting_time | date: \'shortTime\'}}</strong><br/> {{student.tutorial.meeting_location}} - {{student.tutorial.tutor_name}}">{{student.tutorial ? student.tutorial.abbreviation : \'None\'}}</span></td>\n            </tr>\n          </tbody>\n        </table>\n        <pagination total-items="filteredStudents.length" ng-model="currentPage" items-per-page="pageSize" max-size="maxSize" class="pagination-sm pull-left" boundary-links="true" rotate="false"></pagination>\n      </div>\n    </div> <!-- end students div -->\n  </div>\n  <div class="col-sm-12">\n    <ul class="nav nav-tabs nav-justified">\n      <li role="presentation" ng-class="{\'active\' : activeTask == task }" ng-repeat="task in activeStudent.tasks | taskWithPlagiarism"><a href="" ng-click="selectTask(task)">{{task.definition.abbreviation}}</a></li>\n    </ul>\n    <div class="col-sm-12" ng-if="activeTask">\n      <task-plagiarism-report-viewer task="activeTask"></task-plagiarism-report-viewer>\n      <span><a ng-href="{{activeTask.definition.plagiarism_report_url}}" target="new">All plagiarism for {{activeTask.task.definition.name}}</a></span>\n    </div>\n  </div>\n</div>\n')}]),angular.module("units/unit-student-portfolio-list/unit-student-portfolio-list.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/unit-student-portfolio-list/unit-student-portfolio-list.tpl.html",'<div class="unit-student-portfolio-list">\n  <div class="panel panel-primary">\n    <div class="panel-heading clearfix">\n      <div class="pull-left">\n        <h4 class="panel-title">Mark Portfolios</h4>\n        Assess student portfolios\n      </div>\n      <div class="pull-right toolbar">\n        <div class="buttons">\n          <div class="btn-group">\n            <label class="btn btn-default" ng-model="studentFilter" btn-radio="\'allStudents\'">\n              <i class="fa fa-university" tooltip-placement="{{ fullscreen ? \'bottom\' : \'top\' }}" tooltip="Show all students"></i>\n            </label>\n            <label class="btn btn-default" ng-model="studentFilter" btn-radio="\'myStudents\'">\n              <i class="fa fa-pencil" tooltip-placement="{{ fullscreen ? \'bottom\' : \'top\' }}" tooltip="Show only my students"></i>\n              <span class="tooltip">Show only my students</span>\n            </label>\n          </div>\n          <div class="btn-group btn-group-sm select-portfolio-grade">\n            <label ng-repeat="grade in grades" ng-click="chooseGrade($index)" class="btn btn-default col-sm-3 text-center" ng-model="filterOptions.selectedGrade" btn-radio="{{$index}}">\n              <grade-icon grade="grade" tooltip="Select to show student\'s aiming for {{grade}}" tooltip-append-to-body="true" class="text-{{$index == filterOptions.selectedGrade ? \'primary\' : \'muted\'}}"></grade-icon>\n            </label>\n          </div>\n        </div><!--/buttons-->\n        <form role="search" class="form-horizontal">\n          <input id="searchbar" class="input-md form-control" placeholder="Search..." type="search" ng-model="search" typeahead="text for text in unitService.unitTypeAheadData(unit) | filter:$viewValue | limitTo:8" typeahead-wait-ms="200" autofocus />\n          <p ng-show="filteredStudents.length < allStudents.length && filteredStudents.length != 0">Showing {{filteredStudents.length}} of {{unit.students.length}} students enrolled.</p>\n        </form><!--/search-->\n      </div><!--/toolbar-->\n    </div><!--header-->\n    <div class="panel-body unit-student-list">\n      <div class="panel-body large-notice-block" ng-hide="filteredStudents.length > 0">\n        <i class="fa fa-book"></i>\n        <p>No portfolios found</p>\n      </div>\n      <table ng-hide="filteredStudents.length == 0" class="table table-condensed table-hover table-pointer ">\n        <thead>\n          <tr>\n            <th class="student-id">\n              <a ng-click="sortOrder=\'student_id\'; reverse=!reverse">\n                Student ID <i ng-show="sortOrder==\'student_id\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n              </a>\n            </th>\n            <th class="name">\n              <a ng-click="sortOrder=\'name\'; reverse=!reverse">\n                Name <i ng-show="sortOrder==\'name\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i>\n              </a>\n            </th>\n            <th>Tutor</th>\n            <th class="tutorial">\n              <a ng-click="sortOrder=\'tutorial.abbreviation\'; reverse=!reverse">\n                <i ng-show="sortOrder==\'tutorial.abbreviation\'" class="fa fa-caret-{{reverse ? \'down\' : \'up\'}}"></i> Tutorial\n              </a>\n            </th>\n            <th>\n              Target Grade\n            </th>\n            <th>Stats</th>\n            <th>Grade</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr class="task-progress-row" ng-repeat="student in filteredStudents = (allStudents = (unit.students | showStudents:studentFilter:tutorName | studentsWithPortfolio | studentsWithTargetGrade:filterOptions.selectedGrade) | filter:search) | orderBy:sortOrder:reverse | startFrom:(currentPage - 1) * pageSize | limitTo: pageSize" ng-class="{\'info\': selectedStudent == student}" ng-click="selectStudent(student)">\n            <td>{{student.student_id}}</td>\n            <td>{{student.name}}</td>\n            <td>{{student.tutorial ? student.tutorial.tutor_name : \'None\'}}</td>\n            <td>{{student.tutorial ? student.tutorial.abbreviation : \'None\'}}</td>\n            <td class="flags-data">\n              <grade-icon grade="student.target_grade"></grade-icon>\n            </td>\n            <td class="task-progress-bar">\n              <progress class="task-progress" animate="true">\n                <bar ng-repeat="bar in student.task_stats | filter:barLargerZero track by $index" value="bar.value" type="{{bar.type}}" tooltip="{{bar.value}}% {{statusName(bar.type)}}">\n                  <span ng-hide="bar.value < 10">{{bar.value}}%</span>\n                </bar>\n              </progress>\n            </td>\n            <td>{{student.grade}}</td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n    <div class="panel-footer clearfix">\n      <pagination total-items="filteredStudents.length" ng-model="currentPage" items-per-page="pageSize" max-size="maxSize" class="pagination-sm pull-left" boundary-links="true" rotate="false"></pagination>\n      <a class="btn btn-primary pull-right" href="{{portfolioDownloadUrl}}" target="_blank" tooltip-html-unsafe="<i class=\'fa fa-warning\'></i> <strong>WARNING:</strong> Downloading all portfolios may take a long time" tooltip-append-to-body="true">\n        <i class="fa fa-download"></i> Download All Portfolios\n      </a>\n    </div>\n  </div>\n  <div class="panel panel-default" ng-hide="selectedStudent">\n    <div class="panel-heading clearfix">\n      <div class="pull-left">\n        <h4 class="panel-title" ng-hide="selectedStudent">Portfolio Details</h4>\n        Review portfolio and assign grade.\n      </div>\n    </div>\n    <div class="panel-body large-notice-block" ng-hide="selectedStudent">\n      <i class="fa fa-book"></i>\n      <p>Select student to view portfolio and assign grade</p>\n    </div>\n  </div>\n  <div ng-if="selectedStudent">\n    <div class="panel panel-info">\n      <div class="panel-heading clearfix">\n        <div class="pull-left">\n          <h3 class="panel-title">Review Progress of {{selectedStudent.name}}</h3><!--/title-->\n          Review the students progress through the unit\'s tasks.\n        </div>\n      </div>\n      <div class="panel-body">\n        <progress-info ng-if="project"></progress-info>\n      </div>\n    </div>\n\n    <div class="panel panel-info" ng-if="selectedStudent">\n      <div class="panel-heading clearfix">\n        <div class="pull-left">\n          <h3 class="panel-title">Review Portfolio of {{selectedStudent.name}}</h3><!--/title-->\n          View or download portfolio for assessment.\n        </div>\n      </div>\n      <pdf-panel-viewer\n        ng-show="project.portfolio_available"\n        pdf-url="project.portfolioUrl()">\n      </pdf-panel-viewer>\n    </div>\n\n    <div class="panel panel-success" ng-if="selectedStudent">\n      <div class="panel-heading clearfix">\n        <div class="pull-left">\n          <h4 class="panel-title">Grade for {{selectedStudent.name}}</h4>\n          Assign Grade for this work.\n        </div>\n      </div>\n      <div class="panel-body alignment-rater">\n        <div class="col-sm-12 rationale-wrapper">\n          <div tooltip="Click to edit rationale" tooltip-placement="left" tooltip-append-to-body="false" tooltip-popup-delay="300" tooltip-enable="project.grade_rationale != null" ng-click="toggleEditRationale()" class="rationale" ng-class="{\'no-rationale\': project.grade_rationale == null}" ng-hide="editingRationale">\n            <label class="text-muted" ng-show="project.grade_rationale != null">\n              Provided Rationale\n            </label>\n            <div ng-bind-html="(project.grade_rationale || \'No rationale provided\') | markdown"></div>\n            <div class="small" ng-hide="project.grade_rationale">Click to add one</div>\n          </div>\n          <div ng-if="editingRationale" class="clearfix">\n            <markdown-editor\n              height="200"\n              ng-model="project.grade_rationale"\n              placeholder="Edit rationale..."\n              autofocus="true">\n            </markdown-editor>\n            <a ng-click="toggleEditRationale(alignment)" class="pull-right">Done Editing</a>\n          </div>\n        </div>\n\n        <div ng-repeat="results in gradeResults">\n          <h5 class="col-sm-2">{{results.name}}</h5>\n          <p class="btn-group col-sm-10">\n            <label ng-repeat="resultScore in results.scores" ng-click="project.assignGrade(resultScore, project.grade_rationale)" class="btn col-sm-2 text-center {{project.grade == resultScore ? \'btn-primary\' : \'btn-default\'}}">\n              {{resultScore}}\n            </label>\n          </p>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n')
}]),angular.module("units/unit-students-editor/unit-students-editor.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/unit-students-editor/unit-students-editor.tpl.html",'<div class="unit-students-editor row">\n  <div ng-if="unit">\n    <div class="col-md-9">\n      <div class="panel panel-primary">\n        <div class="panel-heading clearfix">\n          <div class="pull-left">\n            <h3 class="panel-title">\n              Enrolled Students\n            </h3>\n            Summary of students enrolled in this unit\n          </div>\n          <div class="pull-right">\n            <form ng-show="unit.students.length > 0" role="search" class="form-horizontal">\n              <input id="searchbar" class="input-md form-control" placeholder="Search..." type="search" ng-model="studentSearch" typeahead="text for text in unitTypeAheadData(unit)| filter:$viewValue | limitTo:8" typeahead-wait-ms="200" autofocus="">\n              <p ng-show="filteredStudents.length < unit.students.length && filteredStudents.length != 0">\n                Showing {{filteredStudents.length}} of {{unit.students.length}} students enrolled.\n              </p>\n              <p ng-show="filteredStudents.length < unit.students.length && filteredStudents.length == 0">\n                No students found.\n              </p>\n            </form>\n          </div>\n        </div>\n        <div class="panel-body">\n          <div ng-hide="unit.students.length > 0" class="callout callout-info">There are no students enrolled in this unit</div>\n          <div ng-show="unit.students.length > 0">\n            <table class="table table-condensed table-hover">\n              <thead>\n                <tr>\n                  <th>Username</th>\n                  <th>First Name</th>\n                  <th>Last Name</th>\n                  <th>Email</th>\n                  <th>Tutorial</th>\n                  <th>Enrolled</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr ng-repeat="student in filteredStudents = (unit.students | filter:studentSearch) | startFrom:(currentPage - 1) * pageSize | limitTo: pageSize">\n                  <td>\n                    <a href="#/projects/{{student.project_id}}?unitRole={{assessingUnitRole.id}}">{{student.student_id}}</a>\n                  </td>\n                  <td>{{student.first_name}}</td>\n                  <td>{{student.last_name}}</td>\n                  <td>\n                    <a href="mailto:{{student.email}}">{{student.student_email}}</a>\n                  </td>\n                  <td>\n                    <span tooltip-html-unsafe="<strong>{{student.tutorial.meeting_day}} {{student.tutorial.meeting_time | date: \'shortTime\'}}</strong><br/> {{student.tutorial.meeting_location}} - {{student.tutorial.tutor_name}}">\n                      <div class="btn-group dropdown" dropdown is-open="status.isopen">\n                        <button type="button" class="btn btn-default dropdown-toggle" dropdown-toggle>\n                          {{student.tutorial ? student.tutorial.abbreviation : \'None\'}} <span class="caret"></span>\n                        </button>\n                        <ul class="dropdown-menu">\n                          <li><a ng-click="switchToLab(student, nil); status.isopen = false">None</a></li>\n                          <li ng-repeat="tutorial in unit.tutorials | orderBy:\'abbreviation\'"><a ng-click="switchToLab(student, tutorial); status.isopen = false" ng-hide="tutorial == student.tutorial">{{tutorial.abbreviation}}</a></li>\n                        </ul>\n                      </div>\n                    </span>\n                  </td>\n                  <td>\n                    <button ng-show="student.enrolled" class="btn col-sm-6 btn-success" ng-click="withdraw(student)">\n                      <i class="fa fa-check" tooltip="Click to withdraw {{student.first_name}}"></i>\n                    </button>\n                    <button ng-hide="student.enrolled" class="btn col-sm-6 btn-danger" ng-click="enrol(student)">\n                      <i class="fa fa-times" tooltip="Click to enrol {{student.first_name}}"></i>\n                    </button>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n            <!--/enrolment-table-->\n          </div>\n        </div>\n        <div class="panel-footer clearfix">\n          <pagination ng-show="unit.students.length > pageSize" total-items="unit.students.length" ng-model="currentPage" items-per-page="pageSize" max-size="maxSize" class="pagination-sm pull-left" boundary-links="true" rotate="false"></pagination>\n          <button class="btn btn-success pull-right" ng-click="showEnrolModal()">\n            <i class="fa fa-user"></i>\n            <i class="fa fa-plus"></i> Enrol Student\n          </button>\n        </div>\n      </div>\n    </div>\n    <!--/student-list-->\n    <div class="col-md-3">\n      <div class="panel panel-default">\n        <div class="panel-heading">\n          <h4 class="panel-title">Batch Student Uploads</h4> Batch enrol or withdraw students into this unit using a CSV containing: unit_code, username, first_name, last_name, email, tutorial.\n        </div>\n        <div class="panel-body">\n          <div class="btn-group btn-group-justified">\n            <label class="btn btn-primary" ng-model="activeBatchStudentType" btn-radio="\'enrol\'">\n              Batch Enrol\n            </label>\n            <label class="btn btn-danger" ng-model="activeBatchStudentType" btn-radio="\'withdraw\'">\n              Batch Withdraw\n            </label>\n          </div>\n          <file-uploader files="batchStudentTypes[activeBatchStudentType].batchFiles" url="batchStudentTypes[activeBatchStudentType].batchUrl()" on-success="batchStudentTypes[activeBatchStudentType].onSuccess"></file-uploader>\n        </div>\n        <!--batch-enrol-->\n        <div class="panel-heading">\n          <h4 class="panel-title">Download Enrolled Students</h4> Download all enrolled students in this unit.\n        </div>\n        <div class="panel-body text-center">\n          <a target="_blank" href="{{batchStudentTypes.enrol.batchUrl()}}" class="btn btn-primary btn-download">\n            <i class="fa fa-download"></i> Download\n          </a>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n')}]),angular.module("units/unit-tasks-editor/unit-tasks-editor.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/unit-tasks-editor/unit-tasks-editor.tpl.html",'<div class="unit-tasks-editor row">\n  <div ng-if="unit">\n    <div class="col-md-9">\n      <div class="panel panel-primary">\n        <div class="panel-heading clearfix">\n          <div class="pull-left">\n            <h3 class="panel-title">\n              Task List\n            </h3>\n            Summary of tasks added as work for this unit\n          </div>\n          <form role="search" class="col-sm-4 form-horizontal pull-right">\n            <input id="searchbar" class="input-md form-control" placeholder="Search..." type="search" ng-model="taskAdminPager.search" autofocus />\n            <p ng-show="filteredTaskDefs.length < allTaskDefs.length && filteredTaskDefs.length != 0">Showing {{filteredTaskDefs.length}} of {{unit.task_definitions.length}} tasks.</p>\n          </form>\n        </div>\n        <div class="panel-body tasks-overview">\n          <div class="callout callout-info" ng-hide="unit.task_definitions.length > 0">\n            This unit has no tasks\n          </div>\n          <table ng-show="unit.task_definitions.length > 0" class="table table-condensed table-hover table-pointer">\n            <thead>\n              <tr>\n                <th>\n                  <a ng-click="taskAdminPager.sortOrder=\'abbreviation\'; taskAdminPager.reverse=!taskAdminPager.reverse">\n                    Name <i ng-show="taskAdminPager.sortOrder==\'abbreviation\'" class="fa fa-caret-{{taskAdminPager.reverse ? \'down\' : \'up\'}}"></i>\n                  </a>\n                </th>\n                <th>\n                  <a ng-click="taskAdminPager.sortOrder=\'target_grade\'; taskAdminPager.reverse=!taskAdminPager.reverse">\n                    Grade <i ng-show="taskAdminPager.sortOrder==\'target_grade\'" class="fa fa-caret-{{taskAdminPager.reverse ? \'down\' : \'up\'}}"></i>\n                  </a>\n                </th>\n                <th>\n                  <a ng-click="taskAdminPager.sortOrder=\'start_date\'; taskAdminPager.reverse=!taskAdminPager.reverse">\n                    Start Date <i ng-show="taskAdminPager.sortOrder==\'start_date\'" class="fa fa-caret-{{taskAdminPager.reverse ? \'down\' : \'up\'}}"></i>\n                  </a>\n                </th>\n                <th>\n                  <a ng-click="taskAdminPager.sortOrder=\'target_date\'; taskAdminPager.reverse=!taskAdminPager.reverse">\n                    Target Date <i ng-show="taskAdminPager.sortOrder==\'target_date\'" class="fa fa-caret-{{taskAdminPager.reverse ? \'down\' : \'up\'}}"></i>\n                  </a>\n                </th>\n                <th>\n                  <a ng-click="taskAdminPager.sortOrder=\'due_date\'; taskAdminPager.reverse=!taskAdminPager.reverse">\n                    Due Date <i ng-show="taskAdminPager.sortOrder==\'due_date\'" class="fa fa-caret-{{taskAdminPager.reverse ? \'down\' : \'up\'}}"></i>\n                  </a>\n                </th>\n                <th ng-show="unit.hasGroupwork()">\n                  <a ng-click="taskAdminPager.sortOrder=\'group_set_id\'; taskAdminPager.reverse=!taskAdminPager.reverse">\n                    Group Set <i ng-show="taskAdminPager.sortOrder==\'group_set_id\'" class="fa fa-caret-{{taskAdminPager.reverse ? \'down\' : \'up\'}}"></i>\n                  </a>\n                </th>\n                <th>\n                  <a ng-click="taskAdminPager.sortOrder=\'upload_requirements.length\'; taskAdminPager.reverse=!taskAdminPager.reverse">\n                    <i class="fa fa-upload" tooltip="The number of files the student needs to submit."></i> <i ng-show="taskAdminPager.sortOrder==\'upload_requirements.length\'" class="fa fa-caret-{{taskAdminPager.reverse ? \'down\' : \'up\'}}"></i>\n                  </a>\n                </th>\n                <th>\n                  <a ng-click="taskAdminPager.sortOrder=\'hasPlagiarismCheck()\'; taskAdminPager.reverse=!taskAdminPager.reverse">\n                    <i class="fa fa-eye" tooltip="Is plagiarism checked?"></i> <i ng-show="taskAdminPager.sortOrder==\'hasPlagiarismCheck()\'" class="fa fa-caret-{{taskAdminPager.reverse ? \'down\' : \'up\'}}"></i>\n                  </a>\n                </th>\n                <th>\n                  <a ng-click="taskAdminPager.sortOrder=\'restrict_status_updates\'; taskAdminPager.reverse=!taskAdminPager.reverse">\n                    <i class="fa fa-lock" tooltip="Are status updated locked to staff only?"></i> <i ng-show="taskAdminPager.sortOrder==\'restrict_status_updates\'" class="fa fa-caret-{{taskAdminPager.reverse ? \'down\' : \'up\'}}"></i>\n                  </a>\n                </th>\n                <th>\n                  Actions\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr ng-repeat="task in filteredTaskDefs = (allTaskDefs = ( unit.task_definitions ) | filter:taskAdminPager.search) | orderBy:taskAdminPager.sortOrder:taskAdminPager.reverse | startFrom:(taskAdminPager.currentPage - 1) * taskAdminPager.pageSize | limitTo: taskAdminPager.pageSize" ng-click="editTask(task)" ng-class="{\'info\': taskAdminData.selectedTask == task}">\n                <td><strong>{{task.abbreviation}}</strong> - {{task.name}}</td>\n                <td>{{grades[task.target_grade]}}</td>\n                <td>{{task.start_date | date:\'d MMM yyyy\'}}</td>\n                <td>{{task.target_date | date:\'d MMM yyyy\'}}</td>\n                <td><span ng-show="task.due_date">{{task.due_date | date:\'d MMM yyyy\'}}</span><span ng-hide="task.due_date">None</span></td>\n                <td ng-show="unit.hasGroupwork()">{{groupSetName(task.group_set_id)}}</td>\n                <td>{{task.upload_requirements.length}}</td>\n                <td><i ng-show="task.hasPlagiarismCheck()" class="fa fa-check"></i><i ng-hide="task.hasPlagiarismCheck()" class="fa fa-times"></i></td>\n                <td><i ng-show="task.restrict_status_updates" class="fa fa-check"></i><i ng-hide="task.restrict_status_updates" class="fa fa-times"></i></td>\n                <td>\n                  <button class="btn btn-danger" ng-click="deleteTask(task)">\n                    <i class="fa fa-trash-o"></i>\n                  </button>\n                </td>\n              </tr>\n            </tbody>\n          </table><!--/task-table-->\n        </div>\n        <div class="panel-footer clearfix">\n          <pagination  ng-show="unit.task_definitions.length > taskAdminPager.pageSize" total-items="unit.task_definitions.length" ng-model="taskAdminPager.currentPage" items-per-page="taskAdminPager.pageSize" max-size="taskAdminPager.maxSize" class="pagination-sm pull-left" boundary-links="true" rotate="false"></pagination>\n          <button class="btn btn-success pull-right" ng-click="createTask()">\n            <i class="fa fa-file"></i>\n            <i class="fa fa-plus"></i> Add Task\n          </button>\n        </div>\n      </div><!--/tasks-overview-->\n      <task-definition-editor\n        unit="unit"\n        task="taskAdminData.selectedTask"\n        is-new="taskAdminData.isNew"></task-definition-editor>\n    </div>\n    <div class="col-md-3">\n          <div class="panel panel-default">\n              <div class="panel-heading">\n                  <h4 class="panel-title">Batch Upload Task Definitions</h4>\n                  <p>Batch upload task definitions with a CSV containing: name, abbreviation, description, weighting, target_grade, restrict_status_updates, upload_requirements, target_week, target_day, due_week, due_day.</p><p>Note: Upload_requirements should be an escaped-JSON-formatted string an array of objects containing a "key",  "name" and "type". Target and due weeks should be the number of weeks from the unit start, and the day should be a short text (eg "Tue").</p>\n              </div>\n              <div class="panel-body">\n                  <file-uploader\n                    files="batchFiles"\n                    url="batchTaskUrl()"\n                    on-success="onBatchTaskSuccess"></file-uploader>\n              </div><!--batch-withdraw-->\n              <div class="panel-heading">\n                  <h4 class="panel-title">Download Tasks</h4>\n                  Download all tasks for the unit.\n              </div>\n              <div class="panel-body text-center">\n                <div class="btn-group col-sm-12">\n                  <a tooltip="Download a CSV with details of all tasks" tooltip-append-to-body="true" target="_blank" ng-href="{{batchTaskUrl()}}" class="btn btn-primary col-sm-6">\n                    <i class="fa fa-download"></i> <i class="fa fa-file-excel-o"></i> CSV\n                  </a>\n                  <a tooltip="Download task resources and task sheets for all tasks" tooltip-append-to-body="true" target="_blank" ng-href="{{allResourceUrl()}}" class="btn btn-info col-sm-6">\n                    <i class="fa fa-download"></i> <i class="fa fa-file-zip-o"></i> Zip\n                  </a>\n                </div>\n              </div>\n              <div class="panel-heading">\n                  <h4 class="panel-title">Upload All Task PDFs</h4>\n                  Upload PDFs of tasks such that they are viewable for students Doubtfire under the relevant task. Upload a ZIP containing PDFs and ZIP file resources. Name each with task abbreviation.\n              </div>\n              <div class="panel-body">\n                <file-uploader\n                  files="taskFiles"\n                  url="taskUploadUrl"\n                  on-success="onTaskPDFSuccess"></file-uploader>\n                  <table ng-show="filesUploaded" class="table table-condensed table-hover">\n                    <thead>\n                      <tr>\n                        <th>Filename</th>\n                        <th>Details</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr ng-repeat="file in filesUploaded.ignored_files">\n                        <td>{{file.name}}</td><td>Ignored</td>\n                      </tr>\n                      <tr ng-repeat="file in filesUploaded.added_files">\n                        <td>{{file.name}}</td><td>Added</td>\n                      </tr>\n                    </tbody>\n                </table>\n              </div><!--batch-enrol-->\n          </div>\n      </div>\n  </div>\n</div>\n')}]),angular.module("units/unit-tutorials-editor/unit-tutorials-editor.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("units/unit-tutorials-editor/unit-tutorials-editor.tpl.html",'<div class="unit-tutorials-editor">\n  <div class="panel panel-primary">\n    <div class="panel-heading clearfix">\n      <h3 class="panel-title">Modify Unit Tutorials</h3>\n      Add new tutorials to the unit or modify existing ones\n    </div>\n    <div class="panel-body">\n      <div ng-hide="unit.tutorials.length > 0" class="callout callout-info">\n        This unit has no tutorials\n      </div>\n      <table ng-show="unit.tutorials.length > 0" class="table table-condensed table-hover table-pointer">\n        <thead>\n          <tr>\n            <th>Abbreviation</th>\n            <th>Location</th>\n            <th>Day</th>\n            <th>Time</th>\n            <th>Tutor</th>\n            <th>Actions</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr ng-repeat="tutorial in unit.tutorials">\n            <td ng-click="editTutorial(tutorial)">{{tutorial.abbreviation}}</td>\n            <td ng-click="editTutorial(tutorial)">{{tutorial.meeting_location}}</td>\n            <td ng-click="editTutorial(tutorial)">{{tutorial.meeting_day}}</td>\n            <td ng-click="editTutorial(tutorial)">{{tutorial.meeting_time | date:\'HH:mm\'}}</td>\n            <td ng-click="editTutorial(tutorial)">{{tutorial.tutor_name}}</td>\n            <td>\n              <button class="btn btn-danger" ng-click="deleteTutorial(tutorial)">\n                <i class="fa fa-trash-o"></i>\n              </button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n    <div class="panel-footer clearfix">\n      <button class="btn btn-success pull-right" ng-click="createTutorial()">\n        <i class="fa fa-pencil"></i>\n        <i class="fa fa-plus"></i> Add Tutorial\n      </button>\n    </div>\n  </div>\n</div>\n')}]),angular.module("users/modals/user-notification-settings-modal/user-notification-settings-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("users/modals/user-notification-settings-modal/user-notification-settings-modal.tpl.html",'<div>\n  <form class="form-horizontal" ng-submit="saveNotifications()" role="form">\n    <div class="modal-header">\n      <h3>Notification Settings</h3>\n    </div>\n    <div class="modal-body">\n      <div class="form-group">\n        <label class="col-sm-6 control-label">Task Notifications</label>\n        <div class="btn-group">\n          <label class="btn btn-default" ng-model="user.receive_task_notifications" btn-radio="true" uncheckable>\n            <i class="glyphicon glyphicon-ok"></i>\n          </label>\n          <label class="btn btn-default" ng-model="user.receive_task_notifications" btn-radio="false" uncheckable>\n            <i class="glyphicon glyphicon-remove"></i>\n          </label>\n        </div>\n      </div>\n      <div class="form-group">\n        <label class="col-sm-6 control-label">Feedback Notifications</label>\n        <div class="btn-group">\n          <label class="btn btn-default" ng-model="user.receive_feedback_notifications" btn-radio="true" uncheckable>\n            <i class="glyphicon glyphicon-ok"></i>\n          </label>\n          <label class="btn btn-default" ng-model="user.receive_feedback_notifications" btn-radio="false" uncheckable>\n            <i class="glyphicon glyphicon-remove"></i>\n          </label>\n        </div>\n      </div>\n      <div class="form-group">\n        <label class="col-sm-6 control-label">Portfolio Notifications</label>\n        <div class="btn-group">\n          <label class="btn btn-default" ng-model="user.receive_portfolio_notifications" btn-radio="true" uncheckable>\n            <i class="glyphicon glyphicon-ok"></i>\n          </label>\n          <label class="btn btn-default" ng-model="user.receive_portfolio_notifications" btn-radio="false" uncheckable>\n            <i class="glyphicon glyphicon-remove"></i>\n          </label>\n        </div>\n      </div>\n    </div>\n    <div class="modal-footer text-right">\n      <input type="submit" class="btn btn-primary" value="Save" />\n    </div>\n  </form>\n</div>\n')}]),angular.module("users/modals/user-settings-modal/user-settings-modal.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("users/modals/user-settings-modal/user-settings-modal.tpl.html",'<div>\n  <form class="form-horizontal" ng-submit="saveUser()" role="form">\n    <div class="modal-header">\n      <h3>{{isNew ? "Create User" : "Edit User"}}</h3>\n    </div>\n    <div class="modal-body">\n      <div class="form-group" ng-if="!isNew">\n        <label class="col-sm-3 control-label">Username</label>\n        <div class="col-sm-7">\n          <p class="form-control-static">{{user.username}}</p>\n        </div>\n      </div>\n      <div class="form-group" ng-if="isNew">\n        <label class="col-sm-3 control-label" ng-required="isNew">Username</label>\n        <div class="col-sm-7">\n          <input type="input" class="form-control" placeholder="1744070" ng-model="user.username">\n        </div>\n      </div>\n      <div class="form-group" ng-required="isNew">\n        <label class="col-sm-3 control-label">First Name</label>\n        <div class="col-sm-7">\n          <input type="input" class="form-control" placeholder="Fred" ng-model="user.first_name">\n        </div>\n      </div>\n      <div class="form-group" ng-required="isNew">\n        <label class="col-sm-3 control-label">Last Name</label>\n        <div class="col-sm-7">\n          <input type="input" class="form-control" placeholder="Derf" ng-model="user.last_name">\n        </div>\n      </div>\n      <div class="form-group" ng-required="isNew">\n        <label class="col-sm-3 control-label">Email</label>\n        <div class="col-sm-7">\n          <input type="email" class="form-control" placeholder="fred@doubtfire.org" ng-model="user.email">\n        </div>\n      </div>\n      <div class="form-group">\n        <label class="col-sm-3 control-label">Nickname</label>\n        <div class="col-sm-7">\n          <input type="input" class="form-control" placeholder="Freddy McDerfson" ng-model="user.nickname">\n        </div>\n      </div>\n      <div class="form-group" if-role="Admin Convenor" ng-required="isNew">\n        <label class="col-sm-3 control-label">System Role</label>\n        <div class="col-sm-7">\n          <label class="radio-inline" if-role="Admin">\n            <input type="radio" ng-disabled="user.id == currentUser.id" name="sysRole" if-role="Admin" ng-model="user.system_role" value="Admin">Administrator\n          </label>\n          <label class="radio-inline">\n            <input type="radio" ng-disabled="user.id == currentUser.id" name="sysRole" if-role="Admin Convenor" ng-model="user.system_role" value="Convenor">Convenor\n          </label>\n          <label class="radio-inline">\n            <input type="radio" ng-disabled="user.id == currentUser.id" name="sysRole" if-role="Admin Convenor" ng-model="user.system_role" value="Tutor">Tutor\n          </label>\n          <label class="radio-inline">\n            <input type="radio" ng-disabled="user.id == currentUser.id" name="sysRole" if-role="Admin Convenor" ng-model="user.system_role" value="Student">Student\n          </label>\n          <p ng-show="user.id == currentUser.id" class="help-block text-center">You cannot modify your own permissions</p>\n        </div>\n      </div>\n      <div ng-if="!isNew && user.id == currentUser.id">\n        <hr>\n        <div class="form-group">\n          <label class="col-sm-3 control-label">Allow Analytics</label>\n          <div class="col-sm-7">\n            <div class="btn-group">\n              <label class="btn btn-default" ng-model="user.opt_in_to_research" btn-radio="true">\n                <i class="fa fa-check"></i>\n              </label>\n              <label class="btn btn-default" ng-model="user.opt_in_to_research" btn-radio="false">\n                <i class="fa fa-close"></i>\n              </label>\n            </div>\n            <p class="help-block">Allow us to anonymously gather your usage to improve Doubtfire</p>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="modal-footer text-right">\n      <input type="submit" class="btn btn-primary" value="{{isNew ? \'Add\' : \'Save\'}}" />\n    </div>\n  </form>\n</div>\n')}]),angular.module("users/states/users-admin-view/users-admin-view.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("users/states/users-admin-view/users-admin-view.tpl.html",'<div class="user-admin-view">\n<ul class="breadcrumb">\n  <li><a href="#/home">Home</a></li>\n  <li>Administrator</li>\n  <li class="active">Manage Users</li>\n</ul>\n<div id=\'admin-users\'>\n  <div ng-show="users == null" class="large-notice-block">\n    <i class="fa fa-2x fa-spinner fa-pulse"></i>\n    <p>Loading...</p>\n  </div><!--/loading-->\n  <div ng-if="users != null">\n    <h2>\n      Doubtfire Users\n      <p class="lead">Users Administration View</p>\n    </h2>\n    <div class="col-sm-9">\n      <div class="panel panel-primary">\n        <div class="panel-heading clearfix">\n          <div class="pull-left">\n            <h4 class="panel-title">\n              Doubtfire Users\n            </h4>\n            Modify users registered with Doubtfire\n          </div>\n          <form role="search" class="pull-right form-horizontal">\n            <input id="searchbar" class="input-md form-control" placeholder="Search for users..." type="search" ng-model="search.$" typeahead="user.name for user in users | filter:$viewValue | limitTo:8" />\n            <p ng-show="filteredUsers.length < students.length && filteredUsers.length != 0">Showing {{filteredUsers.length}} of {{users.length}} users.</p>\n            <p ng-show="filteredUsers.length < students.length && filteredUsers.length == 0">No students found.</p>\n          </form>\n        </div>\n        <div class="panel-body">\n          <div class="callout callout-info" ng-hide="users.length > 0">No users have been registered with Doubtfire yet</div>\n          <table class="table table-condensed table-hover">\n            <thead>\n              <tr>\n                <th><a ng-click="sortOrder=\'id\'; reverse=!reverse">User ID</a></th>\n                <th><a ng-click="sortOrder=\'first_name\'; reverse=!reverse">First Name</a></th>\n                <th><a ng-click="sortOrder=\'last_name\'; reverse=!reverse">Last Name</a></th>\n                <th>Username</th>\n                <th>Email</th>\n                <th><a ng-click="sortOrder=\'system_role\'; reverse=!reverse">System Role</a></th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr class="pointer" ng-repeat="user in filteredUsers = (users | filter:search) | orderBy:sortOrder:reverse | startFrom:(currentPage - 1) * pageSize | limitTo: pageSize" ng-click="showUserModal(user)">\n                <td>{{user.id}}</td>\n                <td>{{user.first_name}}</td>\n                <td>{{user.last_name}}</td>\n                <td>{{user.username}}</td>\n                <td><a href="mailto:{{user.email}}">{{user.email}}</a></td>\n                <td>\n                  {{user.system_role}}\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        <div class="panel-footer clearfix">\n          <a href class="btn btn-success pull-right" ng-click="showUserModal()">\n            <i class="fa fa-user"></i>\n            <i class="fa fa-plus"></i>\n             Add New User\n          </a>\n          <pagination total-items="filteredUsers.length" ng-model="currentPage" items-per-page="pageSize" max-size="maxSize" class="pagination-sm pull-left" boundary-links="true" rotate="false"></pagination>\n        </div>\n      </div>\n    </div>\n    <div class="col-sm-3">\n      <div class="panel panel-default">\n        <div class="panel-heading">\n          <h4 class="panel-title">Batch Import Users</h4>\n          Import users using a CSV containing: email, first_name, last_name, username, nickname, role\n        </div>\n        <div class="panel-body">\n          <file-uploader\n            url="file_data.batchUserUrl"\n            files="file_data.batchUserFiles"\n            on-success="file_data.onBatchUserSuccess"></file-uploader>\n        </div>\n        <div class="panel-heading">\n          <h4 class="panel-title">Batch Export Users</h4>\n          Download a CSV of all users registered with Doubtfire.\n        </div>\n        <div class="panel-body text-center">\n          <a href="batchUserUrl" class="btn btn-primary btn-download">\n            <i class="fa fa-download"></i> Download\n          </a>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n</div>\n')}]),angular.module("visualisations/visualisation.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("visualisations/visualisation.tpl.html",'<div ng-isolate-scope>\n  <nvd3 options="options" data="data" id="chart" api="api" config="config"></nvd3>\n</div>\n')}]),angular.module("templates-common",[])}(window,window.angular);